/*! glpk.js - v4.47.0
* https://github.com/hgourvest/glpk.js
* Copyright (c) 2012 Henri Gourvest; Licensed GPLv2 */
(function(exports) {
var k=void 0,aa=!0,s=null,ia=!1,ja=ia,v=Number.MAX_VALUE,ma=Number.MIN_VALUE,na=16,pa=2147483647,ra=2.220446049250313E-16,sa=1,ta=1E8,ya=1E8,Ba=-1;function y(a){throw Error(a);}function B(a){console.log(a)}exports.__defineGetter__("glp_print_func",function(){return B});exports.__defineSetter__("glp_print_func",function(a){B=a});function Ca(a,b,c,d,e){for(;0<e;b++,d++,e--)a[b]=c[d]}function Da(a,b,c,d){for(;0<d;b++,d--)a[b]=c}function Ea(a,b,c){for(;0<c;b++,c--)a[b]={}}
function Ga(){return(new Date).getTime()}function La(a){return(Ga()-a)/1E3}function Ma(a,b,c){var d=Array(b);Ca(d,0,a,1,b);d.sort(c);Ca(a,1,d,0,b)}var Pa={},ab=exports.glp_version=function(){return Qa+"."+Va};function eb(a){a="string"==typeof a?a.charCodeAt(0):-1;return 0<=a&&31>=a||127==a}function fb(a){a="string"==typeof a?a.charCodeAt(0):-1;return 65<=a&&90>=a||97<=a&&122>=a}function qb(a){a="string"==typeof a?a.charCodeAt(0):-1;return 65<=a&&90>=a||97<=a&&122>=a||48<=a&&57>=a}
function rb(a){a="string"==typeof a?a.charCodeAt(0):-1;return 48<=a&&57>=a}
function vb(){function a(a,d,e,h,l,m,n){a>>>=0;e=e&&a&&{2:"0b",8:"0",16:"0x"}[d]||"";a=e+c(a.toString(d),m||0,"0",ia);return b(a,e,h,l,n)}function b(a,b,d,e,l,m){var n=e-a.length;0<n&&(a=d||!l?c(a,e,m,d):a.slice(0,b.length)+c("",n,"0",aa)+a.slice(b.length));return a}function c(a,b,c,d){c||(c=" ");b=a.length>=b?"":Array(1+b-a.length>>>0).join(c);return d?a+b:b+a}var d=arguments,e=0;return d[e++].replace(/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuideEfFgG])/g,function(f,
g,j,h,l,m,n){var p,t;if("%%"==f)return"%";var r=ia;t="";var w=l=ia;p=" ";for(var E=j.length,q=0;j&&q<E;q++)switch(j.charAt(q)){case " ":t=" ";break;case "+":t="+";break;case "-":r=aa;break;case "'":p=j.charAt(q+1);break;case "0":l=aa;break;case "#":w=aa}h=h?"*"==h?+d[e++]:"*"==h.charAt(0)?+d[h.slice(1,-1)]:+h:0;0>h&&(h=-h,r=aa);if(!isFinite(h))throw Error("sprintf: (minimum-)width must be finite");m=m?"*"==m?+d[e++]:"*"==m.charAt(0)?+d[m.slice(1,-1)]:+m:-1<"fFeE".indexOf(n)?6:"d"==n?0:k;g=g?d[g.slice(0,
-1)]:d[e++];switch(n){case "s":return n=String(g),m!=s&&(n=n.slice(0,m)),b(n,"",r,h,l,p);case "c":return n=String.fromCharCode(+g),m!=s&&(n=n.slice(0,m)),b(n,"",r,h,l,k);case "b":return a(g,2,w,r,h,m,l);case "o":return a(g,8,w,r,h,m,l);case "x":return a(g,16,w,r,h,m,l);case "X":return a(g,16,w,r,h,m,l).toUpperCase();case "u":return a(g,10,w,r,h,m,l);case "i":case "d":return p=+g||0,p=Math.round(p-p%1),f=0>p?"-":t,g=f+c(String(Math.abs(p)),m,"0",ia),b(g,f,r,h,l);case "e":case "E":case "f":case "F":case "g":case "G":return p=
+g,f=0>p?"-":t,t=["toExponential","toFixed","toPrecision"]["efg".indexOf(n.toLowerCase())],n=["toString","toUpperCase"]["eEfFgG".indexOf(n)%2],g=f+Math.abs(p)[t](m),b(g,f,r,h,l)[n]();default:return f}})}var wb=3621377730;function Ab(a){a.xd=wb;a.ee=s;a.W=s;a.name=s;a.Ya=s;a.dir=Gb;a.da=0;a.ab=100;a.I=200;a.f=a.h=0;a.J=0;a.k=Array(1+a.ab);a.e=Array(1+a.I);a.bc={};a.Jc={};a.valid=0;a.head=Array(1+a.ab);a.Kd=s;a.R=s;a.la=a.pa=Vb;a.Y=0;a.V=0;a.some=0;a.Te=Vb;a.Wd=0;a.va=Vb;a.qa=0}
var Wb=exports.glp_create_prob=function(){var a={};Ab(a);return a},Xb=exports.glp_set_prob_name=function(a,b){var c=a.W;c!=s&&0!=c.reason&&y("glp_set_prob_name: operation not allowed");a.name=b},dc=exports.glp_set_obj_name=function(a,b){var c=a.W;c!=s&&0!=c.reason&&y("glp_set_obj_name: operation not allowed");a.Ya=b},nc=exports.glp_set_obj_dir=function(a,b){var c=a.W;c!=s&&0!=c.reason&&y("glp_set_obj_dir: operation not allowed");b==Gb||b==ec||y("glp_set_obj_dir: dir = "+b+"; invalid direction flag");
a.dir=b},zc=exports.glp_add_rows=function(a,b){var c=a.W,d;1>b&&y("glp_add_rows: nrs = "+b+"; invalid number of rows");b>ta-a.f&&y("glp_add_rows: nrs = "+b+"; too many rows");var e=a.f+b;if(a.ab<e){for(;a.ab<e;)a.ab+=a.ab;a.k.length=1+a.ab;a.head=Array(1+a.ab)}for(var f=a.f+1;f<=e;f++){a.k[f]=d={};d.ca=f;d.name=s;d.mb=s;d.Ha=0;d.origin=0;d.mc=0;if(c!=s)switch(c.reason){case oc:d.Ha=c.L.Ha;d.origin=pc;break;case qc:d.Ha=c.L.Ha,d.origin=xc}d.type=yc;d.c=d.d=0;d.j=s;d.ka=1;d.l=D;d.bind=0;d.q=d.H=0;d.$b=
d.hc=0;d.Oa=0}a.f=e;a.valid=0;c!=s&&0!=c.reason&&(c.ie=1);return e-b+1},Hc=exports.glp_add_cols=function(a,b){var c=a.W;c!=s&&0!=c.reason&&y("glp_add_cols: operation not allowed");1>b&&y("glp_add_cols: ncs = "+b+"; invalid number of columns");b>ya-a.h&&y("glp_add_cols: ncs = "+b+"; too many columns");var d=a.h+b;if(a.I<d){for(;a.I<d;)a.I+=a.I;a.e.length=1+a.I}for(var e=a.h+1;e<=d;e++)a.e[e]=c={},c.A=e,c.name=s,c.mb=s,c.Aa=Fc,c.type=G,c.c=c.d=0,c.t=0,c.j=s,c.sa=1,c.l=Gc,c.bind=0,c.q=c.H=0,c.$b=c.hc=
0,c.Oa=0;a.h=d;return d-b+1},Mc=exports.glp_set_row_name=function(a,b,c){1<=b&&b<=a.f||y("glp_set_row_name: i = "+b+"; row number out of range");b=a.k[b];b.name!=s&&(delete a.bc[b.name],b.name=s);c!=s&&(b.name=c,a.bc[b.name]=b)},Xc=exports.glp_set_col_name=function(a,b,c){var d=a.W;d!=s&&0!=d.reason&&y("glp_set_col_name: operation not allowed");1<=b&&b<=a.h||y("glp_set_col_name: j = "+b+"; column number out of range");b=a.e[b];b.name!=s&&(delete a.Jc[b.name],b.name=s);c!=s&&(b.name=c,a.Jc[b.name]=
b)},pd=exports.glp_set_row_bnds=function(a,b,c,d,e){1<=b&&b<=a.f||y("glp_set_row_bnds: i = "+b+"; row number out of range");a=a.k[b];a.type=c;switch(c){case yc:a.c=a.d=0;a.l!=D&&(a.l=Yc);break;case Zc:a.c=d;a.d=0;a.l!=D&&(a.l=K);break;case $c:a.c=0;a.d=e;a.l!=D&&(a.l=od);break;case R:a.c=d;a.d=e;a.l==D||(a.l==K||a.l==od)||(a.l=Math.abs(d)<=Math.abs(e)?K:od);break;case G:a.c=a.d=d;a.l!=D&&(a.l=Gc);break;default:y("glp_set_row_bnds: i = "+b+"; type = "+c+"; invalid row type")}},qd=exports.glp_set_col_bnds=
function(a,b,c,d,e){1<=b&&b<=a.h||y("glp_set_col_bnds: j = "+b+"; column number out of range");a=a.e[b];a.type=c;switch(c){case yc:a.c=a.d=0;a.l!=D&&(a.l=Yc);break;case Zc:a.c=d;a.d=0;a.l!=D&&(a.l=K);break;case $c:a.c=0;a.d=e;a.l!=D&&(a.l=od);break;case R:a.c=d;a.d=e;a.l==D||(a.l==K||a.l==od)||(a.l=Math.abs(d)<=Math.abs(e)?K:od);break;case G:a.c=a.d=d;a.l!=D&&(a.l=Gc);break;default:y("glp_set_col_bnds: j = "+b+"; type = "+c+"; invalid column type")}},rd=exports.glp_set_obj_coef=function(a,b,c){var d=
a.W;d!=s&&0!=d.reason&&y("glp_set_obj_coef: operation not allowed");0<=b&&b<=a.h||y("glp_set_obj_coef: j = "+b+"; column number out of range");0==b?a.da=c:a.e[b].t=c},sd=exports.glp_set_mat_row=function(a,b,c,d,e){var f,g,j;1<=b&&b<=a.f||y("glp_set_mat_row: i = "+b+"; row number out of range");for(var h=a.k[b];h.j!=s;)g=h.j,h.j=g.w,f=g.e,g.oa==s?f.j=g.G:g.oa.G=g.G,g.G!=s&&(g.G.oa=g.oa),a.J--,f.l==D&&(a.valid=0);0<=c&&c<=a.h||y("glp_set_mat_row: i = "+b+"; len = "+c+"; invalid row length ");c>5E8-
a.J&&y("glp_set_mat_row: i = "+b+"; len = "+c+"; too many constraint coefficients");for(j=1;j<=c;j++)g=d[j],1<=g&&g<=a.h||y("glp_set_mat_row: i = "+b+"; ind["+j+"] = "+g+"; column index out of range"),f=a.e[g],f.j!=s&&f.j.k.ca==b&&y("glp_set_mat_row: i = "+b+"; ind["+j+"] = "+g+"; duplicate column indices not allowed"),g={},a.J++,g.k=h,g.e=f,g.i=e[j],g.ra=s,g.w=h.j,g.oa=s,g.G=f.j,g.w!=s&&(g.w.ra=g),g.G!=s&&(g.G.oa=g),h.j=f.j=g,f.l==D&&0!=g.i&&(a.valid=0);for(g=h.j;g!=s;g=b)b=g.w,0==g.i&&(g.ra==s?
h.j=b:g.ra.w=b,b!=s&&(b.ra=g.ra),g.e.j=g.G,g.G!=s&&(g.G.oa=s),a.J--)},td=exports.glp_set_mat_col=function(a,b,c,d,e){var f=a.W,g,j,h;f!=s&&0!=f.reason&&y("glp_set_mat_col: operation not allowed");1<=b&&b<=a.h||y("glp_set_mat_col: j = "+b+"; column number out of range");for(f=a.e[b];f.j!=s;)j=f.j,f.j=j.G,g=j.k,j.ra==s?g.j=j.w:j.ra.w=j.w,j.w!=s&&(j.w.ra=j.ra),a.J--;0<=c&&c<=a.f||y("glp_set_mat_col: j = "+b+"; len = "+c+"; invalid column length");c>5E8-a.J&&y("glp_set_mat_col: j = "+b+"; len = "+c+"; too many constraint coefficients");
for(h=1;h<=c;h++)j=d[h],1<=j&&j<=a.f||y("glp_set_mat_col: j = "+b+"; ind["+h+"] = "+j+"; row index out of range"),g=a.k[j],g.j!=s&&g.j.e.A==b&&y("glp_set_mat_col: j = "+b+"; ind["+h+"] = "+j+"; duplicate row indices not allowed"),j={},a.J++,j.k=g,j.e=f,j.i=e[h],j.ra=s,j.w=g.j,j.oa=s,j.G=f.j,j.w!=s&&(j.w.ra=j),j.G!=s&&(j.G.oa=j),g.j=f.j=j;for(j=f.j;j!=s;j=b)b=j.G,0==j.i&&(j.k.j=j.w,j.w!=s&&(j.w.ra=s),j.oa==s?f.j=b:j.oa.G=b,b!=s&&(b.oa=j.oa),a.J--);f.l==D&&(a.valid=0)};
exports.glp_load_matrix=function(a,b,c,d,e){var f=a.W,g,j,h,l;f!=s&&0!=f.reason&&y("glp_load_matrix: operation not allowed");for(h=1;h<=a.f;h++)for(f=a.k[h];f.j!=s;)j=f.j,f.j=j.w,a.J--;for(j=1;j<=a.h;j++)a.e[j].j=s;0>b&&y("glp_load_matrix: ne = "+b+"; invalid number of constraint coefficients");5E8<b&&y("glp_load_matrix: ne = "+b+"; too many constraint coefficients");for(l=1;l<=b;l++)h=c[l],j=d[l],1<=h&&h<=a.f||y("glp_load_matrix: ia["+l+"] = "+h+"; row index out of range"),f=a.k[h],1<=j&&j<=a.h||
y("glp_load_matrix: ja["+l+"] = "+j+"; column index out of range"),g=a.e[j],j={},a.J++,j.k=f,j.e=g,j.i=e[l],j.ra=s,j.w=f.j,j.w!=s&&(j.w.ra=j),f.j=j;for(h=1;h<=a.f;h++)for(j=a.k[h].j;j!=s;j=j.w){g=j.e;if(g.j!=s&&g.j.k.ca==h){for(l=1;l<=b&&!(c[l]==h&&d[l]==g.A);l++);y("glp_load_mat: ia["+l+"] = "+h+"; ja["+l+"] = "+g.A+"; duplicate indices not allowed")}j.oa=s;j.G=g.j;j.G!=s&&(j.G.oa=j);g.j=j}for(h=1;h<=a.f;h++){f=a.k[h];for(j=f.j;j!=s;j=b)b=j.w,0==j.i&&(j.ra==s?f.j=b:j.ra.w=b,b!=s&&(b.ra=j.ra),j.oa==
s?j.e.j=j.G:j.oa.G=j.G,j.G!=s&&(j.G.oa=j.oa),a.J--)}a.valid=0};
exports.glp_check_dup=function(a,b,c,d,e){var f,g,j,h,l,m;0>a&&y("glp_check_dup: m = %d; invalid parameter");0>b&&y("glp_check_dup: n = %d; invalid parameter");0>c&&y("glp_check_dup: ne = %d; invalid parameter");0<c&&d==s&&y("glp_check_dup: ia = "+d+"; invalid parameter");0<c&&e==s&&y("glp_check_dup: ja = "+e+"; invalid parameter");for(j=1;j<=c;j++)if(f=d[j],g=e[j],!(1<=f&&f<=a&&1<=g&&g<=b))return a=-j;if(0==a||0==b)return 0;h=Array(1+a);l=Array(1+c);m=Array(1+b);for(f=1;f<=a;f++)h[f]=0;for(j=1;j<=
c;j++)f=d[j],l[j]=h[f],h[f]=j;for(g=1;g<=b;g++)m[g]=0;for(f=1;f<=a;f++){for(j=h[f];0!=j;j=l[j]){g=e[j];if(m[g]){for(j=1;j<=c&&!(d[j]==f&&e[j]==g);j++);for(j++;j<=c&&!(d[j]==f&&e[j]==g);j++);return a=+j}m[g]=1}for(j=h[f];0!=j;j=l[j])m[e[j]]=0}return 0};
var Bd=exports.glp_sort_matrix=function(a){var b,c,d;(a==s||a.xd!=wb)&&y("glp_sort_matrix: P = "+a+"; invalid problem object");for(c=a.f;1<=c;c--)a.k[c].j=s;for(d=a.h;1<=d;d--)for(b=a.e[d].j;b!=s;b=b.G)c=b.k.ca,b.ra=s,b.w=a.k[c].j,b.w!=s&&(b.w.ra=b),a.k[c].j=b;for(d=a.h;1<=d;d--)a.e[d].j=s;for(c=a.f;1<=c;c--)for(b=a.k[c].j;b!=s;b=b.w)d=b.e.A,b.oa=s,b.G=a.e[d].j,b.G!=s&&(b.G.oa=b),a.e[d].j=b},Cd=exports.glp_del_rows=function(a,b,c){var d=a.W,e,f,g;1<=b&&b<=a.f||y("glp_del_rows: nrs = "+b+"; invalid number of rows");
for(g=1;g<=b;g++)f=c[g],1<=f&&f<=a.f||y("glp_del_rows: num["+g+"] = "+f+"; row number out of range"),e=a.k[f],d!=s&&0!=d.reason&&(d.reason==oc||d.reason==qc||y("glp_del_rows: operation not allowed"),e.Ha!=d.L.Ha&&y("glp_del_rows: num["+g+"] = "+f+"; invalid attempt to delete row created not in current subproblem"),e.l!=D&&y("glp_del_rows: num["+g+"] = "+f+"; invalid attempt to delete active row (constraint)"),d.hf=1),0==e.ca&&y("glp_del_rows: num["+g+"] = "+f+"; duplicate row numbers not allowed"),
Mc(a,f,s),sd(a,f,0,s,s),e.ca=0;b=0;for(f=1;f<=a.f;f++)e=a.k[f],0!=e.ca&&(e.ca=++b,a.k[e.ca]=e);a.f=b;a.valid=0};
exports.glp_del_cols=function(a,b,c){var d=a.W,e,f;d!=s&&0!=d.reason&&y("glp_del_cols: operation not allowed");1<=b&&b<=a.h||y("glp_del_cols: ncs = "+b+"; invalid number of columns");for(f=1;f<=b;f++)d=c[f],1<=d&&d<=a.h||y("glp_del_cols: num["+f+"] = "+d+"; column number out of range"),e=a.e[d],0==e.A&&y("glp_del_cols: num["+f+"] = "+d+"; duplicate column numbers not allowed"),Xc(a,d,s),td(a,d,0,s,s),e.A=0,e.l==D&&(a.valid=0);b=0;for(d=1;d<=a.h;d++)e=a.e[d],0!=e.A&&(e.A=++b,a.e[e.A]=e);a.h=b;if(a.valid){c=
a.f;e=a.head;for(d=1;d<=b;d++)f=a.e[d].bind,0!=f&&(e[f]=c+d)}};
var ge=exports.glp_copy_prob=function(a,b,c){var d=a.W,e={},f,g,j,h;d!=s&&0!=d.reason&&y("glp_copy_prob: operation not allowed");a==b&&y("glp_copy_prob: copying problem object to itself not allowed");c==Dd||c==Id||y("glp_copy_prob: names = "+c+"; invalid parameter");Od(a);c&&b.name!=s&&Xb(a,b.name);c&&b.Ya!=s&&dc(a,b.Ya);a.dir=b.dir;a.da=b.da;0<b.f&&zc(a,b.f);0<b.h&&Hc(a,b.h);Pd(b,e);Qd(a,e);a.la=b.la;a.pa=b.pa;a.Y=b.Y;a.some=b.some;a.Te=b.Te;a.Wd=b.Wd;a.va=b.va;a.qa=b.qa;for(f=1;f<=b.f;f++)d=a.k[f],
e=b.k[f],c&&e.name!=s&&Mc(a,f,e.name),d.type=e.type,d.c=e.c,d.d=e.d,d.ka=e.ka,d.l=e.l,d.q=e.q,d.H=e.H,d.$b=e.$b,d.hc=e.hc,d.Oa=e.Oa;j=Array(1+b.f);h=Array(1+b.f);for(f=1;f<=b.h;f++)d=a.e[f],e=b.e[f],c&&e.name!=s&&Xc(a,f,e.name),d.Aa=e.Aa,d.type=e.type,d.c=e.c,d.d=e.d,d.t=e.t,g=Rd(b,f,j,h),td(a,f,g,j,h),d.sa=e.sa,d.l=e.l,d.q=e.q,d.H=e.H,d.$b=e.$b,d.hc=e.hc,d.Oa=e.Oa},Od=exports.glp_erase_prob=function(a){var b=a.W;b!=s&&0!=b.reason&&y("glp_erase_prob: operation not allowed");a.xd=1061109567;a.ee=s;
a.k=s;a.e=s;a.bc=s;a.Jc=s;a.head=s;a.Kd=s;a.R=s;Ab(a)};exports.glp_get_prob_name=function(a){return a.name};
var he=exports.glp_get_obj_name=function(a){return a.Ya},xe=exports.glp_get_obj_dir=function(a){return a.dir},ye=exports.glp_get_num_rows=function(a){return a.f},ze=exports.glp_get_num_cols=function(a){return a.h},Ae=exports.glp_get_row_name=function(a,b){1<=b&&b<=a.f||y("glp_get_row_name: i = "+b+"; row number out of range");return a.k[b].name},Be=exports.glp_get_col_name=function(a,b){1<=b&&b<=a.h||y("glp_get_col_name: j = "+b+"; column number out of range");return a.e[b].name},Ce=exports.glp_get_row_type=
function(a,b){1<=b&&b<=a.f||y("glp_get_row_type: i = "+b+"; row number out of range");return a.k[b].type},De=exports.glp_get_row_lb=function(a,b){var c;1<=b&&b<=a.f||y("glp_get_row_lb: i = "+b+"; row number out of range");switch(a.k[b].type){case yc:case $c:c=-v;break;case Zc:case R:case G:c=a.k[b].c}return c},Qe=exports.glp_get_row_ub=function(a,b){var c;1<=b&&b<=a.f||y("glp_get_row_ub: i = "+b+"; row number out of range");switch(a.k[b].type){case yc:case Zc:c=+v;break;case $c:case R:case G:c=a.k[b].d}return c},
Re=exports.glp_get_col_type=function(a,b){1<=b&&b<=a.h||y("glp_get_col_type: j = "+b+"; column number out of range");return a.e[b].type},Se=exports.glp_get_col_lb=function(a,b){var c;1<=b&&b<=a.h||y("glp_get_col_lb: j = "+b+"; column number out of range");switch(a.e[b].type){case yc:case $c:c=-v;break;case Zc:case R:case G:c=a.e[b].c}return c},Te=exports.glp_get_col_ub=function(a,b){var c;1<=b&&b<=a.h||y("glp_get_col_ub: j = "+b+"; column number out of range");switch(a.e[b].type){case yc:case Zc:c=
+v;break;case $c:case R:case G:c=a.e[b].d}return c};exports.glp_get_obj_coef=function(a,b){0<=b&&b<=a.h||y("glp_get_obj_coef: j = "+b+"; column number out of range");return 0==b?a.da:a.e[b].t};exports.glp_get_num_nz=function(a){return a.J};
var Ue=exports.glp_get_mat_row=function(a,b,c,d){var e;1<=b&&b<=a.f||y("glp_get_mat_row: i = "+b+"; row number out of range");e=0;for(a=a.k[b].j;a!=s;a=a.w)e++,c!=s&&(c[e]=a.e.A),d!=s&&(d[e]=a.i);return e},Rd=exports.glp_get_mat_col=function(a,b,c,d){var e;1<=b&&b<=a.h||y("glp_get_mat_col: j = "+b+"; column number out of range");e=0;for(a=a.e[b].j;a!=s;a=a.G)e++,c!=s&&(c[e]=a.k.ca),d!=s&&(d[e]=a.i);return e},kf=exports.glp_create_index=function(a){var b,c;if(a.bc==s){a.bc={};for(c=1;c<=a.f;c++)b=
a.k[c],b.name!=s&&(a.bc[b.name]=b)}if(a.Jc==s){a.Jc={};for(c=1;c<=a.h;c++)b=a.e[c],b.name!=s&&(a.Jc[b.name]=b)}},lf=exports.glp_find_row=function(a,b){var c=0;a.bc==s&&y("glp_find_row: row name index does not exist");var d=a.bc[b];d&&(c=d.ca);return c},mf=exports.glp_find_col=function(a,b){var c=0;a.Jc==s&&y("glp_find_col: column name index does not exist");var d=a.Jc[b];d&&(c=d.A);return c},nf=exports.glp_delete_index=function(a){a.bc=s;a.bc=s},of=exports.glp_set_rii=function(a,b,c){1<=b&&b<=a.f||
y("glp_set_rii: i = "+b+"; row number out of range");0>=c&&y("glp_set_rii: i = "+b+"; rii = "+c+"; invalid scale factor");if(a.valid&&a.k[b].ka!=c)for(var d=a.k[b].j;d!=s;d=d.w)if(d.e.l==D){a.valid=0;break}a.k[b].ka=c},pf=exports.glp_set_sjj=function(a,b,c){1<=b&&b<=a.h||y("glp_set_sjj: j = "+b+"; column number out of range");0>=c&&y("glp_set_sjj: j = "+b+"; sjj = "+c+"; invalid scale factor");a.valid&&(a.e[b].sa!=c&&a.e[b].l==D)&&(a.valid=0);a.e[b].sa=c},qf=exports.glp_get_rii=function(a,b){1<=b&&
b<=a.f||y("glp_get_rii: i = "+b+"; row number out of range");return a.k[b].ka},rf=exports.glp_get_sjj=function(a,b){1<=b&&b<=a.h||y("glp_get_sjj: j = "+b+"; column number out of range");return a.e[b].sa},sf=exports.glp_unscale_prob=function(a){var b=ye(a),c=ze(a),d;for(d=1;d<=b;d++)of(a,d,1);for(b=1;b<=c;b++)pf(a,b,1)},tf=exports.glp_set_row_stat=function(a,b,c){1<=b&&b<=a.f||y("glp_set_row_stat: i = "+b+"; row number out of range");c==D||(c==K||c==od||c==Yc||c==Gc)||y("glp_set_row_stat: i = "+b+
"; stat = "+c+"; invalid status");b=a.k[b];if(c!=D)switch(b.type){case yc:c=Yc;break;case Zc:c=K;break;case $c:c=od;break;case R:c!=od&&(c=K);break;case G:c=Gc}if(b.l==D&&c!=D||b.l!=D&&c==D)a.valid=0;b.l=c},uf=exports.glp_set_col_stat=function(a,b,c){1<=b&&b<=a.h||y("glp_set_col_stat: j = "+b+"; column number out of range");c==D||(c==K||c==od||c==Yc||c==Gc)||y("glp_set_col_stat: j = "+b+"; stat = "+c+"; invalid status");b=a.e[b];if(c!=D)switch(b.type){case yc:c=Yc;break;case Zc:c=K;break;case $c:c=
od;break;case R:c!=od&&(c=K);break;case G:c=Gc}if(b.l==D&&c!=D||b.l!=D&&c==D)a.valid=0;b.l=c},Ff=exports.glp_std_basis=function(a){var b;for(b=1;b<=a.f;b++)tf(a,b,D);for(b=1;b<=a.h;b++){var c=a.e[b];c.type==R&&Math.abs(c.c)>Math.abs(c.d)?uf(a,b,od):uf(a,b,K)}},Pg=exports.glp_simplex=function(a,b){function c(a,b){var c;if(!Gf(a)&&(c=Hf(a),0!=c&&(c==If?b.n>=Jf&&B("glp_simplex: initial basis is invalid"):c==Kf?b.n>=Jf&&B("glp_simplex: initial basis is singular"):c==Lf&&b.n>=Jf&&B("glp_simplex: initial basis is ill-conditioned")),
0!=c))return c;b.Xa==Mf?c=Nf(a,b):b.Xa==$f?(c=ag(a,b),c==bg&&a.valid&&(c=Nf(a,b))):b.Xa==cg&&(c=ag(a,b));return c}function d(a,b){function d(){dg(e,f);f=s;eg(e,a);return h=0}var e,f=s,g={},h;b.n>=fg&&B("Preprocessing...");e=gg();hg(e,a,ig);h=kg(e,0);0!=h&&(h==ug?b.n>=fg&&B("PROBLEM HAS NO PRIMAL FEASIBLE SOLUTION"):h==vg&&b.n>=fg&&B("PROBLEM HAS NO DUAL FEASIBLE SOLUTION"));if(0!=h)return h;f=Wb();Ag(e,f);if(0==f.f&&0==f.h)return f.la=f.pa=Bg,f.Y=f.da,b.n>=Cg&&0==b.Za&&B(a.V+": obj = "+f.Y+"  infeas = 0.0"),
b.n>=fg&&B("OPTIMAL SOLUTION FOUND BY LP PREPROCESSOR"),d();b.n>=fg&&B(f.f+" row"+(1==f.f?"":"s")+", "+f.h+" column"+(1==f.h?"":"s")+", "+f.J+" non-zero"+(1==f.J?"":"s")+"");Pd(a,g);Qd(f,g);var g=Pa,j=g.zb;g.zb=!j||b.n<fg?Id:Dd;Dg(f,Eg);g.zb=j;g=Pa;j=g.zb;g.zb=!j||b.n<fg?Id:Dd;Fg(f);g.zb=j;f.V=a.V;h=c(f,b);a.V=f.V;return!(0==h&&f.la==Bg&&f.pa==Bg)?(b.n>=Jf&&B("glp_simplex: unable to recover undefined or non-optimal solution"),0==h&&(f.la==Gg?h=ug:f.pa==Gg&&(h=vg)),h):d()}var e={};(a==s||a.xd!=wb)&&
y("glp_simplex: P = "+a+"; invalid problem object");a.W!=s&&0!=a.W.reason&&y("glp_simplex: operation not allowed");b==s&&(b=e,Hg(b));b.n==Ig||(b.n==Jf||b.n==Cg||b.n==fg||b.n==Jg)||y("glp_simplex: msg_lev = "+b.n+"; invalid parameter");b.Xa==Mf||(b.Xa==$f||b.Xa==cg)||y("glp_simplex: meth = "+b.Xa+"; invalid parameter");b.ad==Kg||b.ad==Lg||y("glp_simplex: pricing = "+b.ad+"; invalid parameter");b.ge==Mg||b.ge==Ng||y("glp_simplex: r_test = "+b.ge+"; invalid parameter");0<b.Ab&&1>b.Ab||y("glp_simplex: tol_bnd = "+
b.Ab+"; invalid parameter");0<b.ob&&1>b.ob||y("glp_simplex: tol_dj = "+b.ob+"; invalid parameter");0<b.pe&&1>b.pe||y("glp_simplex: tol_piv = "+b.pe+"; invalid parameter");0>b.kc&&y("glp_simplex: it_lim = "+b.kc+"; invalid parameter");0>b.nb&&y("glp_simplex: tm_lim = "+b.nb+"; invalid parameter");1>b.Yb&&y("glp_simplex: out_frq = "+b.Yb+"; invalid parameter");0>b.Za&&y("glp_simplex: out_dly = "+b.Za+"; invalid parameter");b.uc==Dd||b.uc==Id||y("glp_simplex: presolve = "+b.uc+"; invalid parameter");
a.la=a.pa=Vb;a.Y=0;a.some=0;for(e=1;e<=a.f;e++){var f=a.k[e];if(f.type==R&&f.c>=f.d)return b.n>=Jf&&B("glp_simplex: row "+e+": lb = "+f.c+", ub = "+f.d+"; incorrect bounds"),e=Og}for(e=1;e<=a.h;e++)if(f=a.e[e],f.type==R&&f.c>=f.d)return b.n>=Jf&&B("glp_simplex: column "+e+": lb = "+f.c+", ub = "+f.d+"; incorrect bounds"),e=Og;b.n>=fg&&(B("GLPK Simplex Optimizer, v"+ab()+""),B(a.f+" row"+(1==a.f?"":"s")+", "+a.h+" column"+(1==a.h?"":"s")+", "+a.J+" non-zero"+(1==a.J?"":"s")+""));if(0==a.J){var e=b,
f=function(){h.l=K;h.q=h.c},g=function(){h.l=od;h.q=h.d},j,h,l,m,n;a.valid=0;a.la=a.pa=Bg;a.Y=a.da;m=n=a.some=0;for(l=1;l<=a.f;l++){j=a.k[l];j.l=D;j.q=j.H=0;if(j.type==Zc||j.type==R||j.type==G)j.c>+e.Ab&&(a.la=Gg,0==a.some&&e.Xa!=Mf&&(a.some=l)),m<+j.c&&(m=+j.c);if(j.type==$c||j.type==R||j.type==G)j.d<-e.Ab&&(a.la=Gg,0==a.some&&e.Xa!=Mf&&(a.some=l)),m<-j.d&&(m=-j.d)}for(j=l=1;j<=a.h;j++)h=a.e[j],l<Math.abs(h.t)&&(l=Math.abs(h.t));l=(a.dir==Gb?1:-1)/l;for(j=1;j<=a.h;j++){h=a.e[j];h.type==yc?(h.l=Yc,
h.q=0):h.type==Zc?f():h.type==$c?g():h.type==R?0<l*h.t?f():0>l*h.t?g():Math.abs(h.c)<=Math.abs(h.d)?f():g():h.type==G&&(h.l=Gc,h.q=h.c);h.H=h.t;a.Y+=h.t*h.q;if(h.type==yc||h.type==Zc)l*h.H<-e.ob&&(a.pa=Gg,0==a.some&&e.Xa==Mf&&(a.some=a.f+j)),n<-l*h.H&&(n=-l*h.H);if(h.type==yc||h.type==$c)l*h.H>+e.ob&&(a.pa=Gg,0==a.some&&e.Xa==Mf&&(a.some=a.f+j)),n<+l*h.H&&(n=+l*h.H)}e.n>=Cg&&0==e.Za&&B("~"+a.V+": obj = "+a.Y+"  infeas = "+(e.Xa==Mf?m:n)+"");e.n>=fg&&0==e.Za&&(a.la==Bg&&a.pa==Bg?B("OPTIMAL SOLUTION FOUND"):
a.la==Gg?B("PROBLEM HAS NO FEASIBLE SOLUTION"):e.Xa==Mf?B("PROBLEM HAS UNBOUNDED SOLUTION"):B("PROBLEM HAS NO DUAL FEASIBLE SOLUTION"));e=0}else e=b.uc?d(a,b):c(a,b);return e},Hg=exports.glp_init_smcp=function(a){a.n=fg;a.Xa=Mf;a.ad=Lg;a.ge=Ng;a.Ab=1E-7;a.ob=1E-7;a.pe=1E-10;a.Xe=-v;a.Ye=+v;a.kc=pa;a.nb=pa;a.Yb=500;a.Za=0;a.uc=Id},hh=exports.glp_get_status=function(a){var b;b=Qg(a);switch(b){case Bg:switch(eh(a)){case Bg:b=fh;break;case Gg:b=gh}}return b},Qg=exports.glp_get_prim_stat=function(a){return a.la},
eh=exports.glp_get_dual_stat=function(a){return a.pa},ih=exports.glp_get_obj_val=function(a){return a.Y},jh=exports.glp_get_row_stat=function(a,b){1<=b&&b<=a.f||y("glp_get_row_stat: i = "+b+"; row number out of range");return a.k[b].l},kh=exports.glp_get_row_prim=function(a,b){1<=b&&b<=a.f||y("glp_get_row_prim: i = "+b+"; row number out of range");return a.k[b].q},lh=exports.glp_get_row_dual=function(a,b){1<=b&&b<=a.f||y("glp_get_row_dual: i = "+b+"; row number out of range");return a.k[b].H},mh=
exports.glp_get_col_stat=function(a,b){1<=b&&b<=a.h||y("glp_get_col_stat: j = "+b+"; column number out of range");return a.e[b].l},nh=exports.glp_get_col_prim=function(a,b){1<=b&&b<=a.h||y("glp_get_col_prim: j = "+b+"; column number out of range");return a.e[b].q},oh=exports.glp_get_col_dual=function(a,b){1<=b&&b<=a.h||y("glp_get_col_dual: j = "+b+"; column number out of range");return a.e[b].H};exports.glp_get_unbnd_ray=function(a){var b=a.some;b>a.f+a.h&&(b=0);return b};
var rh=exports.glp_set_col_kind=function(a,b,c){1<=b&&b<=a.h||y("glp_set_col_kind: j = "+b+"; column number out of range");var d=a.e[b];switch(c){case Fc:d.Aa=Fc;break;case ph:d.Aa=ph;break;case qh:d.Aa=ph;d.type==R&&0==d.c&&1==d.d||qd(a,b,R,0,1);break;default:y("glp_set_col_kind: j = "+b+"; kind = "+c+"; invalid column kind")}},sh=exports.glp_get_col_kind=function(a,b){1<=b&&b<=a.h||y("glp_get_col_kind: j = "+b+"; column number out of range");var c=a.e[b],d=c.Aa;switch(d){case ph:c.type==R&&(0==
c.c&&1==c.d)&&(d=qh)}return d},th=exports.glp_get_num_int=function(a){for(var b,c=0,d=1;d<=a.h;d++)b=a.e[d],b.Aa==ph&&c++;return c},uh=exports.glp_get_num_bin=function(a){for(var b,c=0,d=1;d<=a.h;d++)b=a.e[d],b.Aa==ph&&(b.type==R&&0==b.c&&1==b.d)&&c++;return c};
exports.glp_intopt=function(a,b){function c(a,b){var c;if(hh(a)!=fh)return b.n>=Jf&&B("glp_intopt: optimal basis to initial LP relaxation not provided"),c=vh;b.n>=fg&&B("Integer optimization begins...");var d=a.f,e=a.h,f,p,t;a.W=f={};f.h=e;f.sc=d;f.Xb=Array(1+d+e);f.Yc=Array(1+d+e);f.Zc=Array(1+d+e);f.af=Array(1+d+e);f.$e=Array(1+d+e);f.Ze=Array(1+d+e);for(p=1;p<=d;p++){var r=a.k[p];f.Xb[p]=r.type;f.Yc[p]=r.c;f.Zc[p]=r.d;f.af[p]=r.l;f.$e[p]=r.q;f.Ze[p]=r.H}for(t=1;t<=e;t++){var w=a.e[t];f.Xb[d+t]=
w.type;f.Yc[d+t]=w.c;f.Zc[d+t]=w.d;f.af[d+t]=w.l;f.$e[d+t]=w.q;f.Ze[d+t]=w.H}f.Wg=a.Y;f.ae=0;f.Qc=0;f.ua=s;f.head=f.Sa=s;f.Jd=f.Qf=f.xg=0;f.wg=0;f.le=s;f.je=f.me=s;f.ke=s;f.L=s;f.z=a;f.Lc=Array(1+e);Da(f.Lc,1,0,e);f.tg=f.ug=0;f.ef=s;f.cf=f.ff=s;f.df=s;var E={size:0};E.head=E.Sa=s;E.Tg=0;E.L=s;f.vd=E;f.Of=s;f.De=s;f.zd=s;f.qg=Array(1+e);f.Hg=Array(1+e);f.o=b;f.dc=Ga();f.zg=0;f.dh=0;f.reason=0;f.ie=0;f.hf=0;f.Rc=0;f.zf=0;f.od=0;f.We=0;f.stop=0;wh(f,s);a:{for(var q=function(a,b){var c,d,e,f;d=a.z.va==
Bg?String(a.z.qa):"not found yet";c=Ah(a);0==c?e="tree is empty":(c=a.ua[c].mb.bound,e=c==-v?"-inf":c==+v?"+inf":c);a.z.dir==Gb?f=">=":a.z.dir==ec&&(f="<=");c=Bh(a);B("+"+a.z.V+": "+(b?">>>>>":"mip =")+" "+d+" "+f+" "+e+" "+(0==c?"  0.0%":0.0010>c?" < 0.1%":9.999>=c?"  "+Number(100*c).toFixed(1)+"%":"")+" ("+a.Jd+"; "+(a.xg-a.Qf)+")");a.zg=Ga()},z=function(a,b){return Ch(a,a.ua[b].mb.bound)},C=function(a){var b=a.z,c,d=0,e=0,f=0,g=0,h=0;for(c=b.f;0<c;c--){var j=b.k[c];j.origin==xc&&(j.mc==Dh?d++:
j.mc==Eh?e++:j.mc==Fh?f++:j.mc==Gh?g++:h++)}0<d+e+f+g+h&&(B("Cuts on level "+a.L.Ha+":"),0<d&&B(" gmi = "+d+";"),0<e&&B(" mir = "+e+";"),0<f&&B(" cov = "+f+";"),0<g&&B(" clq = "+g+";"),0<h&&B(" app = "+h+";"),B(""))},H,O,J,L,u,F=0,x=f.dc,P=0;;){var I=s;switch(P){case 0:if(f.head==s){f.o.n>=Jg&&B("Active list is empty!");u=0;I=3;break}if(f.o.ib!=s&&(f.reason=Hh,f.o.ib(f,f.o.Sc),f.reason=0,f.stop)){u=Ih;I=3;break}if(0==f.We){var X;if(1==f.Jd)X=f.head.r;else{var A;if(0!=f.od)A=f.od;else{var M=k;if(f.o.fc==
Jh)M=f.Sa.r;else if(f.o.fc==Kh)M=f.head.r;else if(f.o.fc==Lh){var N=k,za=s,ua=k,va=k;switch(f.z.dir){case Gb:ua=+v;for(N=f.head;N!=s;N=N.next)ua>N.bound&&(ua=N.bound);va=0.0010*(1+Math.abs(ua));for(N=f.head;N!=s;N=N.next)if(N.bound<=ua+va&&(za==s||za.ga.Wc>N.ga.Wc))za=N;break;case ec:ua=-v;for(N=f.head;N!=s;N=N.next)ua<N.bound&&(ua=N.bound);va=0.0010*(1+Math.abs(ua));for(N=f.head;N!=s;N=N.next)if(N.bound>=ua-va&&(za==s||za.nc<N.nc))za=N}M=za.r}else if(f.o.fc==Mh){var ka=k;if(f.z.va==Vb){for(var fc=
k,Ee=k,Ve=k,Ee=0,Ve=v,fc=f.head;fc!=s;fc=fc.next)Ve>fc.ga.Wc&&(Ee=fc.r,Ve=fc.ga.Wc);ka=Ee}else{for(var We=k,xb=k,Ja=k,ud=k,Sd=k,Ic=k,We=f.ua[1].mb,Sd=(f.z.qa-We.bound)/We.Wc,Ja=0,ud=v,xb=f.head;xb!=s;xb=xb.next)Ic=xb.ga.bound+Sd*xb.ga.Wc,f.z.dir==ec&&(Ic=-Ic),ud>Ic&&(Ja=xb.r,ud=Ic);ka=Ja}M=ka}A=M}X=A}f.We=X}var ha=f,ba=ha.z,ga=k,Ob=k,gb=k,U=k,Bb=k,ca=k,ga=ha.ua[f.We].mb;ha.L=ga;Ob=ha.ua[1].mb;if(ga!=Ob){for(ga.fa=s;ga!=s;ga=ga.ga)ga.ga!=s&&(ga.ga.fa=ga);for(ga=Ob;ga!=s;ga=ga.fa){var Yb=ba.f,Pb=ba.h;
if(ga.fa==s){var wa,Fa;ha.tg=Yb;if(ha.ug<Yb+Pb){var Ac=Yb+Pb+100;ha.ug=Ac;ha.ef=Array(1+Ac);ha.cf=Array(1+Ac);ha.ff=Array(1+Ac);ha.df=Array(1+Ac)}for(wa=1;wa<=Yb;wa++){var Hb=ba.k[wa];ha.ef[wa]=Hb.type;ha.cf[wa]=Hb.c;ha.ff[wa]=Hb.d;ha.df[wa]=Hb.l}for(Fa=1;Fa<=Pb;Fa++){var ad=ba.e[Fa];ha.ef[ba.f+Fa]=ad.type;ha.cf[ba.f+Fa]=ad.c;ha.ff[ba.f+Fa]=ad.d;ha.df[ba.f+Fa]=ad.l}}for(gb=ga.Ja;gb!=s;gb=gb.next)gb.lc<=Yb?pd(ba,gb.lc,gb.type,gb.c,gb.d):qd(ba,gb.lc-Yb,gb.type,gb.c,gb.d);for(Bb=ga.xc;Bb!=s;Bb=Bb.next)Bb.lc<=
Yb?tf(ba,Bb.lc,Bb.l):uf(ba,Bb.lc-Yb,Bb.l);if(ga.ac!=s){var Jc,Fe,bd;Fe=Array(1+Pb);bd=Array(1+Pb);for(U=ga.ac;U!=s;U=U.next){wa=zc(ba,1);Mc(ba,wa,U.name);ba.k[wa].Ha=ga.Ha;ba.k[wa].origin=U.origin;ba.k[wa].mc=U.mc;pd(ba,wa,U.type,U.c,U.d);Jc=0;for(ca=U.j;ca!=s;ca=ca.next)Jc++,Fe[Jc]=ca.A,bd[Jc]=ca.i;sd(ba,wa,Jc,Fe,bd);of(ba,wa,U.ka);tf(ba,wa,U.l)}}}for(ga=ha.L;ga.Ja!=s;)gb=ga.Ja,ga.Ja=gb.next;for(;ga.xc!=s;)Bb=ga.xc,ga.xc=Bb.next;for(;ga.ac!=s;){U=ga.ac;for(ga.ac=U.next;U.j!=s;)ca=U.j,U.j=ca.next}}f.We=
f.od=0;f.L.ga!=s&&f.L.ga.r!=F&&(F=0);H=f.L.r;f.o.n>=Jg&&(B("------------------------------------------------------------------------"),B("Processing node "+H+" at level "+f.L.Ha+""));if(1==H){f.o.ud==Dd&&f.o.n>=fg&&B("Gomory's cuts enabled");if(f.o.yd==Dd){f.o.n>=fg&&B("MIR cuts enabled");var ie=f,cd=f,bb=cd.z,fa=bb.f,qa=bb.h,Q=k;Nh&&B("ios_mir_init: warning: debug mode enabled");Q={};Q.f=fa;Q.h=qa;Q.yb=Array(1+fa);Q.Wa=Array(1+fa+qa);Q.c=Array(1+fa+qa);Q.Sb=Array(1+fa+qa);Q.d=Array(1+fa+qa);Q.ub=
Array(1+fa+qa);Q.x=Array(1+fa+qa);Q.uf=Array(1+Oh);Q.Ta=Ph(fa+qa);Q.fb=Array(1+fa+qa);Q.ma=Ph(fa+qa);Q.D=Ph(fa+qa);for(var Td=cd.z,Rg=Q.f,Wa=k,Wa=1;Wa<=Rg;Wa++){var Kc=Td.k[Wa];Q.yb[Wa]=0;Q.Wa[Wa]=0;switch(Kc.type){case yc:Q.c[Wa]=-v;Q.d[Wa]=+v;break;case Zc:Q.c[Wa]=Kc.c;Q.d[Wa]=+v;break;case $c:Q.c[Wa]=-v;Q.d[Wa]=Kc.d;break;case R:Q.c[Wa]=Kc.c;Q.d[Wa]=Kc.d;break;case G:Q.c[Wa]=Q.d[Wa]=Kc.c}Q.Sb[Wa]=Q.ub[Wa]=0}for(var Zb=cd.z,jg=Q.f,je=Q.h,Xa=k,Xa=jg+1;Xa<=jg+je;Xa++){var Ha=Zb.e[Xa-jg];switch(Ha.Aa){case Fc:Q.Wa[Xa]=
0;break;case ph:Q.Wa[Xa]=1}switch(Ha.type){case yc:Q.c[Xa]=-v;Q.d[Xa]=+v;break;case Zc:Q.c[Xa]=Ha.c;Q.d[Xa]=+v;break;case $c:Q.c[Xa]=-v;Q.d[Xa]=Ha.d;break;case R:Q.c[Xa]=Ha.c;Q.d[Xa]=Ha.d;break;case G:Q.c[Xa]=Q.d[Xa]=Ha.c}Q.Sb[Xa]=Q.ub[Xa]=0}for(var ke=cd.z,xa=Q.f,cb=k,Ib=k,sb=k,rc=k,Bc=k,sc=k,Ib=1;Ib<=xa;Ib++)if(0==Q.c[Ib]&&Q.d[Ib]==+v||Q.c[Ib]==-v&&0==Q.d[Ib])if(cb=ke.k[Ib].j,cb!=s&&(sb=xa+cb.e.A,Bc=cb.i,cb=cb.w,cb!=s&&(rc=xa+cb.e.A,sc=cb.i,cb.w==s))){if(Q.Wa[sb]||!Q.Wa[rc])if(Q.Wa[sb]&&!Q.Wa[rc])rc=
sb,sc=Bc,sb=xa+cb.e.A,Bc=cb.i;else continue;Q.c[rc]==-v||(Q.d[rc]==+v||Q.c[rc]==Q.d[rc])||(0==Q.d[Ib]&&(Bc=-Bc,sc=-sc),0<Bc?0==Q.Sb[sb]&&(Q.c[sb]=-sc/Bc,Q.Sb[sb]=rc,Q.yb[Ib]=1):0==Q.ub[sb]&&(Q.d[sb]=-sc/Bc,Q.ub[sb]=rc,Q.yb[Ib]=1))}for(var Cb=cd.z,Xe=Q.f,hb=k,Aa=k,Qb=k,Ud=k,Aa=1;Aa<=Xe;Aa++)if(Q.c[Aa]==-v&&Q.d[Aa]==+v)Q.yb[Aa]=1;else{Ud=0;for(hb=Cb.k[Aa].j;hb!=s;hb=hb.w){Qb=Xe+hb.e.A;if(Q.c[Qb]==-v&&Q.d[Qb]==+v){Q.yb[Aa]=1;break}if(Q.Wa[Qb]&&Q.c[Qb]==-v||Q.Wa[Qb]&&Q.d[Qb]==+v){Q.yb[Aa]=1;break}0==
Q.Sb[Qb]&&0==Q.ub[Qb]&&Q.c[Qb]==Q.d[Qb]||Ud++}0==Ud&&(Q.yb[Aa]=1)}ie.Of=Q}f.o.rd==Dd&&f.o.n>=fg&&B("Cover cuts enabled");f.o.pd==Dd&&(f.o.n>=fg&&B("Clique cuts enabled"),f.De=Qh(f))}case 1:(f.o.n>=Jg||f.o.n>=Cg&&f.o.Yb-1<=1E3*La(f.zg))&&q(f,0);f.o.n>=fg&&60<=La(x)&&(B("Time used: "+La(f.dc)+" secs"),x=Ga());if(0<f.o.Yd&&Bh(f)<=f.o.Yd){f.o.n>=Jg&&B("Relative gap tolerance reached; search terminated ");u=Rh;I=3;break}if(f.o.nb<pa&&f.o.nb-1<=1E3*La(f.dc)){f.o.n>=Jg&&B("Time limit exhausted; search terminated");
u=Sh;I=3;break}if(f.o.ib!=s&&(f.reason=Th,f.o.ib(f,f.o.Sc),f.reason=0,f.stop)){u=Ih;I=3;break}if(f.o.$c!=Uh)if(f.o.$c==Vh){if(0==f.L.Ha&&Wh(f,100)){I=2;break}}else if(f.o.$c==Xh&&Wh(f,0==f.L.Ha?100:10)){I=2;break}if(!z(f,H)){B("*** not tested yet ***");I=2;break}f.o.n>=Jg&&B("Solving LP relaxation...");var Cc=f,nb=Cc.z,Db={},Lc=k;Hg(Db);switch(Cc.o.n){case Ig:Db.n=Ig;break;case Jf:Db.n=Jf;break;case Cg:case fg:Db.n=Cg;break;case Jg:Db.n=fg}Db.Xa=$f;Db.Za=Cc.o.n<Jg?Cc.o.Za:0;if(nb.va==Bg)switch(Cc.z.dir){case Gb:Db.Ye=
nb.qa;break;case ec:Db.Xe=nb.qa}Lc=Pg(nb,Db);Cc.L.Wf++;u=Lc;if(!(0==u||u==Yh||u==Zh)){f.o.n>=Jf&&B("ios_driver: unable to solve current LP relaxation; glp_simplex returned "+u+"");u=bg;I=3;break}J=f.z.la;L=f.z.pa;if(J==Bg&&L==Bg)f.o.n>=Jg&&B("Found optimal solution to LP relaxation");else if(L==Gg){f.o.n>=Jf&&B("ios_driver: current LP relaxation has no dual feasible solution");u=bg;I=3;break}else if(J==$h&&L==Bg){f.o.n>=Jg&&B("LP relaxation has no solution better than incumbent objective value");
I=2;break}else if(J==Gg){f.o.n>=Jg&&B("LP relaxation has no feasible solution");I=2;break}var tc=f.L.nc=f.z.Y,tc=ai(f,tc);f.z.dir==Gb?f.L.bound<tc&&(f.L.bound=tc):f.z.dir==ec&&f.L.bound>tc&&(f.L.bound=tc);f.o.n>=Jg&&B("Local bound is "+tc+"");if(!z(f,H)){f.o.n>=Jg&&B("Current branch is hopeless and can be pruned");I=2;break}if(f.o.ib!=s){f.reason=oc;f.o.ib(f,f.o.Sc);f.reason=0;if(f.stop){u=Ih;I=3;break}if(f.ie){f.ie=f.hf=0;I=1;break}f.hf&&(f.hf=0,Hf(f.z))}for(var la=f,Ge=la.z,Nc=k,ib=k,da=0,Oc=k,
He=k,jb=k,db=k,Ta=k,Jb=0,Nc=1;Nc<=Ge.h;Nc++){var Ya=Ge.e[Nc];la.Lc[Nc]=0;if(Ya.Aa==ph&&Ya.l==D){ib=Ya.type;Oc=Ya.c;He=Ya.d;jb=Ya.q;if(ib==Zc||ib==R||ib==G){db=Oc-la.o.Ob;Ta=Oc+la.o.Ob;if(db<=jb&&jb<=Ta)continue;if(jb<Oc)continue}if(ib==$c||ib==R||ib==G){db=He-la.o.Ob;Ta=He+la.o.Ob;if(db<=jb&&jb<=Ta)continue;if(jb>He)continue}db=Math.floor(jb+0.5)-la.o.Ob;Ta=Math.floor(jb+0.5)+la.o.Ob;db<=jb&&jb<=Ta||(la.Lc[Nc]=1,da++,db=jb-Math.floor(jb),Ta=Math.ceil(jb)-jb,Jb+=db<=Ta?db:Ta)}}la.L.pg=da;la.L.Wc=Jb;
la.o.n>=Jg&&(0==da?B("There are no fractional columns"):1==da?B("There is one fractional column, integer infeasibility is "+Jb+""):B("There are "+da+" fractional columns, integer infeasibility is "+Jb+""));if(0==f.L.pg){f.o.n>=Jg&&B("New integer feasible solution found");f.o.n>=fg&&C(f);var gc=f,hc=gc.z,vd=k,Vd=k;hc.va=Bg;hc.qa=hc.Y;for(vd=1;vd<=hc.f;vd++){var ic=hc.k[vd];ic.Oa=ic.q}for(Vd=1;Vd<=hc.h;Vd++){var Wd=hc.e[Vd];Wd.Aa==Fc?Wd.Oa=Wd.q:Wd.Aa==ph&&(Wd.Oa=Math.floor(Wd.q+0.5))}gc.dh++;f.o.n>=
Cg&&q(f,1);if(f.o.ib!=s&&(f.reason=bi,f.o.ib(f,f.o.Sc),f.reason=0,f.stop)){u=Ih;I=3;break}I=2;break}if(f.z.va==Bg){for(var Na=f,Rb=Na.z,Za=k,$b=k,Ed=0,uc=k,Fd=k,le=k,jc=k,uc=Rb.Y,Za=1;Za<=Rb.h;Za++){var Dc=Rb.e[Za];if(Dc.Aa==ph)switch(Fd=Dc.c,le=Dc.d,$b=Dc.l,jc=Dc.H,Rb.dir){case Gb:$b==K?(0>jc&&(jc=0),uc+jc>=Rb.qa&&(qd(Rb,Za,G,Fd,Fd),Ed++)):$b==od&&(0<jc&&(jc=0),uc-jc>=Rb.qa&&(qd(Rb,Za,G,le,le),Ed++));break;case ec:$b==K?(0<jc&&(jc=0),uc+jc<=Rb.qa&&(qd(Rb,Za,G,Fd,Fd),Ed++)):$b==od&&(0>jc&&(jc=0),
uc-jc<=Rb.qa&&(qd(Rb,Za,G,le,le),Ed++))}}Na.o.n>=Jg&&0!=Ed&&(1==Ed?B("One column has been fixed by reduced cost"):B(Ed+" columns have been fixed by reduced costs"))}if(f.o.ib!=s){f.reason=ci;f.o.ib(f,f.o.Sc);f.reason=0;if(f.stop){u=Ih;I=3;break}if(!z(f,H)){f.o.n>=Jg&&B("Current branch became hopeless and can be pruned");I=2;break}}if(f.o.Ne&&(f.reason=ci,di(f),f.reason=0,!z(f,H))){f.o.n>=Jg&&B("Current branch became hopeless and can be pruned");I=2;break}if(f.o.ib!=s&&(f.reason=qc,f.o.ib(f,f.o.Sc),
f.reason=0,f.stop)){u=Ih;I=3;break}if(0==f.L.Ha||0==F){f.reason=qc;var Ra=f;if(Ra.o.yd==Dd||Ra.o.ud==Dd||Ra.o.rd==Dd||Ra.o.pd==Dd){var Ie=k,me=k,dd=k,me=Ra.h;1E3>me&&(me=1E3);dd=0;for(Ie=Ra.sc+1;Ie<=Ra.z.f;Ie++)Ra.z.k[Ie].origin==xc&&dd++;if(!(dd>=me)){Ra.o.ud==Dd&&5>Ra.L.Ld&&ei(Ra);Ra.o.yd==Dd&&ji(Ra,Ra.Of);if(Ra.o.rd==Dd){var kb=Ra,lb=kb.z,Pc=ye(lb),ed=ze(lb),yb=k,kc=k,lc=k,Gd=k,Qc=k,Mb=k,Ye=k,Ec=k,Hd=k;hh(lb);Mb=Array(1+ed);Ec=Array(1+ed);Hd=Array(1+ed);for(yb=1;yb<=Pc;yb++)for(Gd=1;2>=Gd;Gd++){lc=
Ce(lb,yb)-yc+ki;if(1==Gd){if(!(lc==li||lc==mi))continue;Qc=Ue(lb,yb,Mb,Ec);Ec[0]=ni(lb,yb)}else{if(!(lc==oi||lc==mi))continue;Qc=Ue(lb,yb,Mb,Ec);for(kc=1;kc<=Qc;kc++)Ec[kc]=-Ec[kc];Ec[0]=-pi(lb,yb)}b:{for(var ob=lb,Ka=Qc,zb=Mb,ea=Ec,mb=Hd,pb=s,tb=s,Ua=Array(5),Sa=k,T=k,Kb=k,fd=k,gd=k,Eb=k,ne=k,Xd=k,Yd=k,fd=0,T=1;T<=Ka;T++)Sa=zb[T],Re(ob,Sa)-yc+ki==qi?ea[0]-=ea[T]*ri(ob,Sa):(fd++,zb[fd]=zb[T],ea[fd]=ea[T]);Ka=fd;Kb=0;for(T=1;T<=Ka;T++)if(Sa=zb[T],(sh(ob,Sa)==Fc?si:ti)==ti&&Re(ob,Sa)-yc+ki==mi&&0==
ri(ob,Sa)&&1==ui(ob,Sa)){var Sg,xh;Kb++;Sg=zb[Kb];xh=ea[Kb];zb[Kb]=zb[T];ea[Kb]=ea[T];zb[T]=Sg;ea[T]=xh}if(2>Kb)Qc=0;else{Eb=ne=0;for(T=Kb+1;T<=Ka;T++){Sa=zb[T];if(Re(ob,Sa)-yc+ki!=mi){Qc=0;break b}0<ea[T]?(Eb+=ea[T]*ri(ob,Sa),ne+=ea[T]*ui(ob,Sa)):(Eb+=ea[T]*ui(ob,Sa),ne+=ea[T]*ri(ob,Sa))}Xd=ne-Eb;Yd=0;for(T=Kb+1;T<=Ka;T++)Sa=zb[T],Yd+=ea[T]*nh(ob,Sa);Yd-=Eb;0>Yd&&(Yd=0);Yd>Xd&&(Yd=Xd);ea[0]-=Eb;for(T=1;T<=Kb;T++)Sa=zb[T],mb[T]=nh(ob,Sa),0>mb[T]&&(mb[T]=0),1<mb[T]&&(mb[T]=1);for(T=1;T<=Kb;T++)0>ea[T]&&
(zb[T]=-zb[T],ea[T]=-ea[T],ea[0]+=ea[T],mb[T]=1-mb[T]);for(var hd=Kb,Lb=ea[0],id=Yd,vf=k,vf=1;vf<=hd;vf++);for(vf=1;vf<=hd;vf++);var lg=k;c:{for(var Jd=k,vc=k,Ze=0,mg=0,yh=k,Je=k,ng=0.0010,yh=0.0010*(1+Math.abs(Lb)),Jd=1;Jd<=hd;Jd++)for(vc=Jd+1;vc<=hd;vc++){Ze++;if(1E3<Ze){lg=mg;break c}ea[Jd]+ea[vc]+id>Lb+yh&&(Je=ea[Jd]+ea[vc]-Lb,pb=1/(Je+Xd),tb=2-pb*Je,Je=mb[Jd]+mb[vc]+pb*id-tb,ng<Je&&(ng=Je,Ua[1]=Jd,Ua[2]=vc,mg=1))}lg=mg}var Tg=k;if(lg)Tg=2;else{var Ug=k;c:{for(var Kd=k,Sb=k,Rc=k,oe=0,Vg=0,og=
k,Sc=k,Of=0.0010,og=0.0010*(1+Math.abs(Lb)),Kd=1;Kd<=hd;Kd++)for(Sb=Kd+1;Sb<=hd;Sb++)for(Rc=Sb+1;Rc<=hd;Rc++){oe++;if(1E3<oe){Ug=Vg;break c}ea[Kd]+ea[Sb]+ea[Rc]+id>Lb+og&&(Sc=ea[Kd]+ea[Sb]+ea[Rc]-Lb,pb=1/(Sc+Xd),tb=3-pb*Sc,Sc=mb[Kd]+mb[Sb]+mb[Rc]+pb*id-tb,Of<Sc&&(Of=Sc,Ua[1]=Kd,Ua[2]=Sb,Ua[3]=Rc,Vg=1))}Ug=Vg}var pg=k;if(Ug)pg=3;else{var qg=k;c:{for(var $e=k,af=k,Ld=k,wd=k,jd=0,Ke=0,wf=k,xd=k,Pf=0.0010,wf=0.0010*(1+Math.abs(Lb)),$e=1;$e<=hd;$e++)for(af=$e+1;af<=hd;af++)for(Ld=af+1;Ld<=hd;Ld++)for(wd=
Ld+1;wd<=hd;wd++){jd++;if(1E3<jd){qg=Ke;break c}ea[$e]+ea[af]+ea[Ld]+ea[wd]+id>Lb+wf&&(xd=ea[$e]+ea[af]+ea[Ld]+ea[wd]-Lb,pb=1/(xd+Xd),tb=4-pb*xd,xd=mb[$e]+mb[af]+mb[Ld]+mb[wd]+pb*id-tb,Pf<xd&&(Pf=xd,Ua[1]=$e,Ua[2]=af,Ua[3]=Ld,Ua[4]=wd,Ke=1))}qg=Ke}pg=qg?4:0}Tg=pg}gd=Tg;if(0==gd)Qc=0;else{zb[0]=0;ea[0]=tb;for(Sa=1;Sa<=gd;Sa++)Ua[Sa]=zb[Ua[Sa]];for(T=1;T<=gd;T++)0<Ua[T]?(zb[T]=+Ua[T],ea[T]=1):(zb[T]=-Ua[T],ea[T]=-1,ea[0]-=1);for(T=Kb+1;T<=Ka;T++)gd++,zb[gd]=zb[T],ea[gd]=pb*ea[T];ea[0]+=pb*Eb;Qc=Ka=
gd}}}if(0!=Qc){var Wg=lb,bf=Qc,Xg=Mb,Yg=Ec,rg=ze(Wg),cf=k,df=k,sg=0;0>bf&&y("lpx_eval_row: len = "+bf+"; invalid row length");for(df=1;df<=bf;df++)cf=Xg[df],1<=cf&&cf<=rg||y("lpx_eval_row: j = "+cf+"; column number out of range"),sg+=Yg[df]*nh(Wg,cf);Ye=sg-Ec[0];0.0010>Ye||vi(kb,Fh,Qc,Mb,Ec,$c,Ec[0])}}}Ra.o.pd==Dd&&Ra.De!=s&&(0==Ra.L.Ha&&50>Ra.L.Ld||0<Ra.L.Ha&&5>Ra.L.Ld)&&wi(Ra,Ra.De)}}f.reason=0}0<f.vd.size&&(f.reason=qc,xi(f),f.reason=0);yi(f.vd);if(f.ie){f.ie=0;f.L.Ld++;I=1;break}for(var Zd=f,
Le=k,xf=0,ef=s,Le=Zd.sc+1;Le<=Zd.z.f;Le++)Zd.z.k[Le].origin==xc&&(Zd.z.k[Le].Ha==Zd.L.Ha&&Zd.z.k[Le].l==D)&&(ef==s&&(ef=Array(1+Zd.z.f)),ef[++xf]=Le);0<xf&&(Cd(Zd.z,xf,ef),Hf(Zd.z));f.o.n>=fg&&0==f.L.Ha&&C(f);if(f.zd!=s){var yd=k,pe=k,tg=k,Nb=k,zd=f.zd;f.L.ga!=s&&(yd=f.L.ga.Rc,pe=f.z.e[yd].q-f.L.ga.ig,tg=f.z.Y-f.L.ga.nc,Nb=Math.abs(tg/pe),0>pe?(zd.sd[yd]++,zd.Od[yd]+=Nb):(zd.Cd[yd]++,zd.qe[yd]+=Nb))}if(f.o.ib!=s&&(f.reason=zi,f.o.ib(f,f.o.Sc),f.reason=0,f.stop)){u=Ih;I=3;break}if(0==f.Rc){var Me=
f,$a=f,$d=function(a){f.zf=a},mc=k;if($a.o.Db==Ai){for(var Ia=k,qe=k,Ia=1;Ia<=$a.h&&!$a.Lc[Ia];Ia++);qe=nh($a.z,Ia);$d(qe-Math.floor(qe)<Math.ceil(qe)-qe?Bi:Ci);mc=Ia}else if($a.o.Db==Di){for(var Qf=k,Rf=k,Qf=$a.h;1<=Qf&&!$a.Lc[Qf];Qf--);Rf=nh($a.z,Qf);$d(Rf-Math.floor(Rf)<Math.ceil(Rf)-Rf?Bi:Ci);mc=Qf}else if($a.o.Db==Ei)mc=Fi($a,$d);else if($a.o.Db==Gi){var Tc=$a.z,yf=Tc.f,zf=Tc.h,Af=$a.Lc,Tb=k,Oa=k,Uc=k,wc=k,kd=k,ae=k,Zg=k,be=k,Ub=k,ce=k,ac=k,re=k,ff=k,Vc=k,Sf=k,Bf=k,ld=k,md=k,wg=k,Ad=k,se=k;hh(Tc);
Ub=Array(1+zf);se=Array(1+zf);Oa=0;Ad=-1;for(Tb=1;Tb<=zf;Tb++)if(Af[Tb]){ce=nh(Tc,Tb);Zg=Hi(Tc,yf+Tb,Ub,se);for(ae=-1;1>=ae;ae+=2){Uc=Ii(Tc,Zg,Ub,se,ae,1E-9);0!=Uc&&(Uc=Ub[Uc]);if(0==Uc)Sf=$a.z.dir==Gb?+v:-v;else{for(wc=1;wc<=Zg&&Ub[wc]!=Uc;wc++);re=se[wc];ff=(0>ae?Math.floor(ce):Math.ceil(ce))-ce;Vc=ff/re;Uc>yf&&sh(Tc,Uc-yf)!=Fc&&0.0010<Math.abs(Vc-Math.floor(Vc+0.5))&&(Vc=0<Vc?Math.ceil(Vc):Math.floor(Vc));Uc<=yf?(be=jh(Tc,Uc),ac=lh(Tc,Uc)):(be=mh(Tc,Uc-yf),ac=oh(Tc,Uc-yf));switch($a.z.dir){case Gb:if(be==
K&&0>ac||be==od&&0<ac||be==Yc)ac=0;break;case ec:if(be==K&&0<ac||be==od&&0>ac||be==Yc)ac=0}Sf=ac*Vc}0>ae?Bf=Sf:ld=Sf}if(Ad<Math.abs(Bf)||Ad<Math.abs(ld))if(Oa=Tb,Math.abs(Bf)<Math.abs(ld)?(kd=Bi,Ad=Math.abs(ld)):(kd=Ci,Ad=Math.abs(Bf)),md=Bf,wg=ld,Ad==v)break}Ad<1E-6*(1+0.0010*Math.abs(Tc.Y))?Oa=Fi($a,$d):($a.o.n>=Jg&&(B("branch_drtom: column "+Oa+" chosen to branch on"),Math.abs(md)==v?B("branch_drtom: down-branch is infeasible"):B("branch_drtom: down-branch bound is "+(ih(Tc)+md)+""),Math.abs(wg)==
v?B("branch_drtom: up-branch   is infeasible"):B("branch_drtom: up-branch   bound is "+(ih(Tc)+wg)+"")),$d(kd));mc=Oa}else $a.o.Db==Ji&&(mc=Ki($a,$d));Me.Rc=mc}O=f.L.r;var oa=f,bc=f.Rc,Tf=f.zf,Fb=oa.z,ub=k,xg=Fb.f,Uf=k,Md=k,Nd=k,Vf=k,Cf=k,fi=k,te=k,ue=Array(3),Wf=k,de=k,Df=k,Wc=k,gf=k,Xf=s,$g=s,Ne=k,Oe=k,Uf=Fb.e[bc].type,Wf=Fb.e[bc].c,de=Fb.e[bc].d,Df=Fb.e[bc].q,Wc=Math.floor(Df),gf=Math.ceil(Df);switch(Uf){case yc:Md=$c;Nd=Zc;break;case Zc:Md=Wf==Wc?G:R;Nd=Zc;break;case $c:Md=$c;Nd=gf==de?G:R;break;
case R:Md=Wf==Wc?G:R,Nd=gf==de?G:R}var cc=oa.z,yg=cc.f,ve=k,we=k,ee=k,ah=k,Yf=k,gi=k,zh=k,hf=k,zg=k,hi=k,bh=oa.qg,ch=oa.Hg,Ef=k,dh=k;hh(cc);Gf(cc);zh=cc.e[bc].q;ve=Hi(cc,yg+bc,bh,ch);for(we=-1;1>=we;we+=2){var bk=bh,Ti=Ii(cc,ve,bk,ch,we,1E-9),ee=0==Ti?0:bk[Ti];if(0==ee)cc.dir==Gb?0>we?Ef=+v:dh=+v:cc.dir==ec&&(0>we?Ef=-v:dh=-v);else{for(ah=1;ah<=ve&&bh[ah]!=ee;ah++);gi=ch[ah];ee<=yg?(Yf=cc.k[ee].l,hf=cc.k[ee].H):(Yf=cc.e[ee-yg].l,hf=cc.e[ee-yg].H);if(cc.dir==Gb){if(Yf==K&&0>hf||Yf==od&&0<hf||Yf==Yc)hf=
0}else if(cc.dir==ec&&(Yf==K&&0<hf||Yf==od&&0>hf||Yf==Yc))hf=0;zg=(0>we?Math.floor(zh):Math.ceil(zh))-zh;zg/=gi;hi=hf*zg;0>we?Ef=cc.Y+hi:dh=cc.Y+hi}}var Fq=dh,Xf=Ef,$g=Fq,Ne=ai(oa,Xf),Oe=ai(oa,$g),Vf=!Ch(oa,Ne),Cf=!Ch(oa,Oe);if(Vf&&Cf)oa.o.n>=Jg&&B("Both down- and up-branches are hopeless"),te=2;else if(Cf)oa.o.n>=Jg&&B("Up-branch is hopeless"),qd(Fb,bc,Md,Wf,Wc),oa.L.nc=Xf,Fb.dir==Gb?oa.L.bound<Ne&&(oa.L.bound=Ne):Fb.dir==ec&&oa.L.bound>Ne&&(oa.L.bound=Ne),te=1;else if(Vf)oa.o.n>=Jg&&B("Down-branch is hopeless"),
qd(Fb,bc,Nd,gf,de),oa.L.nc=$g,Fb.dir==Gb?oa.L.bound<Oe&&(oa.L.bound=Oe):Fb.dir==ec&&oa.L.bound>Oe&&(oa.L.bound=Oe),te=1;else{oa.o.n>=Jg&&B("Branching on column "+bc+", primal value is "+Df+"");fi=oa.L.r;oa.L.Rc=bc;oa.L.ig=Df;Li(oa);var jf=k,ck=k,jf=oa.ua[fi].mb;jf.aa==s?oa.head=jf.next:jf.aa.next=jf.next;jf.next==s?oa.Sa=jf.aa:jf.next.aa=jf.aa;jf.aa=jf.next=s;oa.Jd--;for(ck=1;2>=ck;ck++)ue[ck]=wh(oa,jf).r;oa.o.n>=Jg&&B("Node "+ue[1]+" begins down branch, node "+ue[2]+" begins up branch ");ub=oa.ua[ue[1]].mb;
ub.Ja={};ub.Ja.lc=xg+bc;ub.Ja.type=Md;ub.Ja.c=Wf;ub.Ja.d=Wc;ub.Ja.next=s;ub.nc=Xf;Fb.dir==Gb?ub.bound<Ne&&(ub.bound=Ne):Fb.dir==ec&&ub.bound>Ne&&(ub.bound=Ne);ub=oa.ua[ue[2]].mb;ub.Ja={};ub.Ja.lc=xg+bc;ub.Ja.type=Nd;ub.Ja.c=gf;ub.Ja.d=de;ub.Ja.next=s;ub.nc=$g;Fb.dir==Gb?ub.bound<Oe&&(ub.bound=Oe):Fb.dir==ec&&ub.bound>Oe&&(ub.bound=Oe);Tf==Mi?oa.od=0:Tf==Bi?oa.od=ue[1]:Tf==Ci&&(oa.od=ue[2]);te=0}u=te;f.Rc=f.zf=0;if(0==u){F=O;I=0;break}else if(1==u){f.L.Wf=f.L.Ld=0;I=1;break}else if(2==u){I=2;break}case 2:f.o.n>=
Jg&&B("Node "+H+" fathomed");Li(f);Ni(f,H);if(f.z.va==Bg){for(var dk=f,ii=k,qo=k,ek=0,ii=dk.head;ii!=s;ii=qo)qo=ii.next,z(dk,ii.r)||(Ni(dk,ii.r),ek++);dk.o.n>=Jg&&(1==ek?B("One hopeless branch has been pruned"):1<ek&&B(ek+" hopeless branches have been pruned"))}I=F=0;break;case 3:f.o.n>=Cg&&q(f,0);f.Of=s;f.De=s;c=u;break a}if(I==s)break;P=I}c=k}var fe=f.z,nd,Pe,Zf=fe.f,Hq=fe.h;if(Zf!=f.sc){var fk,Jl;fk=Zf-f.sc;Jl=Array(1+fk);for(nd=1;nd<=fk;nd++)Jl[nd]=f.sc+nd;Cd(fe,fk,Jl)}Zf=f.sc;for(nd=1;nd<=Zf;nd++)pd(fe,
nd,f.Xb[nd],f.Yc[nd],f.Zc[nd]),tf(fe,nd,f.af[nd]),fe.k[nd].q=f.$e[nd],fe.k[nd].H=f.Ze[nd];for(Pe=1;Pe<=Hq;Pe++)qd(fe,Pe,f.Xb[Zf+Pe],f.Yc[Zf+Pe],f.Zc[Zf+Pe]),uf(fe,Pe,f.af[Zf+Pe]),fe.e[Pe].q=f.$e[Zf+Pe],fe.e[Pe].H=f.Ze[Zf+Pe];fe.la=fe.pa=Bg;fe.Y=f.Wg;yi(f.vd);fe.W=s;0==c?a.va==Bg?(b.n>=fg&&B("INTEGER OPTIMAL SOLUTION FOUND"),a.va=fh):(b.n>=fg&&B("PROBLEM HAS NO INTEGER FEASIBLE SOLUTION"),a.va=Gg):c==Rh?b.n>=fg&&B("RELATIVE MIP GAP TOLERANCE REACHED; SEARCH TERMINATED"):c==Sh?b.n>=fg&&B("TIME LIMIT EXCEEDED; SEARCH TERMINATED"):
c==bg?b.n>=Jf&&B("glp_intopt: cannot solve current LP relaxation"):c==Ih&&b.n>=fg&&B("SEARCH TERMINATED BY APPLICATION");return c}function d(a,b){function d(){dg(n,p);p=s;eg(n,a);return w}var e=Pa,f=e.zb,n,p=s,t={},r={},w;b.n>=fg&&B("Preprocessing...");n=gg();hg(n,a,Oi);e.zb=!f||b.n<fg?Id:Dd;var E=n,q,z,C,H,O;z=kg(E,1);if(0==z){if(b.md){var J,L,u,F,x,P;q=O=x=P=0;for(C=E.nd;C!=s;C=C.aa)if(C.Na&&C.c!=C.d&&!(0==C.c&&1==C.d))if(-1E6>C.c||1E6<C.d||4095<C.d-C.c)q++;else if(O++,0!=C.c&&Pi(E,C),L=C.d|0,1!=
L){H=2;for(J=4;L>=J;)H++,J+=J;x+=H;z=Qi(E,function(a,b){var c,d,e=a.La[b.C];c=1;for(d=2;c<b.h;c++,d+=d)e+=d*a.La[b.A+(c-1)];a.La[b.C]=e;return 0});z.C=C.A;z.A=0;z.h=H;L<J-1?(J=Ri(E),P++,J.c=-v,J.d=L):J=s;C.d=1;J!=s&&Si(J,C,1);F=1;for(J=2;F<H;F++,J+=J){L=Ui(E);L.Na=1;L.c=0;L.d=1;L.t=J*C.t;0==z.A&&(z.A=L.A);for(u=C.j;u!=s;u=u.G)Si(u.k,L,J*u.i)}}0<O&&B(O+" integer variable(s) were replaced by "+x+" binary ones");0<P&&B(P+" row(s) were added due to binarization");0<q&&B("Binarization failed for "+q+" integer variable(s)")}O=
0;for(q=E.Nc;q!=s;q=z)if(z=q.aa,!(q.c==-v&&q.d==+v)&&q.c!=q.d&&!(q.j==s||q.j.w==s)){for(H=q.j;H!=s&&!(C=H.e,!C.Na||!(0==C.c&&1==C.d));H=H.w);H==s&&(O+=Vi(E,q))}0<O&&B(O+" hidden packing inequaliti(es) were detected");O=0;for(q=E.Nc;q!=s;q=z)if(z=q.aa,!(q.c==-v&&q.d==+v)&&q.c!=q.d&&!(q.j==s||q.j.w==s||q.j.w.w==s)){for(H=q.j;H!=s&&!(C=H.e,!C.Na||!(0==C.c&&1==C.d));H=H.w);H==s&&(O+=Wi(E,q))}0<O&&B(O+" hidden covering inequaliti(es) were detected");O=0;for(q=E.Nc;q!=s;q=z)if(z=q.aa,q.c!=q.d){C=O;H=E;
O=P=P=u=L=k;x=Array(2);J=k;for(O=x[0]=x[1]=0;1>=O;O++){if(0==O){if(q.c==-v)continue;ja&&B("L");P=Xi(q,1);J=+q.c}else{if(q.d==+v)continue;ja&&B("U");P=Xi(q,-1);J=-q.d}L=x;u=O;b:{F=J;for(var I=k,X=0,A=k,M=k,N=k,A=0,I=P;I!=s;I=I.next)if(0<I.Z){if(I.Bb.c==-v){F=X;break b}A+=I.Z*I.Bb.c}else{if(I.Bb.d==+v){F=X;break b}A+=I.Z*I.Bb.d}for(I=P;I!=s;I=I.next)I.Bb.Na&&(0==I.Bb.c&&1==I.Bb.d)&&(0<I.Z?(M=A,F-I.Z<M&&M<F&&(N=F-M,0.0010<=N&&I.Z-N>=0.01*(1+I.Z)&&(ja&&B("+"),I.Z=N,X++))):(M=A-I.Z,F<M&&M<F-I.Z&&(N=I.Z+
(M-F),-0.0010>=N&&N-I.Z>=0.01*(1-I.Z)&&(ja&&B("-"),I.Z=N,A+=M-F,F=M,X++))));J=F;F=X}L[u]=F;if(0<x[O]){if(q.c==-v||q.d==+v)L=s;else{ja&&B("*");L=Ri(H);0==O?(L.c=-v,L.d=q.d):(L.c=q.c,L.d=+v);for(u=q.j;u!=s;u=u.w)Si(L,u.e,u.i)}Yi(q);q.c=J;for(q.d=+v;P!=s;P=P.next)Si(q,P.Bb,P.Z);L!=s&&(q=L)}}O=C+(x[0]+x[1])}0<O&&B(O+" constraint coefficient(s) were reduced");z=0}w=z;e.zb=f;0!=w&&(w==ug?b.n>=fg&&B("PROBLEM HAS NO PRIMAL FEASIBLE SOLUTION"):w==vg&&b.n>=fg&&B("LP RELAXATION HAS NO DUAL FEASIBLE SOLUTION"));
if(0!=w)return w;p=Wb();Ag(n,p);if(0==p.f&&0==p.h)return p.va=fh,p.qa=p.da,b.n>=fg&&(B("Objective value = "+p.qa+""),B("INTEGER OPTIMAL SOLUTION FOUND BY MIP PREPROCESSOR")),d();b.n>=fg&&(E=th(p),z=uh(p),B(p.f+" row"+(1==p.f?"":"s")+", "+p.h+" column"+(1==p.h?"":"s")+", "+p.J+" non-zero"+(1==p.J?"":"s")+""),B(E+" integer variable"+(1==E?"":"s")+", "+(0==z?"none of":1==E&&1==z?"":1==z?"one of":z==E?"all of":z+" of")+" which "+(1==z?"is":"are")+" binary"));Pd(a,t);Qd(p,t);e.zb=!f||b.n<fg?Id:Dd;Dg(p,
Zi|$i|aj|bj);e.zb=f;e.zb=!f||b.n<fg?Id:Dd;Fg(p);e.zb=f;b.n>=fg&&B("Solving LP relaxation...");Hg(r);r.n=b.n;p.V=a.V;w=Pg(p,r);a.V=p.V;if(0!=w)return b.n>=Jf&&B("glp_intopt: cannot solve LP relaxation"),w=bg;w=hh(p);w==fh?w=0:w==Gg?w=ug:w==gh&&(w=vg);if(0!=w)return w;p.V=a.V;w=c(p,b);a.V=p.V;return!(p.va==fh||p.va==Bg)?(a.va=p.va,w):d()}var e,f;(a==s||a.xd!=wb)&&y("glp_intopt: P = "+a+"; invalid problem object");a.W!=s&&y("glp_intopt: operation not allowed");b==s&&(b={},cj(b));b.n==Ig||(b.n==Jf||b.n==
Cg||b.n==fg||b.n==Jg)||y("glp_intopt: msg_lev = "+b.n+"; invalid parameter");b.Db==Ai||(b.Db==Di||b.Db==Ei||b.Db==Gi||b.Db==Ji)||y("glp_intopt: br_tech = "+b.Db+"; invalid parameter");b.fc==Jh||(b.fc==Kh||b.fc==Lh||b.fc==Mh)||y("glp_intopt: bt_tech = "+b.fc+"; invalid parameter");0<b.Ob&&1>b.Ob||y("glp_intopt: tol_int = "+b.Ob+"; invalid parameter");0<b.oe&&1>b.oe||y("glp_intopt: tol_obj = "+b.oe+"; invalid parameter");0>b.nb&&y("glp_intopt: tm_lim = "+b.nb+"; invalid parameter");0>b.Yb&&y("glp_intopt: out_frq = "+
b.Yb+"; invalid parameter");0>b.Za&&y("glp_intopt: out_dly = "+b.Za+"; invalid parameter");0<=b.Ce&&256>=b.Ce||y("glp_intopt: cb_size = "+b.Ce+"; invalid parameter");b.$c==Uh||(b.$c==Vh||b.$c==Xh)||y("glp_intopt: pp_tech = "+b.$c+"; invalid parameter");0>b.Yd&&y("glp_intopt: mip_gap = "+b.Yd+"; invalid parameter");b.yd==Dd||b.yd==Id||y("glp_intopt: mir_cuts = "+b.yd+"; invalid parameter");b.ud==Dd||b.ud==Id||y("glp_intopt: gmi_cuts = "+b.ud+"; invalid parameter");b.rd==Dd||b.rd==Id||y("glp_intopt: cov_cuts = "+
b.rd+"; invalid parameter");b.pd==Dd||b.pd==Id||y("glp_intopt: clq_cuts = "+b.pd+"; invalid parameter");b.uc==Dd||b.uc==Id||y("glp_intopt: presolve = "+b.uc+"; invalid parameter");b.md==Dd||b.md==Id||y("glp_intopt: binarize = "+b.md+"; invalid parameter");b.Ne==Dd||b.Ne==Id||y("glp_intopt: fp_heur = "+b.Ne+"; invalid parameter");a.va=Vb;a.qa=0;for(e=1;e<=a.f;e++)if(f=a.k[e],f.type==R&&f.c>=f.d)return b.n>=Jf&&B("glp_intopt: row "+e+": lb = "+f.c+", ub = "+f.d+"; incorrect bounds"),e=Og;for(e=1;e<=
a.h;e++)if(f=a.e[e],f.type==R&&f.c>=f.d)return b.n>=Jf&&B("glp_intopt: column "+e+": lb = "+f.c+", ub = "+f.d+"; incorrect bounds"),e=Og;for(e=1;e<=a.h;e++)if(f=a.e[e],f.Aa==ph){if((f.type==Zc||f.type==R)&&f.c!=Math.floor(f.c))return b.n>=Jf&&B("glp_intopt: integer column "+e+" has non-integer lower bound "+f.c+""),e=Og;if((f.type==$c||f.type==R)&&f.d!=Math.floor(f.d))return b.n>=Jf&&B("glp_intopt: integer column "+e+" has non-integer upper bound "+f.d+""),e=Og;if(f.type==G&&f.c!=Math.floor(f.c))return b.n>=
Jf&&B("glp_intopt: integer column "+e+" has non-integer fixed value "+f.c+""),e=Og}b.n>=fg&&(e=th(a),f=uh(a),B("GLPK Integer Optimizer, v"+ab()+""),B(a.f+" row"+(1==a.f?"":"s")+", "+a.h+" column"+(1==a.h?"":"s")+", "+a.J+" non-zero"+(1==a.J?"":"s")+""),B(e+" integer variable"+(1==e?"":"s")+", "+(0==f?"none of":1==e&&1==f?"":1==f?"one of":f==e?"all of":f+" of")+" which "+(1==f?"is":"are")+" binary"));return e=b.uc?d(a,b):c(a,b)};
var cj=exports.glp_init_iocp=function(a){a.n=fg;a.Db=Gi;a.fc=Lh;a.Ob=1E-5;a.oe=1E-7;a.nb=pa;a.Yb=5E3;a.Za=1E4;a.ib=s;a.Sc=s;a.Ce=0;a.$c=Xh;a.Yd=0;a.yd=Id;a.ud=Id;a.rd=Id;a.pd=Id;a.uc=Id;a.md=Id;a.Ne=Id};exports.glp_mip_status=function(a){return a.va};exports.glp_mip_obj_val=function(a){return a.qa};
var dj=exports.glp_mip_row_val=function(a,b){1<=b&&b<=a.f||y("glp_mip_row_val: i = "+b+"; row number out of range");return a.k[b].Oa},ej=exports.glp_mip_col_val=function(a,b){1<=b&&b<=a.h||y("glp_mip_col_val: j = "+b+"; column number out of range");return a.e[b].Oa},Gf=exports.glp_bf_exists=function(a){return 0==a.f||a.valid},Hf=exports.glp_factorize=function(a){function b(a,b,c,d){var e=a.f,f;f=a.head[b];if(f<=e)b=1,c[1]=f,d[1]=1;else{b=0;for(a=a.e[f-e].j;a!=s;a=a.G)b++,c[b]=a.k.ca,d[b]=-a.k.ka*
a.i*a.e.sa}return b}var c=a.f,d=a.h,e=a.k,f=a.e,g=a.head,j,h,l;j=a.valid=0;for(h=1;h<=c+d;h++)if(h<=c?(l=e[h].l,e[h].bind=0):(l=f[h-c].l,f[h-c].bind=0),l==D){j++;if(j>c)return a=If;g[j]=h;h<=c?e[h].bind=j:f[h-c].bind=j}if(j<c)return a=If;if(0<c){a.R==s&&(d={valid:0},d.type=fj,d.$a=s,d.Ua=s,d.wd=0,d.Zb=0.1,d.tc=4,d.cc=1,d.Gb=1E-15,d.oc=1E10,d.Xc=100,d.ec=1E-6,d.rc=100,d.ed=1E3,d.qh=-1,d.Zf=0,a.R=d,gj(a));switch(hj(a.R,c,b,a)){case ij:return a=Kf;case jj:return a=Lf}a.valid=1}return 0};
exports.glp_bf_updated=function(a){0==a.f||a.valid||y("glp_bf_update: basis factorization does not exist");return 0==a.f?0:a.R.Zf};var Pd=exports.glp_get_bfcp=function(a,b){var c=a.Kd;if(c==s)b.type=fj,b.wd=0,b.Zb=0.1,b.tc=4,b.cc=Dd,b.Gb=1E-15,b.oc=1E10,b.Xc=100,b.ec=1E-6,b.rc=100,b.ed=0;else for(var d in c)b[d]=c[d]};function gj(a){var b={};Pd(a,b);a=a.R;a.type=b.type;a.wd=b.wd;a.Zb=b.Zb;a.tc=b.tc;a.cc=b.cc;a.Gb=b.Gb;a.oc=b.oc;a.Xc=b.Xc;a.ec=b.ec;a.rc=b.rc;a.ed=b.ed}
var Qd=exports.glp_set_bfcp=function(a,b){var c=a.Kd;if(b==s)c!=s&&(a.Kd=s);else{c==s&&(c=a.Kd={});var d=c,e;for(e in b)d[e]=b[e];c.type==fj||(c.type==kj||c.type==lj)||y("glp_set_bfcp: type = "+c.type+"; invalid parameter");0>c.wd&&y("glp_set_bfcp: lu_size = "+c.wd+"; invalid parameter");0<c.Zb&&1>c.Zb||y("glp_set_bfcp: piv_tol = "+c.Zb+"; invalid parameter");1>c.tc&&y("glp_set_bfcp: piv_lim = "+c.tc+"; invalid parameter");c.cc==Dd||c.cc==Id||y("glp_set_bfcp: suhl = "+c.cc+"; invalid parameter");
0<=c.Gb&&1E-6>=c.Gb||y("glp_set_bfcp: eps_tol = "+c.Gb+"; invalid parameter");1>c.oc&&y("glp_set_bfcp: max_gro = "+c.oc+"; invalid parameter");1<=c.Xc&&32767>=c.Xc||y("glp_set_bfcp: nfs_max = "+c.Xc+"; invalid parameter");0<c.ec&&1>c.ec||y("glp_set_bfcp: upd_tol = "+c.ec+"; invalid parameter");1<=c.rc&&32767>=c.rc||y("glp_set_bfcp: nrs_max = "+c.rc+"; invalid parameter");0>c.ed&&y("glp_set_bfcp: rs_size = "+c.rc+"; invalid parameter");0==c.ed&&(c.ed=20*c.rc)}a.R!=s&&gj(a)},mj=exports.glp_get_bhead=
function(a,b){0==a.f||a.valid||y("glp_get_bhead: basis factorization does not exist");1<=b&&b<=a.f||y("glp_get_bhead: k = "+b+"; index out of range");return a.head[b]},nj=exports.glp_get_row_bind=function(a,b){0==a.f||a.valid||y("glp_get_row_bind: basis factorization does not exist");1<=b&&b<=a.f||y("glp_get_row_bind: i = "+b+"; row number out of range");return a.k[b].bind},oj=exports.glp_get_col_bind=function(a,b){0==a.f||a.valid||y("glp_get_col_bind: basis factorization does not exist");1<=b&&b<=
a.h||y("glp_get_col_bind: j = "+b+"; column number out of range");return a.e[b].bind},qj=exports.glp_ftran=function(a,b){var c=a.f,d=a.k,e=a.e,f,g;0==c||a.valid||y("glp_ftran: basis factorization does not exist");for(f=1;f<=c;f++)b[f]*=d[f].ka;0<c&&pj(a.R,b);for(f=1;f<=c;f++)g=a.head[f],b[f]=g<=c?b[f]/d[g].ka:b[f]*e[g-c].sa},sj=exports.glp_btran=function(a,b){var c=a.f,d=a.k,e=a.e,f,g;0==c||a.valid||y("glp_btran: basis factorization does not exist");for(f=1;f<=c;f++)g=a.head[f],b[f]=g<=c?b[f]/d[g].ka:
b[f]*e[g-c].sa;0<c&&rj(a.R,b);for(f=1;f<=c;f++)b[f]*=d[f].ka};
exports.glp_warm_up=function(a){var b,c,d,e,f;a.la=a.pa=Vb;a.Y=0;a.some=0;for(d=1;d<=a.f;d++)b=a.k[d],b.q=b.H=0;for(d=1;d<=a.h;d++)b=a.e[d],b.q=b.H=0;if(!Gf(a)&&(e=Hf(a),0!=e))return e;e=Array(1+a.f);for(d=1;d<=a.f;d++)e[d]=0;for(d=1;d<=a.f;d++)b=a.k[d],b.l!=D&&(b.l==K?b.q=b.c:b.l==od?b.q=b.d:b.l==Yc?b.q=0:b.l==Gc&&(b.q=b.c),e[d]-=b.q);for(d=1;d<=a.h;d++)if(b=a.e[d],b.l!=D&&(b.l==K?b.q=b.c:b.l==od?b.q=b.d:b.l==Yc?b.q=0:b.l==Gc&&(b.q=b.c),0!=b.q))for(c=b.j;c!=s;c=c.G)e[c.k.ca]+=c.i*b.q;qj(a,e);a.la=
Bg;for(d=1;d<=a.f;d++)if(b=a.k[d],b.l==D){b.q=e[b.bind];c=b.type;if(c==Zc||c==R||c==G)f=1E-6+1E-9*Math.abs(b.c),b.q<b.c-f&&(a.la=$h);if(c==$c||c==R||c==G)f=1E-6+1E-9*Math.abs(b.d),b.q>b.d+f&&(a.la=$h)}for(d=1;d<=a.h;d++)if(b=a.e[d],b.l==D){b.q=e[b.bind];c=b.type;if(c==Zc||c==R||c==G)f=1E-6+1E-9*Math.abs(b.c),b.q<b.c-f&&(a.la=$h);if(c==$c||c==R||c==G)f=1E-6+1E-9*Math.abs(b.d),b.q>b.d+f&&(a.la=$h)}a.Y=a.da;for(d=1;d<=a.h;d++)b=a.e[d],a.Y+=b.t*b.q;for(d=1;d<=a.f;d++)e[d]=0;for(d=1;d<=a.h;d++)b=a.e[d],
b.l==D&&(e[b.bind]=b.t);sj(a,e);a.pa=Bg;for(d=1;d<=a.f;d++)if(b=a.k[d],b.l==D)b.H=0;else if(b.H=-e[d],c=b.type,f=a.dir==Gb?+b.H:-b.H,(c==yc||c==Zc)&&-1E-5>f||(c==yc||c==$c)&&1E-5<f)a.pa=$h;for(d=1;d<=a.h;d++)if(b=a.e[d],b.l==D)b.H=0;else{b.H=b.t;for(c=b.j;c!=s;c=c.G)b.H+=c.i*e[c.k.ca];c=b.type;f=a.dir==Gb?+b.H:-b.H;if((c==yc||c==Zc)&&-1E-5>f||(c==yc||c==$c)&&1E-5<f)a.pa=$h}return 0};
var Hi=exports.glp_eval_tab_row=function(a,b,c,d){var e=a.f,f=a.h,g,j,h,l,m,n,p;0==e||a.valid||y("glp_eval_tab_row: basis factorization does not exist");1<=b&&b<=e+f||y("glp_eval_tab_row: k = "+b+"; variable number out of range");g=b<=e?nj(a,b):oj(a,b-e);0==g&&y("glp_eval_tab_row: k = "+b+"; variable must be basic");n=Array(1+e);l=Array(1+e);p=Array(1+e);for(j=1;j<=e;j++)n[j]=0;n[g]=1;sj(a,n);g=0;for(b=1;b<=e+f;b++){if(b<=e){if(jh(a,b)==D)continue;m=-n[b]}else{if(mh(a,b-e)==D)continue;h=Rd(a,b-e,
l,p);m=0;for(j=1;j<=h;j++)m+=n[l[j]]*p[j]}0!=m&&(g++,c[g]=b,d[g]=m)}return g},tj=exports.glp_eval_tab_col=function(a,b,c,d){var e=a.f,f=a.h,g;0==e||a.valid||y("glp_eval_tab_col: basis factorization does not exist");1<=b&&b<=e+f||y("glp_eval_tab_col: k = "+b+"; variable number out of range");(b<=e?jh(a,b):mh(a,b-e))==D&&y("glp_eval_tab_col: k = "+b+"; variable must be non-basic");g=Array(1+e);for(f=1;f<=e;f++)g[f]=0;if(b<=e)g[b]=-1;else{b=Rd(a,b-e,c,d);for(f=1;f<=b;f++)g[c[f]]=d[f]}qj(a,g);b=0;for(f=
1;f<=e;f++)0!=g[f]&&(b++,c[b]=mj(a,f),d[b]=g[f]);return b},uj=exports.glp_transform_row=function(a,b,c,d){var e,f,g,j,h,l,m,n,p,t;Gf(a)||y("glp_transform_row: basis factorization does not exist ");f=ye(a);g=ze(a);n=Array(1+g);for(e=1;e<=g;e++)n[e]=0;0<=b&&b<=g||y("glp_transform_row: len = "+b+"; invalid row length");for(j=1;j<=b;j++)e=c[j],1<=e&&e<=g||y("glp_transform_row: ind["+j+"] = "+e+"; column index out of range"),0==d[j]&&y("glp_transform_row: val["+j+"] = 0; zero coefficient not allowed"),
0!=n[e]&&y("glp_transform_row: ind["+j+"] = "+e+"; duplicate column indices not allowed"),n[e]=d[j];p=Array(1+f);for(e=1;e<=f;e++)b=mj(a,e),p[e]=b<=f?0:n[b-f];sj(a,p);b=0;for(e=1;e<=f;e++)jh(a,e)!=D&&(m=-p[e],0!=m&&(b++,c[b]=e,d[b]=m));l=Array(1+f);t=Array(1+f);for(e=1;e<=g;e++)if(mh(a,e)!=D){m=n[e];h=Rd(a,e,l,t);for(j=1;j<=h;j++)m+=t[j]*p[l[j]];0!=m&&(b++,c[b]=f+e,d[b]=m)}return b};
exports.glp_transform_col=function(a,b,c,d){var e,f,g,j;Gf(a)||y("glp_transform_col: basis factorization does not exist ");f=ye(a);j=Array(1+f);for(e=1;e<=f;e++)j[e]=0;0<=b&&b<=f||y("glp_transform_col: len = "+b+"; invalid column length");for(g=1;g<=b;g++)e=c[g],1<=e&&e<=f||y("glp_transform_col: ind["+g+"] = "+e+"; row index out of range"),0==d[g]&&y("glp_transform_col: val["+g+"] = 0; zero coefficient not allowed"),0!=j[e]&&y("glp_transform_col: ind["+g+"] = "+e+"; duplicate row indices not allowed"),
j[e]=d[g];qj(a,j);b=0;for(e=1;e<=f;e++)0!=j[e]&&(b++,c[b]=mj(a,e),d[b]=j[e]);return b};
var vj=exports.glp_prim_rtest=function(a,b,c,d,e,f){var g,j,h,l,m,n,p,t,r,w,E,q,z;Qg(a)!=Bg&&y("glp_prim_rtest: basic solution is not primal feasible ");1==e||-1==e||y("glp_prim_rtest: dir = "+e+"; invalid parameter");0<f&&1>f||y("glp_prim_rtest: eps = "+f+"; invalid parameter");j=ye(a);h=ze(a);l=0;z=v;t=0;for(m=1;m<=b;m++)if(g=c[m],1<=g&&g<=j+h||y("glp_prim_rtest: ind["+m+"] = "+g+"; variable number out of range"),g<=j?(n=Ce(a,g),w=De(a,g),E=Qe(a,g),p=jh(a,g),r=kh(a,g)):(n=Re(a,g-j),w=Se(a,g-j),
E=Te(a,g-j),p=mh(a,g-j),r=nh(a,g-j)),p!=D&&y("glp_prim_rtest: ind["+m+"] = "+g+"; non-basic variable not allowed"),g=0<e?+d[m]:-d[m],n!=yc){if(n==Zc){if(g>-f)continue;q=(w-r)/g}else if(n==$c){if(g<+f)continue;q=(E-r)/g}else if(n==R)if(0>g){if(g>-f)continue;q=(w-r)/g}else{if(g<+f)continue;q=(E-r)/g}else if(n==G){if(-f<g&&g<+f)continue;q=0}0>q&&(q=0);if(z>q||z==q&&t<Math.abs(g))l=m,z=q,t=Math.abs(g)}return l},Ii=exports.glp_dual_rtest=function(a,b,c,d,e,f){var g,j,h,l,m,n,p,t,r,w,E;eh(a)!=Bg&&y("glp_dual_rtest: basic solution is not dual feasible");
1==e||-1==e||y("glp_dual_rtest: dir = "+e+"; invalid parameter");0<f&&1>f||y("glp_dual_rtest: eps = "+f+"; invalid parameter");j=ye(a);h=ze(a);r=xe(a)==Gb?1:-1;l=0;E=v;p=0;for(m=1;m<=b;m++){g=c[m];1<=g&&g<=j+h||y("glp_dual_rtest: ind["+m+"] = "+g+"; variable number out of range");g<=j?(n=jh(a,g),t=lh(a,g)):(n=mh(a,g-j),t=oh(a,g-j));n==D&&y("glp_dual_rtest: ind["+m+"] = "+g+"; basic variable not allowed");g=0<e?+d[m]:-d[m];if(n==K){if(g<+f)continue;w=r*t/g}else if(n==od){if(g>-f)continue;w=r*t/g}else if(n==
Yc){if(-f<g&&g<+f)continue;w=0}else if(n==Gc)continue;0>w&&(w=0);if(E>w||E==w&&p<Math.abs(g))l=m,E=w,p=Math.abs(g)}return l};
exports.glp_analyze_bound=function(a,b,c){var d,e,f,g,j,h,l,m,n,p,t,r,w,E;t=r=w=E=s;(a==s||a.xd!=wb)&&y("glp_analyze_bound: P = "+a+"; invalid problem object");e=a.f;f=a.h;a.la==Bg&&a.pa==Bg||y("glp_analyze_bound: optimal basic solution required");0==e||a.valid||y("glp_analyze_bound: basis factorization required");1<=b&&b<=e+f||y("glp_analyze_bound: k = "+b+"; variable number out of range");d=b<=e?a.k[b]:a.e[b-e];g=d.l;f=d.q;g==D&&y("glp_analyze_bound: k = "+b+"; basic variable not allowed ");g=Array(1+
e);p=Array(1+e);h=tj(a,b,g,p);for(b=-1;1>=b;b+=2)l=vj(a,h,g,p,b,1E-9),0==l?(j=0,l=0>b?-v:+v):(j=g[l],j<=e?(d=a.k[j],m=De(a,d.ca),n=Qe(a,d.ca)):(d=a.e[j-e],m=Se(a,d.A),n=Te(a,d.A)),d=d.q,d=0>b&&0<p[l]||0<b&&0>p[l]?m-d:n-d,l=f+d/p[l]),0>b?(t=l,r=j):(w=l,E=j);c(t,r,w,E)};
exports.glp_analyze_coef=function(a,b){var c,d,e,f,g,j,h,l,m,n,p,t,r,w,E,q,z,C,H,O,J=s,L=s,u=s,F=s,x=s,P=s;(a==s||a.xd!=wb)&&y("glp_analyze_coef: P = "+a+"; invalid problem object");d=a.f;e=a.h;a.la==Bg&&a.pa==Bg||y("glp_analyze_coef: optimal basic solution required");0==d||a.valid||y("glp_analyze_coef: basis factorization required");1<=b&&b<=d+e||y("glp_analyze_coef: k = "+b+"; variable number out of range");b<=d?(c=a.k[b],f=c.type,t=c.c,r=c.d,w=0):(c=a.e[b-d],f=c.type,t=c.c,r=c.d,w=c.t);g=c.l;E=
c.q;g!=D&&y("glp_analyze_coef: k = "+b+"; non-basic variable not allowed");g=Array(1+d);O=Array(1+d);p=Array(1+e);H=Array(1+e);m=Hi(a,b,p,H);for(e=-1;1>=e;e+=2)a.dir==Gb?h=-e:a.dir==ec&&(h=+e),n=Ii(a,m,p,H,h,1E-9),0==n?(q=0>e?-v:+v,j=0,n=E):(j=p[n],c=j<=d?a.k[j]:a.e[j-d],h=c.H,c=-h/H[n],q=w+c,h=0>e&&0<H[n]||0<e&&0>H[n]?1:-1,a.dir==ec&&(h=-h),l=tj(a,j,g,O),c=b<=d?a.k[b]:a.e[b-d],c.type=yc,c.c=c.d=0,l=vj(a,l,g,O,h,1E-9),c=b<=d?a.k[b]:a.e[b-d],c.type=f,c.c=t,c.d=r,0==l?n=0>h&&0<H[n]||0<h&&0>H[n]?-v:
+v:(c=g[l],c<=d?(c=a.k[c],z=De(a,c.ca),C=Qe(a,c.ca)):(c=a.e[c-d],z=Se(a,c.A),C=Te(a,c.A)),c=c.q,c=0>h&&0<O[l]||0<h&&0>O[l]?z-c:C-c,n=E+H[n]/O[l]*c)),0>e?(J=q,L=j,u=n):(F=q,x=j,P=n);callback(J,L,u,F,x,P)};function wj(a){a.reason!=qc&&y("glp_ios_pool_size: operation not allowed");return a.vd.size}
function vi(a,b,c,d,e,f,g){a.reason!=qc&&y("glp_ios_add_row: operation not allowed");var j=a.vd,h,l;h={name:s};0<=b&&255>=b||y("glp_ios_add_row: klass = "+b+"; invalid cut class");h.mc=b;h.j=s;0<=c&&c<=a.h||y("glp_ios_add_row: len = "+c+"; invalid cut length");for(l=1;l<=c;l++)b={},1<=d[l]&&d[l]<=a.h||y("glp_ios_add_row: ind["+l+"] = "+d[l]+"; column index out of range"),b.A=d[l],b.i=e[l],b.next=h.j,h.j=b;f==Zc||(f==$c||f==G)||y("glp_ios_add_row: type = "+f+"; invalid cut type");h.type=f;h.Uf=g;h.aa=
j.Sa;h.next=s;h.aa==s?j.head=h:h.aa.next=h;j.Sa=h;j.size++}function xj(a,b){1<=b&&b<=a.z.h||y("glp_ios_can_branch: j = "+b+"; column number out of range");return a.Lc[b]}
function yj(a,b){var c=a.z,d=a.sc,e=a.h,f,g;g=c.da;for(f=1;f<=e;f++){var j=c.e[f];if(j.Aa==ph&&b[f]!=Math.floor(b[f]))return 1;g+=j.t*b[f]}if(c.va==Bg)switch(c.dir){case Gb:if(g>=a.z.qa)return 1;break;case ec:if(g<=a.z.qa)return 1}a.o.n>=Cg&&B("Solution found by heuristic: "+g+"");c.va=Bg;c.qa=g;for(f=1;f<=e;f++)c.e[f].Oa=b[f];for(e=1;e<=d;e++){f=c.k[e];f.Oa=0;for(g=f.j;g!=s;g=g.w)f.Oa+=g.i*g.e.Oa}return 0}exports.glp_mpl_alloc_wksp=function(){return zj()};
exports._glp_mpl_init_rand=function(a,b){0!=a.B&&y("glp_mpl_init_rand: invalid call sequence\n");Aj(a.Ad,b)};var Cj=exports.glp_mpl_read_model=function(a,b,c,d){0!=a.B&&y("glp_mpl_read_model: invalid call sequence");a=Bj(a,b,c,d);1==a||2==a?a=0:4==a&&(a=1);return a};exports.glp_mpl_read_model_from_string=function(a,b,c,d){var e=0;return Cj(a,b,function(){return e<c.length?c[e++]:-1},d)};
var Ej=exports.glp_mpl_read_data=function(a,b,c){1==a.B||2==a.B||y("glp_mpl_read_data: invalid call sequence");a=Dj(a,b,c);2==a?a=0:4==a&&(a=1);return a};exports.glp_mpl_read_data_from_string=function(a,b,c){var d=0;return Ej(a,b,function(){return d<c.length?c[d++]:-1})};exports.glp_mpl_generate=function(a,b,c){1==a.B||2==a.B||y("glp_mpl_generate: invalid call sequence\n");a=Fj(a,b,c);3==a?a=0:4==a&&(a=1);return a};
exports.glp_mpl_build_prob=function(a,b){var c,d,e,f,g,j,h;3!=a.B&&y("glp_mpl_build_prob: invalid call sequence\n");Od(b);Xb(b,Gj(a));c=Hj(a);0<c&&zc(b,c);for(d=1;d<=c;d++){Mc(b,d,Ij(a,d));g=Jj(a,d,function(a,b){j=a;h=b});switch(g){case Kj:g=yc;break;case Lj:g=Zc;break;case Mj:g=$c;break;case Nj:g=R;break;case Oj:g=G}g==R&&Math.abs(j-h)<1E-9*(1+Math.abs(j))&&(g=G,Math.abs(j)<=Math.abs(h)?h=j:j=h);pd(b,d,g,j,h);0!=Pj(a,d)&&B("glp_mpl_build_prob: row "+Ij(a,d)+"; constant term "+Pj(a,d)+" ignored")}d=
Qj(a);0<d&&Hc(b,d);for(e=1;e<=d;e++){Xc(b,e,Rj(a,e));f=Sj(a,e);switch(f){case Tj:case Uj:rh(b,e,ph)}g=Vj(a,e,function(a,b){j=a;h=b});switch(g){case Kj:g=yc;break;case Lj:g=Zc;break;case Mj:g=$c;break;case Nj:g=R;break;case Oj:g=G}if(f==Uj){if(g==yc||g==$c||0>j)j=0;if(g==yc||g==Zc||1<h)h=1;g=R}g==R&&Math.abs(j-h)<1E-9*(1+Math.abs(j))&&(g=G,Math.abs(j)<=Math.abs(h)?h=j:j=h);qd(b,e,g,j,h)}g=Array(1+d);e=Array(1+d);for(d=1;d<=c;d++)f=Wj(a,d,g,e),sd(b,d,f,g,e);for(d=1;d<=c;d++)if(f=Xj(a,d),f==Yj||f==Zj){dc(b,
Ij(a,d));nc(b,f==Yj?Gb:ec);rd(b,0,Pj(a,d));f=Wj(a,d,g,e);for(c=1;c<=f;c++)rd(b,g[c],e[c]);break}};
exports.glp_mpl_postsolve=function(a,b,c){var d,e,f,g,j,h;(3!=a.B||a.Ef)&&y("glp_mpl_postsolve: invalid call sequence");c==ig||(c==$j||c==Oi)||y("glp_mpl_postsolve: sol = "+c+"; invalid parameter");e=Hj(a);f=Qj(a);e==ye(b)&&f==ze(b)||y("glp_mpl_postsolve: wrong problem object\n");if(!ak(a))return 0;for(d=1;d<=e;d++)c==ig?(g=jh(b,d),j=kh(b,d),h=lh(b,d)):c==$j?(g=0,j=glp_ipt_row_prim(b,d),h=glp_ipt_row_dual(b,d)):c==Oi&&(g=0,j=dj(b,d),h=0),1E-9>Math.abs(j)&&(j=0),1E-9>Math.abs(h)&&(h=0),gk(a,d,g,j,
h);for(d=1;d<=f;d++)c==ig?(g=mh(b,d),j=nh(b,d),h=oh(b,d)):c==$j?(g=0,j=glp_ipt_col_prim(b,d),h=glp_ipt_col_dual(b,d)):c==Oi&&(g=0,j=ej(b,d),h=0),1E-9>Math.abs(j)&&(j=0),1E-9>Math.abs(h)&&(h=0),hk(a,d,g,j,h);a=ik(a);3==a?a=0:4==a&&(a=1);return a};var ij=1,jj=2,jk=3,kk=4,lk=5;
function hj(a,b,c,d){var e,f;f=a.valid=0;switch(a.type){case fj:a.Ua=s;a.$a==s&&(f={},f.ab=f.f=0,f.valid=0,f.ea=mk(),f.Vd=50,f.Jb=0,f.Pe=f.Re=f.Qe=s,f.de=f.ce=s,f.jg=s,f.kg=s,f.ec=1E-6,f.Sf=0,a.$a=f,f=1);break;case kj:case lj:a.$a=s,a.Ua==s&&(nk&&B("lpf_create_it: warning: debug mode enabled"),f={valid:0},f.Kc=f.Ue=0,f.ea=mk(),f.f=0,f.sf=s,f.I=50,f.h=0,f.Gd=f.Fd=s,f.Id=f.Hd=s,f.Oc=s,f.we=f.ve=s,f.ye=f.xe=s,f.Dd=1E3,f.hd=0,f.Qb=s,f.Rb=s,f.bb=f.Fc=s,a.Ua=f,f=1)}a.$a!=s?e=a.$a.ea:a.Ua!=s&&(e=a.Ua.ea);
f&&(e.Ra=a.wd);e.Zb=a.Zb;e.tc=a.tc;e.cc=a.cc;e.Gb=a.Gb;e.oc=a.oc;a.$a!=s&&(f&&(a.$a.Vd=a.Xc),a.$a.ec=a.ec);a.Ua!=s&&(f&&(a.Ua.I=a.rc),f&&(a.Ua.Dd=a.ed));if(a.$a!=s){a:{e=a.$a;1>b&&y("fhv_factorize: m = "+b+"; invalid parameter");b>ta&&y("fhv_factorize: m = "+b+"; matrix too big");e.f=b;e.valid=0;e.Pe==s&&(e.Pe=Array(1+e.Vd));e.Re==s&&(e.Re=Array(1+e.Vd));e.Qe==s&&(e.Qe=Array(1+e.Vd));e.ab<b&&(e.ab=b+100,e.de=Array(1+e.ab),e.ce=Array(1+e.ab),e.jg=Array(1+e.ab),e.kg=Array(1+e.ab));switch(ok(e.ea,b,
c,d)){case pk:b=qk;break a;case rk:b=sk;break a}e.valid=1;e.Jb=0;Ca(e.de,1,e.ea.eb,1,b);Ca(e.ce,1,e.ea.qb,1,b);b=e.Sf=0}switch(b){case qk:return a=ij;case sk:return a=jj}}else if(a.Ua!=s){a:{e=a.Ua;if(nk)var g,j,h,l,m,n;1>b&&y("lpf_factorize: m = "+b+"; invalid parameter");b>ta&&y("lpf_factorize: m = "+b+"; matrix too big");e.Ue=e.f=b;e.valid=0;e.Gd==s&&(e.Gd=Array(1+e.I));e.Fd==s&&(e.Fd=Array(1+e.I));e.Id==s&&(e.Id=Array(1+e.I));e.Hd==s&&(e.Hd=Array(1+e.I));e.Oc==s&&(f=e.I,tk&&B("scf_create_it: warning: debug mode enabled"),
1<=f&&32767>=f||y("scf_create_it: n_max = "+f+"; invalid parameter"),g={},g.I=f,g.h=0,g.Hb=Array(1+f*f),g.u=Array(1+f*(f+1)/2),g.r=Array(1+f),g.Xf=uk,g.vc=0,g.m=tk?Array(1+f*f):s,g.$f=Array(1+f),e.Oc=g);e.Qb==s&&(e.Qb=Array(1+e.Dd));e.Rb==s&&(e.Rb=Array(1+e.Dd));e.Kc<b&&(e.Kc=b+100,e.we=Array(1+e.Kc+e.I),e.ve=Array(1+e.Kc+e.I),e.ye=Array(1+e.Kc+e.I),e.xe=Array(1+e.Kc+e.I),e.bb=Array(1+e.Kc+e.I),e.Fc=Array(1+e.Kc+e.I));switch(ok(e.ea,b,c,d)){case pk:b=vk;break a;case rk:b=LPF_ECOND;break a}e.valid=
1;if(nk){e.sf=m=Array(1+b*b);l=Array(1+b);n=Array(1+b);for(f=1;f<=b*b;f++)m[f]=0;for(j=1;j<=b;j++){h=c(d,j,l,n);for(f=1;f<=h;f++)g=l[f],m[(g-1)*b+j]=n[f]}}e.h=0;c=e.Oc;c.h=c.vc=0;for(f=1;f<=b;f++)e.we[f]=e.ve[f]=f,e.ye[f]=e.xe[f]=f;e.hd=1;b=0}switch(b){case 0:switch(a.type){case kj:a.Ua.Oc.Xf=uk;break;case lj:a.Ua.Oc.Xf=wk}break;case vk:return a=ij;case LPF_ECOND:return a=jj}}a.valid=1;return a.Zf=0}
function pj(a,b){if(a.$a!=s){var c=a.$a,d=c.ea.eb,e=c.ea.qb,f=c.de,g=c.ce;c.valid||y("fhv_ftran: the factorization is not valid");c.ea.eb=f;c.ea.qb=g;xk(c.ea,0,b);c.ea.eb=d;c.ea.qb=e;yk(c,0,b);zk(c.ea,0,b)}else if(a.Ua!=s){var c=a.Ua,d=c.Ue,e=c.f,j=c.h,h=c.ve,f=c.xe,g=c.bb,l,m;if(nk)var n;c.valid||y("lpf_ftran: the factorization is not valid");if(nk){n=Array(1+e);for(l=1;l<=e;l++)n[l]=b[l]}for(l=1;l<=d+j;l++)g[l]=(m=h[l])<=e?b[m]:0;xk(c.ea,0,g);Ak(c,g,d,g);Bk(c.Oc,0,g,d);j=c.h;h=c.Gd;l=c.Fd;m=c.Qb;
var p=c.Rb,t,r,w,E;for(t=1;t<=j;t++)if(0!=g[t+d]){E=-1*g[t+d];r=h[t];for(w=r+l[t];r<w;r++)g[m[r]]+=E*p[r]}zk(c.ea,0,g);for(l=1;l<=e;l++)b[l]=g[f[l]];nk&&Ck(c,0,b,n)}}
function rj(a,b){if(a.$a!=s){var c=a.$a,d=c.ea.eb,e=c.ea.qb,f=c.de,g=c.ce;c.valid||y("fhv_btran: the factorization is not valid");zk(c.ea,1,b);yk(c,1,b);c.ea.eb=f;c.ea.qb=g;xk(c.ea,1,b);c.ea.eb=d;c.ea.qb=e}else if(a.Ua!=s){var c=a.Ua,d=c.Ue,e=c.f,j=c.h,f=c.we,h=c.ye,g=c.bb,l,m;if(nk)var n;c.valid||y("lpf_btran: the factorization is not valid");if(nk){n=Array(1+e);for(l=1;l<=e;l++)n[l]=b[l]}for(l=1;l<=d+j;l++)g[l]=(m=h[l])<=e?b[m]:0;zk(c.ea,1,g);Dk(c,g,d,g);Bk(c.Oc,1,g,d);j=c.h;h=c.Id;l=c.Hd;m=c.Qb;
var p=c.Rb,t,r,w,E;for(t=1;t<=j;t++)if(0!=g[t+d]){E=-1*g[t+d];r=h[t];for(w=r+l[t];r<w;r++)g[m[r]]+=E*p[r]}xk(c.ea,1,g);for(l=1;l<=e;l++)b[l]=g[f[l]];nk&&Ck(c,1,b,n)}}
function Ek(a,b,c,d,e,f){if(a.$a!=s)switch(Fk(a.$a,b,c,d,e,f)){case qk:return a.valid=0,a=ij;case Gk:return a.valid=0,a=jk;case Hk:return a.valid=0,a=kk;case Ik:return a.valid=0,a=lk}else if(a.Ua!=s){a:{var g=a.Ua,j=g.Ue,h=g.f;if(nk)var l=g.sf;var m=g.h,n=g.Gd,p=g.Fd,t=g.Id,r=g.Hd,w=g.we,E=g.ve,q=g.ye,z=g.xe,C=g.hd,H=g.Qb,O=g.Rb,J=g.Fc,L=g.bb,u=g.Fc,F,x,P;g.valid||y("lpf_update_it: the factorization is not valid");1<=b&&b<=h||y("lpf_update_it: j = "+b+"; column number out of range");if(m==g.I)g.valid=
0,b=LPF_ELIMIT;else{for(F=1;F<=h;F++)J[F]=0;for(P=1;P<=c;P++)F=d[e+P],1<=F&&F<=h||y("lpf_update_it: ind["+P+"] = "+F+"; row number out of range"),0!=J[F]&&y("lpf_update_it: ind["+P+"] = "+F+"; duplicate row index not allowed"),0==f[P]&&y("lpf_update_it: val["+P+"] = "+f[P]+"; zero element not allowed"),J[F]=f[P];if(nk)for(F=1;F<=h;F++)l[(F-1)*h+b]=J[F];for(F=1;F<=j+m;F++)L[F]=(x=E[F])<=h?J[x]:0;for(F=1;F<=j+m;F++)u[F]=0;u[z[b]]=1;xk(g.ea,0,L);zk(g.ea,1,u);if(g.Dd<C+j+j){F=g.Dd;c=g.hd-1;d=g.Qb;for(e=
g.Rb;F<C+j+j;)F+=F;g.Dd=F;g.Qb=Array(1+F);g.Rb=Array(1+F);Ca(g.Qb,1,d,1,c);Ca(g.Rb,1,e,1,c);H=g.Qb;O=g.Rb}n[m+1]=C;for(F=1;F<=j;F++)0!=L[F]&&(H[C]=F,O[C]=L[F],C++);p[m+1]=C-g.hd;g.hd=C;t[m+1]=C;for(F=1;F<=j;F++)0!=u[F]&&(H[C]=F,O[C]=u[F],C++);r[m+1]=C-g.hd;g.hd=C;Ak(g,L,0,L);Dk(g,u,0,u);p=0;for(F=1;F<=j;F++)p-=u[F]*L[F];n=g.Oc;C=p;F=n.I;p=n.h;c=n.Hb;d=n.u;e=n.r;if(tk)var I=n.m;r=n.$f;t=0;if(p==F)t=Jk;else{n.h=++p;f=1;for(h=(f-1)*n.I+p;f<p;f++,h+=F)c[h]=0;h=1;for(f=(p-1)*n.I+h;h<p;h++,f++)c[f]=0;for(f=
c[(p-1)*n.I+p]=1;f<p;f++){H=0;h=1;for(l=(f-1)*n.I+1;h<p;h++,l++)H+=c[l]*L[h+j];d[Kk(n,f,p)]=H}for(h=1;h<p;h++)r[h]=u[e[h]+j];r[p]=C;e[p]=p;if(tk){f=1;for(h=(f-1)*n.I+p;f<p;f++,h+=F)I[h]=L[f+j];h=1;for(f=(p-1)*n.I+h;h<p;h++,f++)I[f]=u[h+j];I[(p-1)*n.I+p]=C}for(L=1;L<p&&0==r[L];L++);switch(n.Xf){case uk:u=n.h;I=n.Hb;for(C=n.u;L<u;L++){e=Kk(n,L,L);c=(L-1)*n.I+1;f=(u-1)*n.I+1;if(Math.abs(C[e])<Math.abs(r[L])){F=L;for(d=e;F<=u;F++,d++)l=C[d],C[d]=r[F],r[F]=l;F=1;d=c;for(h=f;F<=u;F++,d++,h++)l=I[d],I[d]=
I[h],I[h]=l}Math.abs(C[e])<Lk&&(C[e]=r[L]=0);if(0!=r[L]){l=r[L]/C[e];F=L+1;for(d=e+1;F<=u;F++,d++)r[F]-=l*C[d];F=1;d=c;for(h=f;F<=u;F++,d++,h++)I[h]-=l*I[d]}}Math.abs(r[u])<Lk&&(r[u]=0);C[Kk(n,u,u)]=r[u];break;case wk:u=n.h;I=n.Hb;for(C=n.u;L<u;L++)if(h=Kk(n,L,L),F=(L-1)*n.I+1,c=(u-1)*n.I+1,Math.abs(C[h])<Lk&&Math.abs(r[L])<Lk&&(C[h]=r[L]=0),0!=r[L]){d=C[h];f=r[L];e=H=l=k;0==f?(H=1,e=0):Math.abs(d)<=Math.abs(f)?(l=-d/f,e=1/Math.sqrt(1+l*l),H=e*l):(l=-f/d,H=1/Math.sqrt(1+l*l),e=H*l);d=H;f=e;for(e=
L;e<=u;e++,h++)l=C[h],H=r[e],C[h]=d*l-f*H,r[e]=f*l+d*H;e=1;h=F;for(F=c;e<=u;e++,h++,F++)c=I[h],l=I[F],I[h]=d*c-f*l,I[F]=f*c+d*l}Math.abs(r[u])<Lk&&(r[u]=0);C[Kk(n,u,u)]=r[u]}F=n.I;r=n.h;L=n.u;C=0;u=1;for(I=Kk(n,u,u);u<=r;u++,I+=F,F--)0!=L[I]&&C++;n.vc=C;n.vc!=p&&(t=Mk);tk&&Ck(n,"scf_update_exp")}switch(t){case Mk:g.valid=0;b=vk;break a}w[j+m+1]=E[j+m+1]=j+m+1;q[j+m+1]=z[j+m+1]=j+m+1;F=z[b];x=z[j+m+1];q[F]=j+m+1;z[j+m+1]=F;q[x]=b;z[b]=x;g.h++;b=0}}switch(b){case vk:return a.valid=0,a=ij;case LPF_ELIMIT:return a.valid=
0,a=kk}}a.Zf++;return 0}
var Nk="!\"#$%&()/,.;?@_`'{}|~",Ok=exports.glp_read_lp=function(a,b,c){function d(a,b){throw Error(a.count+": "+b);}function e(a,b){B(a.count+": warning: "+b)}function f(a){var b;"\n"==a.m&&a.count++;b=a.Eg();0>b?"\n"==a.m?(a.count--,b=Ba):(e(a,"missing final end of line"),b="\n"):"\n"!=b&&(0<=" \t\n\v\f\r".indexOf(b)?b=" ":eb(b)&&d(a,"invalid control character "+b.charCodeAt(0)));a.m=b}function g(a){a.g+=a.m;f(a)}function j(a,b){return a.toLowerCase()==b.toLowerCase()?1:0}function h(a){function b(){for(a.b=
J;qb(a.m)||0<=Nk.indexOf(a.m);)g(a);c&&(j(a.g,"minimize")?a.b=r:j(a.g,"minimum")?a.b=r:j(a.g,"min")?a.b=r:j(a.g,"maximize")?a.b=w:j(a.g,"maximum")?a.b=w:j(a.g,"max")?a.b=w:j(a.g,"subject")?" "==a.m&&(f(a),"t"==a.m.toLowerCase()&&(a.b=E,a.g+=" ",g(a),"o"!=a.m.toLowerCase()&&d(a,"keyword `subject to' incomplete"),g(a),fb(a.m)&&d(a,"keyword `"+a.g+a.m+"...' not recognized"))):j(a.g,"such")?" "==a.m&&(f(a),"t"==a.m.toLowerCase()&&(a.b=E,a.g+=" ",g(a),"h"!=a.m.toLowerCase()&&d(a,"keyword `such that' incomplete"),
g(a),"a"!=a.m.toLowerCase()&&d(a,"keyword `such that' incomplete"),g(a),"t"!=a.m.toLowerCase()&&d(a,"keyword `such that' incomplete"),g(a),fb(a.m)&&d(a,"keyword `"+a.g+a.m+"...' not recognized"))):j(a.g,"st")?a.b=E:j(a.g,"s.t.")?a.b=E:j(a.g,"st.")?a.b=E:j(a.g,"bounds")?a.b=q:j(a.g,"bound")?a.b=q:j(a.g,"general")?a.b=z:j(a.g,"generals")?a.b=z:j(a.g,"gen")?a.b=z:j(a.g,"integer")?a.b=C:j(a.g,"integers")?a.b=C:j(a.g,"int")?a.b=C:j(a.g,"binary")?a.b=H:j(a.g,"binaries")?a.b=H:j(a.g,"bin")?a.b=H:j(a.g,"end")&&
(a.b=O))}var c;a.b=-1;a.g="";for(a.value=0;;){for(c=0;" "==a.m;)f(a);if(a.m==Ba)a.b=t;else if("\n"==a.m)if(f(a),fb(a.m))c=1,b();else continue;else if("\\"==a.m){for(;"\n"!=a.m;)f(a);continue}else if(fb(a.m)||"."!=a.m&&0<=Nk.indexOf(a.m))b();else if(rb(a.m)||"."==a.m){for(a.b=L;rb(a.m);)g(a);if("."==a.m){g(a);for(1==a.g.length&&!rb(a.m)&&d(a,"invalid use of decimal point");rb(a.m);)g(a)}if("e"==a.m||"E"==a.m){g(a);("+"==a.m||"-"==a.m)&&g(a);for(rb(a.m)||d(a,"numeric constant `"+a.g+"' incomplete");rb(a.m);)g(a)}a.value=
Number(a.g);a.value==Number.NaN&&d(a,"numeric constant `"+a.g+"' out of range")}else"+"==a.m?(a.b=u,g(a)):"-"==a.m?(a.b=F,g(a)):":"==a.m?(a.b=x,g(a)):"<"==a.m?(a.b=P,g(a),"="==a.m&&g(a)):">"==a.m?(a.b=I,g(a),"="==a.m&&g(a)):"="==a.m?(a.b=X,g(a),"<"==a.m?(a.b=P,g(a)):">"==a.m&&(a.b=I,g(a))):d(a,"character `"+a.m+"' not recognized");break}for(;" "==a.m;)f(a)}function l(a,b){var c=mf(a.Ga,b);if(0==c){c=Hc(a.Ga,1);Xc(a.Ga,c,b);if(a.I<c){var d=a.I,e=a.X,f=a.i,g=a.cb,h=a.c,j=a.d;a.I+=a.I;a.X=Array(1+a.I);
Ca(a.X,1,e,1,d);a.i=Array(1+a.I);Ca(a.i,1,f,1,d);a.cb=Array(1+a.I);Da(a.cb,1,0,a.I);Ca(a.cb,1,g,1,d);a.c=Array(1+a.I);Ca(a.c,1,h,1,d);a.d=Array(1+a.I);Ca(a.d,1,j,1,d)}a.c[c]=+v;a.d[c]=-v}return c}function m(a){for(var b,c=0,e,f,g;;)if(a.b==u?(f=1,h(a)):a.b==F?(f=-1,h(a)):f=1,a.b==L?(g=a.value,h(a)):g=1,a.b!=J&&d(a,"missing variable name"),b=l(a,a.g),a.cb[b]&&d(a,"multiple use of variable `"+a.g+"' not allowed"),c++,a.X[c]=b,a.i[c]=f*g,a.cb[b]=1,h(a),!(a.b==u||a.b==F)){for(b=1;b<=c;b++)a.cb[a.X[b]]=
0;e=0;for(b=1;b<=c;b++)0!=a.i[b]&&(e++,a.X[e]=a.X[b],a.i[e]=a.i[b]);break}return e}function n(a,b,c){a.c[b]!=+v&&e(a,"lower bound of variable `"+Be(a.Ga,b)+"' redefined");a.c[b]=c}function p(a,b,c){a.d[b]!=-v&&e(a,"upper bound of variable `"+Be(a.Ga,b)+"' redefined");a.d[b]=c}var t=0,r=1,w=2,E=3,q=4,z=5,C=6,H=7,O=8,J=9,L=10,u=11,F=12,x=13,P=14,I=15,X=16,A={};B("Reading problem data");b==s&&(b={});A.Ga=a;A.o=b;A.Eg=c;A.count=0;A.m="\n";A.b=t;A.g="";A.value=0;A.I=100;A.X=Array(1+A.I);A.i=Array(1+A.I);
A.cb=Array(1+A.I);Da(A.cb,1,0,A.I);A.c=Array(1+A.I);A.d=Array(1+A.I);Od(a);kf(a);h(A);A.b==r||A.b==w||d(A,"`minimize' or `maximize' keyword missing");A.b==r?nc(A.Ga,Gb):A.b==w&&nc(A.Ga,ec);h(A);A.b==J&&":"==A.m?(dc(A.Ga,A.g),h(A),h(A)):dc(A.Ga,"obj");c=m(A);for(b=1;b<=c;b++)rd(A.Ga,A.X[b],A.i[b]);A.b!=E&&d(A,"constraints section missing");var M;for(h(A);!(b=zc(A.Ga,1),A.b==J&&":"==A.m?(0!=lf(A.Ga,A.g)&&d(A,"constraint `"+A.g+"' multiply defined"),Mc(A.Ga,b,A.g),h(A),h(A)):Mc(A.Ga,b,"r."+A.count),
c=m(A),sd(A.Ga,b,c,A.X,A.i),A.b==P?(M=$c,h(A)):A.b==I?(M=Zc,h(A)):A.b==X?(M=G,h(A)):d(A,"missing constraint sense"),A.b==u?(c=1,h(A)):A.b==F?(c=-1,h(A)):c=1,A.b!=L&&d(A,"missing right-hand side"),pd(A.Ga,b,M,c*A.value,c*A.value),"\n"==A.m||A.m==Ba||d(A,"invalid symbol(s) beyond right-hand side"),h(A),!(A.b==u||A.b==F||A.b==L||A.b==J)););if(A.b==q){var N;for(h(A);A.b==u||A.b==F||A.b==L||A.b==J;)A.b==u||A.b==F?(b=1,c=A.b==u?1:-1,h(A),A.b==L?(N=c*A.value,h(A)):j(A.g,"infinity")||j(A.g,"inf")?(0<c&&d(A,
"invalid use of `+inf' as lower bound"),N=-v,h(A)):d(A,"missing lower bound")):A.b==L?(b=1,N=A.value,h(A)):b=0,b&&(A.b!=P&&d(A,"missing `<', `<=', or `=<' after lower bound"),h(A)),A.b!=J&&d(A,"missing variable name"),M=l(A,A.g),b&&n(A,M,N),h(A),A.b==P?(h(A),A.b==u||A.b==F?(c=A.b==u?1:-1,h(A),A.b==L?(p(A,M,c*A.value),h(A)):j(A.g,"infinity")||j(A.g,"inf")?(0>c&&d(A,"invalid use of `-inf' as upper bound"),p(A,M,+v),h(A)):d(A,"missing upper bound")):A.b==L?(p(A,M,A.value),h(A)):d(A,"missing upper bound")):
A.b==I?(b&&d(A,"invalid bound definition"),h(A),A.b==u||A.b==F?(c=A.b==u?1:-1,h(A),A.b==L?(n(A,M,c*A.value),h(A)):j(A.g,"infinity")||0==j(A.g,"inf")?(0<c&&d(A,"invalid use of `+inf' as lower bound"),n(A,M,-v),h(A)):d(A,"missing lower bound")):A.b==L?(n(A,M,A.value),h(A)):d(A,"missing lower bound")):A.b==X?(b&&d(A,"invalid bound definition"),h(A),A.b==u||A.b==F?(c=A.b==u?1:-1,h(A),A.b==L?(n(A,M,c*A.value),p(A,M,c*A.value),h(A)):d(A,"missing fixed value")):A.b==L?(n(A,M,A.value),p(A,M,A.value),h(A)):
d(A,"missing fixed value")):j(A.g,"free")?(b&&d(A,"invalid bound definition"),n(A,M,-v),p(A,M,+v),h(A)):b||d(A,"invalid bound definition")}for(;A.b==z||A.b==C||A.b==H;){N=A;b=M=k;N.b==z?(b=0,h(N)):N.b==C?(b=0,h(N)):N.b==H&&(b=1,h(N));for(;N.b==J;)M=l(N,N.g),rh(N.Ga,M,ph),b&&(n(N,M,0),p(N,M,1)),h(N)}A.b==O?h(A):A.b==t?e(A,"keyword `end' missing"):d(A,"symbol "+A.g+" in wrong position");A.b!=t&&d(A,"extra symbol(s) detected beyond `end'");for(N=1;N<=a.h;N++)b=A.c[N],c=A.d[N],b==+v&&(b=0),c==-v&&(c=
+v),M=b==-v&&c==+v?yc:c==+v?Zc:b==-v?$c:b!=c?R:G,qd(A.Ga,N,M,b,c);B(a.f+" row"+(1==a.f?"":"s")+", "+a.h+" column"+(1==a.h?"":"s")+", "+a.J+" non-zero"+(1==a.J?"":"s"));0<th(a)&&(N=th(a),M=uh(a),1==N?0==M?B("One variable is integer"):B("One variable is binary"):(b=N+" integer variables, ",B((0==M?b+"none":1==M?b+"one":M==N?b+"all":b+M)+" of which "+(1==M?"is":"are")+" binary")));B(A.count+" lines were read");nf(a);Bd(a);return 0};
exports.glp_write_lp=function(a,b,c){function d(a){if("."==a[0]||rb(a[0]))return 1;for(var b=0;b<a.length;b++)if(!qb(a[b])&&0>Nk.indexOf(a[b]))return 1;return 0}function e(a){for(var b=0;b<a.length;b++)" "==a[b]?a[b]="_":"-"==a[b]?a[b]="~":"["==a[b]?a[b]="(":"]"==a[b]&&(a[b]=")")}function f(a,b){var c;c=0==b?he(a.Ga):Ae(a.Ga,b);if(c==s)return 0==b?"obj":"r_"+b;e(c);return d(c)?0==b?"obj":"r_"+b:c}function g(a,b){var c=Be(a.Ga,b);if(c==s)return"x_"+b;e(c);return d(c)?"x_"+b:c}function j(){c("End");
t++;B(t+" lines were written");return 0}var h={},l,m,n,p,t,r;B("Writing problem data");b==s&&(b={});h.Ga=a;h.o=b;t=0;c("\\* Problem: "+(a.name==s?"Unknown":a.name)+" *\\");t++;c("");t++;if(!(0<a.f&&0<a.h))return B("Warning: problem has no rows/columns"),c("\\* WARNING: PROBLEM HAS NO ROWS/COLUMNS *\\"),t++,c(""),t++,j();a.dir==Gb?(c("Minimize"),t++):a.dir==ec&&(c("Maximize"),t++);b=f(h,0);r=" "+b+":";m=0;for(n=1;n<=a.h;n++)if(l=a.e[n],0!=l.t||l.j==s)m++,b=g(h,n),p=0==l.t?" + 0 "+b:1==l.t?" + "+b:
-1==l.t?" - "+b:0<l.t?" + "+l.t+" "+b:" - "+-l.t+" "+b,72<r.length+p.length&&(c(r),r="",t++),r+=p;0==m&&(p=" 0 "+g(h,1),r+=p);c(r);t++;0!=a.da&&(c("\\* constant term = "+a.da+" *\\"),t++);c("");t++;c("Subject To");t++;for(n=1;n<=a.f;n++)if(l=a.k[n],l.type!=yc){b=f(h,n);r=" "+b+":";for(m=l.j;m!=s;m=m.w)b=g(h,m.e.A),p=1==m.i?" + "+b:-1==m.i?" - "+b:0<m.i?" + "+m.i+" "+b:" - "+-m.i+" "+b,72<r.length+p.length&&(c(r),r="",t++),r+=p;l.type==R?(p=" - ~r_"+n,72<r.length+p.length&&(c(r),r="",t++),r+=p):l.j==
s&&(p=" 0 "+g(h,1),r+=p);if(l.type==Zc)p=" >= "+l.c;else if(l.type==$c)p=" <= "+l.d;else if(l.type==R||l.type==G)p=" = "+l.c;72<r.length+p.length&&(c(r),r="",t++);r+=p;c(r);t++}c("");t++;p=0;for(n=1;n<=a.f;n++)l=a.k[n],l.type==R&&(p||(c("Bounds"),p=1,t++),c(" 0 <= ~r_"+n+" <= "+(l.d-l.c)),t++);for(n=1;n<=a.h;n++)l=a.e[n],l.type==Zc&&0==l.c||(p||(c("Bounds"),p=1,t++),b=g(h,n),l.type==yc?(c(" "+b+" free"),t++):l.type==Zc?(c(" "+b+" >= "+l.c),t++):l.type==$c?(c(" -Inf <= "+b+" <= "+l.d),t++):l.type==
R?(c(" "+l.c+" <= "+b+" <= "+l.d),t++):l.type==G&&(c(" "+b+" = "+l.c),t++));p&&c("");t++;p=0;for(n=1;n<=a.h;n++)l=a.e[n],l.Aa!=Fc&&(p||(c("Generals"),p=1,t++),c(" "+g(h,n)),t++);p&&(c(""),t++);return j()};exports.glp_read_lp_from_string=function(a,b,c){var d=0;return Ok(a,b,function(){return d<c.length?c[d++]:-1})};var qk=1,sk=2,Gk=3,Hk=4,Ik=5;
function yk(a,b,c){var d=a.Jb,e=a.Pe,f=a.Re,g=a.Qe,j=a.ea.rb,h=a.ea.sb,l,m,n;a.valid||y("fhv_h_solve: the factorization is not valid");if(b)for(b=d;1<=b;b--){if(a=e[b],n=c[a],0!=n){l=f[b];for(m=l+g[b]-1;l<=m;l++)c[j[l]]-=h[l]*n}}else for(b=1;b<=d;b++){a=e[b];n=c[a];l=f[b];for(m=l+g[b]-1;l<=m;l++)n-=h[l]*c[j[l]];c[a]=n}}
function Fk(a,b,c,d,e,f){var g=a.f,j=a.ea,h=j.Ec,l=j.Dc,m=j.jd,n=j.qf,p=j.Cc,t=j.Bc,r=j.Pc,w=j.eb,E=j.qb,q=j.gf,z=j.fe,C=j.rb,H=j.sb,O=j.re,J=j.Gb,L=a.Pe,u=a.Re,F=a.Qe,x=a.de,P=a.ce,I=a.jg,X=a.kg,A=a.ec,M,N;a.valid||y("fhv_update_it: the factorization is not valid");1<=b&&b<=g||y("fhv_update_it: j = "+b+"; column number out of range");if(a.Jb==a.Vd)return a.valid=0,a=Hk;for(M=1;M<=g;M++)X[M]=0;for(N=1;N<=c;N++)M=d[e+N],1<=M&&M<=g||y("fhv_update_it: ind["+N+"] = "+M+"; row number out of range"),0!=
X[M]&&y("fhv_update_it: ind["+N+"] = "+M+"; duplicate row index not allowed"),0==f[N]&&y("fhv_update_it: val["+N+"] = "+f[N]+"; zero element not allowed"),X[M]=f[N];a.ea.eb=x;a.ea.qb=P;xk(a.ea,0,X);a.ea.eb=w;a.ea.qb=E;yk(a,0,X);c=0;for(M=1;M<=g;M++)e=X[M],0==e||Math.abs(e)<J||(c++,I[c]=M,X[c]=e);P=p[b];for(x=P+t[b]-1;P<=x;P++){M=C[P];f=h[M];for(N=f+l[M]-1;C[f]!=b;f++);C[f]=C[N];H[f]=H[N];l[M]--}j.Kb-=t[b];t[b]=0;e=q[b];d=0;for(N=1;N<=c;N++){M=I[N];if(l[M]+1>m[M]&&Pk(j,M,l[M]+10))return a.valid=0,
j.Ra=j.Ca+j.Ca,a=Ik;f=h[M]+l[M];C[f]=b;H[f]=X[N];l[M]++;d<E[M]&&(d=E[M])}if(r[b]<c&&Qk(j,b,c))return a.valid=0,j.Ra=j.Ca+j.Ca,a=Ik;P=p[b];Ca(C,P,I,1,c);Ca(H,P,X,1,c);t[b]=c;j.Kb+=c;if(e>d)return a.valid=0,a=qk;M=w[e];b=z[e];for(N=e;N<d;N++)w[N]=w[N+1],E[w[N]]=N,z[N]=z[N+1],q[z[N]]=N;w[d]=M;E[M]=d;z[d]=b;q[b]=d;for(b=1;b<=g;b++)O[b]=0;f=h[M];for(N=f+l[M]-1;f<=N;f++){b=C[f];O[b]=H[f];P=p[b];for(x=P+t[b]-1;C[P]!=M;P++);C[P]=C[x];H[P]=H[x];t[b]--}j.Kb-=l[M];l[M]=0;a.Jb++;L[a.Jb]=M;F[a.Jb]=0;if(j.Ia-j.Ba<
d-e&&(Rk(j),j.Ia-j.Ba<d-e))return a.valid=j.valid=0,j.Ra=j.Ca+j.Ca,a=Ik;for(N=e;N<d;N++)if(b=w[N],c=z[N],0!=O[c]){E=O[c]/n[b];q=h[b];for(c=q+l[b]-1;q<=c;q++)O[C[q]]-=E*H[q];j.Ia--;C[j.Ia]=b;H[j.Ia]=E;F[a.Jb]++}0==F[a.Jb]?a.Jb--:(u[a.Jb]=j.Ia,a.Sf+=F[a.Jb]);n[M]=O[z[d]];c=0;for(N=d+1;N<=g;N++)if(b=z[N],e=O[b],!(Math.abs(e)<J)){if(t[b]+1>r[b]&&Qk(j,b,t[b]+10))return a.valid=0,j.Ra=j.Ca+j.Ca,a=Ik;P=p[b]+t[b];C[P]=M;H[P]=e;t[b]++;c++;I[c]=b;X[c]=e}if(m[M]<c&&Pk(j,M,c))return a.valid=0,j.Ra=j.Ca+j.Ca,
a=Ik;f=h[M];Ca(C,f,I,1,c);Ca(H,f,X,1,c);l[M]=c;j.Kb+=c;e=0;M=w[d];f=h[M];for(N=f+l[M]-1;f<=N;f++)e<Math.abs(H[f])&&(e=Math.abs(H[f]));b=z[d];P=p[b];for(x=P+t[b]-1;P<=x;P++)e<Math.abs(H[P])&&(e=Math.abs(H[P]));return Math.abs(n[M])<A*e?(a.valid=0,a=Gk):0}
function Fg(a){function b(a,b,c){var d=ye(a);ze(a);var e,f,g,h=0;if(0<b){e=+b;g=Ue(a,e,c,s);for(b=1;b<=g;b++)Sk(a,c[b],function(a){a!=qi&&(c[++h]=d+c[b])});Tk(a,e,function(a){a!=qi&&(c[++h]=e)})}else f=-b,g=function(b){b!=qi&&(f<=d?c[++h]=f:h=Rd(a,f-d,c,s))},f<=d?Tk(a,f,g):Sk(a,f-d,g);return h}if(0==a.f||0==a.h)Ff(a);else{var c=ye(a),d=ze(a),e,f,g,j,h,l,m,n=Array(1+c+d);B("Constructing initial basis...");if(0==c||0==d)Ff(a);else{f=Array(1+c);g=Array(1+c+d);h=c+d;var p,t,r,w,E,q,z,C,H,O,J,L=0;0<c&&
0<h||y("triang: m = "+c+"; n = "+h+"; invalid dimension");l=Array(1+(c>=h?c:h));m=Array(1+c);e=Array(1+h);p=Array(1+c);t=Array(1+c);w=Array(1+h);E=Array(1+h);for(C=0;C<=c;C++)m[C]=0;for(z=1;z<=h;z++)C=b(a,-z,l),w[z]=m[C],m[C]=z;for(C=r=0;C<=c;C++)for(z=m[C];0!=z;z=w[z])E[z]=r,r=z;C=0;for(z=r;0!=z;z=E[z])w[z]=C,C=z;for(C=0;C<=h;C++)e[C]=0;for(q=1;q<=c;q++)m[q]=C=b(a,+q,l),p[q]=0,t[q]=e[C],0!=t[q]&&(p[t[q]]=q),e[C]=q;for(q=1;q<=c;q++)f[q]=0;for(z=1;z<=h;z++)g[z]=0;H=1;for(O=h;H<=O;){q=e[1];if(0!=q){z=
0;for(J=b(a,+q,l);1<=J;J--)C=l[J],0==g[C]&&(z=C);f[q]=g[z]=H;H++;L++}else z=r,g[z]=O,O--;0==w[z]?r=E[z]:E[w[z]]=E[z];0!=E[z]&&(w[E[z]]=w[z]);for(J=b(a,-z,l);1<=J;J--)q=l[J],C=m[q],0==p[q]?e[C]=t[q]:t[p[q]]=t[q],0!=t[q]&&(p[t[q]]=p[q]),m[q]=--C,p[q]=0,t[q]=e[C],0!=t[q]&&(p[t[q]]=q),e[C]=q}for(q=1;q<=c;q++)0==f[q]&&(f[q]=H++);for(z=1;z<=h;z++);for(p=1;p<=c;p++)m[p]=0;for(q=1;q<=c;q++)p=f[q],m[p]=q;for(C=1;C<=h;C++)e[C]=0;for(z=1;z<=h;z++)C=g[z],e[C]=z;for(p=1;p<=L;p++){q=m[p];for(J=b(a,+q,l);1<=J;J--)z=
l[J]}h=L;l=Uk;a.ee==s&&(a.ee={},m=a.ee,m.n=3,m.scale=1,m.H=0,m.Zg=1,m.mh=0.07,m.Ab=1E-7,m.ob=1E-7,m.pe=1E-9,m.round=0,m.Xe=-v,m.Ye=+v,m.kc=-1,m.nb=-1,m.Yb=200,m.Za=0,m.Cg=2,m.Dg=3,m.Ob=1E-5,m.oe=1E-7,m.Lg=1,m.Mg=2,m.Ng=0,m.Pg=1,m.Kg=0,m.Og=0,m.Jg=0,m.Yg=0,m.md=0,m.jh=0,m.Yd=0);m=a.ee;e=0;switch(l){case Uk:e=m.n;break;case Vk:e=m.scale;break;case Wk:e=m.H;break;case Xk:e=m.Zg;break;case Yk:e=m.round;break;case Zk:e=m.kc;break;case $k:e=a.V;break;case al:e=m.Yb;break;case bl:e=m.Cg;break;case cl:e=
m.Dg;break;case dl:e=m.Lg;break;case el:e=m.Mg;break;case fl:e=m.Ng;break;case gl:e=m.Pg;break;case hl:e=m.Kg;break;case il:e=m.Og;break;case jl:e=m.Jg;break;case kl:e=m.Yg;break;case ll:e=m.md;break;case ml:e=m.jh;break;case nl:l={};Pd(a,l);switch(l.type){case fj:e=1;break;case kj:e=2;break;case lj:e=3}break;default:y("lpx_get_int_parm: parm = "+l+"; invalid parameter")}3<=e&&B("Size of triangular part = "+h+"");l=Array(1+c);m=Array(1+c+d);for(e=1;e<=c;e++)l[f[e]]=e;for(f=1;f<=c+d;f++)m[g[f]]=f;
for(j=1;j<=c+d;j++)n[j]=-1;for(g=1;g<=h;g++)f=m[g],n[f]=ol;for(g=h+1;g<=c;g++)e=l[g],n[e]=ol;for(j=1;j<=c+d;j++)n[j]!=ol&&(g=function(a,b,c){switch(a){case ki:n[j]=pl;break;case oi:n[j]=ql;break;case li:n[j]=rl;break;case mi:n[j]=Math.abs(b)<=Math.abs(c)?ql:rl;break;case qi:n[j]=sl}},j<=c?Tk(a,j,g):Sk(a,j-c,g));for(j=1;j<=c+d;j++)j<=c?tf(a,j,n[j]-ol+D):uf(a,j-c,n[j]-ol+D)}}}
function wh(a,b){var c,d;if(0==a.Qc){c=a.ae;d=a.ua;a.ae=0==c?20:c+c;a.ua=Array(1+a.ae);Ea(a.ua,0,1+a.ae);d!=s&&Ca(a.ua,1,d,1,c);for(d=a.ae;d>c;d--)a.ua[d].mb=s,a.ua[d].next=a.Qc,a.Qc=d}d=a.Qc;a.Qc=a.ua[d].next;a.ua[d].next=0;c=d;d={};a.ua[c].mb=d;d.r=c;d.ga=b;d.Ha=b==s?0:b.Ha+1;d.count=0;d.Ja=s;d.xc=s;d.ac=s;d.Wf=0;d.nc=b==s?a.z.dir==Gb?-v:+v:b.nc;d.bound=b==s?a.z.dir==Gb?-v:+v:b.bound;d.Rc=0;d.ig=0;d.pg=0;d.Wc=0;d.Ld=0;d.data=0==a.o.Ce?s:{};d.fa=s;d.aa=a.Sa;d.next=s;a.head==s?a.head=d:a.Sa.next=
d;a.Sa=d;a.Jd++;a.Qf++;a.xg++;b!=s&&b.count++;return d}
function Li(a){var b=a.z,c=b.f,d=b.h,e=a.L,f,g,j;if(e.ga==s){a.wg=c;a.le=Array(1+c+d);a.je=Array(1+c+d);a.me=Array(1+c+d);a.ke=Array(1+c+d);for(f=1;f<=c+d;f++)j=f<=c?b.k[f]:b.e[f-c],a.le[f]=j.type,a.je[f]=j.c,a.me[f]=j.d,a.ke[f]=j.l}else{var h=a.wg,l=a.tg;for(f=1;f<=l+d;f++){var m,n,p,t,r,w;m=a.ef[f];p=a.cf[f];t=a.ff[f];g=a.df[f];j=f<=l?b.k[f]:b.e[f-l];n=j.type;r=j.c;w=j.d;j=j.l;m==n&&p==r&&t==w||(m={},m.lc=f,m.type=n,m.c=r,m.d=w,m.next=e.Ja,e.Ja=m);g!=j&&(g={},g.lc=f,g.l=j,g.next=e.xc,e.xc=g)}if(l<
c){n=Array(1+d);r=Array(1+d);for(g=c;g>l;g--){j=b.k[g];w={};f=Ae(b,g);w.name=f==s?s:f;w.type=j.type;w.c=j.c;w.d=j.d;w.j=s;m=Ue(b,g,n,r);for(f=1;f<=m;f++)p={},p.A=n[f],p.i=r[f],p.next=w.j,w.j=p;w.ka=j.ka;w.l=j.l;w.next=e.ac;e.ac=w}}if(c!=h){c-=h;e=Array(1+c);for(g=1;g<=c;g++)e[g]=h+g;Cd(b,c,e)}c=b.f;for(g=1;g<=c;g++)pd(b,g,a.le[g],a.je[g],a.me[g]),tf(b,g,a.ke[g]);for(h=1;h<=d;h++)qd(b,h,a.le[c+h],a.je[c+h],a.me[c+h]),uf(b,h,a.ke[c+h])}a.L=s}
function Ni(a,b){var c;c=a.ua[b].mb;c.aa==s?a.head=c.next:c.aa.next=c.next;c.next==s?a.Sa=c.aa:c.next.aa=c.aa;c.aa=c.next=s;for(a.Jd--;;){for(var d;c.Ja!=s;)d=c.Ja,c.Ja=d.next;for(;c.xc!=s;)d=c.xc,c.xc=d.next;for(;c.ac!=s;){d=c.ac;for(d.name=s;d.j!=s;)d.j=d.j.next;c.ac=d.next}b=c.r;a.ua[b].mb=s;a.ua[b].next=a.Qc;a.Qc=b;c=c.ga;a.Qf--;if(c!=s&&(c.count--,0==c.count))continue;break}}
function ai(a,b){var c=a.z,d=c.h,e,f,g,j=a.qg,h;g=0;h=c.da;e=0;for(f=1;f<=d;f++){var l=c.e[f];if(0!=l.t)if(l.type==G)h+=l.t*l.q;else{if(l.Aa!=ph||l.t!=Math.floor(l.t))return b;Math.abs(l.t)<=pa?j[++g]=Math.abs(l.t)|0:e=1}}if(0==e){if(0==g)return b;d=0;for(e=1;e<=g;e++){if(1==e)d=j[1];else{f=j[e];for(l=k;0<f;)l=d%f,d=f,f=l}if(1==d)break}e=d}c.dir==Gb?b!=+v&&(c=(b-h)/e,c>=Math.floor(c)+0.0010&&(c=Math.ceil(c),b=e*c+h)):c.dir==ec&&b!=-v&&(c=(b-h)/e,c<=Math.ceil(c)-0.0010&&(c=Math.floor(c),b=e*c+h));
return b}function Ch(a,b){var c=a.z,d=1,e;if(c.va==Bg)switch(e=a.o.oe*(1+Math.abs(c.qa)),c.dir){case Gb:b>=c.qa-e&&(d=0);break;case ec:b<=c.qa+e&&(d=0)}else switch(c.dir){case Gb:b==+v&&(d=0);break;case ec:b==-v&&(d=0)}return d}function Ah(a){var b=s;switch(a.z.dir){case Gb:for(a=a.head;a!=s;a=a.next)if(b==s||b.bound>a.bound)b=a;break;case ec:for(a=a.head;a!=s;a=a.next)if(b==s||b.bound<a.bound)b=a}return b==s?0:b.r}
function Bh(a){var b=a.z,c;b.va==Bg?(b=b.qa,c=Ah(a),0==c?a=0:(a=a.ua[c].mb.bound,a=Math.abs(b-a)/(Math.abs(b)+ra))):a=v;return a}function yi(a){for(;a.head!=s;){var b=a.head;for(a.head=b.next;b.j!=s;)b.j=b.j.next}a.size=0;a.head=a.Sa=s;a.Tg=0;a.L=s}
function Wh(a,b){var c=a.z,d=c.f,e=c.h,f,g,j,h=0,l,m,n,p;l=Array(1+d);m=Array(1+d);switch(c.va){case Vb:l[0]=-v;m[0]=+v;break;case Bg:switch(c.dir){case Gb:l[0]=-v;m[0]=c.qa-c.da;break;case ec:l[0]=c.qa-c.da,m[0]=+v}}for(f=1;f<=d;f++)l[f]=De(c,f),m[f]=Qe(c,f);n=Array(1+e);p=Array(1+e);for(f=1;f<=e;f++)n[f]=Se(c,f),p[f]=Te(c,f);g=d+1;j=Array(1+g);for(f=1;f<=g;f++)j[f]=f-1;a:{var t=c.f;f=c.h;var r={},w,E,q=0,z,C,H,O,J,L,u,F;z=Array(1+f);C=Array(1+t+1);H=Array(1+t+1);Da(H,0,0,t+1);O=Array(1+t+1);Da(O,
0,0,t+1);J=Array(1+f);L=Array(1+f);u=Array(1+f);E=0;for(w=1;w<=g;w++)t=j[w],C[++E]=t,H[t]=1;for(;0<E;)if(t=C[E--],H[t]=0,O[t]++,!(l[t]==-v&&m[t]==+v)){g=0;if(0==t)for(j=1;j<=f;j++)F=c.e[j],0!=F.t&&(g++,z[g]=j,J[g]=F.t);else for(j=c.k[t].j;j!=s;j=j.w)g++,z[g]=j.e.A,J[g]=j.i;for(w=1;w<=g;w++)j=z[w],L[w]=n[j],u[w]=p[j];w=g;j=J;F=L;for(var x=u,P=r,I=k,X=k,A=X=k,A=k,X=A=0,I=1;I<=w;I++)if(0<j[I])if(F[I]==-v)if(0==X)X=I;else{A=-v;X=0;break}else A+=j[I]*F[I];else if(0>j[I])if(x[I]==+v)if(0==X)X=I;else{A=
-v;X=0;break}else A+=j[I]*x[I];P.Qd=A;P.Lf=X;X=A=0;for(I=1;I<=w;I++)if(0<j[I])if(x[I]==+v)if(0==X)X=I;else{A=+v;X=0;break}else A+=j[I]*x[I];else if(0>j[I])if(F[I]==-v)if(0==X)X=I;else{A=+v;X=0;break}else A+=j[I]*F[I];P.Pd=A;P.Kf=X;b:{w=m;j=t;X=k;F=0;x=l[t];P=w[j];A=I=s;X=0==r.Kf?r.Pd:+v;I=0==r.Lf?r.Qd:-v;A=X;if(x!=-v&&(X=0.0010*(1+Math.abs(x)),A<x-X)){w=F=1;break b}if(P!=+v&&(X=0.0010*(1+Math.abs(P)),I>P+X)){w=F=1;break b}x!=-v&&(X=1E-12*(1+Math.abs(x)),I>x-X&&(l[t]=-v));P!=+v&&(X=1E-12*(1+Math.abs(P)),
A<P+X&&(w[j]=+v));w=F}if(w){q=1;break}if(!(l[t]==-v&&m[t]==+v))for(w=1;w<=g;w++){I=P=s;j=z[w];F=c.e[j];x=F.Aa!=Fc;b:{var M=l[t],N=m[t],za=k,X=0,ua=A=k,va=s,ka=s,A=L[w],ua=u[w],fc=za=ka=va=k;M==-v||r.Pd==+v?va=-v:0==r.Kf?0<J[w]?va=M-(r.Pd-J[w]*u[w]):0>J[w]&&(va=M-(r.Pd-J[w]*L[w])):va=r.Kf==w?M-r.Pd:-v;N==+v||r.Qd==-v?ka=+v:0==r.Lf?0<J[w]?ka=N-(r.Qd-J[w]*L[w]):0>J[w]&&(ka=N-(r.Qd-J[w]*u[w])):ka=r.Lf==w?N-r.Qd:+v;1E-6>Math.abs(J[w])?(za=-v,fc=+v):0<J[w]?(za=va==-v?-v:va/J[w],fc=ka==+v?+v:ka/J[w]):0>
J[w]&&(za=ka==+v?-v:ka/J[w],fc=va==-v?+v:va/J[w]);M=fc;va=za;ka=M;x&&(va!=-v&&(va=0.0010>va-Math.floor(va)?Math.floor(va):Math.ceil(va)),ka!=+v&&(ka=0.0010>Math.ceil(ka)-ka?Math.ceil(ka):Math.floor(ka)));if(A!=-v&&(za=0.0010*(1+Math.abs(A)),ka<A-za)){X=1;break b}if(ua!=+v&&(za=0.0010*(1+Math.abs(ua)),va>ua+za)){X=1;break b}va!=-v&&(za=0.0010*(1+Math.abs(va)),A<va-za&&(A=va));ka!=+v&&(za=0.0010*(1+Math.abs(ka)),ua>ka+za&&(ua=ka));A==-v||ua==+v||(P=Math.abs(A),I=Math.abs(ua),za=1E-10*(1+(P<=I?P:I)),
A>ua-za&&(A==L[w]?ua=A:ua==u[w]?A=ua:P<=I?ua=A:A=ua));I=ua;P=A}if(X){f=q=1;break a}X=n[j];A=p[j];ua=k;M=0;X<P&&(x||X==-v?M++:(ua=A==+v?1+Math.abs(X):1+(A-X),P-X>=0.25*ua&&M++));A>I&&(x||A==+v?M++:(ua=X==-v?1+Math.abs(A):1+(A-X),A-I>=0.25*ua&&M++));x=M;n[j]=P;p[j]=I;if(0<x)for(j=F.j;j!=s;j=j.G)F=j.k.ca,!(O[F]>=b)&&(!(l[F]==-v&&m[F]==+v)&&0==H[F])&&(C[++E]=F,H[F]=1)}}f=q}if(f)return 1;for(f=1;f<=d;f++)jh(c,f)==D&&(l[f]==-v&&m[f]==+v?pd(c,f,yc,0,0):m[f]==+v?pd(c,f,Zc,l[f],0):l[f]==-v&&pd(c,f,$c,0,m[f]));
for(f=1;f<=e;f++)qd(c,f,n[f]==-v&&p[f]==+v?yc:p[f]==+v?Zc:n[f]==-v?$c:n[f]!=p[f]?R:G,n[f],p[f]);return h}function Ph(a){var b;b={};b.h=a;b.J=0;b.Ea=Array(1+a);Da(b.Ea,1,0,a);b.X=Array(1+a);b.i=Array(1+a);return b}function tl(a,b,c){var d=a.Ea[b];0==c?0!=d&&(a.Ea[b]=0,d<a.J&&(a.Ea[a.X[a.J]]=d,a.X[d]=a.X[a.J],a.i[d]=a.i[a.J]),a.J--):(0==d&&(d=++a.J,a.Ea[b]=d,a.X[d]=b),a.i[d]=c)}function ul(a){for(var b=1;b<=a.J;b++)a.Ea[a.X[b]]=0;a.J=0}
function vl(a,b){for(var c=0,d=1;d<=a.J;d++)0==Math.abs(a.i[d])||Math.abs(a.i[d])<b?a.Ea[a.X[d]]=0:(c++,a.Ea[a.X[d]]=c,a.X[c]=a.X[d],a.i[c]=a.i[d]);a.J=c}function wl(a,b){ul(a);a.J=b.J;Ca(a.X,1,b.X,1,a.J);Ca(a.i,1,b.i,1,a.J);for(var c=1;c<=a.J;c++)a.Ea[a.X[c]]=c}
function ei(a){function b(a){return a-Math.floor(a)}var c=a.z,d=c.f,e=c.h,f,g,j,h,l;f=Array(1+e);j=Array(1+e);h=Array(1+e);l=Array(1+d+e);d=0;for(g=1;g<=e;g++){var m=c.e[g];m.Aa==ph&&(m.type!=G&&m.l==D)&&(m=b(m.q),0.05<=m&&0.95>=m&&(d++,f[d].A=g,f[d].Hb=m))}Ma(f,d,function(a,b){return a.Hb>b.Hb?-1:a.Hb<b.Hb?1:0});e=wj(a);for(c=1;c<=d&&!(50<=wj(a)-e);c++)a:{g=a;for(var n=f[c].A,m=g.z,p=m.f,t=m.h,r=j,w=h,E=l,q=k,z=q=k,C=k,H=k,O=k,J=k,L=k,u=k,F=k,x=k,P=k,H=H=k,z=Hi(m,p+n,r,w),u=m.e[n].q,q=1;q<=p+t;q++)E[q]=
0;P=b(u);for(n=1;n<=z;n++){q=r[n];q<=p?(H=m.k[q],C=Fc):(H=m.e[q-p],C=H.Aa);O=H.c;J=H.d;H=H.l;F=w[n];if(1E5<Math.abs(F))break a;if(!(1E-10>Math.abs(F))){switch(H){case Yc:break a;case K:L=-F;break;case od:L=+F;break;case Gc:continue}switch(C){case ph:if(1E-10>Math.abs(L-Math.floor(L+0.5)))continue;else x=b(L)<=b(u)?b(L):b(u)/(1-b(u))*(1-b(L));break;case Fc:x=0<=L?+L:b(u)/(1-b(u))*-L}switch(H){case K:E[q]=+x;P+=x*O;break;case od:E[q]=-x,P-=x*J}}}for(q=1;q<=p;q++)if(!(1E-10>Math.abs(E[q]))){H=m.k[q];
for(n=H.j;n!=s;n=n.w)E[p+n.e.A]+=E[q]*n.i}z=0;for(n=1;n<=t;n++)1E-10>Math.abs(E[p+n])||(H=m.e[n],H.type==G?P-=E[p+n]*H.c:(z++,r[z]=n,w[z]=E[p+n]));1E-12>Math.abs(P)&&(P=0);for(q=1;q<=z;q++)if(0.0010>Math.abs(w[q])||1E3<Math.abs(w[q]))break a;vi(g,Dh,z,r,w,Zc,P)}}var Nh=0,Oh=5;
function ji(a,b){function c(a,b,c,f,g,h,j){function l(a,b,c,f,g,h,j){var m;m=c;for(c=1;c<=a;c++)j[c]=b[c]/h,g[c]&&(j[c]=-j[c]),m-=b[c]*f[c];b=m/h;var n;if(0.01>Math.abs(b-Math.floor(b+0.5)))b=1;else{m=b-Math.floor(b);for(c=1;c<=a;c++)n=j[c]-Math.floor(j[c])-m,j[c]=0>=n?Math.floor(j[c]):Math.floor(j[c])+n/(1-m);d=Math.floor(b);e=1/(1-m);b=0}if(b)return 1;for(c=1;c<=a;c++)g[c]&&(j[c]=-j[c],d+=j[c]*f[c]);e/=h;return 0}var m,n,p,q,r;p=Array(4);var t,w,z,E;z=Array(1+a);E=Array(1+a);for(n=1;n<=a;n++)z[n]=
g[n]>=0.5*f[n];w=r=0;for(n=1;n<=a;n++)if(m=1E-9*(1+Math.abs(f[n])),!(g[n]<m||g[n]>f[n]-m))if(m=l(a,b,c,f,z,Math.abs(b[n]),j),!m){t=-d-e*h;for(m=1;m<=a;m++)t+=j[m]*g[m];w<t&&(w=t,r=Math.abs(b[n]))}0.0010>w&&(w=0);if(0==w)return w;p[1]=r/2;p[2]=r/4;p[3]=r/8;for(n=1;3>=n;n++)if(m=l(a,b,c,f,z,p[n],j),!m){t=-d-e*h;for(m=1;m<=a;m++)t+=j[m]*g[m];w<t&&(w=t,r=p[n])}p=0;for(n=1;n<=a;n++)m=1E-9*(1+Math.abs(f[n])),g[n]<m||g[n]>f[n]-m||(p++,E[p].A=n,E[p].nf=Math.abs(g[n]-0.5*f[n]));Ma(E,p,function(a,b){return a.nf<
b.nf?-1:a.nf>b.nf?1:0});for(q=1;q<=p;q++)if(n=E[q].A,z[n]=!z[n],m=l(a,b,c,f,z,r,j),z[n]=!z[n],!m){t=-d-e*h;for(m=1;m<=a;m++)t+=j[m]*g[m];w<t&&(w=t,z[n]=!z[n])}m=l(a,b,c,f,z,r,j);return w}var d,e,f=b.f,g=b.h,j,h,l;j=a.z;l=b.f;h=b.h;var m;for(m=1;m<=l;m++)b.x[m]=j.k[m].q;for(m=l+1;m<=l+h;m++)b.x[m]=j.e[m-l].q;Da(b.fb,1,"?",f+g);for(j=1;j<=f;j++)if(!b.yb[j]){l=b;h=j;m=a.z;var n=l.f,p=k;l.yb[h]=2;l.ze=1;l.uf[1]=h;ul(l.Ta);tl(l.Ta,h,1);for(p=m.k[h].j;p!=s;p=p.w)tl(l.Ta,n+p.e.A,-p.i);for(l.tf=0;;){l=b;
m=h=k;for(h=1;h<=l.Ta.J;h++)m=l.Ta.X[h],0==l.Sb[m]&&(0==l.ub[m]&&l.c[m]==l.d[m])&&(l.tf-=l.Ta.i[h]*l.c[m],l.Ta.i[h]=0);vl(l.Ta,ra);if(Nh)for(h=1;h<=f+g;h++);l=b;p=n=p=m=h=k;for(h=1;h<=l.Ta.J;h++)m=l.Ta.X[h],l.Wa[m]||(p=l.Sb[m],n=0==p?l.c[m]==-v?v:l.x[m]-l.c[m]:l.x[m]-l.c[m]*l.x[p],p=l.ub[m],p=0==p?l.ub[m]==+v?v:l.d[m]-l.x[m]:l.d[m]*l.x[p]-l.x[m],l.fb[m]=n<=p?"L":"U");l=b;p=n=m=h=k;wl(l.ma,l.Ta);l.pc=l.tf;for(h=l.ma.J;1<=h;h--)n=l.ma.X[h],l.Wa[n]||("L"==l.fb[n]?(p=l.Sb[n],0==p?l.pc-=l.ma.i[h]*l.c[n]:
(m=l.ma.Ea[p],0==m&&(tl(l.ma,p,1),m=l.ma.Ea[p],l.ma.i[m]=0),l.ma.i[m]+=l.ma.i[h]*l.c[n])):"U"==l.fb[n]&&(p=l.ub[n],0==p?l.pc-=l.ma.i[h]*l.d[n]:(m=l.ma.Ea[p],0==m&&(tl(l.ma,p,1),m=l.ma.Ea[p],l.ma.i[m]=0),l.ma.i[m]+=l.ma.i[h]*l.d[n]),l.ma.i[h]=-l.ma.i[h]));for(h=1;h<=l.ma.J;h++)n=l.ma.X[h],l.Wa[n]&&(Math.abs(l.c[n])<=Math.abs(l.d[n])?(l.fb[n]="L",l.pc-=l.ma.i[h]*l.c[n]):(l.fb[n]="U",l.pc-=l.ma.i[h]*l.d[n],l.ma.i[h]=-l.ma.i[h]));l=b;h=l.f;m=l.h;var t=n=k,r=k,w=p=k,E=k,q=r=k,w=0;wl(l.D,l.ma);l.Fb=l.pc;
vl(l.D,ra);for(n=1;n<=l.D.J;n++)t=l.D.X[n],!l.Wa[t]&&0<l.D.i[n]&&(l.D.i[n]=0);vl(l.D,0);p=0;for(n=1;n<=l.D.J;n++)t=l.D.X[n],l.Wa[t]&&(p++,r=l.D.X[p],l.D.Ea[t]=p,l.D.Ea[r]=n,l.D.X[p]=t,l.D.X[n]=r,t=l.D.i[p],l.D.i[p]=l.D.i[n],l.D.i[n]=t);if(0!=p){E=Array(1+p);r=Array(1+p);q=Array(1+p);for(n=1;n<=p;n++)t=l.D.X[n],E[n]=l.d[t]-l.c[t],"L"==l.fb[t]?r[n]=l.x[t]-l.c[t]:"U"==l.fb[t]&&(r[n]=l.d[t]-l.x[t]),0>r[n]&&(r[n]=0);w=0;for(n=p+1;n<=l.D.J;n++)t=l.D.X[n],"L"==l.fb[t]?(r=l.Sb[t],r=0==r?l.x[t]-l.c[t]:l.x[t]-
l.c[t]*l.x[r]):"U"==l.fb[t]&&(r=l.ub[t],r=0==r?l.d[t]-l.x[t]:l.d[t]*l.x[r]-l.x[t]),0>r&&(r=0),w-=l.D.i[n]*r;w=c(p,l.D.i,l.Fb,E,r,w,q);if(0!=w){for(n=1;n<=p;n++)l.D.i[n]=q[n];for(n=p+1;n<=l.D.J;n++)t=l.D.X[n],t<=h+m&&(l.D.i[n]*=0);l.Fb=s}}l=w;if(0<l){h=b;t=p=n=m=k;for(m=1;m<=h.D.J;m++)p=h.D.X[m],h.Wa[p]&&("L"==h.fb[p]?h.Fb+=h.D.i[m]*h.c[p]:"U"==h.fb[p]&&(h.Fb-=h.D.i[m]*h.d[p],h.D.i[m]=-h.D.i[m]));for(m=1;m<=h.D.J;m++)p=h.D.X[m],h.Wa[p]||("L"==h.fb[p]?(t=h.Sb[p],0==t?h.Fb+=h.D.i[m]*h.c[p]:(n=h.D.Ea[t],
0==n&&(tl(h.D,t,1),n=h.D.Ea[t],h.D.i[n]=0),h.D.i[n]-=h.D.i[m]*h.c[p])):"U"==h.fb[p]&&(t=h.ub[p],0==t?h.Fb-=h.D.i[m]*h.d[p]:(n=h.D.Ea[t],0==n&&(tl(h.D,t,1),n=h.D.Ea[t],h.D.i[n]=0),h.D.i[n]+=h.D.i[m]*h.d[p]),h.D.i[m]=-h.D.i[m]));h=b;m=a.z;n=h.f;r=q=t=p=t=k;for(p=h.D.J;1<=p;p--)if(t=h.D.X[p],!(t>n)){for(t=m.k[t].j;t!=s;t=t.w)q=n+t.e.A,r=h.D.Ea[q],0==r&&(tl(h.D,q,1),r=h.D.Ea[q],h.D.i[r]=0),h.D.i[r]+=h.D.i[p]*t.i;h.D.i[p]=0}vl(h.D,0);h=a;m=b;n=m.f;w=m.h;q=t=p=k;r=Array(1+w);w=Array(1+w);q=0;for(p=m.D.J;1<=
p;p--)t=m.D.X[p],q++,r[q]=t-n,w[q]=m.D.i[p];vi(h,Eh,q,r,w,$c,m.Fb)}for(m=1;m<=b.ma.J;m++)h=b.ma.X[m],b.fb[h]="?";if(l=0==l)if(l=b.ze<Oh){l=b;var n=a.z,p=l.f,t=l.h,z=r=q=w=r=q=k;m=h=0;E=z=E=k;w=0;for(q=1;q<=l.Ta.J;q++)r=l.Ta.X[q],!(r<=p)&&(!l.Wa[r]&&!(0.0010>Math.abs(l.Ta.i[q])))&&(z=l.Sb[r],E=0==z?l.c[r]==-v?v:l.x[r]-l.c[r]:l.x[r]-l.c[r]*l.x[z],z=l.ub[r],z=0==z?l.ub[r]==+v?v:l.d[r]-l.x[r]:l.d[r]*l.x[z]-l.x[r],E=E<=z?E:z,!(0.0010>E)&&w<E&&(w=E,h=r));if(0==h)m=1;else{for(w=1;w<=p;w++)if(!l.yb[w]){for(q=
n.k[w].j;q!=s&&q.e.A!=h-p;q=q.w);if(q!=s&&0.0010<=Math.abs(q.i))break}if(w>p)m=2;else{l.ze++;l.uf[l.ze]=w;l.yb[w]=2;r=Ph(p+t);tl(r,w,1);for(q=n.k[w].j;q!=s;q=q.w)tl(r,p+q.e.A,-q.i);q=l.Ta.Ea[h];n=l.Ta;p=-l.Ta.i[q]/r.i[r.Ea[h]];t=r;E=w=q=k;for(r=1;r<=t.J;r++)q=t.X[r],w=k,w=n.Ea[q],w=0==w?0:n.i[w],E=t.i[r],tl(n,q,w+p*E);tl(l.Ta,h,0)}}l=m;l=0==l}if(!l)break}for(h=1;h<=b.ze;h++)l=b.uf[h],b.yb[l]=0}}
function xl(a,b,c){var d;0<b?b=a.of[b]:(b=a.of[-b],b+=a.wb);0<c?c=a.of[c]:(c=a.of[-c],c+=a.wb);b<c&&(d=b,b=c,c=d);d=(b-1)*(b-2)/2+(c-1);a.Tb[d/sa]|=1<<sa-1-d%sa;a.sg++}
function Qh(a){a=a.z;var b=function(a,b){var c;switch(Ce(a,b)-yc+ki){case ki:case li:c=-v;break;case oi:case mi:case qi:c=pi(a,b)}return c},c=function(a,b){var c;switch(Ce(a,b)-yc+ki){case ki:case oi:c=+v;break;case li:case mi:case qi:c=ni(a,b)}return c},d=function(a,b){var c;switch(Re(a,b)-yc+ki){case ki:case li:c=-v;break;case oi:case mi:case qi:c=ri(a,b)}return c},e=function(a,b){var c;switch(Re(a,b)-yc+ki){case ki:case oi:c=+v;break;case li:case mi:case qi:c=ui(a,b)}return c},f=function(a,b){return(sh(a,
b)==Fc?si:ti)==ti&&Re(a,b)-yc+ki==mi&&0==ri(a,b)&&1==ui(a,b)},g=function(a,b,c,f){var g,h,j;j=0;for(h=1;h<=b;h++)if(g=c[h],0<f[h]){g=d(a,g);if(g==-v){j=-v;break}j+=f[h]*g}else if(0>f[h]){g=e(a,g);if(g==+v){j=-v;break}j+=f[h]*g}return j},j=function(a,b,c,f){var g,h,j;j=0;for(h=1;h<=b;h++)if(g=c[h],0<f[h]){g=e(a,g);if(g==+v){j=+v;break}j+=f[h]*g}else if(0>f[h]){g=d(a,g);if(g==-v){j=+v;break}j+=f[h]*g}return j},h=function(a,b,c,d,e,f,g,h){b!=-v&&g&&(b-=a[f]);c!=+v&&g&&(c-=a[f]);d!=-v&&(0>a[f]&&(d-=a[f]),
0>a[h]&&(d-=a[h]));e!=+v&&(0<a[f]&&(e-=a[f]),0<a[h]&&(e-=a[h]));f=0<a[h]?b==-v||e==+v?-v:(b-e)/a[h]:c==+v||d==-v?-v:(c-d)/a[h];if(0.0010<f)return 2;f=0<a[h]?c==+v||d==-v?+v:(c-d)/a[h]:b==-v||e==+v?+v:(b-e)/a[h];return 0.999>f?1:0},l=s,m,n,p,t,r,w,E,q,z,C,H,O,J,L,u,F;B("Creating the conflict graph...");m=ye(a);n=ze(a);p=0;C=Array(1+n);for(r=1;r<=n;r++)C[r]=0;H=Array(1+n);z=Array(1+n);F=Array(1+n);for(t=1;t<=m;t++)if(O=b(a,t),J=c(a,t),!(O==-v&&J==+v)&&(q=Ue(a,t,z,F),!(500<q))){L=g(a,q,z,F);u=j(a,q,
z,F);for(w=1;w<=q;w++)if(f(a,z[w]))for(E=w+1;E<=q;E++)if(f(a,z[E])&&(h(F,O,J,L,u,w,0,E)||h(F,O,J,L,u,w,1,E)))r=z[w],0==C[r]&&(p++,C[r]=p,H[p]=r),r=z[E],0==C[r]&&(p++,C[r]=p,H[p]=r)}if(0==p||4E3<p)B("The conflict graph is either empty or too big");else{l={};l.h=n;l.wb=p;l.sg=0;l.of=C;l.be=H;q=p+p;q=(q*(q-1)/2+(sa-1))/sa;l.Tb=Array(q);Da(l.Tb,0,0,q);for(r=1;r<=p;r++)xl(l,+H[r],-H[r]);for(t=1;t<=m;t++)if(O=b(a,t),J=c(a,t),!(O==-v&&J==+v)&&(q=Ue(a,t,z,F),!(500<q))){L=g(a,q,z,F);u=j(a,q,z,F);for(w=1;w<=
q;w++)if(f(a,z[w]))for(E=w+1;E<=q;E++)if(f(a,z[E])){switch(h(F,O,J,L,u,w,0,E)){case 1:xl(l,-z[w],+z[E]);break;case 2:xl(l,-z[w],-z[E])}switch(h(F,O,J,L,u,w,1,E)){case 1:xl(l,+z[w],+z[E]);break;case 2:xl(l,+z[w],-z[E])}}}B("The conflict graph has 2*"+l.wb+" vertices and "+l.sg+" edges")}return l}
function wi(a,b){function c(a,b,e,f,g,h){var j,l,m,n,p,q,r,t;t=Array(a.h);if(0>=b){if(0==b&&(a.set[f++]=e[0],g+=h),g>a.bd){a.bd=g;a.Tf=f;for(j=0;j<f;j++)a.ah[j+1]=a.set[j]}}else for(j=b;0<=j&&!(0==f&&j<b);j--){m=e[j];if(0<f&&a.lg[m]<=a.bd-g)break;a.set[f]=m;n=g+a.Hc[m+1];h-=a.Hc[m+1];if(h<=a.bd-n)break;for(p=r=q=0;r<e+j;)l=e[r],r++,d(a,l,m)&&(t[q]=l,q++,p+=a.Hc[l+1]);p<=a.bd-n||c(a,q-1,t,f+1,n,p)}}function d(a,b,c){return b==c?0:b>c?a.Tb[(b*(b-1)/2+c)/sa]&1<<sa-1-(b*(b-1)/2+c)%sa:a.Tb[(c*(c-1)/2+
b)/sa]&1<<sa-1-(c*(c-1)/2+b)%sa}var e=ze(a.z),f,g;g=Array(1+e);var e=Array(1+e),j=a.z;f=ze(j);var h,l,m,n=0,p,t,r;p=Array(1+2*b.wb);t=Array(1+2*b.wb);r=Array(1+f);for(l=1;l<=b.wb;l++)h=b.be[l],h=nh(j,h),h=100*h+0.5|0,0>h&&(h=0),100<h&&(h=100),p[l]=h,p[b.wb+l]=100-h;h=b.Tb;l={};var w,E,q,z,C,H;l.h=2*b.wb;l.Hc=p;l.Tb=h;l.bd=0;l.Tf=0;l.ah=t;l.lg=Array(l.h);l.set=Array(l.h);z=Array(l.h);C=Array(l.h);h=Array(l.h);H=Ga();for(p=0;p<l.h;p++)for(w=C[p]=0;w<l.h;w++)d(l,p,w)&&(C[p]+=l.Hc[w+1]);for(p=0;p<l.h;p++)z[p]=
0;for(p=l.h-1;0<=p;p--){q=E=-1;for(w=0;w<l.h;w++)if(!z[w]&&(l.Hc[w+1]>E||l.Hc[w+1]==E&&C[w]>q))E=l.Hc[w+1],q=C[w],m=w;h[p]=m;z[m]=1;for(w=0;w<l.h;w++)!z[w]&&(w!=m&&d(l,m,w))&&(C[w]-=l.Hc[m+1])}for(p=m=0;p<l.h;p++)m+=l.Hc[h[p]+1],c(l,p,h,0,0,m),l.lg[h[p]]=l.bd,4.999<=La(H)&&(B("level = "+p+1+" ("+l.h+"); best = "+l.bd+""),H=Ga());for(p=1;p<=l.Tf;p++)t[p]++;m=l.Tf;p=0;for(l=1;l<=m;l++)h=t[l],h<=b.wb?(h=b.be[h],h=nh(j,h),p+=h):(h=b.be[h-b.wb],h=nh(j,h),p+=1-h);if(1.01<=p){for(h=1;h<=f;h++)r[h]=0;for(l=
j=1;l<=m;l++)h=t[l],h<=b.wb?(h=b.be[h],r[h]+=1):(h=b.be[h-b.wb],r[h]-=1,j-=1);for(h=1;h<=f;h++)0!=r[h]&&(n++,g[n]=h,e[n]=r[h]);g[0]=0;e[0]=j}f=n;0<f&&vi(a,Gh,f,g,e,$c,e[0])}function Fi(a,b){var c,d,e,f,g,j;d=0;g=v;for(c=1;c<=a.h;c++)a.Lc[c]&&(f=nh(a.z,c),j=Math.floor(f)+0.5,g>Math.abs(f-j)&&(d=c,g=Math.abs(f-j),e=f<j?Bi:Ci));b(e);return d}
function Ki(a,b){function c(a,b,c){var d,e={},f;hh(a);d=Wb();ge(d,a,0);qd(d,b,G,c,c);Hg(e);e.n=Ig;e.Xa=cg;e.kc=30;e.Za=1E3;e.Xa=cg;b=Pg(d,e);0==b||b==yl?Qg(d)==Gg?f=v:eh(d)==Bg?(a.dir==Gb?f=d.Y-a.Y:a.dir==ec&&(f=a.Y-d.Y),f<1E-6*(1+0.0010*Math.abs(a.Y))&&(f=0)):f=0:f=0;return f}function d(a,b,d){var e=a.zd,f;if(d==Bi){if(0==e.sd[b]){d=a.z.e[b].q;a=c(a.z,b,Math.floor(d));if(a==v)return f=v;e.sd[b]=1;e.Od[b]=a/(d-Math.floor(d))}f=e.Od[b]/e.sd[b]}else if(d==Ci){if(0==e.Cd[b]){d=a.z.e[b].q;a=c(a.z,b,Math.ceil(d));
if(a==v)return f=v;e.Cd[b]=1;e.qe[b]=a/(Math.ceil(d)-d)}f=e.qe[b]/e.Cd[b]}return f}var e=Ga(),f,g,j,h,l,m,n;if(a.zd==s){f=a.h;n={};n.sd=Array(1+f);n.Od=Array(1+f);n.Cd=Array(1+f);n.qe=Array(1+f);for(g=1;g<=f;g++)n.sd[g]=n.Cd[g]=0,n.Od[g]=n.qe[g]=0;a.zd=n}g=0;n=-1;for(f=1;f<=a.h;f++)if(xj(a,f)){h=a.z.e[f].q;l=d(a,f,Bi);if(l==v)return g=f,j=Bi,b(j),g;m=l*(h-Math.floor(h));l=d(a,f,Ci);if(l==v)return g=f,j=Ci,b(j),g;h=l*(Math.ceil(h)-h);l=m>h?m:h;n<l&&(n=l,g=f,j=m<=h?Bi:Ci);if(a.o.n>=Dd&&10<=La(e)){e=
a;m=e.zd;h=k;var p=l=0;for(h=1;h<=e.h;h++)xj(e,h)&&(l++,0<m.sd[h]&&0<m.Cd[h]&&p++);B("Pseudocosts initialized for "+p+" of "+l+" variables");e=Ga()}}if(0==n)return g=Fi(a,b);b(j);return g}
function di(a){var b=a.z,c=b.h,d=s,e=s,f=s,g,j={},h,l,m,n,p,t;for(l=0;;){var r=s;switch(l){case 0:hh(b);if(!(0==a.L.Ha&&1==a.L.Wf)){r=5;break}p=0;for(h=1;h<=c;h++)if(g=b.e[h],g.Aa!=Fc&&g.type!=G)if(g.type==R&&0==g.c&&1==g.d)p++;else{a.o.n>=fg&&B("FPUMP heuristic cannot be applied due to general integer variables");r=5;break}if(r!=s)break;if(0==p){r=5;break}a.o.n>=fg&&B("Applying FPUMP heuristic...");e=Array(1+p);Ea(e,1,p);l=0;for(h=1;h<=c;h++)g=b.e[h],g.Aa==ph&&g.type==R&&(e[++l].A=h);d=Wb();case 1:ge(d,
b,Id);if(b.va==Bg){zc(d,1);m=Array(1+c);n=Array(1+c);for(h=1;h<=c;h++)m[h]=h,n[h]=b.e[h].t;sd(d,d.f,c,m,n);m=0.1*b.Y+0.9*b.qa;b.dir==Gb?pd(d,d.f,$c,0,m-b.da):b.dir==ec&&pd(d,d.f,Zc,m-b.da,0)}n=0;for(l=1;l<=p;l++)e[l].x=-1;case 2:if(n++,a.o.n>=fg&&B("Pass "+n+""),t=v,m=0,1<n){f==s&&(f=zl());for(l=1;l<=p;l++)h=e[l].A,g=d.e[h],r=Al(f)/2147483647,r=-0.3*(1-r)+0.7*r,0>r&&(r=0),g=Math.abs(e[l].x-g.q),0.5<g+r&&(e[l].x=1-e[l].x);r=4;break}case 3:for(l=h=1;l<=p;l++)g=d.e[e[l].A],g=0.5>g.q?0:1,e[l].x!=g&&(h=
0,e[l].x=g);if(h){for(l=1;l<=p;l++)g=d.e[e[l].A],e[l].Nd=Math.abs(g.q-e[l].x);Ma(e,p,function(a,b){return a.Nd>b.Nd?-1:a.Nd<b.Nd?1:0});for(l=1;l<=p&&!(5<=l&&0.35>e[l].Nd||10<=l);l++)e[l].x=1-e[l].x}case 4:if(a.o.nb<pa&&a.o.nb-1<=1E3*La(a.dc)){r=5;break}d.dir=Gb;d.da=0;for(h=1;h<=c;h++)d.e[h].t=0;for(l=1;l<=p;l++)h=e[l].A,0==e[l].x?d.e[h].t=1:(d.e[h].t=-1,d.da+=1);Hg(j);a.o.n<=Jf?j.n=a.o.n:a.o.n<=fg&&(j.n=Cg,j.Za=1E4);l=Pg(d,j);if(0!=l){a.o.n>=Jf&&B("Warning: glp_simplex returned "+l+"");r=5;break}l=
hh(d);if(l!=fh){a.o.n>=Jf&&B("Warning: glp_get_status returned "+l+"");r=5;break}a.o.n>=Jg&&B("delta = "+d.Y+"");h=0.3*a.o.Ob;for(l=1;l<=p&&!(g=d.e[e[l].A],h<g.q&&g.q<1-h);l++);if(l>p){g=Array(1+c);for(h=1;h<=c;h++)g[h]=d.e[h].q,b.e[h].Aa==ph&&(g[h]=Math.floor(g[h]+0.5));d.da=b.da;d.dir=b.dir;for(l=1;l<=p;l++)d.e[e[l].A].c=g[e[l].A],d.e[e[l].A].d=g[e[l].A],d.e[e[l].A].type=G;for(h=1;h<=c;h++)d.e[h].t=b.e[h].t;l=Pg(d,j);if(0!=l){a.o.n>=Jf&&B("Warning: glp_simplex returned "+l+"");r=5;break}l=hh(d);
if(l!=fh){a.o.n>=Jf&&B("Warning: glp_get_status returned "+l+"");r=5;break}for(h=1;h<=c;h++)b.e[h].Aa!=ph&&(g[h]=d.e[h].q);l=yj(a,g);if(0==l){r=Ch(a,a.L.bound)?1:5;break}}t==v||d.Y<=t-1E-6*(1+t)?(m=0,t=d.Y):m++;if(3>m){r=3;break}5>n&&(r=2)}if(r==s)break;l=r}}
function xi(a){var b,c,d,e,f,g,j,h,l,m;b=a.vd;e=Array(1+b.size);h=Array(1+a.h);l=Array(1+a.h);m=Array(1+a.h);for(f=1;f<=a.h;f++)m[f]=0;f=0;for(c=b.head;c!=s;c=c.next)f++,e[f].He=c,e[f].cb=0;for(f=1;f<=b.size;f++){var n=s,p=s;c=e[f].He;g=j=0;for(d=c.j;d!=s;d=d.next)j++,h[j]=d.A,l[j]=d.i,g+=d.i*d.i;g<ra*ra&&(g=ra);j=uj(a.z,j,h,l);a:{d=a.z;var t=h,r=l,w=c.type,E=c.Uf,q=k,z=k,C=k,H=k;c=0;var O=k,q=H=O=k;d.la==Vb&&y("glp_analyze_row: primal basic solution components are undefined");d.pa!=Bg&&y("glp_analyze_row: basic solution is not dual feasible");
0<=j&&j<=d.h||y("glp_analyze_row: len = "+j+"; invalid row length");H=0;for(q=1;q<=j;q++)z=t[q],1<=z&&z<=d.f+d.h||y("glp_analyze_row: ind["+q+"] = "+z+"; row/column index out of range"),z<=d.f?(d.k[z].l==D&&y("glp_analyze_row: ind["+q+"] = "+z+"; basic auxiliary variable is not allowed"),O=d.k[z].q):(d.e[z-d.f].l==D&&y("glp_analyze_row: ind["+q+"] = "+z+"; basic structural variable is not allowed"),O=d.e[z-d.f].q),H+=r[q]*O;if(w==Zc){if(H>=E){d=c=1;break a}C=1}else if(w==$c){if(H<=E){d=c=1;break a}C=
-1}else y("glp_analyze_row: type = "+w+"; invalid parameter");q=E-H;H=Ii(d,j,t,r,C,1E-9);0==H?c=2:(z=t[H],O=z<=d.f?d.k[z].q:d.e[z-d.f].q,O=q/r[H],p=z<=d.f?d.k[z].H*O:d.e[z-d.f].H*O,n=q);d=c}0==d?(e[f].Uc=Math.abs(n)/Math.sqrt(g),a.z.dir==Gb?(0>p&&(p=0),e[f].vb=+p):(0<p&&(p=0),e[f].vb=-p)):1==d?e[f].Uc=e[f].vb=0:2==d&&(e[f].Uc=1,e[f].vb=v);0.01>e[f].vb&&(e[f].vb=0)}Ma(e,b.size,function(a,b){if(0==a.vb&&0==b.vb){if(a.Uc>b.Uc)return-1;if(a.Uc<b.Uc)return 1}else{if(a.vb>b.vb)return-1;if(a.vb<b.vb)return 1}return 0});
g=0==a.L.Ha?90:10;g>b.size&&(g=b.size);for(f=1;f<=g;f++)if(!(0.01>e[f].vb&&0.01>e[f].Uc)){for(b=1;b<f;b++){if(n=e[b].cb){n=e[f].He;p=e[b].He;d=m;w=k;r=t=j=0;w=k;for(w=n.j;w!=s;w=w.next)d[w.A]=w.i,t+=w.i*w.i;for(w=p.j;w!=s;w=w.next)j+=d[w.A]*w.i,r+=w.i*w.i;for(w=n.j;w!=s;w=w.next)d[w.A]=0;w=Math.sqrt(t)*Math.sqrt(r);w<ra*ra&&(w=ra);n=0.9<j/w}if(n)break}if(!(b<f)){c=e[f].He;e[f].cb=1;b=zc(a.z,1);c.name!=s&&Mc(a.z,b,c.name);a.z.k[b].mc=c.mc;j=0;for(d=c.j;d!=s;d=d.next)j++,h[j]=d.A,l[j]=d.i;sd(a.z,b,
j,h,l);pd(a.z,b,c.type,c.Uf,c.Uf)}}}
var Qa=exports.GLP_MAJOR_VERSION=4,Va=exports.GLP_MINOR_VERSION=47,Gb=exports.GLP_MIN=1,ec=exports.GLP_MAX=2,Fc=exports.GLP_CV=1,ph=exports.GLP_IV=2,qh=exports.GLP_BV=3,yc=exports.GLP_FR=1,Zc=exports.GLP_LO=2,$c=exports.GLP_UP=3,R=exports.GLP_DB=4,G=exports.GLP_FX=5,D=exports.GLP_BS=1,K=exports.GLP_NL=2,od=exports.GLP_NU=3,Yc=exports.GLP_NF=4,Gc=exports.GLP_NS=5,Zi=exports.GLP_SF_GM=1,$i=exports.GLP_SF_EQ=16,aj=exports.GLP_SF_2N=32,bj=exports.GLP_SF_SKIP=64,Eg=exports.GLP_SF_AUTO=128,ig=exports.GLP_SOL=
1,$j=exports.GLP_IPT=2,Oi=exports.GLP_MIP=3,Vb=exports.GLP_UNDEF=1,Bg=exports.GLP_FEAS=2,$h=exports.GLP_INFEAS=3,Gg=exports.GLP_NOFEAS=4,fh=exports.GLP_OPT=5,gh=exports.GLP_UNBND=6,fj=exports.GLP_BF_FT=1,kj=exports.GLP_BF_BG=2,lj=exports.GLP_BF_GR=3,Ig=exports.GLP_MSG_OFF=0,Jf=exports.GLP_MSG_ERR=1,Cg=exports.GLP_MSG_ON=2,fg=exports.GLP_MSG_ALL=3,Jg=exports.GLP_MSG_DBG=4,Mf=exports.GLP_PRIMAL=1,$f=exports.GLP_DUALP=2,cg=exports.GLP_DUAL=3,Kg=exports.GLP_PT_STD=17,Lg=exports.GLP_PT_PSE=34,Mg=exports.GLP_RT_STD=
17,Ng=exports.GLP_RT_HAR=34;exports.GLP_ORD_NONE=0;exports.GLP_ORD_QMD=1;exports.GLP_ORD_AMD=2;exports.GLP_ORD_SYMAMD=3;var Ai=exports.GLP_BR_FFV=1,Di=exports.GLP_BR_LFV=2,Ei=exports.GLP_BR_MFV=3,Gi=exports.GLP_BR_DTH=4,Ji=exports.GLP_BR_PCH=5,Jh=exports.GLP_BT_DFS=1,Kh=exports.GLP_BT_BFS=2,Lh=exports.GLP_BT_BLB=3,Mh=exports.GLP_BT_BPH=4,Uh=exports.GLP_PP_NONE=0,Vh=exports.GLP_PP_ROOT=1,Xh=exports.GLP_PP_ALL=2;exports.GLP_RF_REG=0;
var pc=exports.GLP_RF_LAZY=1,xc=exports.GLP_RF_CUT=2,Dh=exports.GLP_RF_GMI=1,Eh=exports.GLP_RF_MIR=2,Fh=exports.GLP_RF_COV=3,Gh=exports.GLP_RF_CLQ=4,Dd=exports.GLP_ON=1,Id=exports.GLP_OFF=0,oc=exports.GLP_IROWGEN=1,bi=exports.GLP_IBINGO=2,ci=exports.GLP_IHEUR=3,qc=exports.GLP_ICUTGEN=4,zi=exports.GLP_IBRANCH=5,Hh=exports.GLP_ISELECT=6,Th=exports.GLP_IPREPRO=7,Mi=exports.GLP_NO_BRNCH=0,Bi=exports.GLP_DN_BRNCH=1,Ci=exports.GLP_UP_BRNCH=2,If=exports.GLP_EBADB=1,Kf=exports.GLP_ESING=2,Lf=exports.GLP_ECOND=
3,Og=exports.GLP_EBOUND=4,bg=exports.GLP_EFAIL=5,Yh=exports.GLP_EOBJLL=6,Zh=exports.GLP_EOBJUL=7,yl=exports.GLP_EITLIM=8,Sh=exports.GLP_ETMLIM=9,ug=exports.GLP_ENOPFS=10,vg=exports.GLP_ENODFS=11,vh=exports.GLP_EROOT=12,Ih=exports.GLP_ESTOP=13,Rh=exports.GLP_EMIPGAP=14;exports.GLP_ENOFEAS=15;exports.GLP_ENOCVG=16;exports.GLP_EINSTAB=17;exports.GLP_EDATA=18;exports.GLP_ERANGE=19;exports.GLP_KKT_PE=1;exports.GLP_KKT_PB=2;exports.GLP_KKT_DE=3;exports.GLP_KKT_DB=4;exports.GLP_KKT_CS=5;
exports.GLP_MPS_DECK=1;exports.GLP_MPS_FILE=2;exports.GLP_ASN_MIN=1;exports.GLP_ASN_MAX=2;exports.GLP_ASN_MMP=3;exports.LPX_LP=100;exports.LPX_MIP=101;var ki=exports.LPX_FR=110,oi=exports.LPX_LO=111,li=exports.LPX_UP=112,mi=exports.LPX_DB=113,qi=exports.LPX_FX=114;exports.LPX_MIN=120;exports.LPX_MAX=121;exports.LPX_P_UNDEF=132;exports.LPX_P_FEAS=133;exports.LPX_P_INFEAS=134;exports.LPX_P_NOFEAS=135;exports.LPX_D_UNDEF=136;exports.LPX_D_FEAS=137;exports.LPX_D_INFEAS=138;exports.LPX_D_NOFEAS=139;
var ol=exports.LPX_BS=140,ql=exports.LPX_NL=141,rl=exports.LPX_NU=142,pl=exports.LPX_NF=143,sl=exports.LPX_NS=144;exports.LPX_T_UNDEF=150;exports.LPX_T_OPT=151;var si=exports.LPX_CV=160,ti=exports.LPX_IV=161;exports.LPX_I_UNDEF=170;exports.LPX_I_OPT=171;exports.LPX_I_FEAS=172;exports.LPX_I_NOFEAS=173;exports.LPX_OPT=180;exports.LPX_FEAS=181;exports.LPX_INFEAS=182;exports.LPX_NOFEAS=183;exports.LPX_UNBND=184;exports.LPX_UNDEF=185;exports.LPX_E_OK=200;exports.LPX_E_EMPTY=201;exports.LPX_E_BADB=202;
exports.LPX_E_INFEAS=203;exports.LPX_E_FAULT=204;exports.LPX_E_OBJLL=205;exports.LPX_E_OBJUL=206;exports.LPX_E_ITLIM=207;exports.LPX_E_TMLIM=208;exports.LPX_E_NOFEAS=209;exports.LPX_E_INSTAB=210;exports.LPX_E_SING=211;exports.LPX_E_NOCONV=212;exports.LPX_E_NOPFS=213;exports.LPX_E_NODFS=214;exports.LPX_E_MIPGAP=215;var Uk=exports.LPX_K_MSGLEV=300,Vk=exports.LPX_K_SCALE=301,Wk=exports.LPX_K_DUAL=302,Xk=exports.LPX_K_PRICE=303;exports.LPX_K_RELAX=304;exports.LPX_K_TOLBND=305;exports.LPX_K_TOLDJ=306;
exports.LPX_K_TOLPIV=307;var Yk=exports.LPX_K_ROUND=308;exports.LPX_K_OBJLL=309;exports.LPX_K_OBJUL=310;var Zk=exports.LPX_K_ITLIM=311,$k=exports.LPX_K_ITCNT=312;exports.LPX_K_TMLIM=313;var al=exports.LPX_K_OUTFRQ=314;exports.LPX_K_OUTDLY=315;var bl=exports.LPX_K_BRANCH=316,cl=exports.LPX_K_BTRACK=317;exports.LPX_K_TOLINT=318;exports.LPX_K_TOLOBJ=319;
var dl=exports.LPX_K_MPSINFO=320,el=exports.LPX_K_MPSOBJ=321,fl=exports.LPX_K_MPSORIG=322,gl=exports.LPX_K_MPSWIDE=323,hl=exports.LPX_K_MPSFREE=324,il=exports.LPX_K_MPSSKIP=325,jl=exports.LPX_K_LPTORIG=326,kl=exports.LPX_K_PRESOL=327,ll=exports.LPX_K_BINARIZE=328,ml=exports.LPX_K_USECUTS=329,nl=exports.LPX_K_BFTYPE=330;exports.LPX_K_MIPGAP=331;exports.LPX_C_COVER=1;exports.LPX_C_CLIQUE=2;exports.LPX_C_GOMORY=4;exports.LPX_C_MIR=8;exports.LPX_C_ALL=255;
function Bl(a){var b=Math.floor(Math.log(a)/Math.log(2))+1;return Math.pow(2,0.75>=a/Math.pow(2,b)?b-1:b)}function Cl(a,b){var c=Number(a);if(isNaN(c))return 2;switch(c){case Number.POSITIVE_INFINITY:case Number.NEGATIVE_INFINITY:return 1;default:return b(c),0}}function Dl(a,b){var c=Number(a);if(isNaN(c))return 2;switch(c){case Number.POSITIVE_INFINITY:case Number.NEGATIVE_INFINITY:return 1;default:return 0==c%1?(b(c),0):2}}
function El(a,b,c){var d,e;if(!(1<=a&&31>=a&&1<=b&&12>=b&&1<=c&&4E3>=c))return-1;3<=b?b-=3:(b+=9,c--);d=c/100|0;c=(146097*d/4|0)+(1461*(c-100*d)/4|0);c+=(153*b+2)/5|0;c+=a+1721119;Fl(c,function(a){e=a});a!=e&&(c=-1);return c}function Fl(a,b){var c,d,e;1721426<=a&&3182395>=a&&(a-=1721119,e=(4*a-1)/146097|0,c=(4*a-1)%146097/4|0,a=(4*c+3)/1461|0,c=((4*c+3)%1461+4)/4|0,d=(5*c-3)/153|0,c=(5*c-3)%153,c=(c+5)/5|0,e=100*e+a,9>=d?d+=3:(d-=9,e++),b(c,d,e))}var vk=1;LPF_ECOND=2;LPF_ELIMIT=3;var nk=0;
function Dk(a,b,c,d){var e=a.h,f=a.Gd,g=a.Fd,j=a.Qb;a=a.Rb;var h,l,m,n;for(h=1;h<=e;h++){n=0;l=f[h];for(m=l+g[h];l<m;l++)n+=a[l]*d[j[l]];b[h+c]+=-1*n}}function Ak(a,b,c,d){var e=a.h,f=a.Id,g=a.Hd,j=a.Qb;a=a.Rb;var h,l,m,n;for(h=1;h<=e;h++){n=0;l=f[h];for(m=l+g[h];l<m;l++)n+=a[l]*d[j[l]];b[h+c]+=-1*n}}
if(nk)var Ck=function(a,b,c,d){var e=a.f;a=a.sf;var f,g,j=0,h,l,m;for(f=1;f<=e;f++){h=0;for(g=m=1;g<=e;g++)l=b?a[e*(g-1)+f]*c[g]:a[e*(f-1)+g]*c[g],m<Math.abs(l)&&(m=Math.abs(l)),h+=l;g=Math.abs(h-d[f])/m;j<g&&(j=g)}1E-8<j&&B((!b?"lpf_ftran":"lpf_btran")+": dmax = "+j+"; relative error too large")};function pi(a,b){var c=De(a,b);c==-v&&(c=0);return c}function ni(a,b){var c=Qe(a,b);c==+v&&(c=0);return c}function Tk(a,b,c){c(Ce(a,b)-yc+ki,pi(a,b),ni(a,b))}
function ri(a,b){var c=Se(a,b);c==-v&&(c=0);return c}function ui(a,b){var c=Te(a,b);c==+v&&(c=0);return c}function Sk(a,b,c){c(Re(a,b)-yc+ki,ri(a,b),ui(a,b))}var pk=1,rk=2;
function mk(){var a={};a.I=a.h=0;a.valid=0;a.Hf=a.Oe=s;a.Sd=a.Rd=s;a.Ec=a.Dc=a.jd=s;a.qf=s;a.Cc=a.Bc=a.Pc=s;a.eb=a.qb=s;a.gf=a.fe=s;a.Ca=0;a.Ba=a.Ia=0;a.rb=s;a.sb=s;a.fd=a.Mb=0;a.Bd=a.gd=s;a.pf=s;a.kf=a.Vf=a.lf=s;a.Ee=a.Ge=a.Fe=s;a.cb=s;a.re=s;a.Ra=0;a.Zb=0.1;a.tc=4;a.cc=1;a.Gb=1E-15;a.oc=1E10;a.Rg=a.Rf=a.Kb=0;a.rg=a.ld=0;a.vc=0;return a}
function Rk(a){var b=a.h,c=a.Ec,d=a.Dc,e=a.jd,f=a.Cc,g=a.Bc,j=a.Pc,h=a.rb,l=a.sb,m=a.gd,n=1,p,t;for(t=a.fd;0!=t;t=m[t])if(t<=b){p=t;if(c[p]!=n)break;e[p]=d[p];n+=e[p]}else{p=t-b;if(f[p]!=n)break;j[p]=g[p];n+=j[p]}for(;0!=t;t=m[t])t<=b?(p=t,Ca(h,n,h,c[p],d[p]),Ca(l,n,l,c[p],d[p]),c[p]=n,e[p]=d[p],n+=e[p]):(p=t-b,Ca(h,n,h,f[p],g[p]),Ca(l,n,l,f[p],g[p]),f[p]=n,j[p]=g[p],n+=j[p]);a.Ba=n}
function Pk(a,b,c){var d=a.h,e=a.Ec,f=a.Dc,g=a.jd,j=a.Pc,h=a.rb,l=a.sb,m=a.Bd,n=a.gd,p=0,t;if(a.Ia-a.Ba<c&&(Rk(a),a.Ia-a.Ba<c))return 1;t=g[b];Ca(h,a.Ba,h,e[b],f[b]);Ca(l,a.Ba,l,e[b],f[b]);e[b]=a.Ba;g[b]=c;a.Ba+=c;0==m[b]?a.fd=n[b]:(c=m[b],c<=d?g[c]+=t:j[c-d]+=t,n[m[b]]=n[b]);0==n[b]?a.Mb=m[b]:m[n[b]]=m[b];m[b]=a.Mb;n[b]=0;0==m[b]?a.fd=b:n[m[b]]=b;a.Mb=b;return p}
function Qk(a,b,c){var d=a.h,e=a.jd,f=a.Cc,g=a.Bc,j=a.Pc,h=a.rb,l=a.sb,m=a.Bd,n=a.gd,p=0,t;if(a.Ia-a.Ba<c&&(Rk(a),a.Ia-a.Ba<c))return 1;t=j[b];Ca(h,a.Ba,h,f[b],g[b]);Ca(l,a.Ba,l,f[b],g[b]);f[b]=a.Ba;j[b]=c;a.Ba+=c;b=d+b;0==m[b]?a.fd=n[b]:(c=m[b],c<=d?e[c]+=t:j[c-d]+=t,n[m[b]]=n[b]);0==n[b]?a.Mb=m[b]:m[n[b]]=m[b];m[b]=a.Mb;n[b]=0;0==m[b]?a.fd=b:n[m[b]]=b;a.Mb=b;return p}
function Gl(a,b){function c(){b(C,H);return 0==C}var d=a.h,e=a.Ec,f=a.Dc,g=a.Cc,j=a.Bc,h=a.rb,l=a.sb,m=a.pf,n=a.kf,p=a.lf,t=a.Ee,r=a.Ge,w=a.Fe,E=a.Zb,q=a.tc,z=a.cc,C,H,O,J,L,u,F,x,P,I,X,A,M,N,za,ua,va,ka;C=H=0;ua=v;X=0;x=t[1];if(0!=x)return C=h[g[x]],H=x,c();J=n[1];if(0!=J)return C=J,H=h[e[J]],c();for(O=2;O<=d;O++){for(x=t[O];0!=x;x=A){J=g[x];P=J+j[x]-1;A=w[x];M=N=0;za=pa;for(I=J;I<=P;I++)if(J=h[I],L=e[J],u=L+f[J]-1,!(f[J]>=za)){va=m[J];if(0>va){for(F=L;F<=u;F++)ka=l[F],0>ka&&(ka=-ka),va<ka&&(va=
ka);m[J]=va}for(F=e[J];h[F]!=x;F++);ka=l[F];0>ka&&(ka=-ka);if(!(ka<E*va)&&(M=J,N=x,za=f[J],za<=O))return C=M,H=N,c()}if(0!=M){if(X++,x=(za-1)*(O-1),x<ua&&(C=M,H=N,ua=x),X==q)return c()}else z&&(0==r[x]?t[O]=w[x]:w[r[x]]=w[x],0!=w[x]&&(r[w[x]]=r[x]),r[x]=w[x]=x)}for(J=n[O];0!=J;J=p[J]){L=e[J];u=L+f[J]-1;va=m[J];if(0>va){for(F=L;F<=u;F++)ka=l[F],0>ka&&(ka=-ka),va<ka&&(va=ka);m[J]=va}M=N=0;za=pa;for(F=L;F<=u;F++)if(x=h[F],!(j[x]>=za)&&(ka=l[F],0>ka&&(ka=-ka),!(ka<E*va)&&(M=J,N=x,za=j[x],za<=O)))return C=
M,H=N,c();if(0!=M&&(X++,x=(O-1)*(za-1),x<ua&&(C=M,H=N,ua=x),X==q))return c()}}return c()}
function ok(a,b,c,d){function e(){0<a.Ra&&(a.Ca=a.Ra,a.rb=Array(1+a.Ca),a.sb=Array(1+a.Ca),a.Ra=0);var e;a:{var q=a,z=c,C=d,u=q.h,F=q.Sd,x=q.Rd,P=q.Ec,I=q.Dc,X=q.jd,A=q.Cc,M=q.Bc,N=q.Pc,za=q.eb,ua=q.qb,va=q.gf,ka=q.fe,fc=q.rb,Ee=q.sb,Ve=q.Bd,We=q.gd,xb=q.pf,Ja=q.kf,ud=q.Vf,Sd=q.lf,Ic=q.Ee,ha=q.Ge,ba=q.Fe,ga=q.cb,Ob=q.re,gb=0,U,Bb,ca,Yb,Pb,wa,Fa,Ac,Hb,ad,Jc,Fe,bd;Hb=1;ad=q.Ca+1;for(ca=1;ca<=u;ca++)F[ca]=ad,x[ca]=0;for(U=1;U<=u;U++)I[U]=X[U]=0,ga[U]=0;Fe=Ac=0;for(ca=1;ca<=u;ca++){var ie=za,cd=Ob;Fa=
z(C,ca,ie,cd);0<=Fa&&Fa<=u||y("luf_factorize: j = "+ca+"; len = "+Fa+"; invalid column length");if(ad-Hb<Fa){e=gb=1;break a}A[ca]=Hb;M[ca]=N[ca]=Fa;Ac+=Fa;for(Jc=1;Jc<=Fa;Jc++)U=ie[Jc],bd=cd[Jc],1<=U&&U<=u||y("luf_factorize: i = "+U+"; j = "+ca+"; invalid row index"),ga[U]&&y("luf_factorize: i = "+U+"; j = "+ca+"; duplicate element not allowed"),0==bd&&y("luf_factorize: i = "+U+"; j = "+ca+"; zero element not allowed"),fc[Hb]=U,Ee[Hb]=bd,Hb++,0>bd&&(bd=-bd),Fe<bd&&(Fe=bd),ga[U]=1,X[U]++;for(Jc=1;Jc<=
Fa;Jc++)ga[ie[Jc]]=0}for(U=1;U<=u;U++){Fa=X[U];if(ad-Hb<Fa){e=gb=1;break a}P[U]=Hb;Hb+=Fa}for(ca=1;ca<=u;ca++){Yb=A[ca];Pb=Yb+M[ca]-1;for(wa=Yb;wa<=Pb;wa++)U=fc[wa],bd=Ee[wa],Bb=P[U]+I[U],fc[Bb]=ca,Ee[Bb]=bd,I[U]++}for(wa=1;wa<=u;wa++)za[wa]=ua[wa]=va[wa]=ka[wa]=wa;q.Ba=Hb;q.Ia=ad;q.fd=u+1;q.Mb=u;for(U=1;U<=u;U++)Ve[U]=U-1,We[U]=U+1;Ve[1]=u+u;We[u]=0;for(ca=1;ca<=u;ca++)Ve[u+ca]=u+ca-1,We[u+ca]=u+ca+1;Ve[u+1]=0;for(wa=We[u+u]=1;wa<=u;wa++)ga[wa]=0,Ob[wa]=0;q.Rg=Ac;q.Rf=0;q.Kb=Ac;q.rg=Fe;q.ld=Fe;q.vc=
-1;for(U=1;U<=u;U++)xb[U]=-1;for(Fa=0;Fa<=u;Fa++)Ja[Fa]=0;for(U=1;U<=u;U++)Fa=I[U],ud[U]=0,Sd[U]=Ja[Fa],0!=Sd[U]&&(ud[Sd[U]]=U),Ja[Fa]=U;for(Fa=0;Fa<=u;Fa++)Ic[Fa]=0;for(ca=1;ca<=u;ca++)Fa=M[ca],ha[ca]=0,ba[ca]=Ic[Fa],0!=ba[ca]&&(ha[ba[ca]]=ca),Ic[Fa]=ca;e=gb}if(e)return a.Ra=a.Ca+a.Ca,aa;for(p=1;p<=b;p++){if(Gl(a,function(a,b){t=a;r=b}))return a.vc=p-1,E=pk,ia;m=g[t];n=j[r];w=f[p];f[m]=w;g[w]=m;f[p]=t;g[t]=p;w=h[p];h[n]=w;j[w]=n;h[p]=r;j[r]=p;var bb;a:{var fa=a,qa=t,Q=r,Td=fa.h,Rg=fa.Sd,Wa=fa.Rd,
Kc=fa.Ec,Zb=fa.Dc,jg=fa.jd,je=fa.qf,Xa=fa.Cc,Ha=fa.Bc,ke=fa.Pc,xa=fa.rb,cb=fa.sb,Ib=fa.Bd,sb=fa.gd,rc=fa.pf,Bc=fa.kf,sc=fa.Vf,Cb=fa.lf,Xe=fa.Ee,hb=fa.Ge,Aa=fa.Fe,Qb=fa.cb,Ud=fa.re,Cc=fa.Gb,nb=fa.Oe,Db=0,Lc=k,tc=k,la=k,Ge=k,Nc=k,ib=k,da=k,Oc=k,He=k,jb=k,db=k,Ta=k,Jb=k,Ya=k,gc=k,hc=k,vd=k,Vd=k,ic=k,Wd=k,Na=k;0==sc[qa]?Bc[Zb[qa]]=Cb[qa]:Cb[sc[qa]]=Cb[qa];0!=Cb[qa]&&(sc[Cb[qa]]=sc[qa]);0==hb[Q]?Xe[Ha[Q]]=Aa[Q]:Aa[hb[Q]]=Aa[Q];0!=Aa[Q]&&(hb[Aa[Q]]=hb[Q]);Ta=Kc[qa];Jb=Ta+Zb[qa]-1;for(Ya=Ta;xa[Ya]!=Q;Ya++);
Wd=je[qa]=cb[Ya];xa[Ya]=xa[Jb];cb[Ya]=cb[Jb];Zb[qa]--;Jb--;gc=Xa[Q];hc=gc+Ha[Q]-1;for(vd=gc;xa[vd]!=qa;vd++);xa[vd]=xa[hc];Ha[Q]--;hc--;for(Ya=Ta;Ya<=Jb;Ya++){da=xa[Ya];Qb[da]=1;Ud[da]=cb[Ya];0==hb[da]?Xe[Ha[da]]=Aa[da]:Aa[hb[da]]=Aa[da];0!=Aa[da]&&(hb[Aa[da]]=hb[da]);Oc=Xa[da];He=Oc+Ha[da]-1;for(jb=Oc;xa[jb]!=qa;jb++);xa[jb]=xa[He];Ha[da]--}for(;gc<=hc;){la=xa[gc];0==sc[la]?Bc[Zb[la]]=Cb[la]:Cb[sc[la]]=Cb[la];0!=Cb[la]&&(sc[Cb[la]]=sc[la]);Ge=Kc[la];Nc=Ge+Zb[la]-1;for(ib=Ge;xa[ib]!=Q;ib++);Vd=cb[ib]/
Wd;xa[ib]=xa[Nc];cb[ib]=cb[Nc];Zb[la]--;Nc--;xa[gc]=xa[hc];Ha[Q]--;hc--;tc=Zb[qa];for(ib=Ge;ib<=Nc;ib++)if(da=xa[ib],Qb[da])if(Na=cb[ib]-=Vd*Ud[da],0>Na&&(Na=-Na),Qb[da]=0,tc--,0==Na||Na<Cc){xa[ib]=xa[Nc];cb[ib]=cb[Nc];Zb[la]--;ib--;Nc--;Oc=Xa[da];He=Oc+Ha[da]-1;for(jb=Oc;xa[jb]!=la;jb++);xa[jb]=xa[He];Ha[da]--}else fa.ld<Na&&(fa.ld=Na);if(Zb[la]+tc>jg[la]){if(Pk(fa,la,Zb[la]+tc)){bb=Db=1;break a}Ta=Kc[qa];Jb=Ta+Zb[qa]-1;gc=Xa[Q];hc=gc+Ha[Q]-1}Lc=0;for(Ya=Ta;Ya<=Jb;Ya++)da=xa[Ya],Qb[da]?(Na=ic=-Vd*
Ud[da],0>Na&&(Na=-Na),0==Na||Na<Cc||(ib=Kc[la]+Zb[la],xa[ib]=da,cb[ib]=ic,Zb[la]++,nb[++Lc]=da,fa.ld<Na&&(fa.ld=Na))):Qb[da]=1;for(db=1;db<=Lc;db++){da=nb[db];if(Ha[da]+1>ke[da]){if(Qk(fa,da,Ha[da]+10)){bb=Db=1;break a}Ta=Kc[qa];Jb=Ta+Zb[qa]-1;gc=Xa[Q];hc=gc+Ha[Q]-1}jb=Xa[da]+Ha[da];xa[jb]=la;Ha[da]++}sc[la]=0;Cb[la]=Bc[Zb[la]];0!=Cb[la]&&(sc[Cb[la]]=la);Bc[Zb[la]]=la;rc[la]=-1;if(1>fa.Ia-fa.Ba){Rk(fa);if(1>fa.Ia-fa.Ba){bb=Db=1;break a}Ta=Kc[qa];Jb=Ta+Zb[qa]-1;gc=Xa[Q];hc=gc+Ha[Q]-1}fa.Ia--;xa[fa.Ia]=
la;cb[fa.Ia]=Vd;Wa[qa]++}ke[Q]=0;db=Td+Q;0==Ib[db]?fa.fd=sb[db]:sb[Ib[db]]=sb[db];0==sb[db]?fa.Mb=Ib[db]:Ib[sb[db]]=Ib[db];Rg[qa]=fa.Ia;for(Ya=Ta;Ya<=Jb;Ya++)da=xa[Ya],Qb[da]=0,Ud[da]=0,1!=Ha[da]&&hb[da]==da&&Aa[da]==da||(hb[da]=0,Aa[da]=Xe[Ha[da]],0!=Aa[da]&&(hb[Aa[da]]=da),Xe[Ha[da]]=da);bb=Db}if(bb)return a.Ra=a.Ca+a.Ca,aa;if(a.ld>l*a.rg)return a.vc=p-1,E=rk,ia}Rk(a);var Rb;var Za=a,$b=Za.h,Ed=Za.Ec,uc=Za.Dc,Fd=Za.Cc,le=Za.Bc,jc=Za.Pc,Dc=Za.rb,Ra=Za.sb,Ie=Za.Bd,me=Za.gd,dd=0,kb,lb,Pc,ed,yb,kc,
lc,Gd;Gd=0;for(kb=1;kb<=$b;kb++){lb=Ed[kb];Pc=lb+uc[kb]-1;for(ed=lb;ed<=Pc;ed++)jc[Dc[ed]]++;Gd+=uc[kb]}Za.Kb=Gd;if(Za.Ia-Za.Ba<Gd)dd=1;else{for(yb=1;yb<=$b;yb++)Fd[yb]=Za.Ba,Za.Ba+=jc[yb];for(kb=1;kb<=$b;kb++){lb=Ed[kb];Pc=lb+uc[kb]-1;for(ed=lb;ed<=Pc;ed++)yb=Dc[ed],kc=Fd[yb]+le[yb],Dc[kc]=kb,Ra[kc]=Ra[ed],le[yb]++}for(lc=$b+1;lc<=$b+$b;lc++)Ie[lc]=lc-1,me[lc]=lc+1;Ie[$b+1]=Za.Mb;me[Za.Mb]=$b+1;me[$b+$b]=0;Za.Mb=$b+$b}Rb=dd;if(Rb)return a.Ra=a.Ca+a.Ca,aa;var Qc;var Mb=a,Ye=Mb.h,Ec=Mb.Hf,Hd=Mb.Oe,
ob=Mb.Sd,Ka=Mb.Rd,zb=Mb.rb,ea=Mb.sb,mb=0,pb,tb,Ua,Sa,T,Kb,fd;for(pb=1;pb<=Ye;pb++)Hd[pb]=0;fd=0;for(tb=1;tb<=Ye;tb++){Ua=ob[tb];Sa=Ua+Ka[tb]-1;for(T=Ua;T<=Sa;T++)Hd[zb[T]]++;fd+=Ka[tb]}Mb.Rf=fd;if(Mb.Ia-Mb.Ba<fd)mb=1;else{for(pb=1;pb<=Ye;pb++)Ec[pb]=Mb.Ia,Mb.Ia-=Hd[pb];for(tb=1;tb<=Ye;tb++){Ua=ob[tb];Sa=Ua+Ka[tb]-1;for(T=Ua;T<=Sa;T++)pb=zb[T],Kb=--Ec[pb],zb[Kb]=tb,ea[Kb]=ea[T]}}Qc=mb;return Qc?(a.Ra=a.Ca+a.Ca,aa):ia}var f,g,j,h,l=a.oc,m,n,p,t,r,w,E=s;1>b&&y("luf_factorize: n = "+b+"; invalid parameter");
b>ya&&y("luf_factorize: n = "+b+"; matrix too big");a.valid=0;var q=a,z=b,C=q.I;q.h=z;z<=C||(q.I=C=z+100,q.Hf=Array(1+C),q.Oe=Array(1+C),q.Sd=Array(1+C),q.Rd=Array(1+C),q.Ec=Array(1+C),q.Dc=Array(1+C),q.jd=Array(1+C),q.qf=Array(1+C),q.Cc=Array(1+C),q.Bc=Array(1+C),q.Pc=Array(1+C),q.eb=Array(1+C),q.qb=Array(1+C),q.gf=Array(1+C),q.fe=Array(1+C),q.Bd=Array(1+C+C),q.gd=Array(1+C+C),q.pf=Array(1+C),q.kf=Array(1+C),q.Vf=Array(1+C),q.lf=Array(1+C),q.Ee=Array(1+C),q.Ge=Array(1+C),q.Fe=Array(1+C),q.cb=Array(1+
C),q.re=Array(1+C));f=a.eb;g=a.qb;j=a.gf;h=a.fe;0==a.Ca&&0==a.Ra&&(a.Ra=5*(b+10));for(;e(););if(E!=s)return E;a.valid=1;a.vc=b;E=0;w=3*(b+a.Kb)+2*a.Rf;if(a.Ca<w)for(a.Ra=a.Ca;a.Ra<w;)p=a.Ra,a.Ra=p+p;return E}
function xk(a,b,c){var d=a.h,e=a.Hf,f=a.Oe,g=a.Sd,j=a.Rd,h=a.eb,l=a.rb,m=a.sb,n;a.valid||y("luf_f_solve: LU-factorization is not valid");if(b)for(;1<=d;d--){if(n=h[d],a=c[n],0!=a){b=e[n];for(n=b+f[n]-1;b<=n;b++)c[l[b]]-=m[b]*a}}else for(e=1;e<=d;e++)if(n=h[e],a=c[n],0!=a){b=g[n];for(n=b+j[n]-1;b<=n;b++)c[l[b]]-=m[b]*a}}
function zk(a,b,c){var d=a.h,e=a.Ec,f=a.Dc,g=a.qf,j=a.Cc,h=a.Bc,l=a.eb,m=a.fe,n=a.rb,p=a.sb,t=a.re,r,w,E;a.valid||y("luf_v_solve: LU-factorization is not valid");for(a=1;a<=d;a++)t[a]=c[a],c[a]=0;if(b)for(a=1;a<=d;a++){if(r=l[a],w=m[a],b=t[w],0!=b){c[r]=b/=g[r];E=e[r];for(r=E+f[r]-1;E<=r;E++)t[n[E]]-=p[E]*b}}else for(a=d;1<=a;a--)if(r=l[a],w=m[a],b=t[r],0!=b){c[w]=b/=g[r];E=j[w];for(r=E+h[w]-1;E<=r;E++)t[n[E]]-=p[E]*b}}
var Hl=-1,Il=101,Kl=102,Ll=103,Ml=104,Nl=105,Ol=106,Pl=107,Ql=108,Rl=109,Sl=110,Tl=111,Ul=112,Vl=113,Wl=114,Xl=115,Yl=116,Zl=117,S=118,$l=119,am=120,bm=121,cm=122,dm=123,V=124,em=125,fm=126,gm=127,hm=100,im=60,jm=201,km=202,lm=203,mm=204,nm=205,om=206,pm=207,qm=208,rm=209,sm=210,tm=211,um=212,vm=213,wm=214,xm=215,ym=216,zm=217,Am=218,Bm=219,Cm=220,Dm=221,Em=222,Fm=223,Gm=224,Hm=225,Im=226,Jm=227,Km=228,Lm=229,Mm=230,Nm=231,Om=232,Pm=233,Qm=234,Rm=235,Sm=236,Tm=237,Um=238,Vm=239,Wm=240,Xm=241,Ym=242,
Zm=243,$m=244,an=245,bn=246,cn=247,dn=248,en=249,fn=250,gn=251,hn=252,jn=0,kn=1,ln=2,mn=3,nn=4,on=5,pn=301,qn=302,rn=303,sn=304,tn=305,un=306,vn=307,wn=308,xn=309,yn=310,zn=311,An=312,Bn=313,Cn=314,Dn=315,En=316,Fn=317,Gn=318,Hn=319,In=320,Jn=321,Kn=322,Ln=323,Mn=324,Nn=325,On=326,Pn=327,Qn=328,Rn=329,Sn=330,Tn=331,Un=332,Vn=333,Wn=334,Xn=335,Yn=336,Zn=337,$n=338,ao=339,bo=340,co=341,eo=342,fo=343,go=344,ho=345,io=346,jo=347,ko=348,lo=349,mo=350,no=351,oo=352,po=353,ro=354,so=355,to=356,uo=357,vo=
358,wo=359,xo=360,yo=361,zo=362,Ao=363,Bo=364,Co=365,Do=366,Eo=367,Fo=368,Go=369,Ho=370,Io=371,Jo=372,Ko=373,Lo=374,Mo=375,No=376,Oo=377,Po=378,Qo=379,Ro=380,So=381,To=382,Uo=383,Vo=384,Kj=401,Lj=402,Mj=403,Nj=404,Oj=405,Yj=412,Zj=413,Tj=422,Uj=423;function Wo(){return{index:{},P:{},set:{},s:{},F:{},a:{},loop:{}}}function Xo(a){var b;b=a.b==jm?"_|_":a.b==nm?"'...'":a.g;a.Ub[a.gc++]=" ";a.gc==im&&(a.gc=0);for(var c=0;c<b.length;c++)a.Ub[a.gc++]=b[c],a.gc==im&&(a.gc=0)}
function Yo(a){var b;a.m!=Hl&&("\n"==a.m&&a.jb++,b=a.Se(),0>b&&(b=Hl),b==Hl?"\n"==a.m?a.jb--:Zo(a,"final NL missing before end of file"):"\n"!=b&&(0<=" \t\n\v\f\r".indexOf(b)?b=" ":eb(b)&&(Xo(a),W(a,"control character "+b+" not allowed"))),a.m=b)}
function $o(a){if(a.Vb==hm)switch(a.b){case km:Xo(a);W(a,"symbolic name "+a.g+"... too long");break;case lm:Xo(a);W(a,"symbol "+a.g+"... too long");break;case mm:Xo(a);W(a,"numeric literal "+a.g+"... too long");break;case nm:Xo(a),W(a,"string literal too long")}a.g+=a.m;a.Vb++;Yo(a)}
function Y(a){function b(){Xo(a);W(a,"keyword s.t. incomplete")}function c(){Xo(a);W(a,"cannot convert numeric literal "+a.g+" to floating-point number")}function d(){if("e"==a.m||"E"==a.m){$o(a);("+"==a.m||"-"==a.m)&&$o(a);rb(a.m)||(Xo(a),W(a,"numeric literal "+a.g+" incomplete"));for(;rb(a.m);)$o(a)}if(fb(a.m)||"_"==a.m)Xo(a),W(a,"symbol "+a.g+a.m+"... should be enclosed in quotes")}a.xf=a.b;a.wf=a.Vb;a.vf=a.g;a.yf=a.value;if(a.Ke)a.Ke=0,a.b=a.Cf,a.Vb=a.Bf,a.g=a.Af,a.value=a.Df;else{for(;;){a.b=
0;a.Vb=0;a.g="";for(a.value=0;" "==a.m||"\n"==a.m;)Yo(a);if(a.m==Hl)a.b=jm;else if("#"==a.m){for(;"\n"!=a.m&&a.m!=Hl;)Yo(a);continue}else if(!a.ic&&(fb(a.m)||"_"==a.m)){for(a.b=km;qb(a.m)||"_"==a.m;)$o(a);"and"==a.g?a.b=om:"by"==a.g?a.b=pm:"cross"==a.g?a.b=qm:"diff"==a.g?a.b=rm:"div"==a.g?a.b=sm:"else"==a.g?a.b=tm:"if"==a.g?a.b=um:"in"==a.g?a.b=vm:"Infinity"==a.g?a.b=wm:"inter"==a.g?a.b=xm:"less"==a.g?a.b=ym:"mod"==a.g?a.b=zm:"not"==a.g?a.b=Am:"or"==a.g?a.b=Bm:"s"==a.g&&"."==a.m?(a.b=Cm,$o(a),"t"!=
a.m&&b(),$o(a),"."!=a.m&&b(),$o(a)):"symdiff"==a.g?a.b=Dm:"then"==a.g?a.b=Em:"union"==a.g?a.b=Fm:"within"==a.g&&(a.b=Gm)}else if(!a.ic&&rb(a.m)){for(a.b=mm;rb(a.m);)$o(a);var e=ia;if("."==a.m)if($o(a),"."==a.m)a.Vb--,a.g=a.g.substr(0,a.g.length-1),a.Je=1,e=aa;else for(;rb(a.m);)$o(a);e||d();Cl(a.g,function(b){a.value=b})&&c()}else if("'"==a.m||'"'==a.m){e=a.m;a.b=nm;for(Yo(a);;){if("\n"==a.m||a.m==Hl)Xo(a),W(a,"unexpected end of line; string literal incomplete");if(a.m==e&&(Yo(a),a.m!=e))break;$o(a)}}else if(!a.ic&&
"+"==a.m)a.b=Hm,$o(a);else if(!a.ic&&"-"==a.m)a.b=Im,$o(a);else if("*"==a.m)a.b=Jm,$o(a),"*"==a.m&&(a.b=Lm,$o(a));else if("/"==a.m){if(a.b=Km,$o(a),"*"==a.m){for(Yo(a);;)if(a.m==Hl)W(a,"unexpected end of file; comment sequence incomplete");else if("*"==a.m){if(Yo(a),"/"==a.m)break}else Yo(a);Yo(a);continue}}else if("^"==a.m)a.b=Lm,$o(a);else if("<"==a.m)a.b=Mm,$o(a),"="==a.m?(a.b=Nm,$o(a)):">"==a.m?(a.b=Rm,$o(a)):"-"==a.m&&(a.b=hn,$o(a));else if("="==a.m)a.b=Om,$o(a),"="==a.m&&$o(a);else if(">"==
a.m)a.b=Qm,$o(a),"="==a.m?(a.b=Pm,$o(a)):">"==a.m&&(a.b=fn,$o(a));else if("!"==a.m)a.b=Am,$o(a),"="==a.m&&(a.b=Rm,$o(a));else if("&"==a.m)a.b=Sm,$o(a),"&"==a.m&&(a.b=om,$o(a));else if("|"==a.m)a.b=Tm,$o(a),"|"==a.m&&(a.b=Bm,$o(a));else if(!a.ic&&"."==a.m)if(a.b=Um,$o(a),a.Je)a.b=Zm,a.Vb=2,a.g="..",a.Je=0;else if("."==a.m)a.b=Zm,$o(a);else{if(rb(a.m)){a.b=mm;for($o(a);rb(a.m);)$o(a);d();Cl(a.g,function(b){a.value=b})&&c()}}else if(","==a.m)a.b=Vm,$o(a);else if(":"==a.m)a.b=Wm,$o(a),"="==a.m&&(a.b=
Ym,$o(a));else if(";"==a.m)a.b=Xm,$o(a);else if("("==a.m)a.b=$m,$o(a);else if(")"==a.m)a.b=an,$o(a);else if("["==a.m)a.b=bn,$o(a);else if("]"==a.m)a.b=cn,$o(a);else if("{"==a.m)a.b=dn,$o(a);else if("}"==a.m)a.b=en,$o(a);else if("~"==a.m)a.b=gn,$o(a);else if(qb(a.m)||0<="+-._".indexOf(a.m)){for(a.b=lm;qb(a.m)||0<="+-._".indexOf(a.m);)$o(a);switch(Cl(a.g,function(b){a.value=b})){case 0:a.b=mm;break;case 1:c()}}else Xo(a),W(a,"character "+a.m+" not allowed");break}Xo(a);a.Ff=0}}
function ap(a){a.Ke=1;a.Cf=a.b;a.Bf=a.Vb;a.Af=a.g;a.Df=a.value;a.b=a.xf;a.Vb=a.wf;a.g=a.vf;a.value=a.yf}function bp(a,b){return a.b==km&&a.g==b}function cp(a){return a.b==om&&"a"==a.g[0]||a.b==pm||a.b==qm||a.b==rm||a.b==sm||a.b==tm||a.b==um||a.b==vm||a.b==xm||a.b==ym||a.b==zm||a.b==Am&&"n"==a.g[0]||a.b==Bm&&"o"==a.g[0]||a.b==Dm||a.b==Em||a.b==Fm||a.b==Gm}
function dp(a,b,c,d){var e={};e.Pa=a;e.Q=0;e.a=Wo();e.value={};switch(a){case pn:e.a.O=b.O;break;case qn:e.a.K=b.K;break;case rn:e.a.index.ua=b.index.ua;e.a.index.next=b.index.next;break;case sn:case tn:for(a=b.P.list;a!=s;a=a.next)a.x.ga=e,e.Q|=a.x.Q;e.a.P.P=b.P.P;e.a.P.list=b.P.list;break;case un:for(a=b.set.list;a!=s;a=a.next)a.x.ga=e,e.Q|=a.x.Q;e.a.set.set=b.set.set;e.a.set.list=b.set.list;break;case vn:for(a=b.s.list;a!=s;a=a.next)a.x.ga=e,e.Q|=a.x.Q;e.a.s.s=b.s.s;e.a.s.list=b.s.list;e.a.s.zc=
b.s.zc;break;case wn:for(a=b.F.list;a!=s;a=a.next)a.x.ga=e,e.Q|=a.x.Q;e.a.F.F=b.F.F;e.a.F.list=b.F.list;e.a.F.zc=b.F.zc;break;case xn:case yn:for(a=b.list;a!=s;a=a.next)a.x.ga=e,e.Q|=a.x.Q;e.a.list=b.list;break;case zn:e.a.slice=b.slice;break;case An:case Bn:case Cn:case Dn:e.Q=1;break;case En:case Fn:case Gn:case Hn:case In:case Jn:case Kn:case Ln:case Mn:case Nn:case On:case Pn:case Qn:case Rn:case Sn:case Tn:case Un:case Vn:case Wn:case Xn:case Yn:case Zn:b.a.x.ga=e;e.Q|=b.a.x.Q;e.a.a.x=b.a.x;
break;case $n:case ao:case bo:case co:case eo:case fo:case go:case ho:case io:case jo:case ko:case lo:a==lo&&(e.Q=1);case mo:a==mo&&(e.Q=1);case no:case oo:case po:case ro:case so:case to:case uo:case vo:case wo:case xo:case yo:case zo:case Ao:case Bo:case Co:case Do:case Eo:case Fo:case Go:case Ho:case Io:b.a.x.ga=e;e.Q|=b.a.x.Q;b.a.y.ga=e;e.Q|=b.a.y.Q;e.a.a.x=b.a.x;e.a.a.y=b.a.y;break;case Jo:case Ko:case Lo:b.a.x.ga=e;e.Q|=b.a.x.Q;b.a.y.ga=e;e.Q|=b.a.y.Q;b.a.Ka!=s&&(b.a.Ka.ga=e,e.Q|=b.a.Ka.Q);
e.a.a.x=b.a.x;e.a.a.y=b.a.y;e.a.a.Ka=b.a.Ka;break;case Mo:case No:for(a=b.list;a!=s;a=a.next)a.x.ga=e,e.Q|=a.x.Q;e.a.list=b.list;break;case Oo:case Po:case Qo:case Ro:case So:case To:case Uo:case Vo:a=b.loop.domain;a.code!=s&&(a.code.ga=e,e.Q|=a.code.Q);for(a=a.list;a!=s;a=a.next)a.code.ga=e,e.Q|=a.code.Q;b.loop.x!=s&&(b.loop.x.ga=e,e.Q|=b.loop.x.Q);e.a.loop.domain=b.loop.domain;e.a.loop.x=b.loop.x}e.type=c;e.p=d;e.ga=s;e.valid=0;e.value={};return e}
function Z(a,b,c,d){var e=Wo();e.a.x=b;return dp(a,e,c,d)}function ep(a,b,c,d,e){var f=Wo();f.a.x=b;f.a.y=c;return dp(a,f,d,e)}function fp(a,b,c,d,e,f){var g=Wo();g.a.x=b;g.a.y=c;g.a.Ka=d;return dp(a,g,e,f)}function gp(a,b){var c={},d;c.x=b;c.next=s;if(a==s)a=c;else{for(d=a;d.next!=s;d=d.next);d.next=c}return a}function hp(a){var b;for(b=0;a!=s;a=a.next)b++;return b}
function ip(a){var b,c,d,e,f,g,j,h,l,m=Wo(),n=a.W[a.g];n==s&&W(a,a.g+" not defined");switch(n.type){case Tl:b=n.link;h=b.name;l=0;break;case cm:c=n.link;h=c.name;l=c.p;0==c.T&&(c.T=1);break;case am:d=n.link;h=d.name;l=d.p;break;case gm:e=n.link;h=e.name;l=e.p;break;case Ll:f=n.link,h=f.name,l=f.p}Y(a);if(a.b==bn){0==l&&W(a,h+" cannot be subscripted");Y(a);for(var p=s;;)if(g=jp(a),g.type==S&&(g=Z(Fn,g,V,0)),g.type!=V&&W(a,"subscript expression has invalid type"),p=gp(p,g),a.b==Vm)Y(a);else if(a.b==
cn)break;else W(a,"syntax error in subscript list");g=p;l!=hp(g)&&W(a,h+" must have "+l+" subscript"+(1==l?"":"s")+" rather than "+hp(g));Y(a)}else 0!=l&&W(a,h+" must be subscripted"),g=s;l=!a.Ib&&n.type==gm?jn:nn;a.b==Um&&(Y(a),a.b!=km&&W(a,"invalid use of period"),n.type==gm||n.type==Ll||W(a,h+" cannot have a suffix"),"lb"==a.g?l=kn:"ub"==a.g?l=ln:"status"==a.g?l=mn:"val"==a.g?l=nn:"dual"==a.g?l=on:W(a,"suffix ."+a.g+" invalid"),Y(a));switch(n.type){case Tl:m.index.ua=b;m.index.next=b.list;j=dp(rn,
m,V,0);b.list=j;break;case cm:m.set.set=c;m.set.list=g;j=dp(un,m,Ol,c.T);break;case am:m.P.P=d;m.P.list=g;j=d.type==V?dp(tn,m,V,0):dp(sn,m,S,0);break;case gm:!a.Ib&&(l==mn||l==nn||l==on)&&W(a,"invalid reference to status, primal value, or dual value of variable "+e.name+" above solve statement");m.s.s=e;m.s.list=g;m.s.zc=l;j=dp(vn,m,l==jn?Sl:S,0);break;case Ll:if(!a.Ib&&(l==mn||l==nn||l==on))W(a,"invalid reference to status, primal value, or dual value of "+(f.type==Ll?"constraint":"objective")+" "+
f.name+" above solve statement");m.F.F=f;m.F.list=g;m.F.zc=l;j=dp(wn,m,S,0)}return j}function kp(a,b){var c=jp(a);c.type==V&&(c=Z(En,c,S,0));c.type!=S&&W(a,"argument for "+b+" has invalid type");return c}function lp(a,b){var c=jp(a);c.type==S&&(c=Z(Fn,c,V,0));c.type!=V&&W(a,"argument for "+b+" has invalid type");return c}function mp(a,b,c){var d={};d.name=b;d.code=c;d.value=s;d.list=s;d.next=s;if(a.list==s)a.list=d;else{for(a=a.list;a.next!=s;a=a.next);a.next=d}}
function np(a){var b,c,d,e;Y(a);a.b==en&&W(a,"empty indexing expression not allowed");for(b={};;){e=c=s;a.b==km?(Y(a),d=a.b,ap(a),d==vm&&a.W[a.g]==s&&(c={},d=a.g,mp(c,d,s),Y(a),Y(a))):a.b==$m&&(a.Ff=1,e=op(a),e.Pa==zn&&(c=e.a.slice,e=s,Y(a)));e==s&&(e=op(a));if(e.type!=Ol){c!=s&&W(a,"domain expression has invalid type");d=a;var f=Wo(),g=k;f.list=s;for(g=1;;g++){e.type==S&&(e=Z(Fn,e,V,0));e.type==V&&(e=Z(Hn,e,fm,1));e.type!=fm&&W(d,"member expression has invalid type");f.list!=s&&f.list.x.p!=e.p&&
W(d,"member "+(g-1)+" has "+f.list.x.p+" component"+(1==f.list.x.p?"":"s")+" while member "+g+" has "+e.p+" component"+(1==e.p?"":"s"));f.list=gp(f.list,e);if(d.b==Vm)Y(d);else if(d.b==en)break;else W(d,"syntax error in literal set");e=jp(d)}e=dp(yn,f,Ol,f.list.x.p)}if(c==s){c={};for(d=1;d<=e.p;d++)mp(c,s,s)}f=0;for(d=c.list;d!=s;d=d.next)f++;f!=e.p&&W(a,f+" "+(1==f?"index":"indices")+" specified for set of dimension "+e.p);c.code=e;e=b;d=c;f=k;if(e.list==s)e.list=d;else{for(f=e.list;f.next!=s;f=
f.next);f.next=d}for(d=c.list;d!=s;d=d.next)d.name!=s&&(a.W[d.name]={type:Tl,link:d});if(a.b==Vm)Y(a);else if(a.b==Wm||a.b==en)break;else W(a,"syntax error in indexing expression")}a.b==Wm&&(Y(a),e=pp(a),e.type==V&&(e=Z(En,e,S,0)),e.type==S&&(e=Z(Gn,e,Wl,0)),e.type!=Wl&&W(a,"expression following colon has invalid type"),b.code=e,a.b!=en&&W(a,"syntax error in indexing expression"));Y(a);return b}
function qp(a,b){var c,d;for(c=b.list;c!=s;c=c.next)for(d=c.list;d!=s;d=d.next)d.name!=s&&delete a.W[d.name]}function rp(a){var b,c;for(b=a.a.loop.domain.list;b!=s;b=b.next)for(c=b.list;c!=s;c=c.next)c.code!=s&&(c.code.ga=a)}function sp(a){var b=0;for(a=a.list;a!=s;a=a.next)for(var c=a.list;c!=s;c=c.next)c.code==s&&b++;return b}function tp(a,b){W(a,"operand preceding "+b+" has invalid type")}function up(a,b){W(a,"operand following "+b+" has invalid type")}
function vp(a,b,c,d){W(a,"operands preceding and following "+b+" have different dimensions "+c+" and "+d+", respectively")}
function wp(a){var b,c,d;if(a.b==mm)b=Wo(),b.O=a.value,b=dp(pn,b,S,0),Y(a),d=b;else if(a.b==wm)b=Wo(),b.O=v,d=dp(pn,b,S,0),Y(a);else if(a.b==nm)b=Wo(),b.K=a.g,b=dp(qn,b,V,0),Y(a),d=b;else if(a.b==km)switch(Y(a),d=a.b,ap(a),d){case bn:d=ip(a);break;case $m:c=Wo();var e;"abs"==a.g?b=Mn:"ceil"==a.g?b=Nn:"floor"==a.g?b=On:"exp"==a.g?b=Pn:"log"==a.g?b=Qn:"log10"==a.g?b=Rn:"sqrt"==a.g?b=Sn:"sin"==a.g?b=Tn:"cos"==a.g?b=Un:"atan"==a.g?b=Vn:"min"==a.g?b=Mo:"max"==a.g?b=No:"round"==a.g?b=Wn:"trunc"==a.g?b=
Xn:"Irand224"==a.g?b=An:"Uniform01"==a.g?b=Bn:"Uniform"==a.g?b=lo:"Normal01"==a.g?b=Cn:"Normal"==a.g?b=mo:"card"==a.g?b=Yn:"length"==a.g?b=Zn:"substr"==a.g?b=Go:"str2time"==a.g?b=Ho:"time2str"==a.g?b=Io:"gmtime"==a.g?b=Dn:W(a,"function "+a.g+" unknown");e=a.g;Y(a);Y(a);if(b==Mo||b==No)for(c.list=s;;)if(c.list=gp(c.list,kp(a,e)),a.b==Vm)Y(a);else if(a.b==an)break;else W(a,"syntax error in argument list for "+e);else if(b==An||b==Bn||b==Cn||b==Dn)a.b!=an&&W(a,e+" needs no arguments");else if(b==lo||
b==mo)c.a.x=kp(a,e),a.b!=Vm&&(a.b==an?W(a,e+" needs two arguments"):W(a,"syntax error in argument for "+e)),Y(a),c.a.y=kp(a,e),a.b==Vm?W(a,e+" needs two argument"):a.b!=an&&W(a,"syntax error in argument for "+e);else if(b==Vn||b==Wn||b==Xn){c.a.x=kp(a,e);if(a.b==Vm){switch(b){case Vn:b=io;break;case Wn:b=jo;break;case Xn:b=ko}Y(a);c.a.y=kp(a,e)}a.b==Vm?W(a,e+" needs one or two arguments"):a.b!=an&&W(a,"syntax error in argument for "+e)}else if(b==Go)c.a.x=lp(a,e),a.b!=Vm&&(a.b==an?W(a,e+" needs two or three arguments"):
W(a,"syntax error in argument for "+e)),Y(a),c.a.y=kp(a,e),a.b==Vm&&(b=Lo,Y(a),c.a.Ka=kp(a,e)),a.b==Vm?W(a,e+" needs two or three arguments"):a.b!=an&&W(a,"syntax error in argument for "+e);else if(b==Ho)c.a.x=lp(a,e),a.b!=Vm&&(a.b==an?W(a,e+" needs two arguments"):W(a,"syntax error in argument for "+e)),Y(a),c.a.y=lp(a,e),a.b==Vm?W(a,e+" needs two argument"):a.b!=an&&W(a,"syntax error in argument for "+e);else if(b==Io)c.a.x=kp(a,e),a.b!=Vm&&(a.b==an?W(a,e+" needs two arguments"):W(a,"syntax error in argument for "+
e)),Y(a),c.a.y=lp(a,e),a.b==Vm?W(a,e+" needs two argument"):a.b!=an&&W(a,"syntax error in argument for "+e);else{d=c.a;var f;b==Yn?(f=op(a),f.type!=Ol&&W(a,"argument for "+e+" has invalid type")):f=b==Zn?lp(a,e):kp(a,e);d.x=f;a.b==Vm?W(a,e+" needs one argument"):a.b!=an&&W(a,"syntax error in argument for "+e)}b=b==Go||b==Lo||b==Io?dp(b,c,V,0):dp(b,c,S,0);Y(a);d=b;break;case dn:b=function(){W(a,"integrand following "+g+"{...} has invalid type")};d=Wo();var g;"sum"==a.g?e=Oo:"prod"==a.g?e=Po:"min"==
a.g?e=Qo:"max"==a.g?e=Ro:"forall"==a.g?e=So:"exists"==a.g?e=To:"setof"==a.g?e=Uo:W(a,"operator "+a.g+" unknown");g=a.g;Y(a);d.loop.domain=np(a);switch(e){case Oo:case Po:case Qo:case Ro:d.loop.x=xp(a);d.loop.x.type==V&&(d.loop.x=Z(En,d.loop.x,S,0));d.loop.x.type==S||e==Oo&&d.loop.x.type==Sl||b();c=dp(e,d,d.loop.x.type,0);break;case So:case To:d.loop.x=yp(a);d.loop.x.type==V&&(d.loop.x=Z(En,d.loop.x,S,0));d.loop.x.type==S&&(d.loop.x=Z(Gn,d.loop.x,Wl,0));d.loop.x.type!=Wl&&b();c=dp(e,d,Wl,0);break;
case Uo:d.loop.x=jp(a),d.loop.x.type==S&&(d.loop.x=Z(Fn,d.loop.x,V,0)),d.loop.x.type==V&&(d.loop.x=Z(Hn,d.loop.x,fm,1)),d.loop.x.type!=fm&&b(),c=dp(e,d,Ol,d.loop.x.p)}qp(a,d.loop.domain);rp(c);d=c;break;default:d=ip(a)}else if(a.b==$m){var j;b=Wo();var h=Array(21);Ea(h,0,21);var l;e=0;c=a.Ff;Y(a);for(l=1;;l++){20<l&&W(a,"too many components within parentheses");f=function(){j=pp(a);if(a.b==Vm||1<l)j.type==S&&(j=Z(Fn,j,V,0)),j.type!=V&&W(a,"component expression has invalid type");h[l].name=s;h[l].code=
j};if(a.b==km)if(Y(a),d=a.b,ap(a),!c||!((d==Vm||d==an)&&a.W[a.g]==s))f();else{for(d=1;d<l;d++)h[d].name!=s&&h[d].name==a.g&&W(a,"duplicate dummy index "+a.g+" not allowed");h[l].name=a.g;h[l].code=s;Y(a);e=1;1==l&&a.b==an&&W(a,h[l].name+" not defined")}else f();if(a.b==Vm)Y(a);else if(a.b==an)break;else W(a,"right parenthesis missing where expected")}if(1==l&&!e)j=h[1].code;else if(e){b.slice={};for(d=1;d<=l;d++)mp(b.slice,h[d].name,h[d].code);j=dp(zn,b,fm,l)}else{b.list=s;for(d=1;d<=l;d++)b.list=
gp(b.list,h[d].code);j=dp(xn,b,fm,l)}Y(a);e&&a.b!=vm&&W(a,"keyword in missing where expected");c&&(a.b==vm&&!e)&&(1==l?W(a,"syntax error in indexing expression"):W(a,"0-ary slice not allowed"));d=j}else if(a.b==dn)b=Wo(),Y(a),a.b==en?(b.list=s,b=dp(yn,b,Ol,1),Y(a)):(ap(a),b.loop.domain=np(a),b.loop.x=s,qp(a,b.loop.domain),b=dp(Vo,b,Ol,sp(b.loop.domain)),rp(b)),d=b;else if(a.b==um){Y(a);b=pp(a);b.type==V&&(b=Z(En,b,S,0));b.type==S&&(b=Z(Gn,b,Wl,0));b.type!=Wl&&W(a,"expression following if has invalid type");
a.b!=Em&&W(a,"keyword then missing where expected");Y(a);c=op(a);c.type==S||(c.type==V||c.type==Ol||c.type==Sl)||W(a,"expression following then has invalid type");if(a.b!=tm)c.type==Ol&&W(a,"keyword else missing where expected"),e=s;else{Y(a);e=op(a);e.type==S||(e.type==V||e.type==Ol||e.type==Sl)||W(a,"expression following else has invalid type");if(c.type==Sl||e.type==Sl)c.type==V&&(c=Z(En,c,S,0)),c.type==S&&(c=Z(In,c,Sl,0)),e.type==V&&(e=Z(En,e,S,0)),e.type==S&&(e=Z(In,e,Sl,0));if(c.type==V||e.type==
V)c.type==S&&(c=Z(Fn,c,V,0)),e.type==S&&(e=Z(Fn,e,V,0));c.type!=e.type&&W(a,"expressions following then and else have incompatible types");c.p!=e.p&&W(a,"expressions following then and else have different dimensions "+c.p+" and "+e.p+", respectively")}d=fp(Ko,b,c,e,c.type,c.p)}else cp(a)?W(a,"invalid use of reserved keyword "+a.g):W(a,"syntax error in expression");c=d;a.b==Lm&&(e=a.g,c.type==V&&(c=Z(En,c,S,0)),c.type!=S&&tp(a,e),Y(a),b=a.b==Hm||a.b==Im?zp(a):wp(a),b.type==V&&(b=Z(En,b,S,0)),b.type!=
S&&up(a,e),c=ep(ho,c,b,S,0));return c}function zp(a){var b;a.b==Hm?(Y(a),b=wp(a),b.type==V&&(b=Z(En,b,S,0)),b.type==S||b.type==Sl||up(a,"+"),b=Z(Jn,b,b.type,0)):a.b==Im?(Y(a),b=wp(a),b.type==V&&(b=Z(En,b,S,0)),b.type==S||b.type==Sl||up(a,"-"),b=Z(Kn,b,b.type,0)):b=wp(a);return b}
function xp(a){for(var b,c=zp(a);;)if(a.b==Jm)c.type==V&&(c=Z(En,c,S,0)),c.type==S||c.type==Sl||tp(a,"*"),Y(a),b=zp(a),b.type==V&&(b=Z(En,b,S,0)),b.type==S||b.type==Sl||up(a,"*"),c.type==Sl&&b.type==Sl&&W(a,"multiplication of linear forms not allowed"),c=c.type==S&&b.type==S?ep(co,c,b,S,0):ep(co,c,b,Sl,0);else if(a.b==Km)c.type==V&&(c=Z(En,c,S,0)),c.type==S||c.type==Sl||tp(a,"/"),Y(a),b=zp(a),b.type==V&&(b=Z(En,b,S,0)),b.type!=S&&up(a,"/"),c=c.type==S?ep(eo,c,b,S,0):ep(eo,c,b,Sl,0);else if(a.b==sm)c.type==
V&&(c=Z(En,c,S,0)),c.type!=S&&tp(a,"div"),Y(a),b=zp(a),b.type==V&&(b=Z(En,b,S,0)),b.type!=S&&up(a,"div"),c=ep(fo,c,b,S,0);else if(a.b==zm)c.type==V&&(c=Z(En,c,S,0)),c.type!=S&&tp(a,"mod"),Y(a),b=zp(a),b.type==V&&(b=Z(En,b,S,0)),b.type!=S&&up(a,"mod"),c=ep(go,c,b,S,0);else break;return c}
function Ap(a){for(var b,c=xp(a);;)if(a.b==Hm)c.type==V&&(c=Z(En,c,S,0)),c.type==S||c.type==Sl||tp(a,"+"),Y(a),b=xp(a),b.type==V&&(b=Z(En,b,S,0)),b.type==S||b.type==Sl||up(a,"+"),c.type==S&&b.type==Sl&&(c=Z(In,c,Sl,0)),c.type==Sl&&b.type==S&&(b=Z(In,b,Sl,0)),c=ep($n,c,b,c.type,0);else if(a.b==Im)c.type==V&&(c=Z(En,c,S,0)),c.type==S||c.type==Sl||tp(a,"-"),Y(a),b=xp(a),b.type==V&&(b=Z(En,b,S,0)),b.type==S||b.type==Sl||up(a,"-"),c.type==S&&b.type==Sl&&(c=Z(In,c,Sl,0)),c.type==Sl&&b.type==S&&(b=Z(In,
b,Sl,0)),c=ep(ao,c,b,c.type,0);else if(a.b==ym)c.type==V&&(c=Z(En,c,S,0)),c.type!=S&&tp(a,"less"),Y(a),b=xp(a),b.type==V&&(b=Z(En,b,S,0)),b.type!=S&&up(a,"less"),c=ep(bo,c,b,S,0);else break;return c}function jp(a){for(var b,c=Ap(a);;)if(a.b==Sm)c.type==S&&(c=Z(Fn,c,V,0)),c.type!=V&&tp(a,"&"),Y(a),b=Ap(a),b.type==S&&(b=Z(Fn,b,V,0)),b.type!=V&&up(a,"&"),c=ep(no,c,b,V,0);else break;return c}
function Bp(a){var b,c,d=jp(a);a.b==Zm&&(d.type==V&&(d=Z(En,d,S,0)),d.type!=S&&tp(a,".."),Y(a),b=jp(a),b.type==V&&(b=Z(En,b,S,0)),b.type!=S&&up(a,".."),a.b==pm?(Y(a),c=jp(a),c.type==V&&(c=Z(En,c,S,0)),c.type!=S&&up(a,"by")):c=s,d=fp(Jo,d,b,c,Ol,1));return d}function Cp(a){for(var b,c=Bp(a);;)if(a.b==qm)c.type!=Ol&&tp(a,"cross"),Y(a),b=Bp(a),b.type!=Ol&&up(a,"cross"),c=ep(Bo,c,b,Ol,c.p+b.p);else break;return c}
function Dp(a){for(var b,c=Cp(a);;)if(a.b==xm)c.type!=Ol&&tp(a,"inter"),Y(a),b=Cp(a),b.type!=Ol&&up(a,"inter"),c.p!=b.p&&vp(a,"inter",c.p,b.p),c=ep(Ao,c,b,Ol,c.p);else break;return c}
function op(a){for(var b,c=Dp(a);;)if(a.b==Fm)c.type!=Ol&&tp(a,"union"),Y(a),b=Dp(a),b.type!=Ol&&up(a,"union"),c.p!=b.p&&vp(a,"union",c.p,b.p),c=ep(xo,c,b,Ol,c.p);else if(a.b==rm)c.type!=Ol&&tp(a,"diff"),Y(a),b=Dp(a),b.type!=Ol&&up(a,"diff"),c.p!=b.p&&vp(a,"diff",c.p,b.p),c=ep(yo,c,b,Ol,c.p);else if(a.b==Dm)c.type!=Ol&&tp(a,"symdiff"),Y(a),b=Dp(a),b.type!=Ol&&up(a,"symdiff"),c.p!=b.p&&vp(a,"symdiff",c.p,b.p),c=ep(zo,c,b,Ol,c.p);else break;return c}
function Ep(a){var b,c=-1,d="",e=op(a);switch(a.b){case Mm:c=oo;break;case Nm:c=po;break;case Om:c=ro;break;case Pm:c=so;break;case Qm:c=to;break;case Rm:c=uo;break;case vm:c=Co;break;case Gm:c=Eo;break;case Am:d=a.g;Y(a);a.b==vm?c=Do:a.b==Gm?c=Fo:W(a,"invalid use of "+d);d+=" ";break;default:return e}d+=a.g;switch(c){case ro:case uo:case oo:case po:case to:case so:e.type==S||e.type==V||tp(a,d);Y(a);b=op(a);b.type==S||b.type==V||up(a,d);e.type==S&&b.type==V&&(e=Z(Fn,e,V,0));e.type==V&&b.type==S&&
(b=Z(Fn,b,V,0));e=ep(c,e,b,Wl,0);break;case Co:case Do:e.type==S&&(e=Z(Fn,e,V,0));e.type==V&&(e=Z(Hn,e,fm,1));e.type!=fm&&tp(a,d);Y(a);b=op(a);b.type!=Ol&&up(a,d);e.p!=b.p&&vp(a,d,e.p,b.p);e=ep(c,e,b,Wl,0);break;case Eo:case Fo:e.type!=Ol&&tp(a,d),Y(a),b=op(a),b.type!=Ol&&up(a,d),e.p!=b.p&&vp(a,d,e.p,b.p),e=ep(c,e,b,Wl,0)}return e}function Fp(a){var b,c;a.b==Am?(c=a.g,Y(a),b=Ep(a),b.type==V&&(b=Z(En,b,S,0)),b.type==S&&(b=Z(Gn,b,Wl,0)),b.type!=Wl&&up(a,c),b=Z(Ln,b,Wl,0)):b=Ep(a);return b}
function yp(a){for(var b,c="",d=Fp(a);;)if(a.b==om)c=a.g,d.type==V&&(d=Z(En,d,S,0)),d.type==S&&(d=Z(Gn,d,Wl,0)),d.type!=Wl&&tp(a,c),Y(a),b=Fp(a),b.type==V&&(b=Z(En,b,S,0)),b.type==S&&(b=Z(Gn,b,Wl,0)),b.type!=Wl&&up(a,c),d=ep(vo,d,b,Wl,0);else break;return d}
function pp(a){for(var b,c=yp(a);;)if(a.b==Bm){var d=a.g;c.type==V&&(c=Z(En,c,S,0));c.type==S&&(c=Z(Gn,c,Wl,0));c.type!=Wl&&tp(a,d);Y(a);b=yp(a);b.type==V&&(b=Z(En,b,S,0));b.type==S&&(b=Z(Gn,b,Wl,0));b.type!=Wl&&up(a,d);c=ep(wo,c,b,Wl,0)}else break;return c}
function Gp(a){function b(){W(a,"syntax error in constraint statement")}var c,d,e,f;a.Ib&&W(a,"constraint statement must precede solve statement");bp(a,"subject")?(Y(a),bp(a,"to")||W(a,"keyword subject to incomplete"),Y(a)):bp(a,"subj")?(Y(a),bp(a,"to")||W(a,"keyword subj to incomplete"),Y(a)):a.b==Cm&&Y(a);a.b!=km&&(cp(a)?W(a,"invalid use of reserved keyword "+a.g):W(a,"symbolic name missing where expected"));a.W[a.g]!=s&&W(a,a.g+" multiply declared");var g={};g.name=a.g;g.Cb=s;g.p=0;g.domain=s;
g.type=Ll;g.code=s;g.N=s;g.S=s;g.M=s;Y(a);a.b==nm&&(g.Cb=a.g,Y(a));a.b==dn&&(g.domain=np(a),g.p=sp(g.domain));c=a.W[g.name]={};c.type=Ll;c.link=g;a.b!=Wm&&W(a,"colon missing where expected");Y(a);c=jp(a);c.type==V&&(c=Z(En,c,S,0));c.type==S||c.type==Sl||W(a,"expression following colon has invalid type");a.b==Vm&&Y(a);switch(a.b){case Nm:case Pm:case Om:break;case Mm:case Qm:case Rm:W(a,"strict inequality not allowed");break;case Xm:W(a,"constraint must be equality or inequality");break;default:b()}f=
a.b;e=a.g;Y(a);d=jp(a);d.type==V&&(d=Z(En,d,S,0));d.type==S||d.type==Sl||W(a,"expression following "+e+" has invalid type");a.b==Vm&&(Y(a),a.b==Xm&&b());a.b==Mm||a.b==Nm||a.b==Om||a.b==Pm||a.b==Qm||a.b==Rm?((f==Om||a.b!=f)&&W(a,"double inequality must be ... <= ... <= ... or ... >= ... >= ..."),c.type==Sl&&W(a,"leftmost expression in double inequality cannot be linear form"),Y(a),e=jp(a),e.type==V&&(e=Z(En,d,S,0)),e.type==S||e.type==Sl||W(a,"rightmost expression in double inequality constraint has invalid type"),
e.type==Sl&&W(a,"rightmost expression in double inequality cannot be linear form")):e=s;g.domain!=s&&qp(a,g.domain);c.type!=Sl&&(c=Z(In,c,Sl,0));d.type!=Sl&&(d=Z(In,d,Sl,0));e!=s&&(e=Z(In,e,Sl,0));if(e==s)switch(f){case Nm:g.code=c;g.N=s;g.S=d;break;case Pm:g.code=c;g.N=d;g.S=s;break;case Om:g.code=c,g.N=d,g.S=d}else switch(f){case Nm:g.code=d;g.N=c;g.S=e;break;case Pm:g.code=d,g.N=e,g.S=c}a.b!=Xm&&b();Y(a);return g}
function Hp(a){!a.ic&&bp(a,"end")||a.ic&&Ip(a,"end")?(Y(a),a.b==Xm?Y(a):Zo(a,"no semicolon following end statement; missing semicolon inserted")):Zo(a,"unexpected end of file; missing end statement inserted");a.b!=jm&&Zo(a,"some text detected beyond end statement; text ignored")}
function Jp(a,b){var c={u:{}};c.jb=a.jb;c.next=s;if(bp(a,"set")){b&&W(a,"set statement not allowed here");c.type=cm;var d=c.u,e=function(){W(a,"at most one := or default/data allowed")},f=function(){W(a,a.g+" not a plain set")},g=function(){W(a,"dimension of "+a.g+" too small")},j=function(){W(a,"component number must be integer between 1 and "+n.set.T)},h,l,m=0,n;Y(a);a.b!=km&&(cp(a)?W(a,"invalid use of reserved keyword "+a.g):W(a,"symbolic name missing where expected"));a.W[a.g]!=s&&W(a,a.g+" multiply declared");
h={};h.name=a.g;h.Cb=s;h.p=0;h.domain=s;h.T=0;h.rf=s;h.assign=s;h.ta=s;h.Vc=s;h.data=0;h.M=s;Y(a);a.b==nm&&(h.Cb=a.g,Y(a));a.b==dn&&(h.domain=np(a),h.p=sp(h.domain));l=a.W[h.name]={};l.type=cm;for(l.link=h;;){if(a.b==Vm)Y(a);else if(a.b==Xm)break;if(bp(a,"dimen")){var p;Y(a);a.b==mm&&1<=a.value&&20>=a.value&&Math.floor(a.value)==a.value||W(a,"dimension must be integer between 1 and 20");p=a.value+0.5|0;m&&W(a,"at most one dimension attribute allowed");0<h.T&&W(a,"dimension "+p+" conflicts with dimension "+
h.T+" already determined");h.T=p;m=1;Y(a)}else if(a.b==Gm||a.b==vm){a.b==vm&&!a.gg&&(Zo(a,"keyword in understood as within"),a.gg=1);Y(a);p={code:s,next:s};if(h.rf==s)h.rf=p;else{for(l=h.rf;l.next!=s;l=l.next);l.next=p}p.code=op(a);p.code.type!=Ol&&W(a,"expression following within has invalid type");0==h.T&&(h.T=p.code.p);h.T!=p.code.p&&W(a,"set expression following within must have dimension "+h.T+" rather than "+p.code.p)}else if(a.b==Ym)h.assign==s&&h.ta==s&&h.Vc==s||e(),Y(a),h.assign=op(a),h.assign.type!=
Ol&&W(a,"expression following := has invalid type"),0==h.T&&(h.T=h.assign.p),h.T!=h.assign.p&&W(a,"set expression following := must have dimension "+h.T+" rather than "+h.assign.p);else if(bp(a,"default"))h.assign==s&&h.ta==s||e(),Y(a),h.ta=op(a),h.ta.type!=Ol&&W(a,"expression following default has invalid type"),0==h.T&&(h.T=h.ta.p),h.T!=h.ta.p&&W(a,"set expression following default must have dimension "+h.T+" rather than "+h.ta.p);else if(bp(a,"data")){var t=0;p=Array(20);h.assign==s&&h.Vc==s||
e();Y(a);h.Vc=n={};a.b!=km&&(cp(a)?W(a,"invalid use of reserved keyword "+a.g):W(a,"set name missing where expected"));l=a.W[a.g];l==s&&W(a,a.g+" not defined");l.type!=cm&&f();n.set=l.link;0!=n.set.p&&f();n.set==h&&W(a,"set cannot be initialized by itself");h.p>=n.set.T&&g();0==h.T&&(h.T=n.set.T-h.p);h.p+h.T>n.set.T?g():h.p+h.T<n.set.T&&W(a,"dimension of "+a.g+" too big");Y(a);a.b==$m?Y(a):W(a,"left parenthesis missing where expected");for(l=0;l<n.set.T;l++)p[l]=0;for(l=0;;)if(a.b!=mm&&W(a,"component number missing where expected"),
0!=Dl(a.g,function(a){t=a})&&j(),1<=t&&t<=n.set.T||j(),0!=p[t-1]&&W(a,"component "+t+" multiply specified"),n.X[l++]=t,p[t-1]=1,Y(a),a.b==Vm)Y(a);else if(a.b==an)break;else W(a,"syntax error in data attribute");l<n.set.T&&W(a,"there are must be "+n.set.T+" components rather than "+l);Y(a)}else W(a,"syntax error in set statement")}h.domain!=s&&qp(a,h.domain);0==h.T&&(h.T=1);Y(a);d.set=h}else if(bp(a,"param")){b&&W(a,"parameter statement not allowed here");c.type=am;var e=c.u,f=function(){w&&W(a,"at most one binary allowed");
r.type==V&&W(a,"symbolic parameter cannot be binary");r.type=Il;w=1;Y(a)},g=function(){W(a,"at most one := or default allowed")},r,w=j=0;h=0;Y(a);a.b!=km&&(cp(a)?W(a,"invalid use of reserved keyword "+a.g):W(a,"symbolic name missing where expected"));a.W[a.g]!=s&&W(a,a.g+" multiply declared");r={};r.name=a.g;r.Cb=s;r.p=0;r.domain=s;r.type=S;r.qd=s;r.na=s;r.assign=s;r.ta=s;r.data=0;r.Tc=s;r.M=s;Y(a);a.b==nm&&(r.Cb=a.g,Y(a));a.b==dn&&(r.domain=np(a),r.p=sp(r.domain));m=a.W[r.name]={};m.type=am;for(m.link=
r;;){if(a.b==Vm)Y(a);else if(a.b==Xm)break;if(bp(a,"integer"))j&&W(a,"at most one integer allowed"),r.type==V&&W(a,"symbolic parameter cannot be integer"),r.type!=Il&&(r.type=Vl),j=1,Y(a);else if(bp(a,"binary"))f();else if(bp(a,"logical"))a.Ae||(Zo(a,"keyword logical understood as binary"),a.Ae=1),f();else if(bp(a,"symbolic"))h&&W(a,"at most one symbolic allowed"),r.type!=S&&W(a,"integer or binary parameter cannot be symbolic"),r.qd==s&&r.na==s&&r.assign==s&&r.ta==s||W(a,"keyword symbolic must precede any other parameter attributes"),
r.type=V,h=1,Y(a);else if(a.b==Mm||a.b==Nm||a.b==Om||a.b==Pm||a.b==Qm||a.b==Rm){p={};switch(a.b){case Mm:p.dd=oo;d=a.g;break;case Nm:p.dd=po;d=a.g;break;case Om:p.dd=ro;d=a.g;break;case Pm:p.dd=so;d=a.g;break;case Qm:p.dd=to;d=a.g;break;case Rm:p.dd=uo,d=a.g}p.code=s;p.next=s;if(r.qd==s)r.qd=p;else{for(m=r.qd;m.next!=s;m=m.next);m.next=p}Y(a);p.code=jp(a);p.code.type==S||p.code.type==V||W(a,"expression following "+d+" has invalid type");r.type!=V&&p.code.type==V&&(p.code=Z(En,p.code,S,0));r.type==
V&&p.code.type!=V&&(p.code=Z(Fn,p.code,V,0))}else if(a.b==vm||a.b==Gm){a.b==Gm&&!a.fg&&(Zo(a,"keyword within understood as in"),a.fg=1);Y(a);p={code:s,next:s};if(r.na==s)r.na=p;else{for(m=r.na;m.next!=s;m=m.next);m.next=p}p.code=op(a);p.code.type!=Ol&&W(a,"expression following in has invalid type");1!=p.code.p&&W(a,"set expression following in must have dimension 1 rather than "+p.code.p)}else a.b==Ym?(r.assign==s&&r.ta==s||g(),Y(a),r.assign=jp(a),r.assign.type==S||r.assign.type==V||W(a,"expression following := has invalid type"),
r.type!=V&&r.assign.type==V&&(r.assign=Z(En,r.assign,S,0)),r.type==V&&r.assign.type!=V&&(r.assign=Z(Fn,r.assign,V,0))):bp(a,"default")?(r.assign==s&&r.ta==s||g(),Y(a),r.ta=jp(a),r.ta.type==S||r.ta.type==V||W(a,"expression following default has invalid type"),r.type!=V&&r.ta.type==V&&(r.ta=Z(En,r.ta,S,0)),r.type==V&&r.ta.type!=V&&(r.ta=Z(Fn,r.ta,V,0))):W(a,"syntax error in parameter statement")}r.domain!=s&&qp(a,r.domain);Y(a);e.P=r}else if(bp(a,"var")){b&&W(a,"variable statement not allowed here");
c.type=gm;var d=c.u,e=function(){E&&W(a,"at most one binary allowed");q.type=Il;E=1;Y(a)},E=f=0;a.Ib&&W(a,"variable statement must precede solve statement");Y(a);a.b!=km&&(cp(a)?W(a,"invalid use of reserved keyword "+a.g):W(a,"symbolic name missing where expected"));a.W[a.g]!=s&&W(a,a.g+" multiply declared");var q={};q.name=a.g;q.Cb=s;q.p=0;q.domain=s;q.type=S;q.N=s;q.S=s;q.M=s;Y(a);a.b==nm&&(q.Cb=a.g,Y(a));a.b==dn&&(q.domain=np(a),q.p=sp(q.domain));g=a.W[q.name]={};g.type=gm;for(g.link=q;;){if(a.b==
Vm)Y(a);else if(a.b==Xm)break;bp(a,"integer")?(f&&W(a,"at most one integer allowed"),q.type!=Il&&(q.type=Vl),f=1,Y(a)):bp(a,"binary")?e():bp(a,"logical")?(a.Ae||(Zo(a,"keyword logical understood as binary"),a.Ae=1),e()):bp(a,"symbolic")?W(a,"variable cannot be symbolic"):a.b==Pm?(q.N!=s&&(q.N==q.S?W(a,"both fixed value and lower bound not allowed"):W(a,"at most one lower bound allowed")),Y(a),q.N=jp(a),q.N.type==V&&(q.N=Z(En,q.N,S,0)),q.N.type!=S&&W(a,"expression following >= has invalid type")):
a.b==Nm?(q.S!=s&&(q.S==q.N?W(a,"both fixed value and upper bound not allowed"):W(a,"at most one upper bound allowed")),Y(a),q.S=jp(a),q.S.type==V&&(q.S=Z(En,q.S,S,0)),q.S.type!=S&&W(a,"expression following <= has invalid type")):a.b==Om?(q.N==s&&q.S==s||(q.N==q.S?W(a,"at most one fixed value allowed"):q.N!=s?W(a,"both lower bound and fixed value not allowed"):W(a,"both upper bound and fixed value not allowed")),g=a.g,Y(a),q.N=jp(a),q.N.type==V&&(q.N=Z(En,q.N,S,0)),q.N.type!=S&&W(a,"expression following "+
g+" has invalid type"),q.S=q.N):a.b==Mm||a.b==Qm||a.b==Rm?W(a,"strict bound not allowed"):W(a,"syntax error in variable statement")}q.domain!=s&&qp(a,q.domain);Y(a);d.s=q}else if(bp(a,"subject")||bp(a,"subj")||a.b==Cm)b&&W(a,"constraint statement not allowed here"),c.type=Ll,c.u.F=Gp(a);else if(bp(a,"minimize")||bp(a,"maximize"))b&&W(a,"objective statement not allowed here"),c.type=Ll,d=c.u,bp(a,"minimize")?f=Yl:bp(a,"maximize")&&(f=Xl),a.Ib&&W(a,"objective statement must precede solve statement"),
Y(a),a.b!=km&&(cp(a)?W(a,"invalid use of reserved keyword "+a.g):W(a,"symbolic name missing where expected")),a.W[a.g]!=s&&W(a,a.g+" multiply declared"),e={},e.name=a.g,e.Cb=s,e.p=0,e.domain=s,e.type=f,e.code=s,e.N=s,e.S=s,e.M=s,Y(a),a.b==nm&&(e.Cb=a.g,Y(a)),a.b==dn&&(e.domain=np(a),e.p=sp(e.domain)),f=a.W[e.name]={},f.type=Ll,f.link=e,a.b!=Wm&&W(a,"colon missing where expected"),Y(a),e.code=jp(a),e.code.type==V&&(e.code=Z(En,e.code,S,0)),e.code.type==S&&(e.code=Z(In,e.code,Sl,0)),e.code.type!=Sl&&
W(a,"expression following colon has invalid type"),e.domain!=s&&qp(a,e.domain),a.b!=Xm&&W(a,"syntax error in objective statement"),Y(a),d.F=e;else if(bp(a,"table")){b&&W(a,"table statement not allowed here");c.type=em;d=c.u;Y(a);a.b!=km&&(cp(a)?W(a,"invalid use of reserved keyword "+a.g):W(a,"symbolic name missing where expected"));a.W[a.g]!=s&&W(a,a.g+" multiply declared");e={u:{na:{},Mc:{}}};e.name=a.g;Y(a);a.b==nm?(e.Cb=a.g,Y(a)):e.Cb=s;a.b==dn?(e.type=$l,e.u.Mc.domain=np(a),bp(a,"OUT")||W(a,"keyword OUT missing where expected")):
(e.type=Ul,bp(a,"IN")||W(a,"keyword IN missing where expected"));Y(a);for(e.a=f=s;;)if(g={},(a.b==Vm||a.b==Wm||a.b==Xm)&&W(a,"argument expression missing where expected"),g.code=jp(a),g.code.type==S&&(g.code=Z(Fn,g.code,V,0)),g.code.type!=V&&W(a,"argument expression has invalid type"),g.next=s,f==s?e.a=g:f.next=g,f=g,a.b==Vm)Y(a);else if(a.b==Wm||a.b==Xm)break;a.b==Wm?Y(a):W(a,"colon missing where expected");switch(e.type){case Ul:a.b==km?(g=a.W[a.g],g==s&&W(a,a.g+" not defined"),g.type!=cm&&W(a,
a.g+" not a set"),e.u.na.set=g.link,e.u.na.set.assign!=s&&W(a,a.g+" needs no data"),0!=e.u.na.set.p&&W(a,a.g+" must be a simple set"),Y(a),a.b==hn?Y(a):W(a,"delimiter <- missing where expected")):cp(a)?W(a,"invalid use of reserved keyword "+a.g):e.u.na.set=s;e.u.na.Me=g=s;f=0;for(a.b==bn?Y(a):W(a,"field list missing where expected");;)if(j={},a.b!=km&&(cp(a)?W(a,"invalid use of reserved keyword "+a.g):W(a,"field name missing where expected")),j.name=a.g,Y(a),j.next=s,g==s?e.u.na.Me=j:g.next=j,g=j,
f++,a.b==Vm)Y(a);else if(a.b==cn)break;else W(a,"syntax error in field list");e.u.na.set!=s&&e.u.na.set.T!=f&&W(a,"there must be "+e.u.na.set.T+" field"+(1==e.u.na.set.T?"":"s")+" rather than "+f);Y(a);for(e.u.na.list=j=s;a.b==Vm;)Y(a),h={},a.b!=km&&(cp(a)?W(a,"invalid use of reserved keyword "+a.g):W(a,"parameter name missing where expected")),g=a.W[a.g],g==s&&W(a,a.g+" not defined"),g.type!=am&&W(a,a.g+" not a parameter"),h.P=g.link,h.P.p!=f&&W(a,a.g+" must have "+f+" subscript"+(1==f?"":"s")+" rather than "+
h.P.p),h.P.assign!=s&&W(a,a.g+" needs no data"),Y(a),a.b==gn?(Y(a),a.b!=km&&(cp(a)?W(a,"invalid use of reserved keyword "+a.g):W(a,"field name missing where expected")),g=a.g,Y(a)):g=h.P.name,h.name=g,h.next=s,j==s?e.u.na.list=h:j.next=h,j=h;break;case $l:for(e.u.Mc.list=f=s;;)if(j={},(a.b==Vm||a.b==Xm)&&W(a,"expression missing where expected"),g=a.b==km?a.g:"",j.code=jp(a),a.b==gn&&(Y(a),a.b!=km&&(cp(a)?W(a,"invalid use of reserved keyword "+a.g):W(a,"field name missing where expected")),g=a.g,Y(a)),
""==g&&W(a,"field name required"),j.name=g,j.next=s,f==s?e.u.Mc.list=j:f.next=j,f=j,a.b==Vm)Y(a);else if(a.b==Xm)break;else W(a,"syntax error in output list");qp(a,e.u.Mc.domain)}a.b!=Xm&&W(a,"syntax error in table statement");Y(a);d.mf=e}else if(bp(a,"solve"))b&&W(a,"solve statement not allowed here"),c.type=dm,d=c.u,a.Ib&&W(a,"at most one solve statement allowed"),a.Ib=1,Y(a),a.b!=Xm&&W(a,"syntax error in solve statement"),Y(a),d.nh=s;else if(bp(a,"check"))c.type=Kl,d=c.u,e={domain:s,code:s},Y(a),
a.b==dn&&(e.domain=np(a)),a.b==Wm&&Y(a),e.code=pp(a),e.code.type!=Wl&&W(a,"expression has invalid type"),e.domain!=s&&qp(a,e.domain),a.b!=Xm&&W(a,"syntax error in check statement"),Y(a),d.Fg=e;else if(bp(a,"display")){c.type=Ml;d=c.u;f={domain:s};f.list=e=s;Y(a);a.b==dn&&(f.domain=np(a));for(a.b==Wm&&Y(a);;){var z={u:{}},g=function(){z.type=Ql;z.u.code=pp(a)};z.type=0;z.next=s;f.list==s?f.list=z:e.next=z;e=z;if(a.b==km)if(Y(a),j=a.b,ap(a),j==Vm||j==Xm){g=a.W[a.g];g==s&&W(a,a.g+" not defined");z.type=
g.type;switch(g.type){case Tl:z.u.ua=g.link;break;case cm:z.u.set=g.link;break;case am:z.u.P=g.link;break;case gm:z.u.s=g.link;a.Ib||W(a,"invalid reference to variable "+z.u.s.name+" above solve statement");break;case Ll:z.u.F=g.link,a.Ib||W(a,"invalid reference to "+(z.u.F.type==Ll?"constraint":"objective")+" "+z.u.F.name+" above solve statement")}Y(a)}else g();else g();if(a.b==Vm)Y(a);else break}f.domain!=s&&qp(a,f.domain);a.b!=Xm&&W(a,"syntax error in display statement");Y(a);d.Gg=f}else if(bp(a,
"printf")){c.type=bm;d=c.u;g={domain:s,td:s};g.list=f=s;Y(a);a.b==dn&&(g.domain=np(a));a.b==Wm&&Y(a);g.td=jp(a);g.td.type==S&&(g.td=Z(Fn,g.td,V,0));for(g.td.type!=V&&W(a,"format expression has invalid type");a.b==Vm;)Y(a),e={code:s,next:s},g.list==s?g.list=e:f.next=e,f=e,e.code=op(a),e.code.type==S||(e.code.type==V||e.code.type==Wl)||W(a,"only numeric, symbolic, or logical expression allowed");g.domain!=s&&qp(a,g.domain);g.Td=s;g.Ag=0;if(a.b==Qm||a.b==fn)g.Ag=a.b==fn,Y(a),g.Td=jp(a),g.Td.type==S&&
(g.Td=Z(Fn,g.Td,V,0)),g.Td.type!=V&&W(a,"file name expression has invalid type");a.b!=Xm&&W(a,"syntax error in printf statement");Y(a);d.$g=g}else if(bp(a,"for")){c.type=Rl;d=c.u;g={domain:s};g.list=f=s;Y(a);a.b!=dn&&W(a,"indexing expression missing where expected");g.domain=np(a);a.b==Wm&&Y(a);if(a.b!=dn)g.list=Jp(a,1);else{for(Y(a);a.b!=en;)e=Jp(a,1),f==s?g.list=e:f.next=e,f=e;Y(a)}qp(a,g.domain);d.Ig=g}else a.b==km?(b&&W(a,"constraint statement not allowed here"),c.type=Ll,c.u.F=Gp(a)):cp(a)?W(a,
"invalid use of reserved keyword "+a.g):W(a,"syntax error in model section");return c}function Kp(a,b){var c,d={};d.U=b;d.next=s;if(a==s)a=d;else{for(c=a;c.next!=s;c=c.next);c.next=d}return a}function Lp(a){for(var b=0;a!=s;a=a.next)b++;return b}function Mp(a){for(var b=0;a!=s;a=a.next)a.U==s&&b++;return b}function Np(a){for(var b=s;0<a--;)b=Kp(b,s);return b}function Op(a){return a.b==mm||a.b==lm||a.b==nm}function Ip(a,b){return Op(a)&&a.g==b}
function Pp(a){var b;b=a.b==mm?Qp(a.value):Rp(a.g);Y(a);return b}
function Sp(a,b,c){var d,e;switch(a.b){case bn:e=cn;break;case $m:e=an}0==c&&W(a,b+" cannot be subscripted");Y(a);for(d=s;;)if(Op(a)?d=Kp(d,Pp(a)):a.b==Jm?(d=Kp(d,s),Y(a)):W(a,"number, symbol, or asterisk missing where expected"),a.b==Vm)Y(a);else if(a.b==e)break;else W(a,"syntax error in slice");if(Lp(d)!=c)switch(e){case cn:W(a,b+" must have "+c+" subscript"+(1==c?"":"s")+", not "+Lp(d));break;case an:W(a,b+" has dimension "+c+", not "+Lp(d))}Y(a);return d}
function Tp(a,b){var c;c=a.W[b];(c==s||c.type!=cm)&&W(a,b+" not a set");c=c.link;(c.assign!=s||c.Vc!=s)&&W(a,b+" needs no data");c.data=1;return c}function Up(a,b,c){var d,e,f=s;for(d=s;c!=s;c=c.next)c.U==s?(Op(a)||(e=Mp(c),1==e?W(a,"one item missing in data group beginning with "+Vp(f)):W(a,e+" items missing in data group beginning with "+Vp(f))),e=Pp(a),f==s&&(f=e)):e=Wp(c.U),d=Xp(d,e),c.next!=s&&a.b==Vm&&Y(a);Yp(a,b.value.set,d)}
function Zp(a,b,c,d){var e,f,g,j,h;for(e=s;a.b!=Ym;)Op(a)||W(a,"number, symbol, or := missing where expected"),e=Kp(e,Pp(a));for(Y(a);Op(a);){h=Pp(a);for(f=e;f!=s;f=f.next){var l=0;if(!Ip(a,"+"))if(Ip(a,"-")){Y(a);continue}else g=Lp(f),1==g?W(a,"one item missing in data group beginning with "+Vp(h)):W(a,g+" items missing in data group beginning with "+Vp(h));j=s;for(g=c;g!=s;g=g.next)if(g.U==s)switch(++l){case 1:j=Xp(j,Wp(d?f.U:h));break;case 2:j=Xp(j,Wp(d?h:f.U))}else j=Xp(j,Wp(g.U));Yp(a,b.value.set,
j);Y(a)}}}
function $p(a){function b(){W(a,"slice currently used must specify 2 asterisks, not "+Mp(j))}function c(){W(a,"transpose indicator (tr) incomplete")}function d(){Y(a);Ip(a,"tr")||c();2!=Mp(j)&&b();Y(a);a.b!=an&&c();Y(a);a.b==Wm&&Y(a);h=1;Zp(a,g,j,h)}var e,f,g,j,h=0;Y(a);Op(a)||W(a,"set name missing where expected");e=Tp(a,a.g);Y(a);f=s;if(a.b==bn){0==e.p&&W(a,e.name+" cannot be subscripted");for(Y(a);;)if(Op(a)||W(a,"number or symbol missing where expected"),f=Xp(f,Pp(a)),a.b==Vm)Y(a);else if(a.b==cn)break;
else W(a,"syntax error in subscript list");e.p!=aq(f)&&W(a,e.name+" must have "+e.p+" subscript"+(1==e.p?"":"s")+" rather than "+aq(f));Y(a)}else 0!=e.p&&W(a,e.name+" must be subscripted");bq(e.M,f)!=s&&W(a,e.name+cq("[",f)+" already defined");g=dq(e.M,f);g.value.set=eq(a,Zl,e.T);for(j=Np(e.T);;)if(a.b==Vm&&Y(a),a.b==Ym)Y(a);else if(a.b==$m)Y(a),f=Ip(a,"tr"),ap(a),f?d():(j=Sp(a,e.name,e.T),h=0,0==Mp(j)&&Up(a,g,j));else if(Op(a))Up(a,g,j);else if(a.b==Wm)2!=Mp(j)&&b(),Y(a),Zp(a,g,j,h);else if(a.b==
$m)d();else if(a.b==Xm){Y(a);break}else W(a,"syntax error in set data block")}function fq(a,b){var c;c=a.W[b];(c==s||c.type!=am)&&W(a,b+" not a parameter");c=c.link;c.assign!=s&&W(a,b+" needs no data");c.data&&W(a,b+" already provided with data");c.data=1;return c}function gq(a,b,c){b.ta!=s&&W(a,"default value for "+b.name+" already specified in model section");b.Tc=c}
function hq(a,b,c){bq(b.M,c)!=s&&W(a,b.name+cq("[",c)+" already defined");c=dq(b.M,c);switch(b.type){case S:case Vl:case Il:a.b==mm||W(a,b.name+" requires numeric data");b=c.value;c=a.value;Y(a);b.O=c;break;case V:c.value.U=Pp(a)}}
function iq(a,b,c,d){var e,f,g,j,h;for(e=s;a.b!=Ym;)Op(a)||W(a,"number, symbol, or := missing where expected"),e=Kp(e,Pp(a));for(Y(a);Op(a);){h=Pp(a);for(f=e;f!=s;f=f.next){var l=0;if(Ip(a,"."))Y(a);else{j=s;for(g=c;g!=s;g=g.next)if(g.U==s)switch(++l){case 1:j=Xp(j,Wp(d?f.U:h));break;case 2:j=Xp(j,Wp(d?h:f.U))}else j=Xp(j,Wp(g.U));Op(a)||(g=Lp(f),1==g?W(a,"one item missing in data group beginning with "+Vp(h)):W(a,g+" items missing in data group beginning with "+Vp(h)));hq(a,b,j)}}}}
function jq(a){function b(){W(a,e.name+" not a subscripted parameter")}function c(){W(a,"slice currently used must specify 2 asterisks, not "+Mp(g))}function d(){W(a,"transpose indicator (tr) incomplete")}var e,f=s,g,j=0;Y(a);Ip(a,"default")&&(Y(a),Op(a)||W(a,"default value missing where expected"),f=Pp(a),a.b!=Wm&&W(a,"colon missing where expected"));if(a.b==Wm){Y(a);a.b==Vm&&Y(a);var j=a,h=f,f=s,l,m,n=0,p=s;Op(j)&&(Y(j),m=j.b,ap(j),m==Wm&&(f=Tp(j,j.g),0!=f.p&&W(j,f.name+" must be a simple set"),
f.M.head!=s&&W(j,f.name+" already defined"),dq(f.M,s).value.set=eq(j,Zl,f.T),p=f.name,n=f.T,Y(j),Y(j)));for(m=s;j.b!=Ym;)Op(j)||W(j,"parameter name or := missing where expected"),l=fq(j,j.g),0==l.p&&W(j,j.g+" not a subscripted parameter"),0!=n&&l.p!=n&&W(j,p+" has dimension "+n+" while "+l.name+" has dimension "+l.p),h!=s&&gq(j,l,Wp(h)),m=Kp(m,l),p=l.name,n=l.p,Y(j),j.b==Vm&&Y(j);0==Lp(m)&&W(j,"at least one parameter name required");Y(j);for(j.b==Vm&&Y(j);Op(j);){h=s;for(l=1;l<=n;l++)Op(j)||(p=Lp(m)+
n-l+1,W(j,p+" items missing in data group beginning with "+Vp(h.U))),h=Xp(h,Pp(j)),l<n&&j.b==Vm&&Y(j);f!=s&&Yp(j,f.M.head.value.set,kq(h));j.b==Vm&&Y(j);for(l=m;l!=s;l=l.next)Ip(j,".")?Y(j):(Op(j)||(p=Lp(l),1==p?W(j,"one item missing in data group beginning with "+Vp(h.U)):W(j,p+" items missing in data group beginning with "+Vp(h.U))),hq(j,l.U,kq(h)),l.next!=s&&j.b==Vm&&Y(j));j.b==Vm&&(Y(j),Op(j)||ap(j))}for(l=m;l!=s;l=l.next)l.U=s;a.b!=Xm&&W(a,"symbol, number, or semicolon missing where expected");
Y(a)}else{Op(a)||W(a,"parameter name missing where expected");e=fq(a,a.g);Y(a);Ip(a,"default")&&(Y(a),Op(a)||W(a,"default value missing where expected"),f=Pp(a),gq(a,e,f));for(g=Np(e.p);;)if(a.b==Vm&&Y(a),a.b==Ym)Y(a);else if(a.b==bn)g=Sp(a,e.name,e.p),j=0;else if(Op(a)){f=a;n=e;p=h=m=k;m=l=s;for(h=g;h!=s;h=h.next)h.U==s?(Op(f)||W(f,Mp(h)+1+" items missing in data group beginning with "+Vp(l)),p=Pp(f),l==s&&(l=p)):p=Wp(h.U),m=Xp(m,p),f.b==Vm&&Y(f);Op(f)||W(f,"one item missing in data group beginning with "+
Vp(l));hq(f,n,m)}else if(a.b==Wm)0==e.p&&b(),2!=Mp(g)&&c(),Y(a),iq(a,e,g,j);else if(a.b==$m)Y(a),Ip(a,"tr")||d(),0==e.p&&b(),2!=Mp(g)&&c(),Y(a),a.b!=an&&d(),Y(a),a.b==Wm&&Y(a),j=1,iq(a,e,g,j);else if(a.b==Xm){Y(a);break}else W(a,"syntax error in parameter data block")}}function lq(a){for(;!(a.b==jm||Ip(a,"end"));)Ip(a,"set")?$p(a):Ip(a,"param")?jq(a):W(a,"syntax error in data section")}
function mq(a,b,c){(0<b&&0<c&&b>0.999*v-c||0>b&&0>c&&b<-0.999*v-c)&&W(a,b+" + "+c+"; floating-point overflow");return b+c}function nq(a,b,c){(0<b&&0>c&&b>0.999*v+c||0>b&&0<c&&b<-0.999*v+c)&&W(a,b+" - "+c+"; floating-point overflow");return b-c}function oq(a,b,c){1<Math.abs(c)&&Math.abs(b)>0.999*v/Math.abs(c)&&W(a,b+" * "+c+"; floating-point overflow");return b*c}
function pq(a,b,c){Math.abs(c)<ma&&W(a,b+" / "+c+"; floating-point zero divide");1>Math.abs(c)&&Math.abs(b)>0.999*v*Math.abs(c)&&W(a,b+" / "+c+"; floating-point overflow");return b/c}function qq(a,b,c){c!=Math.floor(c)&&W(a,"round("+b+", "+c+"); non-integer second argument");c<=na+2&&(a=Math.pow(10,c),Math.abs(b)<0.999*v/a&&(b=Math.floor(b*a+0.5),0!=b&&(b/=a)));return b}
function rq(a,b,c){c!=Math.floor(c)&&W(a,"trunc("+b+", "+c+"); non-integer second argument");c<=na+2&&(a=Math.pow(10,c),Math.abs(b)<0.999*v/a&&(b=0<=b?Math.floor(b*a):Math.ceil(b*a),0!=b&&(b/=a)));return b}function sq(a){var b,c;do b=-1+2*(Al(a.Ad)/2147483648),c=-1+2*(Al(a.Ad)/2147483648),b=b*b+c*c;while(1<b||0==b);return c*Math.sqrt(-2*Math.log(b)/b)}function Qp(a){var b={};b.O=a;b.K=s;return b}function Rp(a){var b={O:0};b.K=a;return b}
function Wp(a){var b={};a.K==s?(b.O=a.O,b.K=s):(b.O=0,b.K=a.K);return b}function tq(a,b){return a.K==s&&b.K==s?a.O<b.O?-1:a.O>b.O?1:0:a.K==s?-1:b.K==s?1:a.K==b.K?0:a.K>b.K?1:-1}
function Vp(a){var b;if(a.K==s)b=String(a.O);else{var c,d,e=a.K;if(fb(e[0])||"_"==e[0]){a=ia;for(c=1;c<e.length;c++)if(!(qb(e[c])||0<="+-._".indexOf(e[c]))){a=aa;break}}else a=aa;b="";d=0;var f=function(a){255>d&&(b+=a,d++)};a&&f("'");for(c=0;c<e.length;c++)a&&"'"==e[c]&&f("'"),f(e[c]);a&&f("'");255==d&&(b=b.slice(0,252)+"...")}return b}function Xp(a,b){var c,d={};d.U=b;d.next=s;if(a==s)a=d;else{for(c=a;c.next!=s;c=c.next);c.next=d}return a}function aq(a){for(var b=0;a!=s;a=a.next)b++;return b}
function kq(a){var b,c;if(a==s)b=s;else{for(b=c={};a!=s;a=a.next)c.U=Wp(a.U),a.next!=s&&(c=c.next={});c.next=s}return b}function uq(a,b){var c,d,e;c=a;for(d=b;c!=s;c=c.next,d=d.next)if(e=tq(c.U,d.U),0!=e)return e;return 0}function vq(a,b){for(var c=s,d=1,e=a;d<=b;d++,e=e.next)c=Xp(c,Wp(e.U));return c}
function cq(a,b){function c(a){255>f&&(g+=a);f++}var d,e,f=0,g="",j="",h=aq(b);"["==a&&0<h&&c("[");"("==a&&1<h&&c("(");for(d=b;d!=s;d=d.next){d!=b&&c(",");j=Vp(d.U);for(e=0;e<j.length;e++)c(j[e])}"["==a&&0<h&&c("]");"("==a&&1<h&&c(")");255==f&&(g=g.slice(0,252)+"...");return g}function wq(a,b){dq(a,b).value.Sg=s}function Yp(a,b,c){bq(b,c)!=s&&W(a,"duplicate tuple "+cq("(",c)+" detected");wq(b,c)}function xq(a,b){var c,d;c=eq(a,Zl,b.p);for(d=b.head;d!=s;d=d.next)wq(c,kq(d.v));return c}
function yq(a,b,c,d){var e;0==d&&W(a,b+" .. "+c+" by "+d+"; zero stride not allowed");e=0<c&&0>b&&c>0.999*v+b?+v:0>c&&0<b&&c<-0.999*v+b?-v:c-b;1>Math.abs(d)&&Math.abs(e)>0.999*v*Math.abs(d)?e=0<e&&0<d||0>e&&0>d?+v:0:(e=Math.floor(e/d)+1,0>e&&(e=0));e>pa-1&&W(a,b+" .. "+c+" by "+d+"; set too large");return e+0.5|0}function zq(a,b,c,d,e){1<=e&&yq(a,b,c,d);return b+(e-1)*d}function Aq(a){var b;0==a?b=s:(b={},b.t=a,b.s=s,b.next=s);return b}
function Bq(a){var b,c;if(a==s)b=s;else{for(b=c={};a!=s;a=a.next)c.t=a.t,c.s=a.s,a.next!=s&&(c=c.next={});c.next=s}return b}
function Cq(a,b,c,d,e){var f=s,g,j=0;for(g=c;g!=s;g=g.next)g.s==s?j=mq(a,j,oq(a,b,g.t)):g.s.fa=mq(a,g.s.fa,oq(a,b,g.t));for(g=e;g!=s;g=g.next)g.s==s?j=mq(a,j,oq(a,d,g.t)):g.s.fa=mq(a,g.s.fa,oq(a,d,g.t));for(g=c;g!=s;g=g.next)g.s!=s&&0!=g.s.fa&&(a={},a.t=g.s.fa,a.s=g.s,a.next=f,f=a,g.s.fa=0);for(g=e;g!=s;g=g.next)g.s!=s&&0!=g.s.fa&&(a={},a.t=g.s.fa,a.s=g.s,a.next=f,f=a,g.s.fa=0);0!=j&&(a={},a.t=j,a.s=s,a.next=f,f=a);return f}
function Dq(a,b,c){for(var d=s,e,f=0;b!=s;)e=b,b=b.next,e.s==s?f=mq(a,f,e.t):(e.next=d,d=e);c(f);return d}function Eq(a,b){switch(a){case Zl:b.Sg=s;break;case S:b.O=0;break;case V:b.U=s;break;case Wl:b.hg=0;break;case fm:b.v=s;break;case Ol:b.set=s;break;case Pl:b.s=s;break;case Sl:b.form=s;break;case Nl:b.F=s}}function eq(a,b,c){var d={};d.type=b;d.p=c;d.size=0;d.head=s;d.Sa=s;d.W=ia;d.aa=s;d.next=a.eg;d.next!=s&&(d.next.aa=d);return a.eg=d}
function bq(a,b){var c;if(30<a.size&&!a.W)for(c=a.head;c!=s;c=c.next)c.v.$=c;if(a.W)c=b.$,c=c==s?s:c.link;else for(c=a.head;c!=s&&0!=uq(c.v,b);c=c.next);return c}function dq(a,b){var c={};c.v=b;c.next=s;c.value={};a.size++;a.head==s?a.head=c:a.Sa.next=c;a.Sa=c;a.W&&(c.v.$=c);return c}
function Gq(a){var b;if(a.Be!=s){b=a.list;for(a=a.Be;b!=s;b=b.next,a=a.next)a:{var c=b,d=a.U,e=k,f=k;if(c.value!=s){if(0==tq(c.value,d))break a;c.value=s}for(e=c.list;e!=s;e=e.a.index.next)for(f=e;f!=s;f=f.ga)f.valid&&(f.valid=0,Eq(f.type,f.value));c.value=Wp(d)}}}function Iq(a,b,c,d,e){var f,g=0;if(!Jq(a,b.code,c))return 1;f=b.Be;b.Be=c;Gq(b);e(a,d);b.Be=f;Gq(b);return g}
function Kq(a,b){if(b.Ic!=s){var c,d,e=s,f=s;c=b.Ic;b.Ic=c.next;for(d=c.list;d!=s;d=d.next)e==s?e=f={}:f=f.next={},d.code==s?(f.U=b.v.U,b.v=b.v.next):f.U=Lq(a,d.code);f.next=s;Iq(a,c,e,b,Kq)&&(b.Le=1);for(d=c.list;d!=s;d=d.next)e=e.next}else b.domain.code!=s&&!Mq(a,b.domain.code)?b.Le=2:b.Ud(a,b.info)}function Nq(a,b,c,d,e){var f={};b==s?(e(a,d),f.Le=0):(f.domain=b,f.Ic=b.list,f.v=c,f.info=d,f.Ud=e,f.Le=0,Kq(a,f));return f.Le}
function Oq(a,b){if(b.Ic!=s){var c,d,e;c=b.Ic;b.Ic=c.next;e=s;for(d=c.list;d!=s;d=d.next)d.code!=s&&(e=Xp(e,Lq(a,d.code)));if(c.code.Pa==Jo){var f,g,j,h;g=$(a,c.code.a.a.x);j=$(a,c.code.a.a.y);h=c.code.a.a.Ka==s?1:$(a,c.code.a.a.Ka);e=yq(a,g,j,h);d=Xp(s,Qp(0));for(f=1;f<=e&&b.Nf;f++)d.U.O=zq(a,g,j,h,f),Iq(a,c,d,b,Oq)}else for(f=Pq(a,c.code).head;f!=s&&b.Nf;f=f.next){g=f.v;j=e;h=ia;for(d=c.list;d!=s;d=d.next){if(d.code!=s){if(0!=tq(g.U,j.U)){h=aa;break}j=j.next}g=g.next}h||Iq(a,c,f.v,b,Oq)}b.Ic=c}else if(b.domain.code==
s||Mq(a,b.domain.code))b.Nf=!b.Ud(a,b.info)}function Qq(a,b,c,d){var e={};b==s?d(a,c):(e.domain=b,e.Ic=b.list,e.Nf=1,e.info=c,e.Ud=d,Oq(a,e))}function Rq(a,b,c){W(a,b+cq("[",c)+" out of domain")}function Sq(a){var b=s;if(a!=s)for(a=a.list;a!=s;a=a.next)for(var c=a.list;c!=s;c=c.next)c.code==s&&(b=Xp(b,Wp(c.value)));return b}
function Tq(a,b,c,d){for(var e=b.rf,f=1;e!=s;e=e.next,f++)for(var g=d.head;g!=s;g=g.next)if(!Jq(a,e.code,g.v)){var j=cq("(",g.v);W(a,b.name+cq("[",c)+" contains "+j+" which not within specified set; see ("+f+")")}}function Uq(a,b){if(b.$!=s)Tq(a,b.set,b.$.v,b.$.value.set);else{var c=b.set,d=b.v,e=function(){Tq(a,c,d,f);g=dq(c.M,kq(d));g.value.set=f},f,g=bq(c.M,d);g!=s?f=g.value.set:c.assign!=s?(f=Pq(a,c.assign),e()):c.ta!=s?(f=Pq(a,c.ta),e()):W(a,"no value for "+c.name+cq("[",d));b.he=f}}
function Vq(a,b){var c=b.Vc,d,e,f,g=Array(20);B("Generating "+b.name+"...");d=c.set;Qq(a,d.domain,d,Wq);for(d=c.set.M.head.value.set.head;d!=s;d=d.next){f=kq(d.v);for(e=0;e<c.set.T;e++)g[e]=s;for(e=0;f!=s;f=f.next)g[c.X[e++]-1]=f;for(e=0;e<c.set.T;e++)g[e].next=g[e+1];0==b.p?f=s:(f=g[0],g[b.p-1].next=s);e=bq(b.M,f);e==s&&(e=dq(b.M,f),e.value.set=eq(a,Zl,b.T));f=g[b.p];g[c.set.T-1].next=s;wq(e.value.set,f)}b.data=1}
function Xq(a,b,c){var d={};d.set=b;d.v=c;b.Vc!=s&&0==b.data&&Vq(a,b);if(1==b.data){c=b.M.Sa;b.data=2;for(d.$=b.M.head;d.$!=s&&!(Nq(a,b.domain,d.$.v,d,Uq)&&Rq(a,b.name,d.$.v),d.$==c);d.$=d.$.next);}d.$=s;Nq(a,d.set.domain,d.v,d,Uq)&&Rq(a,b.name,d.v);return d.he}function Wq(a,b){var c=Sq(b.domain);Xq(a,b,c);return 0}
function Yq(a,b,c,d){var e,f;switch(b.type){case Vl:d!=Math.floor(d)&&W(a,b.name+cq("[",c)+" = "+d+" not integer");break;case Il:0==d||1==d||W(a,b.name+cq("[",c)+" = "+d+" not binary")}e=b.qd;for(f=1;e!=s;e=e.next,f++){var g;g=$(a,e.code);var j=function(e){W(a,b.name+cq("[",c)+" = "+d+" not "+e+" "+g+"; see ("+f+")")};switch(e.dd){case oo:d<g||j("<");break;case po:d<=g||j("<=");break;case ro:d!=g&&j("=");break;case so:d>=g||j(">=");break;case to:d>g||j(">");break;case uo:d==g&&j("<>")}}f=1;for(e=
b.na;e!=s;e=e.next,f++)j=Xp(s,Qp(d)),Jq(a,e.code,j)||W(a,b.name+cq("[",c)+" = "+d+" not in specified set; see ("+f+")")}function Zq(a,b,c){function d(d){Yq(a,b,c,d);e=dq(b.M,kq(c));return e.value.O=d}var e=bq(b.M,c);return e!=s?e.value.O:b.assign!=s?d($(a,b.assign)):b.ta!=s?d($(a,b.ta)):b.Tc!=s?(b.Tc.K!=s&&W(a,"cannot convert "+Vp(b.Tc)+" to floating-point number"),d(b.Tc.O)):W(a,"no value for "+b.name+cq("[",c))}function $q(a,b){b.$!=s?Yq(a,b.P,b.$.v,b.$.value.O):b.value=Zq(a,b.P,b.v)}
function ar(a,b,c){var d={};d.P=b;d.v=c;if(1==b.data){c=b.M.Sa;b.data=2;for(d.$=b.M.head;d.$!=s&&!(Nq(a,b.domain,d.$.v,d,$q)&&Rq(a,b.name,d.$.v),d.$==c);d.$=d.$.next);}d.$=s;Nq(a,d.P.domain,d.v,d,$q)&&Rq(a,b.name,d.v);return d.value}
function br(a,b,c,d){var e,f=1;for(e=b.qd;e!=s;e=e.next,f++){var g;g=Lq(a,e.code);switch(e.dd){case oo:0>tq(d,g)||(g=Vp(g),W(a,b.name+cq("[",c)+" = "+Vp(d)+" not < "+g));break;case po:0>=tq(d,g)||(g=Vp(g),W(a,b.name+cq("[",c)+" = "+Vp(d)+" not <= "+g));break;case ro:0!=tq(d,g)&&(g=Vp(g),W(a,b.name+cq("[",c)+" = "+Vp(d)+" not = "+g));break;case so:0<=tq(d,g)||(g=Vp(g),W(a,b.name+cq("[",c)+" = "+Vp(d)+" not >= "+g));break;case to:0<tq(d,g)||(g=Vp(g),W(a,b.name+cq("[",c)+" = "+Vp(d)+" not > "+g));break;
case uo:0==tq(d,g)&&(g=Vp(g),W(a,b.name+cq("[",c)+" <> "+Vp(d)+" not > "+g))}}f=1;for(e=b.na;e!=s;e=e.next,f++)g=Xp(s,Wp(d)),Jq(a,e.code,g)||W(a,b.name,cq("[",c)+" = "+Vp(d)+" not in specified set; see ("+f+")")}
function cr(a,b){if(b.$!=s)br(a,b.P,b.$.v,b.$.value.U);else{var c,d=b.P,e=b.v;c=function(b){br(a,d,e,b);f=dq(d.M,kq(e));f.value.U=Wp(b);return b};var f=bq(d.M,e);c=f!=s?Wp(f.value.U):d.assign!=s?c(Lq(a,d.assign)):d.ta!=s?c(Lq(a,d.ta)):d.Tc!=s?Wp(d.Tc):W(a,"no value for "+d.name+cq("[",e));b.value=c}}
function dr(a,b,c){var d={};d.P=b;d.v=c;if(1==b.data){c=b.M.Sa;b.data=2;for(d.$=b.M.head;d.$!=s&&!(Nq(a,b.domain,d.$.v,d,cr)&&Rq(a,b.name,d.$.v),d.$==c);d.$=d.$.next);}d.$=s;Nq(a,d.P.domain,d.v,d,cr)&&Rq(a,b.name,d.v);return d.value}function er(a,b){var c=Sq(b.domain);switch(b.type){case S:case Vl:case Il:ar(a,b,c);break;case V:dr(a,b,c)}return 0}
function fr(a,b){var c=b.s,d=b.v,e=bq(c.M,d);e!=s?d=e.value.s:(e=dq(c.M,kq(d)),d=e.value.s={},d.A=0,d.s=c,d.$=e,d.N=c.N==s?0:$(a,c.N),d.S=c.S==s?0:c.S==c.N?d.N:$(a,c.S),d.fa=0,d.l=0,d.q=d.H=0);b.he=d}function gr(a,b,c){var d={};d.s=b;d.v=c;Nq(a,d.s.domain,d.v,d,fr)&&Rq(a,b.name,d.v);return d.he}
function hr(a,b){var c=b.F,d=b.v,e=s,f=bq(c.M,d);if(f!=s)d=f.value.F;else{f=dq(c.M,kq(d));d=f.value.F={};d.ca=0;d.F=c;d.$=f;d.form=ir(a,c.code);if(c.N==s&&c.S==s)d.form=Dq(a,d.form,function(a){e=a}),d.N=d.S=-e;else if(c.N!=s&&c.S==s)d.form=Cq(a,1,d.form,-1,ir(a,c.N)),d.form=Dq(a,d.form,function(a){e=a}),d.N=-e,d.S=0;else if(c.N==s&&c.S!=s)d.form=Cq(a,1,d.form,-1,ir(a,c.S)),d.form=Dq(a,d.form,function(a){e=a}),d.N=0,d.S=-e;else if(c.N==c.S)d.form=Cq(a,1,d.form,-1,ir(a,c.N)),d.form=Dq(a,d.form,function(a){e=
a}),d.N=d.S=-e;else{var g=s,j=s;d.form=Dq(a,d.form,function(a){e=a});Dq(a,ir(a,c.N),function(a){g=a});Dq(a,ir(a,c.S),function(a){j=a});d.N=nq(a,g,e);d.S=nq(a,j,e)}d.l=0;d.q=d.H=0}b.he=d}function jr(a,b,c){var d={};d.F=b;d.v=c;Nq(a,d.F.domain,d.v,d,hr)&&Rq(a,b.name,d.v);return d.he}function kr(a,b){var c=Sq(b.domain);jr(a,b,c);return 0}
function lr(a,b){var c=$(a,b.code.a.loop.x);switch(b.code.Pa){case Oo:b.value=mq(a,b.value,c);break;case Po:b.value=oq(a,b.value,c);break;case Qo:b.value>c&&(b.value=c);break;case Ro:b.value<c&&(b.value=c)}return 0}
function $(a,b){var c,d,e,f;b.Q&&b.valid&&(b.valid=0,Eq(b.type,b.value));if(b.valid)return b.value.O;switch(b.Pa){case pn:c=b.a.O;break;case sn:d=s;for(e=b.a.P.list;e!=s;e=e.next)d=Xp(d,Lq(a,e.x));c=ar(a,b.a.P.P,d);break;case vn:d=s;for(e=b.a.s.list;e!=s;e=e.next)d=Xp(d,Lq(a,e.x));e=gr(a,b.a.s.s,d);switch(b.a.s.zc){case kn:c=e.s.N==s?-v:e.N;break;case ln:c=e.s.S==s?+v:e.S;break;case mn:c=e.l;break;case nn:c=e.q;break;case on:c=e.H}break;case wn:d=s;for(e=b.a.F.list;e!=s;e=e.next)d=Xp(d,Lq(a,e.x));
e=jr(a,b.a.F.F,d);switch(b.a.F.zc){case kn:c=e.F.N==s?-v:e.N;break;case ln:c=e.F.S==s?+v:e.S;break;case mn:c=e.l;break;case nn:c=e.q;break;case on:c=e.H}break;case An:e=a.Ad;do d=Al(e);while(2147483648<=d);c=d%16777216;break;case Bn:c=Al(a.Ad)/2147483648;break;case Cn:c=sq(a);break;case Dn:c=Math.round(Date.now()/1E3);break;case En:d=Lq(a,b.a.a.x);d.K==s?c=d.O:Cl(d.K,function(a){c=a})&&W(a,"cannot convert "+Vp(d)+" to floating-point number");break;case Jn:c=+$(a,b.a.a.x);break;case Kn:c=-$(a,b.a.a.x);
break;case Mn:c=Math.abs($(a,b.a.a.x));break;case Nn:c=Math.ceil($(a,b.a.a.x));break;case On:c=Math.floor($(a,b.a.a.x));break;case Pn:e=$(a,b.a.a.x);e>0.999*Math.log(v)&&W(a,"exp("+e+"); floating-point overflow");c=Math.exp(e);break;case Qn:e=$(a,b.a.a.x);0>=e&&W(a,"log("+e+"); non-positive argument");c=Math.log(e);break;case Rn:e=$(a,b.a.a.x);0>=e&&W(a,"log10("+e+"); non-positive argument");c=Math.log(e)/Math.LN10;break;case Sn:e=$(a,b.a.a.x);0>e&&W(a,"sqrt("+e+"); negative argument");c=Math.sqrt(e);
break;case Tn:e=$(a,b.a.a.x);-1E6<=e&&1E6>=e||W(a,"sin("+e+"); argument too large");c=Math.sin(e);break;case Un:e=$(a,b.a.a.x);-1E6<=e&&1E6>=e||W(a,"cos("+e+"); argument too large");c=Math.cos(e);break;case Vn:e=$(a,b.a.a.x);c=Math.atan(e);break;case io:e=$(a,b.a.a.x);d=$(a,b.a.a.y);c=Math.atan2(e,d);break;case Wn:c=qq(a,$(a,b.a.a.x),0);break;case jo:c=qq(a,$(a,b.a.a.x),$(a,b.a.a.y));break;case Xn:c=rq(a,$(a,b.a.a.x),0);break;case ko:c=rq(a,$(a,b.a.a.x),$(a,b.a.a.y));break;case $n:c=mq(a,$(a,b.a.a.x),
$(a,b.a.a.y));break;case ao:c=nq(a,$(a,b.a.a.x),$(a,b.a.a.y));break;case bo:e=$(a,b.a.a.x);d=$(a,b.a.a.y);e<d?c=0:(0<e&&(0>d&&e>0.999*v+d)&&W(a,e+" less "+d+"; floating-point overflow"),c=e-d);break;case co:c=oq(a,$(a,b.a.a.x),$(a,b.a.a.y));break;case eo:c=pq(a,$(a,b.a.a.x),$(a,b.a.a.y));break;case fo:e=$(a,b.a.a.x);d=$(a,b.a.a.y);Math.abs(d)<ma&&W(a,e+" div "+d+"; floating-point zero divide");1>Math.abs(d)&&Math.abs(e)>0.999*v*Math.abs(d)&&W(a,e+" div "+d+"; floating-point overflow");e/=d;c=0<e?
Math.floor(e):0>e?Math.ceil(e):0;break;case go:e=$(a,b.a.a.x);d=$(a,b.a.a.y);if(0==e)f=0;else if(0==d)f=e;else if(f=Math.abs(e)%Math.abs(d),0!=f&&(0>e&&(f=-f),0<e&&0>d||0>e&&0<d))f+=d;c=f;break;case ho:e=$(a,b.a.a.x);d=$(a,b.a.a.y);(0==e&&0>=d||0>e&&d!=Math.floor(d))&&W(a,e+" ** "+d+"; result undefined");0==e?e=Math.pow(e,d):((1<Math.abs(e)&&1<d&&+Math.log(Math.abs(e))>0.999*Math.log(v)/d||1>Math.abs(e)&&-1>d&&+Math.log(Math.abs(e))<0.999*Math.log(v)/d)&&W(a,e+" ** "+d+"; floating-point overflow"),
e=1<Math.abs(e)&&-1>d&&-Math.log(Math.abs(e))<0.999*Math.log(v)/d||1>Math.abs(e)&&1<d&&-Math.log(Math.abs(e))>0.999*Math.log(v)/d?0:Math.pow(e,d));c=e;break;case lo:e=$(a,b.a.a.x);d=$(a,b.a.a.y);e>=d&&W(a,"Uniform("+e+", "+d+"); invalid range");f=Al(a.Ad)/2147483648;c=f=mq(a,e*(1-f),d*f);break;case mo:e=$(a,b.a.a.x);d=$(a,b.a.a.y);c=mq(a,e,oq(a,d,sq(a)));break;case Yn:c=Pq(a,b.a.a.x).size;break;case Zn:d=Lq(a,b.a.a.x);f=d.K==s?String(d.O):d.K;c=f.length;break;case Ho:d=Lq(a,b.a.a.x);f=d.K==s?String(d.O):
d.K;d=Lq(a,b.a.a.y);var g=f,j=d.K==s?String(d.O):d.K;d=function(){mr(a,g,q,j,z,"time zone offset value incomplete or invalid")};f=function(){mr(a,g,q,j,z,"time zone offset value out of range")};var h=function(){g[q]!=j[z]&&mr(a,g,q,j,z,"character mismatch");q++},l,m,n,p,t,r,w,E,q,z;m=n=p=t=r=w=-1;E=pa;for(z=q=0;z<j.length;z++)if("%"==j[z])if(z++,"b"==j[z]||"h"==j[z]){var C;for(0<=n&&mr(a,g,q,j,z,"month multiply specified");" "==g[q];)q++;for(n=1;12>=n;n++){C=nr[n-1];var H=ia;for(l=0;2>=l;l++)if(q[l].toUpperCase()!=
C[l].toUpperCase()){H=aa;break}if(!H){q+=3;for(l=3;"\x00"!=C[l]&&g[q].toUpperCase()==C[l].toUpperCase();l++)q++;break}}12<n&&mr(a,g,q,j,z,"abbreviated month name missing or invalid")}else if("d"==j[z]){for(0<=p&&mr(a,g,q,j,z,"day multiply specified");" "==g[q];)q++;"0"<=g[q]&&"9">=g[q]||mr(a,g,q,j,z,"day missing or invalid");p=g[q++]-0;"0"<=g[q]&&"9">=g[q]&&(p=10*p+(g[q++]-0));1<=p&&31>=p||mr(a,g,q,j,z,"day out of range")}else if("H"==j[z]){for(0<=t&&mr(a,g,q,j,z,"hour multiply specified");" "==g[q];)q++;
"0"<=g[q]&&"9">=g[q]||mr(a,g,q,j,z,"hour missing or invalid");t=g[q++]-0;"0"<=g[q]&&"9">=g[q]&&(t=10*t+(g[q++]-0));0<=t&&23>=t||mr(a,g,q,j,z,"hour out of range")}else if("m"==j[z]){for(0<=n&&mr(a,g,q,j,z,"month multiply specified");" "==g[q];)q++;"0"<=g[q]&&"9">=g[q]||mr(a,g,q,j,z,"month missing or invalid");n=g[q++]-0;"0"<=g[q]&&"9">=g[q]&&(n=10*n+(g[q++]-0));1<=n&&12>=n||mr(a,g,q,j,z,"month out of range")}else if("M"==j[z]){for(0<=r&&mr(a,g,q,j,z,"minute multiply specified");" "==g[q];)q++;"0"<=
g[q]&&"9">=g[q]||mr(a,g,q,j,z,"minute missing or invalid");r=g[q++]-0;"0"<=g[q]&&"9">=g[q]&&(r=10*r+(g[q++]-0));0<=r&&59>=r||mr(a,g,q,j,z,"minute out of range")}else if("S"==j[z]){for(0<=w&&mr(a,g,q,j,z,"second multiply specified");" "==g[q];)q++;"0"<=g[q]&&"9">=g[q]||mr(a,g,q,j,z,"second missing or invalid");w=g[q++]-0;"0"<=g[q]&&"9">=g[q]&&(w=10*w+(g[q++]-0));0<=w&&60>=w||mr(a,g,q,j,z,"second out of range")}else if("y"==j[z]){for(0<=m&&mr(a,g,q,j,z,"year multiply specified");" "==g[q];)q++;"0"<=
g[q]&&"9">=g[q]||mr(a,g,q,j,z,"year missing or invalid");m=g[q++]-0;"0"<=g[q]&&"9">=g[q]&&(m=10*m+(g[q++]-0));m+=69<=m?1900:2E3}else if("Y"==j[z]){for(0<=m&&mr(a,g,q,j,z,"year multiply specified");" "==g[q];)q++;"0"<=g[q]&&"9">=g[q]||mr(a,g,q,j,z,"year missing or invalid");m=0;for(l=1;4>=l&&"0"<=g[q]&&"9">=g[q];l++)m=10*m+(g[q++]-0);1<=m&&4E3>=m||mr(a,g,q,j,z,"year out of range")}else if("z"==j[z]){for(E!=pa&&mr(a,g,q,j,z,"time zone offset multiply specified");" "==g[q];)q++;if("Z"==g[q])e=t=r=0,
q++;else{"+"==g[q]?(e=1,q++):"-"==g[q]?(e=-1,q++):mr(a,g,q,j,z,"time zone offset sign missing");t=0;for(l=1;2>=l;l++)"0"<=g[q]&&"9">=g[q]||d(),t=10*t+(g[q++]-0);23<t&&f();":"==g[q]&&(q++,"0"<=g[q]&&"9">=g[q]||d());r=0;if("0"<=g[q]&&"9">=g[q]){for(l=1;2>=l;l++)"0"<=g[q]&&"9">=g[q]||d(),r=10*r+(g[q++]-0);59<r&&f()}}E=e*(60*t+r)}else"%"==j[z]?h():mr(a,g,q,j,z,"invalid conversion specifier");else" "!=j[z]&&h();0>m&&(m=1970);0>n&&(n=1);0>p&&(p=1);0>t&&(t=0);0>r&&(r=0);0>w&&(w=0);E==pa&&(E=0);l=El(p,n,
m);c=60*(60*(24*(l-El(1,1,1970))+t)+r)+w-60*E;break;case Ko:c=Mq(a,b.a.a.x)?$(a,b.a.a.y):b.a.a.Ka==s?0:$(a,b.a.a.Ka);break;case Mo:c=+v;for(e=b.a.list;e!=s;e=e.next)d=$(a,e.x),c>d&&(c=d);break;case No:c=-v;for(e=b.a.list;e!=s;e=e.next)d=$(a,e.x),c<d&&(c=d);break;case Oo:e={};e.code=b;e.value=0;Qq(a,b.a.loop.domain,e,lr);c=e.value;break;case Po:e={};e.code=b;e.value=1;Qq(a,b.a.loop.domain,e,lr);c=e.value;break;case Qo:e={};e.code=b;e.value=+v;Qq(a,b.a.loop.domain,e,lr);e.value==+v&&W(a,"min{} over empty set; result undefined");
c=e.value;break;case Ro:e={},e.code=b,e.value=-v,Qq(a,b.a.loop.domain,e,lr),e.value==-v&&W(a,"max{} over empty set; result undefined"),c=e.value}b.valid=1;return b.value.O=c}
function Lq(a,b){var c,d;b.Q&&b.valid&&(b.valid=0,Eq(b.type,b.value));if(b.valid)return Wp(b.value.U);switch(b.Pa){case qn:c=Rp(b.a.K);break;case rn:c=Wp(b.a.index.ua.value);break;case tn:var e;d=s;for(e=b.a.P.list;e!=s;e=e.next)d=Xp(d,Lq(a,e.x));c=dr(a,b.a.P.P,d);break;case Fn:c=Qp($(a,b.a.a.x));break;case no:var f=Lq(a,b.a.a.x);d=Lq(a,b.a.a.y);e=f.K==s?String(f.O):f.K;c=d.K==s?String(d.O):d.K;e.length+c.length>hm&&(f=Vp(f),W(a,f+" & "+Vp(d)+"; resultant symbol exceeds "+hm+" characters"));c=Rp(e+
c);break;case Ko:c=Mq(a,b.a.a.x)?Lq(a,b.a.a.y):b.a.a.Ka==s?Qp(0):Lq(a,b.a.a.Ka);break;case Go:case Lo:c=Lq(a,b.a.a.x);d=c.K==s?String(c.O):c.K;b.Pa==Go?(c=$(a,b.a.a.y),c!=Math.floor(c)&&W(a,"substr('...', "+c+"); non-integer second argument"),(1>c||c>d.length+1)&&W(a,"substr('...', "+c+"); substring out of range")):(c=$(a,b.a.a.y),e=$(a,b.a.a.Ka),(c!=Math.floor(c)||e!=Math.floor(e))&&W(a,"substr('...', "+c+", "+e+"); non-integer second and/or third argument"),(1>c||0>e||c+e>d.length+1)&&W(a,"substr('...', "+
c+", "+e+"); substring out of range"));c=Rp(d.slice(c-1,c+e-1));break;case Io:c=$(a,b.a.a.x);e=Lq(a,b.a.a.y);var g=c;e=e.K==s?String(e.O):e.K;var j=0,h=0,l=0,m,n,p,t,f="";-62135596800<=g&&64092211199>=g||W(a,"time2str("+g+",...); argument out of range");g=Math.floor(g+0.5);m=Math.abs(g)/86400;c=Math.floor(m);0>g&&(c=m==Math.floor(m)?-c:-(c+1));Fl(c+El(1,1,1970),function(a,b,c){l=a;h=b;j=c});n=g-86400*c|0;m=n/60;n%=60;g=m/60;m%=60;for(t=p=0;t<e.length;t++){if("%"==e[t])if(t++,"a"==e[t])d=or[pr(c)-
1].slice(0,3);else if("A"==e[t])d=or[pr(c)-1];else if("b"==e[t]||"h"==e[t])d=nr[h-1].slice(0,3);else if("B"==e[t])d=nr[h-1];else if("C"==e[t])d=String(Math.floor(j/100));else if("d"==e[t])d=String(l);else if("D"==e[t])d=h+"/"+l+"/"+j%100;else if("e"==e[t])d=String(l);else if("F"==e[t])vb(d,j+"-"+h+"-"+l);else if("g"==e[t])d=c<qr(j)?j-1:c<qr(j+1)?j:j+1,d=String(d%100);else if("G"==e[t])d=c<qr(j)?j-1:c<qr(j+1)?j:j+1,d=String(d);else if("H"==e[t])d=String(g);else if("I"==e[t])d=String(0==g?12:12>=g?
g:g-12);else if("j"==e[t])d=String(El(l,h,j)-El(1,1,j)+1);else if("k"==e[t])d=String(g);else if("l"==e[t])d=String(0==g?12:12>=g?g:g-12);else if("m"==e[t])d=String(h);else if("M"==e[t])d=String(m);else if("p"==e[t])d=11>=g?"AM":"PM";else if("P"==e[t])d=11>=g?"am":"pm";else if("r"==e[t])d=(0==g?12:12>=g?g:g-12)+":"+m+":"+n+" "+(11>=g?"AM":"PM");else if("R"==e[t])d=g+":"+m;else if("S"==e[t])d=String(n);else if("T"==e[t])d=g+":"+m+":"+n;else if("u"==e[t])d=String(pr(c));else if("U"==e[t])d=El(1,1,j)-
El(1,1,1970),d+=7-pr(d),d=String((c+7-d)/7);else if("V"==e[t])d=c<qr(j)?c-qr(j-1):c<qr(j+1)?c-qr(j):c-qr(j+1),d=String(d/7+1);else if("w"==e[t])d=String(pr(c)%7);else if("W"==e[t])d=El(1,1,j)-El(1,1,1970),d+=(8-pr(d))%7,d=String((c+7-d)/7);else if("y"==e[t])d=String(j%100);else if("Y"==e[t])d=String(j);else if("%"==e[t])d="%";else{var r=a,w=e,E=t;B("Format string passed to time2str:");B(w);B(rr(E));W(r,"invalid conversion specifier")}else d=e[t];p+d.length>hm&&W(a,"time2str; output string length exceeds "+
hm+" charaters");f+=d;p+=d.length}c=Rp(f)}b.valid=1;b.value.U=Wp(c);return c}function sr(a,b){var c=0;switch(b.code.Pa){case So:b.value&=Mq(a,b.code.a.loop.x);b.value||(c=1);break;case To:b.value|=Mq(a,b.code.a.loop.x),b.value&&(c=1)}return c}
function Mq(a,b){var c,d;b.Q&&b.valid&&(b.valid=0,Eq(b.type,b.value));if(b.valid)return b.value.hg;switch(b.Pa){case Gn:c=0!=$(a,b.a.a.x);break;case Ln:c=!Mq(a,b.a.a.x);break;case oo:b.a.a.x.type==S?c=$(a,b.a.a.x)<$(a,b.a.a.y):(c=Lq(a,b.a.a.x),d=Lq(a,b.a.a.y),c=0>tq(c,d));break;case po:b.a.a.x.type==S?c=$(a,b.a.a.x)<=$(a,b.a.a.y):(c=Lq(a,b.a.a.x),d=Lq(a,b.a.a.y),c=0>=tq(c,d));break;case ro:b.a.a.x.type==S?c=$(a,b.a.a.x)==$(a,b.a.a.y):(c=Lq(a,b.a.a.x),d=Lq(a,b.a.a.y),c=0==tq(c,d));break;case so:b.a.a.x.type==
S?c=$(a,b.a.a.x)>=$(a,b.a.a.y):(c=Lq(a,b.a.a.x),d=Lq(a,b.a.a.y),c=0<=tq(c,d));break;case to:b.a.a.x.type==S?c=$(a,b.a.a.x)>$(a,b.a.a.y):(c=Lq(a,b.a.a.x),d=Lq(a,b.a.a.y),c=0<tq(c,d));break;case uo:b.a.a.x.type==S?c=$(a,b.a.a.x)!=$(a,b.a.a.y):(c=Lq(a,b.a.a.x),d=Lq(a,b.a.a.y),c=0!=tq(c,d));break;case vo:c=Mq(a,b.a.a.x)&&Mq(a,b.a.a.y);break;case wo:c=Mq(a,b.a.a.x)||Mq(a,b.a.a.y);break;case Co:c=tr(a,b.a.a.x);c=Jq(a,b.a.a.y,c);break;case Do:c=tr(a,b.a.a.x);c=!Jq(a,b.a.a.y,c);break;case Eo:d=Pq(a,b.a.a.x);
c=1;for(d=d.head;d!=s;d=d.next)if(!Jq(a,b.a.a.y,d.v)){c=0;break}break;case Fo:d=Pq(a,b.a.a.x);c=1;for(d=d.head;d!=s;d=d.next)if(Jq(a,b.a.a.y,d.v)){c=0;break}break;case So:c={};c.code=b;c.value=1;Qq(a,b.a.loop.domain,c,sr);c=c.value;break;case To:c={},c.code=b,c.value=0,Qq(a,b.a.loop.domain,c,sr),c=c.value}b.valid=1;return b.value.hg=c}
function tr(a,b){var c;b.Q&&b.valid&&(b.valid=0,Eq(b.type,b.value));if(b.valid)return kq(b.value.v);switch(b.Pa){case xn:c=s;for(var d=b.a.list;d!=s;d=d.next)c=Xp(c,Lq(a,d.x));break;case Hn:c=Xp(s,Lq(a,b.a.a.x))}b.valid=1;b.value.v=kq(c);return c}function ur(a,b){var c;switch(b.code.Pa){case Uo:c=tr(a,b.code.a.loop.x);bq(b.value,c)==s&&wq(b.value,c);break;case Vo:wq(b.value,Sq(b.code.a.loop.domain))}return 0}
function Pq(a,b){var c,d;b.Q&&b.valid&&(b.valid=0,Eq(b.type,b.value));if(b.valid)return xq(a,b.value.set);switch(b.Pa){case un:c=s;for(d=b.a.set.list;d!=s;d=d.next)c=Xp(c,Lq(a,d.x));c=xq(a,Xq(a,b.a.set.set,c));break;case yn:c=eq(a,Zl,b.p);for(d=b.a.list;d!=s;d=d.next)Yp(a,c,tr(a,d.x));break;case xo:d=Pq(a,b.a.a.x);for(c=Pq(a,b.a.a.y).head;c!=s;c=c.next)bq(d,c.v)==s&&wq(d,kq(c.v));c=d;break;case yo:var e=Pq(a,b.a.a.x);d=Pq(a,b.a.a.y);c=eq(a,Zl,e.p);for(e=e.head;e!=s;e=e.next)bq(d,e.v)==s&&wq(c,kq(e.v));
break;case zo:d=Pq(a,b.a.a.x);c=Pq(a,b.a.a.y);for(var f=eq(a,Zl,d.p),e=d.head;e!=s;e=e.next)bq(c,e.v)==s&&wq(f,kq(e.v));for(e=c.head;e!=s;e=e.next)bq(d,e.v)==s&&wq(f,kq(e.v));c=f;break;case Ao:e=Pq(a,b.a.a.x);d=Pq(a,b.a.a.y);c=eq(a,Zl,e.p);for(e=e.head;e!=s;e=e.next)bq(d,e.v)!=s&&wq(c,kq(e.v));break;case Bo:e=Pq(a,b.a.a.x);d=Pq(a,b.a.a.y);var g,j;c=eq(a,Zl,e.p+d.p);for(e=e.head;e!=s;e=e.next)for(f=d.head;f!=s;f=f.next){g=kq(e.v);for(j=f.v;j!=s;j=j.next)g=Xp(g,Wp(j.U));wq(c,g)}break;case Jo:d=$(a,
b.a.a.x);c=$(a,b.a.a.y);e=b.a.a.Ka==s?1:$(a,b.a.a.Ka);f=eq(a,Zl,1);g=yq(a,d,c,e);for(j=1;j<=g;j++)wq(f,Xp(s,Qp(zq(a,d,c,e,j))));c=f;break;case Ko:c=Mq(a,b.a.a.x)?Pq(a,b.a.a.y):Pq(a,b.a.a.Ka);break;case Uo:d={};d.code=b;d.value=eq(a,Zl,b.p);Qq(a,b.a.loop.domain,d,ur);c=d.value;break;case Vo:d={},d.code=b,d.value=eq(a,Zl,b.p),Qq(a,b.a.loop.domain,d,ur),c=d.value}b.valid=1;b.value.set=xq(a,c);return c}function vr(){}
function Jq(a,b,c){var d,e,f;switch(b.Pa){case un:f=s;for(e=b.a.set.list;e!=s;e=e.next)f=Xp(f,Lq(a,e.x));a=Xq(a,b.a.set.set,f);f=vq(c,a.p);d=bq(a,f)!=s;break;case yn:d=0;f=vq(c,b.p);for(e=b.a.list;e!=s&&!(c=tr(a,e.x),d=0==uq(f,c));e=e.next);break;case xo:d=Jq(a,b.a.a.x,c)||Jq(a,b.a.a.y,c);break;case yo:d=Jq(a,b.a.a.x,c)&&!Jq(a,b.a.a.y,c);break;case zo:f=Jq(a,b.a.a.x,c);a=Jq(a,b.a.a.y,c);d=f&&!a||!f&&a;break;case Ao:d=Jq(a,b.a.a.x,c)&&Jq(a,b.a.a.y,c);break;case Bo:if(d=Jq(a,b.a.a.x,c)){for(f=1;f<=
b.a.a.x.p;f++)c=c.next;d=Jq(a,b.a.a.y,c)}break;case Jo:f=$(a,b.a.a.x);e=$(a,b.a.a.y);b=b.a.a.Ka==s?1:$(a,b.a.a.Ka);yq(a,f,e,b);if(c.U.K!=s){d=0;break}c=c.U.O;if(0<b&&!(f<=c&&c<=e)||0>b&&!(e<=c&&c<=f)){d=0;break}d=zq(a,f,e,b,((c-f)/b+0.5|0)+1)==c;break;case Ko:d=Mq(a,b.a.a.x)?Jq(a,b.a.a.y,c):Jq(a,b.a.a.Ka,c);break;case Uo:W(a,"implementation restriction; in/within setof{} not allowed");break;case Vo:f=vq(c,b.p),d=0==Nq(a,b.a.loop.domain,f,s,vr)}return d}
function wr(a,b){switch(b.code.Pa){case Oo:var c;c=ir(a,b.code.a.loop.x);for(b.value==s?b.value=c:b.Sa.next=c;c!=s;c=c.next)b.Sa=c}return 0}
function ir(a,b){var c;b.Q&&b.valid&&(b.valid=0,Eq(b.type,b.value));if(b.valid)return Bq(b.value.form);switch(b.Pa){case vn:var d=s;for(c=b.a.s.list;c!=s;c=c.next)d=Xp(d,Lq(a,c.x));c=gr(a,b.a.s.s,d);d={t:1};d.s=c;d.next=s;c=d;break;case In:c=Aq($(a,b.a.a.x));break;case Jn:c=Cq(a,0,Aq(0),1,ir(a,b.a.a.x));break;case Kn:c=Cq(a,0,Aq(0),-1,ir(a,b.a.a.x));break;case $n:c=Cq(a,1,ir(a,b.a.a.x),1,ir(a,b.a.a.y));break;case ao:c=Cq(a,1,ir(a,b.a.a.x),-1,ir(a,b.a.a.y));break;case co:c=b.a.a.x.type==S?Cq(a,$(a,
b.a.a.x),ir(a,b.a.a.y),0,Aq(0)):Cq(a,$(a,b.a.a.y),ir(a,b.a.a.x),0,Aq(0));break;case eo:c=Cq(a,pq(a,1,$(a,b.a.a.y)),ir(a,b.a.a.x),0,Aq(0));break;case Ko:c=Mq(a,b.a.a.x)?ir(a,b.a.a.y):b.a.a.Ka==s?Aq(0):ir(a,b.a.a.Ka);break;case Oo:c={};c.code=b;c.value=Aq(0);c.Sa=s;Qq(a,b.a.loop.domain,c,wr);c=c.value;for(var e,f=0,d=c;d!=s;d=d.next)d.s==s?f=mq(a,f,d.t):d.s.fa=mq(a,d.s.fa,d.t);e=c;c=s;for(d=e;d!=s;d=e)e=d.next,d.s==s&&0!=f?(d.t=f,f=0,d.next=c,c=d):d.s!=s&&0!=d.s.fa&&(d.t=d.s.fa,d.s.fa=0,d.next=c,c=
d)}b.valid=1;b.value.form=Bq(c);return c}exports.mpl_tab_num_args=function(a){return a.Ve};exports.mpl_tab_get_arg=function(a,b){return a.a[b]};exports.mpl_tab_num_flds=function(a){return a.lb};exports.mpl_tab_get_name=function(a,b){return a.name[b]};exports.mpl_tab_get_type=function(a,b){return a.type[b]};exports.mpl_tab_get_num=function(a,b){return a.O[b]};exports.mpl_tab_get_str=function(a,b){return a.K[b]};exports.mpl_tab_set_num=function(a,b,c){a.type[b]="N";a.O[b]=c};
exports.mpl_tab_set_str=function(a,b,c){a.type[b]="S";a.K[b]=c};function xr(a,b){var c=a.ng,d,e,f;f=0;for(d=b.u.Mc.list;d!=s;d=d.next)switch(f++,d.code.type){case S:c.type[f]="N";c.O[f]=$(a,d.code);c.K[f][0]="\x00";break;case V:e=Lq(a,d.code),e.K==s?(c.type[f]="N",c.O[f]=e.O,c.K[f][0]="\x00"):(c.type[f]="S",c.O[f]=0,c.K[f]=e.K)}mpl_tab_drv_write(a);return 0}function yr(a,b){Mq(a,b.code)||W(a,"check"+cq("[",Sq(b.domain))+" failed");return 0}
function zr(a,b,c){var d=c.value.set;b=b.name+cq("[",c.v)+(d.head==s?" is empty":":");a.ia(b);for(d=d.head;d!=s;d=d.next)b="   "+cq("(",d.v),a.ia(b)}function Ar(a,b,c){switch(b.type){case S:case Vl:case Il:b=b.name+cq("[",c.v)+" = "+c.value.O;a.ia(b);break;case V:b=b.name+cq("[",c.v)+" = "+Vp(c.value.U),a.ia(b)}}
function Br(a,b,c,d){d==jn||d==nn?(b=b.name+cq("[",c.v)+".val = "+c.value.s.q,a.ia(b)):d==kn?(b=b.name+cq("[",c.v)+".lb = "+(c.value.s.s.N==s?-v:c.value.s.N),a.ia(b)):d==ln?(b=b.name+cq("[",c.v)+".ub = "+(c.value.s.s.S==s?+v:c.value.s.S),a.ia(b)):d==mn?(b=b.name+cq("[",c.v)+".status = "+c.value.s.l,a.ia(b)):d==on&&(b=b.name+cq("[",c.v)+".dual = "+c.value.s.H,a.ia(b))}
function Cr(a,b,c,d){d==jn||d==nn?(b=b.name+cq("[",c.v)+".val = "+c.value.F.q,a.ia(b)):d==kn?(b=b.name+cq("[",c.v)+".lb = "+(c.value.F.F.N==s?-v:c.value.F.N),a.ia(b)):d==ln?(b=b.name+cq("[",c.v)+".ub = "+(c.value.F.F.S==s?+v:c.value.F.S),a.ia(b)):d==mn?(b=b.name+cq("[",c.v)+".status = "+c.value.F.l,a.ia(b)):d==on&&(b=b.name+cq("[",c.v)+".dual = "+c.value.F.H,a.ia(b))}
function Dr(a,b){for(var c,d=b.list;d!=s;d=d.next)if(d.type==Tl)c=d.u.ua,c=c.name+" = "+Vp(c.value),a.ia(c);else if(d.type==cm){var e=d.u.set;e.assign!=s?Qq(a,e.domain,e,Wq):(e.Vc!=s&&0==e.data&&Vq(a,e),e.M.head!=s&&Xq(a,e,e.M.head.v));e.M.head==s&&a.ia(e.name+" has empty content");for(c=e.M.head;c!=s;c=c.next)zr(a,e,c)}else if(d.type==am){e=d.u.P;e.assign!=s?Qq(a,e.domain,e,er):e.M.head!=s&&(e.type!=V?ar(a,e,e.M.head.v):dr(a,e,e.M.head.v));e.M.head==s&&a.ia(e.name+" has empty content");for(c=e.M.head;c!=
s;c=c.next)Ar(a,e,c)}else if(d.type==gm){e=d.u.s;e.M.head==s&&a.ia(e.name+" has empty content");for(c=e.M.head;c!=s;c=c.next)Br(a,e,c,jn)}else if(d.type==Ll){e=d.u.F;e.M.head==s&&a.ia(e.name+" has empty content");for(c=e.M.head;c!=s;c=c.next)Cr(a,e,c,jn)}else if(d.type==Ql)if(e=d.u.code,e.Pa==sn||e.Pa==tn||e.Pa==un||e.Pa==vn||e.Pa==wn){c=a;var f={},g=k;f.v=s;for(g=e.a.P.list;g!=s;g=g.next)f.v=Xp(f.v,Lq(c,g.x));switch(e.Pa){case sn:f.value.O=ar(c,e.a.P.P,f.v);Ar(c,e.a.P.P,f);break;case tn:f.value.U=
dr(c,e.a.P.P,f.v);Ar(c,e.a.P.P,f);break;case un:f.value.set=Xq(c,e.a.set.set,f.v);zr(c,e.a.set.set,f);break;case vn:f.value.s=gr(c,e.a.s.s,f.v);Br(c,e.a.s.s,f,e.a.s.zc);break;case wn:f.value.F=jr(c,e.a.F.F,f.v),Cr(c,e.a.F.F,f,e.a.F.zc)}}else switch(c=a,f=e,f.type){case S:e=$(c,f);c.ia(String(e));break;case V:e=Lq(c,f);e=Vp(e);c.ia(e);break;case Wl:e=Mq(c,f);c.ia(e?"true":"false");break;case fm:e=tr(c,f);e=cq("(",e);c.ia(e);break;case Ol:e=Pq(c,f);0==e.head&&c.ia("set is empty");for(e=e.head;e!=s;e=
e.next)f="   "+cq("(",e.v),c.ia(f);break;case Sl:e=k;e=ir(c,f);for(e==s&&c.ia("linear form is empty");e!=s;e=e.next)e.s==s?c.ia("   "+e.t):(f="   "+e.t+" "+e.s.s.name+cq("[",e.s.$.v),c.ia(f))}return 0}function Er(a,b){a.vg==s?"\n"==b?(a.ia(a.flush),a.flush=""):a.flush+=b:a.vg(b)}function Fr(a,b){for(var c=0;c<b.length;c++)Er(a,b[c])}
function Gr(a,b){var c,d,e,f,g,j=Lq(a,b.td);d=j.K==s?String(j.O):j.K;c=b.list;for(f=0;f<d.length;f++)if("%"==d[f])if(e=f++,"%"==d[f])Er(a,"%");else{if(c==s)break;for(;"-"==d[f]||"+"==d[f]||" "==d[f]||"#"==d[f]||"0"==d[f];)f++;for(;rb(d[f]);)f++;if("."==d[f])for(f++;rb(d[f]);)f++;if("d"==d[f]||"i"==d[f]||"e"==d[f]||"E"==d[f]||"f"==d[f]||"F"==d[f]||"g"==d[f]||"G"==d[f]){switch(c.code.type){case S:g=$(a,c.code);break;case V:j=Lq(a,c.code);j.K!=s&&W(a,"cannot convert "+Vp(j)+" to floating-point number");
g=j.O;break;case Wl:g=Mq(a,c.code)?1:0}"d"==d[f]||"i"==d[f]?(j=pa,-j<=g&&g<=+j||W(a,"cannot convert "+g+" to integer"),Fr(a,vb(d.slice(e,f+1),Math.floor(g+0.5)|0))):Fr(a,vb(d.slice(e,f+1),g))}else if("s"==d[f]){switch(c.code.type){case S:g=String($(a,c.code));break;case Wl:g=Mq(a,c.code)?"T":"F";break;case V:j=Lq(a,c.code),g=j.K==s?String(j.O):j.K}Fr(a,vb(d.slice(e,f+1),g))}else W(a,"format specifier missing or invalid");c=c.next}else"\\"==d[f]?(f++,"t"==d[f]?Er(a,"\t"):"n"==d[f]?Er(a,"\n"):"\x00"==
d[f]?W(a,"invalid use of escape character \\ in format control string"):Er(a,d[f])):Er(a,d[f]);return 0}function Hr(a,b){for(var c=a.yc,d=b.list;d!=s;d=d.next)Ir(a,d);a.yc=c;return 0}
function Ir(a,b){a.yc=b;switch(b.type){case Ll:B("Generating "+b.u.F.name+"...");var c=b.u.F;Qq(a,c.domain,c,kr);break;case em:switch(b.u.mf.type){case Ul:B("Reading "+b.u.mf.name+"...");break;case $l:B("Writing "+b.u.mf.name+"...")}var c=b.u.mf,d,e,f,g;a.ng=f={};f.id=0;f.link=s;f.Ve=0;f.a=s;f.lb=0;f.name=s;f.type=s;f.O=s;f.K=s;for(d=c.a;d!=s;d=d.next)f.Ve++;f.a=Array(1+f.Ve);for(g=1;g<=f.Ve;g++)f.a[g]=s;g=0;for(d=c.a;d!=s;d=d.next)g++,e=Lq(a,d.code),e=e.K==s?String(e.O):e.K,f.a[g]=e;switch(c.type){case Ul:g=
c.u.na.set;g!=s&&(g.data&&W(a,g.name+" already provided with data"),dq(g.M,s).value.set=eq(a,Zl,g.T),g.data=1);for(e=c.u.na.list;e!=s;e=e.next)e.P.data&&W(a,e.P.name+" already provided with data"),e.P.data=1;for(e=c.u.na.Me;e!=s;e=e.next)f.lb++;for(e=c.u.na.list;e!=s;e=e.next)f.lb++;f.name=Array(1+f.lb);f.type=Array(1+f.lb);f.O=Array(1+f.lb);f.K=Array(1+f.lb);g=0;for(e=c.u.na.Me;e!=s;e=e.next)g++,f.name[g]=e.name,f.type[g]="?",f.O[g]=0,f.K[g]="";for(e=c.u.na.list;e!=s;e=e.next)g++,f.name[g]=e.name,
f.type[g]="?",f.O[g]=0,f.K[g]="";for(mpl_tab_drv_open(a,"R");;){for(g=1;g<=f.lb;g++)f.type[g]="?";if(mpl_tab_drv_read(a))break;for(g=1;g<=f.lb;g++)"?"==f.type[g]&&W(a,"field "+f.name[g]+" missing in input table");d=s;g=0;for(e=c.u.na.Me;e!=s;e=e.next)switch(g++,f.type[g]){case "N":d=Xp(d,Qp(f.O[g]));break;case "S":d=Xp(d,Rp(f.K[g]))}c.u.na.set!=s&&Yp(a,c.u.na.set.M.head.value.set,kq(d));for(e=c.u.na.list;e!=s;e=e.next){var j;g++;bq(e.P.M,d)!=s&&W(a,e.P.name+cq("[",d)+" already defined");j=dq(e.P.M,
kq(d));switch(e.P.type){case S:case Vl:case Il:"N"!=f.type[g]&&W(a,e.P.name+" requires numeric data");j.value.O=f.O[g];break;case V:switch(f.type[g]){case "N":j.value.U=Qp(f.O[g]);break;case "S":j.value.U=Rp(f.K[g])}}}}break;case $l:for(d=c.u.Mc.list;d!=s;d=d.next)f.lb++;f.name=Array(1+f.lb);f.type=Array(1+f.lb);f.O=Array(1+f.lb);f.K=Array(1+f.lb);g=0;for(d=c.u.Mc.list;d!=s;d=d.next)g++,f.name[g]=d.name,f.type[g]="?",f.O[g]=0,f.K[g]="";mpl_tab_drv_open(a,"W");Qq(a,c.u.Mc.domain,c,xr)}break;case Kl:B("Checking (line "+
b.jb+")...");c=b.u.Fg;Qq(a,c.domain,c,yr);break;case Ml:a.ia("Display statement at line "+b.jb);c=b.u.Gg;Qq(a,c.domain,c,Dr);break;case bm:c=b.u.$g;Qq(a,c.domain,c,Gr);break;case Rl:c=b.u.Ig,Qq(a,c.domain,c,Hr)}}function Jr(a,b,c){a.jb=0;a.m="\n";a.b=0;a.Vb=0;a.g="";a.value=0;a.xf=jm;a.wf=0;a.vf="";a.yf=0;a.Je=0;a.Ke=0;a.Cf=0;a.Bf=0;a.Af="";a.Df=0;Da(a.Ub,0," ",im);a.gc=0;a.Se=c;a.If=b||"input";Yo(a);Y(a)}
function W(a,b){switch(a.B){case 1:case 2:for(var c;0<a.gc;)a.gc--,c=a.Ub[0],Ca(a.Ub,0,a.Ub,1,im-1),a.Ub[im-1]=c;B("Context: "+a.jb+" > "+(" "==a.Ub[0]?"":"...")+a.Ub.join("").trim())}a.B=4;throw Error(b);}function Zo(a,b){switch(a.B){case 1:case 2:B(a.If+":"+a.jb+": warning: "+b);break;case 3:B(a.Pf+":"+(a.yc==s?0:a.yc.jb)+": warning: "+b)}}
var zj=exports.mpl_initialize=function(){var a={jb:0,m:0,b:0,Vb:0,g:"",value:0,xf:0,wf:0,vf:"",yf:0,Je:0,Ke:0,Cf:0,Bf:0,Af:"",Df:0};a.Ub=Array(im);Da(a.Ub,0," ",im);a.gc=0;a.ic=0;a.W={};a.qc=s;a.Ff=0;a.gg=0;a.fg=0;a.Ae=0;a.Ib=0;a.eg=s;a.oh="";a.ph="";a.Ad=zl();a.Ef=0;a.yc=s;a.ng=s;a.f=0;a.h=0;a.k=s;a.e=s;a.Se=s;a.If=s;a.ia=s;a.Xg=s;a.vg=s;a.lh=s;a.B=0;a.Pf=s;a.kh="";return a},Bj=exports.mpl_read_model=function(a,b,c,d){function e(){B(a.jb+" line"+(1==a.jb?"":"s")+" were read");a.Se=s;return a.B}0!=
a.B&&y("mpl_read_model: invalid call sequence");c==s&&y("mpl_read_model: no input specified");a.B=1;B("Reading model section from "+b+" ...");Jr(a,b,c);c=a;var f,g;for(g=s;!(c.b==jm||bp(c,"data")||bp(c,"end"));)f=Jp(c,0),g==s?c.qc=f:g.next=f,g=f;a.qc==s&&W(a,"empty model section not allowed");a.Pf=a.If;c=a;for(f=c.qc;f!=s;f=f.next)switch(f.type){case cm:f.u.set.M=eq(c,Ol,f.u.set.p);break;case am:switch(f.u.P.type){case S:case Vl:case Il:f.u.P.M=eq(c,S,f.u.P.p);break;case V:f.u.P.M=eq(c,V,f.u.P.p)}break;
case gm:f.u.s.M=eq(c,Pl,f.u.s.p);break;case Ll:f.u.F.M=eq(c,Nl,f.u.F.p)}if(bp(a,"data")){if(d)return Zo(a,"data section ignored"),e();a.ic=1;Y(a);a.b!=Xm&&W(a,"semicolon missing where expected");Y(a);a.B=2;B("Reading data section from "+b+" ...");lq(a)}Hp(a);return e()},Dj=exports.mpl_read_data=function(a,b,c){1==a.B||2==a.B||y("mpl_read_data: invalid call sequence");c==s&&y("mpl_read_data: no input specified");a.B=2;B("Reading data section from "+b+" ...");a.ic=1;Jr(a,b,c);Ip(a,"data")&&(Y(a),a.b!=
Xm&&W(a,"semicolon missing where expected"),Y(a));lq(a);Hp(a);B(a.jb+" line"+(1==a.jb?"":"s")+" were read");a.Se=s;return a.B},Fj=exports.mpl_generate=function(a,b,c){1==a.B||2==a.B||y("mpl_generate: invalid call sequence");a.B=3;c==s?a.ia=B:(a.ia=c,a.ia==s&&W(a,"unable to use output callback"),a.Xg=b);a.flush="";for(b=a.qc;b!=s&&!(Ir(a,b),a.yc.type==dm);b=b.next);a.yc=b;var d;for(b=a.qc;b!=s;b=b.next)if(b.type==gm){c=b.u.s;for(c=c.M.head;c!=s;c=c.next);}for(b=a.qc;b!=s;b=b.next)if(b.type==Ll){c=
b.u.F;for(c=c.M.head;c!=s;c=c.next){c.value.F.ca=++a.f;for(d=c.value.F.form;d!=s;d=d.next)d.s.$.value.s.A=-1}}for(b=a.qc;b!=s;b=b.next)if(b.type==gm){c=b.u.s;for(c=c.M.head;c!=s;c=c.next)0!=c.value.s.A&&(c.value.s.A=++a.h)}a.k=Array(1+a.f);for(d=1;d<=a.f;d++)a.k[d]=s;for(b=a.qc;b!=s;b=b.next)if(b.type==Ll){c=b.u.F;for(c=c.M.head;c!=s;c=c.next)d=c.value.F.ca,a.k[d]=c.value.F}for(d=1;d<=a.f;d++);a.e=Array(1+a.h);for(d=1;d<=a.h;d++)a.e[d]=s;for(b=a.qc;b!=s;b=b.next)if(b.type==gm){c=b.u.s;for(c=c.M.head;c!=
s;c=c.next)d=c.value.s.A,0!=d&&(a.e[d]=c.value.s)}for(d=1;d<=a.h;d++);B("Model has been successfully generated");return a.B},Gj=exports.mpl_get_prob_name=function(a){return a.Pf},Hj=exports.mpl_get_num_rows=function(a){3!=a.B&&y("mpl_get_num_rows: invalid call sequence");return a.f},Qj=exports.mpl_get_num_cols=function(a){3!=a.B&&y("mpl_get_num_cols: invalid call sequence");return a.h},Ij=exports.mpl_get_row_name=function(a,b){3!=a.B&&y("mpl_get_row_name: invalid call sequence");1<=b&&b<=a.f||y("mpl_get_row_name: i = "+
b+"; row number out of range");var c=a.k[b].F.name,c=c+cq("[",a.k[b].$.v).slice(0,255);255==c.length&&(c=c.slice(0,252)+"...");return c},Xj=exports.mpl_get_row_kind=function(a,b){var c;3!=a.B&&y("mpl_get_row_kind: invalid call sequence");1<=b&&b<=a.f||y("mpl_get_row_kind: i = "+b+"; row number out of range");switch(a.k[b].F.type){case Ll:c=411;break;case Yl:c=Yj;break;case Xl:c=Zj}return c},Jj=exports.mpl_get_row_bnds=function(a,b,c){var d;3!=a.B&&y("mpl_get_row_bnds: invalid call sequence");1<=b&&
b<=a.f||y("mpl_get_row_bnds: i = "+b+"; row number out of range");d=a.k[b];a=d.F.N==s?-v:d.N;b=d.F.S==s?+v:d.S;a==-v&&b==+v?(d=Kj,a=b=0):b==+v?(d=Lj,b=0):a==-v?(d=Mj,a=0):d=d.F.N!=d.F.S?Nj:Oj;c(a,b);return d},Wj=exports.mpl_get_mat_row=function(a,b,c,d){var e=0;3!=a.B&&y("mpl_get_mat_row: invalid call sequence");1<=b&&b<=a.f||y("mpl_get_mat_row: i = "+b+"; row number out of range");for(a=a.k[b].form;a!=s;a=a.next)e++,c!=s&&(c[e]=a.s.A),d!=s&&(d[e]=a.t);return e},Pj=exports.mpl_get_row_c0=function(a,
b){var c;3!=a.B&&y("mpl_get_row_c0: invalid call sequence");1<=b&&b<=a.f||y("mpl_get_row_c0: i = "+b+"; row number out of range");c=a.k[b];return c.F.N==s&&c.F.S==s?-c.N:0},Rj=exports.mpl_get_col_name=function(a,b){3!=a.B&&y("mpl_get_col_name: invalid call sequence");1<=b&&b<=a.h||y("mpl_get_col_name: j = "+b+"; column number out of range");var c=a.e[b].s.name,c=c+cq("[",a.e[b].$.v);255==c.length&&(c=c.slice(0,252)+"...");return c},Sj=exports.mpl_get_col_kind=function(a,b){var c;3!=a.B&&y("mpl_get_col_kind: invalid call sequence");
1<=b&&b<=a.h||y("mpl_get_col_kind: j = "+b+"; column number out of range");switch(a.e[b].s.type){case S:c=421;break;case Vl:c=Tj;break;case Il:c=Uj}return c},Vj=exports.mpl_get_col_bnds=function(a,b,c){var d;3!=a.B&&y("mpl_get_col_bnds: invalid call sequence");1<=b&&b<=a.h||y("mpl_get_col_bnds: j = "+b+"; column number out of range");d=a.e[b];a=d.s.N==s?-v:d.N;b=d.s.S==s?+v:d.S;a==-v&&b==+v?(d=Kj,a=b=0):b==+v?(d=Lj,b=0):a==-v?(d=Mj,a=0):d=d.s.N!=d.s.S?Nj:Oj;c(a,b);return d},ak=exports.mpl_has_solve_stmt=
function(a){3!=a.B&&y("mpl_has_solve_stmt: invalid call sequence");return a.Ib},gk=exports.mpl_put_row_soln=function(a,b,c,d,e){a.k[b].l=c;a.k[b].q=d;a.k[b].H=e},hk=exports.mpl_put_col_soln=function(a,b,c,d,e){a.e[b].l=c;a.e[b].q=d;a.e[b].H=e},ik=exports.mpl_postsolve=function(a){(3!=a.B||a.Ef)&&y("mpl_postsolve: invalid call sequence");var b;a.Ef=1;for(b=a.yc;b!=s;b=b.next)Ir(a,b);a.yc=s;B("Model has been successfully processed");return a.B},or="Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),
nr="January February March April May June July August September October November December".split(" ");function rr(a){for(var b="";0<a;)b+="^",a--;return b}function mr(a,b,c,d,e,f){B("Input string passed to str2time:");B(b);B(rr(c+1));B("Format string passed to str2time:\n");B(d);B(rr(e+1));W(a,f)}function pr(a){return(a+El(1,1,1970))%7+1}
function qr(a){a=El(1,1,a)-El(1,1,1970);switch(pr(a)){case 1:a+=0;break;case 2:a-=1;break;case 3:a-=2;break;case 4:a-=3;break;case 5:a+=3;break;case 6:a+=2;break;case 7:a+=1}pr(a);return a}function gg(){var a={Wb:0};a.sc=a.Ug=a.Vg=0;a.name=a.Ya=s;a.da=0;a.$d=a.Zd=0;a.xb=a.Nc=s;a.Eb=a.nd=s;a.top=s;a.f=a.h=a.J=0;a.jf=a.Md=s;a.ba=a.ne=0;a.bf=a.mg=a.yg=a.og=0;a.ja=s;a.wa=s;a.ha=s;a.La=s;return a}
function Kr(a,b,c){0==c?(b.aa=s,b.next=a.xb,b.next==s?a.Nc=b:b.next.aa=b,a.xb=b):(b.aa=a.Nc,b.next=s,b.aa==s?a.xb=b:b.aa.next=b,a.Nc=b)}function Lr(a,b){b.aa==s?a.xb=b.next:b.aa.next=b.next;b.next==s?a.Nc=b.aa:b.next.aa=b.aa}function Mr(a,b){b.fa||(b.fa=1,Lr(a,b),Kr(a,b,0))}function Nr(a,b,c){0==c?(b.aa=s,b.next=a.Eb,b.next==s?a.nd=b:b.next.aa=b,a.Eb=b):(b.aa=a.nd,b.next=s,b.aa==s?a.Eb=b:b.aa.next=b,a.nd=b)}function Or(a,b){b.aa==s?a.Eb=b.next:b.aa.next=b.next;b.next==s?a.nd=b.aa:b.next.aa=b.aa}
function Pr(a,b){b.fa||(b.fa=1,Or(a,b),Nr(a,b,0))}function Ri(a){var b={};b.ca=++a.$d;b.name=s;b.c=-v;b.d=+v;b.j=s;b.fa=0;Kr(a,b,1);return b}function Ui(a){var b={};b.A=++a.Zd;b.name=s;b.Na=0;b.c=b.d=b.t=0;b.j=s;b.fa=0;b.kb={};b.pb={};Nr(a,b,1);return b}function Si(a,b,c){var d={};d.k=a;d.e=b;d.i=c;d.ra=s;d.w=a.j;d.oa=s;d.G=b.j;d.w!=s&&(d.w.ra=d);d.G!=s&&(d.G.oa=d);a.j=b.j=d}function Qi(a,b){var c;c={};c.Ud=b;c.info={};c.link=a.top;a.top=c;return c.info}
function Yi(a){for(var b;a.j!=s;)b=a.j,a.j=b.w,b.oa==s?b.e.j=b.G:b.oa.G=b.G,b.G!=s&&(b.G.oa=b.oa)}function Qr(a,b){for(var c;b.j!=s;)c=b.j,b.j=c.G,c.ra==s?c.k.j=c.w:c.ra.w=c.w,c.w!=s&&(c.w.ra=c.ra);Or(a,b)}
function hg(a,b,c){var d=Id,e=Id,f=b.f,g=b.h,j,h,l;a.Wb=b.dir;a.Wb==Gb?l=1:a.Wb==ec&&(l=-1);a.sc=f;a.Ug=g;a.Vg=b.J;d&&b.name!=s&&(a.name=b.name);d&&b.Ya!=s&&(a.Ya=b.Ya);a.da=l*b.da;j=Array(1+f);for(h=1;h<=f;h++){var m=b.k[h],n;j[h]=n=Ri(a);d&&m.name!=s&&(n.name=m.name);if(e){var p=m.ka;m.type==yc?(n.c=-v,n.d=+v):m.type==Zc?(n.c=m.c*p,n.d=+v):m.type==$c?(n.c=-v,n.d=m.d*p):m.type==R?(n.c=m.c*p,n.d=m.d*p):m.type==G&&(n.c=n.d=m.c*p)}else m.type==yc?(n.c=-v,n.d=+v):m.type==Zc?(n.c=m.c,n.d=+v):m.type==
$c?(n.c=-v,n.d=m.d):m.type==R?(n.c=m.c,n.d=m.d):m.type==G&&(n.c=n.d=m.c)}for(f=1;f<=g;f++)if(n=b.e[f],h=Ui(a),d&&n.name!=s&&(h.name=n.name),c==Oi&&(h.Na=Number(n.Aa==ph)),e){m=n.sa;n.type==yc?(h.c=-v,h.d=+v):n.type==Zc?(h.c=n.c/m,h.d=+v):n.type==$c?(h.c=-v,h.d=n.d/m):n.type==R?(h.c=n.c/m,h.d=n.d/m):n.type==G&&(h.c=h.d=n.c/m);h.t=l*n.t*m;for(n=n.j;n!=s;n=n.G)Si(j[n.k.ca],h,n.k.ka*n.i*m)}else{n.type==yc?(h.c=-v,h.d=+v):n.type==Zc?(h.c=n.c,h.d=+v):n.type==$c?(h.c=-v,h.d=n.d):n.type==R?(h.c=n.c,h.d=n.d):
n.type==G&&(h.c=h.d=n.c);h.t=l*n.t;for(n=n.j;n!=s;n=n.G)Si(j[n.k.ca],h,n.i)}a.ba=c;a.ne=e}
function Ag(a,b){var c,d,e,f,g,j,h;Od(b);Xb(b,a.name);dc(b,a.Ya);nc(b,a.Wb);a.Wb==Gb?j=1:a.Wb==ec&&(j=-1);rd(b,0,j*a.da);for(c=a.xb;c!=s;c=c.next)c.fa=e=zc(b,1),Mc(b,e,c.name),d=c.c==-v&&c.d==+v?yc:c.d==+v?Zc:c.c==-v?$c:c.c!=c.d?R:G,pd(b,e,d,c.c,c.d);g=Array(1+b.f);h=Array(1+b.f);for(c=a.Eb;c!=s;c=c.next){e=Hc(b,1);Xc(b,e,c.name);rh(b,e,c.Na?ph:Fc);d=c.c==-v&&c.d==+v?yc:c.d==+v?Zc:c.c==-v?$c:c.c!=c.d?R:G;qd(b,e,d,c.c,c.d);rd(b,e,j*c.t);f=0;for(d=c.j;d!=s;d=d.G)f++,g[f]=d.k.fa,h[f]=d.i;td(b,e,f,g,
h)}a.f=b.f;a.h=b.h;a.J=b.J;a.jf=Array(1+a.f);a.Md=Array(1+a.h);c=a.xb;for(e=0;c!=s;c=c.next)a.jf[++e]=c.ca;c=a.Eb;for(e=0;c!=s;c=c.next)a.Md[++e]=c.A;a.name=a.Ya=s;a.da=0;a.xb=a.Nc=s;a.Eb=a.nd=s}
function dg(a,b){var c,d,e,f;a.Wb==Gb?d=1:a.Wb==ec&&(d=-1);a.ba==ig?(a.bf=b.la,a.mg=b.pa):a.ba==$j?a.yg=b.Te:a.ba==Oi&&(a.og=b.va);if(a.ba==ig){a.ja==s&&(a.ja=Array(1+a.$d));for(f=1;f<=a.$d;f++)a.ja[f]=0;a.ha==s&&(a.ha=Array(1+a.Zd));for(c=1;c<=a.Zd;c++)a.ha[c]=0}a.La==s&&(a.La=Array(1+a.Zd));for(c=1;c<=a.Zd;c++)a.La[c]=v;if(a.ba!=Oi){a.wa==s&&(a.wa=Array(1+a.$d));for(f=1;f<=a.$d;f++)a.wa[f]=v}if(a.ba==ig){for(f=1;f<=a.f;f++)c=b.k[f],e=a.jf[f],a.ja[e]=c.l,a.wa[e]=d*c.H;for(c=1;c<=a.h;c++)d=b.e[c],
e=a.Md[c],a.ha[e]=d.l,a.La[e]=d.q}else if(a.ba==$j){for(f=1;f<=a.f;f++)c=b.k[f],e=a.jf[f],a.wa[e]=d*c.hc;for(c=1;c<=a.h;c++)d=b.e[c],e=a.Md[c],a.La[e]=d.$b}else if(a.ba==Oi)for(c=1;c<=a.h;c++)d=b.e[c],e=a.Md[c],a.La[e]=d.Oa;for(e=a.top;e!=s;e=e.link)e.Ud(a,e.info)}
function eg(a,b){var c,d,e,f;a.Wb==Gb?e=1:a.Wb==ec&&(e=-1);if(a.ba==ig){b.valid=0;b.la=a.bf;b.pa=a.mg;b.Y=b.da;b.some=0;for(d=1;d<=b.f;d++)c=b.k[d],c.l=a.ja[d],c.H=a.ne?e*a.wa[d]*c.ka:e*a.wa[d],c.l==D?c.H=0:c.l==K?c.q=c.c:c.l==od?c.q=c.d:c.l==Yc?c.q=0:c.l==Gc&&(c.q=c.c);for(d=1;d<=b.h;d++)c=b.e[d],c.l=a.ha[d],c.q=a.ne?a.La[d]*c.sa:a.La[d],c.l==D?c.H=0:c.l==K?c.q=c.c:c.l==od?c.q=c.d:c.l==Yc?c.q=0:c.l==Gc&&(c.q=c.c),b.Y+=c.t*c.q;for(d=1;d<=b.f;d++)if(c=b.k[d],c.l==D){f=0;for(e=c.j;e!=s;e=e.w)f+=e.i*
e.e.q;c.q=f}for(d=1;d<=b.h;d++)if(c=b.e[d],c.l!=D){f=c.t;for(e=c.j;e!=s;e=e.G)f-=e.i*e.k.H;c.H=f}}else if(a.ba==$j){b.Te=a.yg;b.Wd=b.da;for(d=1;d<=b.f;d++)c=b.k[d],c.hc=a.ne?e*a.wa[d]*c.ka:e*a.wa[d];for(d=1;d<=b.h;d++)c=b.e[d],c.$b=a.ne?a.La[d]*c.sa:a.La[d],b.Wd+=c.t*c.$b;for(d=1;d<=b.f;d++){c=b.k[d];f=0;for(e=c.j;e!=s;e=e.w)f+=e.i*e.e.$b;c.$b=f}for(d=1;d<=b.h;d++){c=b.e[d];f=c.t;for(e=c.j;e!=s;e=e.G)f-=e.i*e.k.hc;c.hc=f}}else if(a.ba==Oi){b.va=a.og;b.qa=b.da;for(d=1;d<=b.h;d++)c=b.e[d],c.Oa=a.La[d],
b.qa+=c.t*c.Oa;for(d=1;d<=b.f;d++){c=b.k[d];f=0;for(e=c.j;e!=s;e=e.w)f+=e.i*e.e.Oa;c.Oa=f}}}function Rr(a,b){Qi(a,function(a,b){a.ba==ig&&(a.ja[b.r]=D);a.ba!=Oi&&(a.wa[b.r]=0);return 0}).r=b.ca;Yi(b);Lr(a,b)}
function Pi(a,b){var c,d;c=Qi(a,function(a,b){if(a.ba==ig)if(a.ha[b.C]==D||a.ha[b.C]==K||a.ha[b.C]==od)a.ha[b.C]=a.ha[b.C];else return 1;a.La[b.C]=b.Bg+a.La[b.C];return 0});c.C=b.A;c.Bg=b.c;a.da+=b.t*b.c;for(d=b.j;d!=s;d=d.G)c=d.k,c.c==c.d?c.d=c.c-=d.i*b.c:(c.c!=-v&&(c.c-=d.i*b.c),c.d!=+v&&(c.d-=d.i*b.c));b.d!=+v&&(b.d-=b.c);b.c=0}
function Sr(a,b){var c,d;c=Qi(a,function(a,b){a.ba==ig&&(a.ha[b.C]=Gc);a.La[b.C]=b.bh;return 0});c.C=b.A;c.bh=b.c;a.da+=b.t*b.c;for(d=b.j;d!=s;d=d.G)c=d.k,c.c==c.d?c.d=c.c-=d.i*b.c:(c.c!=-v&&(c.c-=d.i*b.c),c.d!=+v&&(c.d-=d.i*b.c));Qr(a,b)}
function Tr(a,b){var c,d,e;d=1E-9+1E-12*Math.abs(b.c);if(b.d-b.c>d)return 0;Qi(a,function(a,b){if(a.ba==ig)if(a.ja[b.r]==D)a.ja[b.r]=D;else if(a.ja[b.r]==Gc)a.ja[b.r]=0<=a.wa[b.r]?K:od;else return 1;return 0}).r=b.ca;c=0.5*(b.d+b.c);e=Math.floor(c+0.5);Math.abs(c-e)<=d&&(c=e);b.c=b.d=c;return 1}
function Ur(a,b){var c,d,e,f;f=1E-9+1E-12*Math.abs(b.c);if(b.d-b.c>f)return 0;c=Qi(a,function(a,b){var c,d;if(a.ba==ig)if(a.ha[b.C]==D)a.ha[b.C]=D;else if(a.ha[b.C]==Gc){d=b.m;for(c=b.j;c!=s;c=c.next)d-=c.i*a.wa[c.wc];a.ha[b.C]=0<=d?K:od}else return 1;return 0});c.C=b.A;c.m=b.t;c.j=s;if(a.ba==ig)for(d=b.j;d!=s;d=d.G)e={},e.wc=d.k.ca,e.i=d.i,e.next=c.j,c.j=e;c=0.5*(b.d+b.c);d=Math.floor(c+0.5);Math.abs(c-d)<=f&&(c=d);b.c=b.d=c;return 1}
function Vr(a,b){var c;if(a.Na)if(c=Math.floor(b+0.5),1E-5>=Math.abs(b-c))b=c;else return 2;if(a.c!=-v){c=a.Na?1E-5:1E-5+1E-8*Math.abs(a.c);if(b<a.c-c)return 1;if(b<a.c+0.0010*c)return a.d=a.c,0}if(a.d!=+v){c=a.Na?1E-5:1E-5+1E-8*Math.abs(a.d);if(b>a.d+c)return 1;if(b>a.d-0.0010*c)return a.c=a.d,0}a.c=a.d=b;return 0}
function Wr(a,b){var c;a.Na&&(c=Math.floor(b+0.5),b=1E-5>=Math.abs(b-c)?c:Math.ceil(b));if(a.c!=-v&&(c=a.Na?0.0010:0.0010+1E-6*Math.abs(a.c),b<a.c+c))return 0;if(a.d!=+v){c=a.Na?1E-5:1E-5+1E-8*Math.abs(a.d);if(b>a.d+c)return 4;if(b>a.d-0.0010*c)return a.c=a.d,3}c=a.c==-v?2:a.Na&&b>a.c+0.5?2:b>a.c+0.3*(1+Math.abs(a.c))?2:1;a.c=b;return c}
function Xr(a,b){var c;a.Na&&(c=Math.floor(b+0.5),b=1E-5>=Math.abs(b-c)?c:Math.floor(b));if(a.d!=+v&&(c=a.Na?0.0010:0.0010+1E-6*Math.abs(a.d),b>a.d-c))return 0;if(a.c!=-v){c=a.Na?1E-5:1E-5+1E-8*Math.abs(a.c);if(b<a.c-c)return 4;if(b<a.c+0.0010*c)return a.d=a.c,3}c=a.d==+v?2:a.Na&&b<a.d-0.5?2:b<a.d-0.3*(1+Math.abs(a.d))?2:1;a.d=b;return c}
function Yr(a,b){var c,d,e,f,g,j;e=b.j;d=e.e;0<e.i?(g=b.c==-v?-v:b.c/e.i,c=b.d==+v?+v:b.d/e.i):(g=b.d==+v?-v:b.d/e.i,c=b.c==-v?+v:b.c/e.i);if(g==-v)g=0;else if(g=Wr(d,g),4==g)return 4;if(c==+v)j=0;else if(3==g)j=0;else if(j=Xr(d,c),4==j)return 4;if(!g&&!j)return b.c=-v,b.d=+v,Rr(a,b),0;c=Qi(a,function(a,b){var c,d;if(a.ba==Oi)return 0;d=b.m;for(c=b.j;c!=s;c=c.next)d-=c.i*a.wa[c.wc];if(a.ba==ig){c=function(){b.Mf?(a.ja[b.r]=0<b.za?K:od,a.ha[b.C]=D,a.wa[b.r]=d/b.za):(a.ja[b.r]=D,a.wa[b.r]=0);return 0};
var e=function(){b.Yf?(a.ja[b.r]=0<b.za?od:K,a.ha[b.C]=D,a.wa[b.r]=d/b.za):(a.ja[b.r]=D,a.wa[b.r]=0);return 0};if(a.ha[b.C]==D)a.ja[b.r]=D,a.wa[b.r]=0;else if(a.ha[b.C]==K)c();else if(a.ha[b.C]==od)e();else if(a.ha[b.C]==Gc){if(1E-7<d&&(0<b.za&&b.c!=-v||0>b.za&&b.d!=+v||!b.Mf))return a.ha[b.C]=K,c();if(-1E-7>d&&(0<b.za&&b.d!=+v||0>b.za&&b.c!=-v||!b.Yf))return a.ha[b.C]=od,e();if(b.c!=-v&&b.d==+v)a.ja[b.r]=K;else if(b.c==-v&&b.d!=+v)a.ja[b.r]=od;else if(b.c!=-v&&b.d!=+v)a.ja[b.r]=b.za*a.La[b.C]<=0.5*
(b.c+b.d)?K:od;else return 1;a.ha[b.C]=D;a.wa[b.r]=d/b.za}else return 1}a.ba==$j&&(a.wa[b.r]=d>+ra&&b.Mf||d<-ra&&b.Yf?d/b.za:0);return 0});c.r=b.ca;c.C=d.A;c.za=e.i;c.m=d.t;c.c=b.c;c.d=b.d;c.Mf=g;c.Yf=j;c.j=s;if(a.ba!=Oi)for(d=d.j;d!=s;d=d.G)d!=e&&(f={},f.wc=d.k.ca,f.i=d.i,f.next=c.j,c.j=f);Yi(b);Lr(a,b);return g>=j?g:j}
function Zr(a,b){function c(){e.l=K;f.d=f.c}function d(){e.l=od;f.c=f.d}var e,f,g,j,h,l;g=b.j;f=g.k;h=f.c;if(h!=-v)for(j=f.j;j!=s;j=j.w)if(j!=g)if(0<j.i){if(j.e.d==+v){h=-v;break}h-=j.i*j.e.d}else{if(j.e.c==-v){h=-v;break}h-=j.i*j.e.c}l=f.d;if(l!=+v)for(j=f.j;j!=s;j=j.w)if(j!=g)if(0<j.i){if(j.e.c==-v){l=+v;break}l-=j.i*j.e.c}else{if(j.e.d==+v){l=+v;break}l-=j.i*j.e.d}j=0<g.i?h==-v?-v:h/g.i:l==+v?-v:l/g.i;h=0<g.i?l==+v?+v:l/g.i:h==-v?+v:h/g.i;if(b.c!=-v&&(l=1E-9+1E-12*Math.abs(b.c),j<b.c-l)||b.d!=
+v&&(l=1E-9+1E-12*Math.abs(b.d),h>b.d+l))return 1;b.c=-v;b.d=+v;e=Qi(a,function(a,b){if(a.ba==ig)if(a.ja[b.r]==D)a.ja[b.r]=D;else if(a.ja[b.r]==Gc)a.ja[b.r]=b.l;else return 1;return 0});e.r=f.ca;e.l=-1;g=b.t/g.i;if(g>+ra)if(f.c!=-v)c();else{if(1E-5<g)return 2;d()}else if(g<-ra)if(f.d!=+v)d();else{if(-1E-5>g)return 2;c()}else f.d==+v?c():f.c==-v?d():Math.abs(f.c)<=Math.abs(f.d)?c():d();return 0}
function $r(a,b,c){var d,e=s,f,g,j;d=1;for(g=b.j;g!=s;g=g.w)d<Math.abs(g.i)&&(d=Math.abs(g.i));for(g=b.j;g!=s;g=g.w)if(Math.abs(g.i)<1E-7*d)return 1;d=Qi(a,function(a,b){var c,d,e,f,g;if(a.ba==Oi)return 0;if(a.ba==ig){if(a.ja[b.r]!=D)return 1;for(c=b.j;c!=s;c=c.next){if(a.ha[c.A]!=Gc)return 1;a.ha[c.A]=c.l}}for(c=b.j;c!=s;c=c.next){e=c.m;for(d=c.j;d!=s;d=d.next)e-=d.i*a.wa[d.wc];c.m=e}d=s;f=0;for(c=b.j;c!=s;c=c.next)if(e=c.m,g=Math.abs(e/c.Tb),c.l==K)0>e&&f<g&&(d=c,f=g);else if(c.l==od)0<e&&f<g&&
(d=c,f=g);else return 1;d!=s&&(a.ba==ig&&(a.ja[b.r]=b.l,a.ha[d.A]=D),a.wa[b.r]=d.m/d.Tb);return 0});d.r=b.ca;d.l=b.c==b.d?Gc:0==c?K:od;d.j=s;for(g=b.j;g!=s;g=g.w)if(f=g.e,a.ba!=Oi&&(e={},e.A=f.A,e.l=-1,e.Tb=g.i,e.m=f.t,e.j=s,e.next=d.j,d.j=e),0==c&&0>g.i||0!=c&&0<g.i?(a.ba!=Oi&&(e.l=K),f.d=f.c):(a.ba!=Oi&&(e.l=od),f.c=f.d),a.ba!=Oi)for(f=f.j;f!=s;f=f.G)f!=g&&(j={},j.wc=f.k.ca,j.i=f.i,j.next=e.j,e.j=j);b.c=-v;b.d=+v;return 0}
function as(a,b,c){a.ba==ig&&(a=Qi(a,function(a,b){if(a.ba!=ig)return 1;a.ja[b.r]=a.ja[b.r]==D?D:b.l;return 0}),a.r=b.ca,a.l=b.d==+v?K:b.c==-v?od:b.c!=b.d?0==c?od:K:Gc);0==c?b.c=-v:1==c&&(b.d=+v)}function Xi(a,b){var c,d,e;d=s;for(c=a.j;c!=s;c=c.w)e={},e.Z=b*c.i,e.Bb=c.e,e.next=d,d=e;return d}
function bs(a,b,c){var d,e,f;for(d=a;d!=s;d=d.next);e=0;for(d=a;d!=s;d=d.next)if(1!=d.Z)if(-1==d.Z)e++;else break;if(d==s&&b==1-e)return 1;for(d=a;d!=s;d=d.next)0>d.Z&&(b-=d.Z);for(d=a;d!=s;d=d.next)if(Math.abs(d.Z)>b)return 0;e=s;for(d=a;d!=s;d=d.next)if(e==s||Math.abs(e.Z)>Math.abs(d.Z))e=d;f=s;for(d=a;d!=s;d=d.next)if(d!=e&&(f==s||Math.abs(f.Z)>Math.abs(d.Z)))f=d;if(Math.abs(e.Z)+Math.abs(f.Z)<=b+(0.0010+1E-6*Math.abs(b)))return 0;b=1;for(d=a;d!=s;d=d.next)0<d.Z?d.Z=1:(d.Z=-1,b-=1);c(b);return 2}
function Vi(a,b){var c,d,e,f,g=0,j;for(f=0;1>=f;f++){if(0==f){if(b.d==+v)continue;e=Xi(b,1);j=+b.d}else{if(b.c==-v)continue;e=Xi(b,-1);j=-b.c}c=bs(e,j,function(a){j=a});if(1==f&&1==c||2==c){g++;if(ja){B("Original constraint:");for(d=b.j;d!=s;d=d.w)B(" "+d.i+" x"+d.e.A);b.c!=-v&&B(", >= "+b.c);b.d!=+v&&B(", <= "+b.d);B("");B("Equivalent packing inequality:");for(d=e;d!=s;d=d.next)B(" "+(0<d.Z?"+":"-")+"x"+d.Bb.A);B(", <= "+j+"")}if(b.c==-v||b.d==+v)c=s;else{c=Ri(a);0==f?(c.c=b.c,c.d=+v):(c.c=-v,c.d=
b.d);for(d=b.j;d!=s;d=d.w)Si(c,d.e,d.i)}Yi(b);b.c=-v;b.d=j;for(d=e;d!=s;d=d.next)Si(b,d.Bb,d.Z);c!=s&&(b=c)}}return g}function cs(a,b,c){var d,e;for(d=a;d!=s;d=d.next);e=0;for(d=a;d!=s;d=d.next)if(1!=d.Z)if(-1==d.Z)e++;else break;if(d==s&&b==1-e)return 1;for(d=a;d!=s;d=d.next)0>d.Z&&(b-=d.Z);if(0.0010>b)return 0;e=1E-9+1E-12*Math.abs(b);for(d=a;d!=s;d=d.next)if(Math.abs(d.Z)<b-e)return 0;b=1;for(d=a;d!=s;d=d.next)0<d.Z?d.Z=1:(d.Z=-1,b-=1);c(b);return 2}
function Wi(a,b){var c,d,e,f,g=0,j;for(f=0;1>=f;f++){if(0==f){if(b.c==-v)continue;e=Xi(b,1);j=+b.c}else{if(b.d==+v)continue;e=Xi(b,-1);j=-b.d}c=cs(e,j,function(a){j=a});if(1==f&&1==c||2==c){g++;if(ja){B("Original constraint:");for(d=b.j;d!=s;d=d.w)B(" "+d.i+" x"+d.e.A);b.c!=-v&&B(", >= "+b.c);b.d!=+v&&B(", <= "+b.d);B("");B("Equivalent covering inequality:");for(d=e;d!=s;d=d.next)B(" "+(0<d.Z?"+":"-")+"x"+d.Bb.A);B(", >= "+j+"")}if(b.c==-v||b.d==+v)c=s;else{c=Ri(a);0==f?(c.c=-v,c.d=b.d):(c.c=b.c,
c.d=+v);for(d=b.j;d!=s;d=d.w)Si(c,d.e,d.i)}Yi(b);b.c=j;b.d=+v;for(d=e;d!=s;d=d.next)Si(b,d.Bb,d.Z);c!=s&&(b=c)}}return g}
function ds(a,b,c){function d(){for(f=b.j;f!=s;f=g){ja&&B("H");e=f.e;g=f.w;for(j=e.j;j!=s;j=j.G)Mr(a,j.k);Sr(a,e)}Rr(a,b);return 0}var e,f,g,j,h;if(b.j==s){h=a;var l=b;0.0010<l.c||-0.0010>l.d?h=1:(l.c=-v,l.d=+v,Rr(h,l),h=0);if(0==h)return ja&&B("A"),0;if(1==h)return ug}if(b.j.w==s)if(e=b.j.e,b.c==b.d){h=a;var l=b,m,n,p;p=l.j;n=p.e;m=Vr(n,l.c/p.i);if(0!=m)h=m;else{m=Qi(h,function(a,b){var c,d;if(a.ba==ig){if(a.ha[b.C]!=Gc)return 1;a.ja[b.r]=Gc;a.ha[b.C]=D}if(a.ba!=Oi){d=b.m;for(c=b.j;c!=s;c=c.next)d-=
c.i*a.wa[c.wc];a.wa[b.r]=d/b.za}return 0});m.r=l.ca;m.C=n.A;m.za=p.i;m.m=n.t;m.j=s;if(h.ba!=Oi)for(p=n.j;p!=s;p=p.G)p.k!=l&&(n={},n.wc=p.k.ca,n.i=p.i,n.next=m.j,m.j=n);Yi(l);Lr(h,l);h=0}if(0==h){ja&&B("B");for(f=e.j;f!=s;f=f.G)Mr(a,f.k);Sr(a,e);return 0}if(1==h||2==h)return ug}else{h=Yr(a,b);if(0<=h&&3>=h){ja&&B("C");Pr(a,e);if(2<=h)for(f=e.j;f!=s;f=f.G)Mr(a,f.k);3==h&&(ja&&B("D"),Sr(a,e));return 0}if(4==h)return ug}a:{l=h=0;for(m=b.j;m!=s;m=m.w)if(0<m.i){if(m.e.c==-v){l=-v;break}l+=m.i*m.e.c}else{if(m.e.d==
+v){l=-v;break}l+=m.i*m.e.d}p=0;for(m=b.j;m!=s;m=m.w)if(0<m.i){if(m.e.d==+v){p=+v;break}p+=m.i*m.e.d}else{if(m.e.c==-v){p=+v;break}p+=m.i*m.e.c}if(b.c!=-v&&(m=0.0010+1E-6*Math.abs(b.c),b.c-m>p)){h=51;break a}if(b.d!=+v&&(m=0.0010+1E-6*Math.abs(b.d),b.d+m<l)){h=51;break a}b.c!=-v&&(m=1E-9+1E-12*Math.abs(b.c),b.c-m>l&&(h=b.c+m<=p?h|1:h|2));b.d!=+v&&(m=1E-9+1E-12*Math.abs(b.d),b.d+m<p&&(h=b.d-m>=l?h|16:h|32))}if(51==h)return ug;if(0==(h&15))b.c!=-v&&(ja&&B("F"),as(a,b,0));else if(1!=(h&15)&&2==(h&15)&&
(ja&&B("G"),0==$r(a,b,0)))return d();if(0==(h&240))b.d!=+v&&(ja&&B("I"),as(a,b,1));else if(16!=(h&240)&&32==(h&240)&&(ja&&B("J"),0==$r(a,b,1)))return d();if(b.c==-v&&b.d==+v){ja&&B("K");for(f=b.j;f!=s;f=f.w)Pr(a,f.e);Rr(a,b);return 0}return a.ba==Oi&&c&&0>es(a,b,1)?ug:0}
function es(a,b,c){var d,e,f,g,j,h=0,l;j=ia;e=1;for(d=b.j;d!=s;d=d.w)d.e.kb.kb=-v,d.e.pb.pb=+v,e<Math.abs(d.i)&&(e=Math.abs(d.i));g=1E-6*e;if(b.c!=-v){e=s;for(d=b.j;d!=s;d=d.w)if(0<d.i&&d.e.d==+v||0>d.i&&d.e.c==-v)if(e==s)e=d;else{j=aa;break}if(!j){j=b.c;for(d=b.j;d!=s;d=d.w)d!=e&&(j=0<d.i?j-d.i*d.e.d:j-d.i*d.e.c);if(e==s)for(d=b.j;d!=s;d=d.w)d.i>=+g?d.e.kb.kb=d.e.d+j/d.i:d.i<=-g&&(d.e.pb.pb=d.e.c+j/d.i);else e.i>=+g?e.e.kb.kb=j/e.i:e.i<=-g&&(e.e.pb.pb=j/e.i)}}j=ia;if(b.d!=+v){e=s;for(d=b.j;d!=s;d=
d.w)if(0<d.i&&d.e.c==-v||0>d.i&&d.e.d==+v)if(e==s)e=d;else{j=aa;break}if(!j){j=b.d;for(d=b.j;d!=s;d=d.w)d!=e&&(j=0<d.i?j-d.i*d.e.c:j-d.i*d.e.d);if(e==s)for(d=b.j;d!=s;d=d.w)d.i>=+g?d.e.pb.pb=d.e.c+j/d.i:d.i<=-g&&(d.e.kb.kb=d.e.d+j/d.i);else e.i>=+g?e.e.pb.pb=j/e.i:e.i<=-g&&(e.e.kb.kb=j/e.i)}}for(e=b.j;e!=s;){d=e.e;e=e.w;for(g=0;1>=g;g++){f=d.c;l=d.d;if(0==g){if(d.kb.kb==-v)continue;j=Wr(d,d.kb.kb)}else{if(d.pb.pb==+v)continue;j=Xr(d,d.pb.pb)}if(0==j||1==j)d.c=f,d.d=l;else if(2==j||3==j){ja&&B("L");
h++;if(c)for(f=d.j;f!=s;f=f.G)f.k!=b&&Mr(a,f.k);if(3==j){ja&&B("M");Sr(a,d);break}}else if(4==j)return-1}}return h}
function fs(a,b){var c,d,e;if(b.j==s){e=function(){g.l=K;b.d=b.c};var f=function(){g.l=od;b.c=b.d},g;0.0010<b.t&&b.c==-v||-0.0010>b.t&&b.d==+v?e=1:(g=Qi(a,function(a,b){a.ba==ig&&(a.ha[b.C]=b.l);return 0}),g.C=b.A,b.c==-v&&b.d==+v?(g.l=Yc,b.c=b.d=0):b.d==+v?e():b.c==-v?f():b.c!=b.d?b.t>=+ra?e():b.t<=-ra?f():Math.abs(b.c)<=Math.abs(b.d)?e():f():g.l=Gc,Sr(a,b),e=0);if(0==e)return ja&&B("N"),0;if(1==e)return vg}if(b.j.G==s)if(c=b.j.k,f=function(){ja&&B("O");var e,f,g,m;g=b.j;f=g.k;e=Qi(a,function(a,
b){var c,d;if(a.ba==ig){if(a.ja[b.r]==D||a.ja[b.r]==Yc)a.ha[b.C]=a.ja[b.r];else if(a.ja[b.r]==K)a.ha[b.C]=0<b.za?od:K;else if(a.ja[b.r]==od)a.ha[b.C]=0<b.za?K:od;else return 1;a.ja[b.r]=Gc}a.ba!=Oi&&(a.wa[b.r]+=b.m/b.za);c=b.kd;for(d=b.j;d!=s;d=d.next)c-=d.i*a.La[d.wc];a.La[b.C]=c/b.za;return 0});e.r=f.ca;e.C=b.A;e.za=g.i;e.kd=f.c;e.m=b.t;e.j=s;for(g=f.j;g!=s;g=g.w)g.e!=b&&(m={},m.wc=g.e.A,m.i=g.i,m.next=e.j,e.j=m,g.e.t-=e.m*(g.i/e.za));a.da+=e.m*(e.kd/e.za);0<e.za?(f.c=b.d==+v?-v:e.kd-e.za*b.d,f.d=
b.c==-v?+v:e.kd-e.za*b.c):(f.c=b.c==-v?-v:e.kd-e.za*b.c,f.d=b.d==+v?+v:e.kd-e.za*b.d);Qr(a,b);if(c.c==-v&&c.d==+v){ja&&B("P");for(d=c.j;d!=s;d=d.w)Pr(a,d.e);Rr(a,c)}else Mr(a,c);return 0},c.c==c.d){if(!b.Na)return f()}else if(!b.Na){e=Zr(a,b);if(0==e)return ja&&B("Q"),f();if(1!=e&&2==e)return vg}return 0}
function kg(a,b){function c(){ja&&B("");return f}var d,e,f,g;for(d=a.xb;d!=s;d=e)e=d.next,d.c==-v&&d.d==+v&&(ja&&B("1"),Rr(a,d));for(d=a.xb;d!=s;d=e)e=d.next,d.c!=-v&&(d.d!=+v&&d.c<d.d)&&(d=Tr(a,d),0!=d&&1==d&&ja&&B("2"));for(e=a.Eb;e!=s;e=g)g=e.next,e.c==e.d&&(ja&&B("3"),Sr(a,e));for(e=a.Eb;e!=s;e=g)g=e.next,e.c!=-v&&(e.d!=+v&&e.c<e.d)&&(d=Ur(a,e),0!=d&&1==d&&(ja&&B("4"),Sr(a,e)));for(d=a.xb;d!=s;d=d.next)d.fa=1;for(d=a.Eb;d!=s;d=d.next)d.fa=1;for(e=1;e;){for(e=0;;){d=a.xb;if(d==s||!d.fa)break;e=
a;g=d;g.fa&&(g.fa=0,Lr(e,g),Kr(e,g,1));f=ds(a,d,b);if(0!=f)return c();e=1}for(;;){d=a.Eb;if(d==s||!d.fa)break;e=a;g=d;g.fa&&(g.fa=0,Or(e,g),Nr(e,g,1));f=fs(a,d);if(0!=f)return c();e=1}}if(a.ba==Oi&&!b)for(d=a.xb;d!=s;d=d.next)if(0>es(a,d,0))return f=ug,c();f=0;return c()}function gs(a){var b,c;b=1;for(c=32;55>=c;b++,c++)a.hb[b]=a.hb[b]-a.hb[c]&2147483647;for(c=1;55>=b;b++,c++)a.hb[b]=a.hb[b]-a.hb[c]&2147483647;a.Gf=54;return a.hb[55]}
function zl(){var a={},b;a.hb=Array(56);a.hb[0]=-1;for(b=1;55>=b;b++)a.hb[b]=0;a.Gf=0;Aj(a,1);return a}function Aj(a,b){var c,d,e=1;b=d=b-0&2147483647;a.hb[55]=d;for(c=21;c;c=(c+21)%55)a.hb[c]=e,e=d-e&2147483647,b=b&1?1073741824+(b>>1):b>>1,e=e-b&2147483647,d=a.hb[c];gs(a);gs(a);gs(a);gs(a);gs(a)}function Al(a){return 0<=a.hb[a.Gf]?a.hb[a.Gf--]:gs(a)}var uk=1,wk=2,Mk=1,Jk=2,tk=0,Lk=1E-10;function Kk(a,b,c){return(b-1)*a.I+c-b*(b-1)/2}
tk&&(Ck=function(a,b){var c=a.h,d=a.Hb,e=a.u,f=a.r,g=a.m,j,h,l,m,n=0;for(j=1;j<=c;j++)for(h=1;h<=c;h++){m=0;for(l=1;l<=c;l++)m+=d[(j-1)*a.I+l]*g[(l-1)*a.I+h];l=f[h];l=j<=l?e[Kk(a,j,l)]:0;m=Math.abs(m-l)/(1+Math.abs(l));n<m&&(n=m)}1E-8<n&&B(b+": dmax = "+n+"; relative error too large")});
function Bk(a,b,c,d){a.vc<a.h&&y("scf_solve_it: singular matrix");if(b){b=a.h;var e=a.Hb,f=a.u,g=a.r,j=a.$f,h,l,m;for(h=1;h<=b;h++)j[h]=c[g[h]+d];for(h=1;h<=b;h++){l=Kk(a,h,h);m=j[h]/=f[l];g=h+1;for(l++;g<=b;g++,l++)j[g]-=f[l]*m}for(g=1;g<=b;g++)c[g+d]=0;for(h=1;h<=b;h++){m=j[h];g=1;for(l=(h-1)*a.I+1;g<=b;g++,l++)c[g+d]+=e[l]*m}}else{b=a.h;e=a.Hb;f=a.u;j=a.r;h=a.$f;for(var n,g=1;g<=b;g++){n=0;l=1;for(m=(g-1)*a.I+1;l<=b;l++,m++)n+=e[m]*c[l+d];h[g]=n}for(g=b;1<=g;g--){n=h[g];l=b;for(m=Kk(a,g,b);l>g;l--,
m--)n-=f[m]*h[l];h[g]=n/f[m]}for(g=1;g<=b;g++)c[j[g]+d]=h[g]}}
var Dg=exports.glp_scale_prob=function(a,b){function c(a,b){var c,d,e;d=1;for(c=a.k[b].j;c!=s;c=c.w)if(e=Math.abs(c.i),e*=c.k.ka*c.e.sa,c.ra==s||d>e)d=e;return d}function d(a,b){var c,d,e;d=1;for(c=a.k[b].j;c!=s;c=c.w)if(e=Math.abs(c.i),e*=c.k.ka*c.e.sa,c.ra==s||d<e)d=e;return d}function e(a,b){var c,d,e;d=1;for(c=a.e[b].j;c!=s;c=c.G)if(e=Math.abs(c.i),e*=c.k.ka*c.e.sa,c.oa==s||d>e)d=e;return d}function f(a,b){var c,d,e;d=1;for(c=a.e[b].j;c!=s;c=c.G)if(e=Math.abs(c.i),e*=c.k.ka*c.e.sa,c.oa==s||d<
e)d=e;return d}function g(a){var b,d,e;for(b=d=1;b<=a.f;b++)if(e=c(a,b),1==b||d>e)d=e;return d}function j(a){var b,c,e;for(b=c=1;b<=a.f;b++)if(e=d(a,b),1==b||c<e)c=e;return c}function h(a){var b,e,f;for(b=e=1;b<=a.f;b++)if(f=d(a,b)/c(a,b),1==b||e<f)e=f;return e}function l(a){var b,c,d;for(b=c=1;b<=a.h;b++)if(d=f(a,b)/e(a,b),1==b||c<d)c=d;return c}b&~(Zi|$i|aj|bj|Eg)&&y("glp_scale_prob: flags = "+b+"; invalid scaling options");b&Eg&&(b=Zi|$i|bj);a:{var m=b,n=function(a,b,c,d){return a+": min|aij| = "+
b+"  max|aij| = "+c+"  ratio = "+d+""},p,t;B("Scaling...");sf(a);p=g(a);t=j(a);B(n(" A",p,t,t/p));if(0.1<=p&&10>=t&&(B("Problem data seem to be well scaled"),m&bj))break a;if(m&Zi){var r=0,w;t=h(a)>l(a);for(p=1;15>=p;p++){w=r;r=j(a)/g(a);if(1<p&&r>0.9*w)break;w=a;for(var E=t,q=k,z=q=k,C=k,z=0;1>=z;z++)if(z==E)for(q=1;q<=w.f;q++)C=c(w,q)*d(w,q),of(w,q,qf(w,q)/Math.sqrt(C));else for(q=1;q<=w.h;q++)C=e(w,q)*f(w,q),pf(w,q,rf(w,q)/Math.sqrt(C))}p=g(a);t=j(a);B(n("GM",p,t,t/p))}if(m&$i){p=h(a)>l(a);for(t=
0;1>=t;t++)if(t==p)for(w=1;w<=a.f;w++)r=d(a,w),of(a,w,qf(a,w)/r);else for(w=1;w<=a.h;w++)r=f(a,w),pf(a,w,rf(a,w)/r);p=g(a);t=j(a);B(n("EQ",p,t,t/p))}if(m&aj){for(m=1;m<=a.f;m++)of(a,m,Bl(qf(a,m)));for(m=1;m<=a.h;m++)pf(a,m,Bl(rf(a,m)));p=g(a);t=j(a);B(n("2N",p,t,t/p))}}};
function Nf(a,b){function c(a,b,c,d){var e=a.f,f=a.ya,g=a.xa,j=a.Fa;a=a.head[b];if(a<=e)e=1,c[1]=a,d[1]=1;else{b=f[a-e];e=f[a-e+1]-b;Ca(c,1,g,b,e);Ca(d,1,j,b,e);for(c=1;c<=e;c++)d[c]=-d[c]}return e}function d(a,b,c){var d=a.f,e=a.bb,f=a.bb,g=a.f,j=a.ya,h=a.xa,l=a.Fa,m=a.head,n,p,q;Ca(f,1,b,1,g);for(b=1;b<=g;b++)if(q=c[b],0!=q)if(n=m[b],n<=g)f[n]-=q;else{p=j[n-g];for(n=j[n-g+1];p<n;p++)f[h[p]]+=l[p]*q}pj(a.R,e);for(a=1;a<=d;a++)c[a]+=e[a]}function e(a,b,c){var d=a.f,e=a.bb,f=a.bb,g=a.f,j=a.ya,h=a.xa,
l=a.Fa,m=a.head,n,p,q,r;for(n=1;n<=g;n++){p=m[n];r=b[n];if(p<=g)r-=c[p];else{q=j[p-g];for(p=j[p-g+1];q<p;q++)r+=l[q]*c[h[q]]}f[n]=r}rj(a.R,e);for(a=1;a<=d;a++)c[a]+=e[a]}function f(a,b,c){var d=a.f,e=a.te,f=a.Ed,g=a.se,j=a.ue,h;if(c<=d)h=e[c]+f[c]++,g[h]=b,j[h]=1;else{h=a.ya;var l=a.xa;a=a.Fa;var m;m=h[c-d];c=h[c-d+1];for(d=m;d<c;d++)h=l[d],h=e[h]+f[h]++,g[h]=b,j[h]=-a[d]}}function g(a,b){var c=a.c,d=a.d,e=a.l,f,g;f=a.head[a.f+b];switch(e[b]){case K:g=c[f];break;case od:g=d[f];break;case Yc:g=0;break;
case Gc:g=c[f]}return g}function j(a){var b=a.h,c=a.Ma,d=a.Gc,f;f=a.f;var g=a.t,j=a.head,h=a.Fc,l;for(l=1;l<=f;l++)h[l]=g[j[l]];Ca(d,1,h,1,f);rj(a.R,d);e(a,h,d);for(f=1;f<=b;f++){g=a.f;l=a.t;h=j=k;j=a.head[g+f];h=l[j];if(j<=g)h-=d[j];else{l=a.ya;for(var m=a.xa,n=a.Fa,p=k,q=k,p=k,p=l[j-g],q=l[j-g+1];p<q;p++)h+=n[p]*d[m[p]]}c[f]=h}}function h(a,b){var c=a.h,d=a.l,e=a.Ma,f=a.jc,g,j,h,l;l=j=0;for(g=1;g<=c;g++){h=e[g];switch(d[g]){case K:if(h>=-b)continue;break;case od:if(h<=+b)continue;break;case Yc:if(-b<=
h&&h<=+b)continue;break;case Gc:continue}h=h*h/f[g];l<h&&(j=g,l=h)}a.C=j}function l(a,b){var c=a.f,d=a.type,e=a.c,f=a.d,g=a.t,j=a.head,h=a.B,l=a.Da,m=a.C,n=a.tb,p=a.Qa,q=a.fh,r,t,u,x,z,A,C,E,F;C=0<a.Ma[m]?-1:1;r=j[c+m];d[r]==R?(m=-1,t=0,F=f[r]-e[r],z=1):(t=m=0,F=v,z=0);for(u=1;u<=q;u++){c=n[u];r=j[c];x=C*p[c];if(0<x)if(1==h&&0>g[r])A=b*(1+w*Math.abs(e[r])),E=(e[r]+A-l[c])/x,r=K;else if(1==h&&0<g[r])continue;else if(d[r]==$c||d[r]==R||d[r]==G)A=b*(1+w*Math.abs(f[r])),E=(f[r]+A-l[c])/x,r=od;else continue;
else if(1==h&&0<g[r])A=b*(1+w*Math.abs(f[r])),E=(f[r]-A-l[c])/x,r=od;else if(1==h&&0>g[r])continue;else if(d[r]==Zc||d[r]==R||d[r]==G)A=b*(1+w*Math.abs(e[r])),E=(e[r]-A-l[c])/x,r=K;else continue;0>E&&(E=0);if(F>E||F==E&&z<Math.abs(x))m=c,t=r,F=E,z=Math.abs(x)}if(!(0==b||0>=m||0==F)){A=F;t=m=0;F=v;z=0;for(u=1;u<=q;u++){c=n[u];r=j[c];x=C*p[c];if(0<x)if(1==h&&0>g[r])E=(e[r]-l[c])/x,r=K;else if(1==h&&0<g[r])continue;else if(d[r]==$c||d[r]==R||d[r]==G)E=(f[r]-l[c])/x,r=od;else continue;else if(1==h&&0<
g[r])E=(f[r]-l[c])/x,r=od;else if(1==h&&0>g[r])continue;else if(d[r]==Zc||d[r]==R||d[r]==G)E=(e[r]-l[c])/x,r=K;else continue;0>E&&(E=0);E<=A&&z<Math.abs(x)&&(m=c,t=r,F=E,z=Math.abs(x))}}a.r=m;a.bf=0<m&&d[j[m]]==G?Gc:t;a.gh=C*F}function m(a){var b=a.f,c=a.h,d=a.t,e=a.Ya;a=a.Va;var f;for(f=1;f<=b;f++)d[f]=0;for(f=1;f<=c;f++)d[b+f]=a*e[f]}function n(a,b){var c=a.f,d=a.type,e=a.c,f=a.d,g=a.t,h=a.head,j=a.B,l=a.Da,m,n,p;for(m=1;m<=c;m++)if(n=h[m],1==j&&0>g[n]){if(p=b*(1+w*Math.abs(e[n])),l[m]>e[n]+p)return 1}else if(1==
j&&0<g[n]){if(p=b*(1+w*Math.abs(f[n])),l[m]<f[n]-p)return 1}else{if(d[n]==Zc||d[n]==R||d[n]==G)if(p=b*(1+w*Math.abs(e[n])),l[m]<e[n]-p)return 1;if(d[n]==$c||d[n]==R||d[n]==G)if(p=b*(1+w*Math.abs(f[n])),l[m]>f[n]+p)return 1}return 0}function p(a){var b=a.f,c=a.h,d=a.Ya,e=a.head,f=a.Da,h,j,l;l=d[0];for(h=1;h<=b;h++)j=e[h],j>b&&(l+=d[j-b]*f[h]);for(f=1;f<=c;f++)j=e[b+f],j>b&&(l+=d[j-b]*g(a,f));return l}function t(a,b,c){var d=a.f,e=a.type,f=a.c,g=a.d,j=a.B,h=a.head,l=a.Da,m,n;if(!(b.n<Cg)&&!(0<b.Za&&
1E3*La(a.dc)<b.Za)&&a.V!=a.Xd&&(c||0==a.V%b.Yb)){m=n=0;for(b=1;b<=d;b++){c=h[b];if(e[c]==Zc||e[c]==R||e[c]==G)l[b]<f[c]&&(n+=f[c]-l[b]);if(e[c]==$c||e[c]==R||e[c]==G)l[b]>g[c]&&(n+=l[b]-g[c]);e[c]==G&&m++}B((1==j?" ":"*")+a.V+": obj = "+p(a)+"  infeas = "+n+" ("+m+")");a.Xd=a.V}}function r(a,b,c,d,e){var f=a.f,g=a.h,j=a.Va,h=a.head,l=a.l,m=a.Da,n=a.Ma;b.valid=1;a.valid=0;b.R=a.R;a.R=s;Ca(b.head,1,h,1,f);b.la=c;b.pa=d;b.Y=p(a);b.V=a.V;b.some=e;for(a=1;a<=f;a++)c=h[a],c<=f?(c=b.k[c],c.l=D,c.bind=a,
c.q=m[a]/c.ka):(c=b.e[c-f],c.l=D,c.bind=a,c.q=m[a]*c.sa),c.H=0;for(m=1;m<=g;m++)if(c=h[f+m],c<=f){c=b.k[c];c.l=l[m];c.bind=0;switch(l[m]){case K:c.q=c.c;break;case od:c.q=c.d;break;case Yc:c.q=0;break;case Gc:c.q=c.c}c.H=n[m]*c.ka/j}else{c=b.e[c-f];c.l=l[m];c.bind=0;switch(l[m]){case K:c.q=c.c;break;case od:c.q=c.d;break;case Yc:c.q=0;break;case Gc:c.q=c.c}c.H=n[m]/c.sa/j}}var w=0.1,E=2,q=0,z=0,C=0,H,O,J,L=a.f,u=a.h,F=a.J,x={};x.f=L;x.h=u;x.type=Array(1+L+u);x.c=Array(1+L+u);x.d=Array(1+L+u);x.t=
Array(1+L+u);x.Ya=Array(1+u);x.ya=Array(1+u+1);x.xa=Array(1+F);x.Fa=Array(1+F);x.head=Array(1+L+u);x.l=Array(1+u);x.te=Array(1+L+1);x.Ed=Array(1+L);x.se=s;x.ue=s;x.Da=Array(1+L);x.Ma=Array(1+u);x.cd=Array(1+L+u);x.jc=Array(1+u);x.tb=Array(1+L);x.Qa=Array(1+L);x.Pb=Array(1+u);x.gb=Array(1+u);x.bb=Array(1+L);x.Fc=Array(1+L);x.Gc=Array(1+L);x.ag=Array(1+L);var P=x.f,I=x.h,X=x.type,A=x.c,M=x.d,N=x.t,za=x.Ya,ua=x.ya,va=x.xa,ka=x.Fa,fc=x.head,Ee=x.l,Ve=x.cd,We=x.jc,xb,Ja,ud,Sd,Ic,ha,ba;for(xb=1;xb<=P;xb++)ha=
a.k[xb],X[xb]=ha.type,A[xb]=ha.c*ha.ka,M[xb]=ha.d*ha.ka,N[xb]=0;for(Ja=1;Ja<=I;Ja++)ba=a.e[Ja],X[P+Ja]=ba.type,A[P+Ja]=ba.c/ba.sa,M[P+Ja]=ba.d/ba.sa,N[P+Ja]=ba.t*ba.sa;za[0]=a.da;Ca(za,1,N,P+1,I);Ic=0;for(Ja=1;Ja<=I;Ja++)Ic<Math.abs(za[Ja])&&(Ic=Math.abs(za[Ja]));0==Ic&&(Ic=1);switch(a.dir){case Gb:x.Va=1/Ic;break;case ec:x.Va=-1/Ic}1>Math.abs(x.Va)&&(x.Va*=1E3);for(Ja=Sd=1;Ja<=I;Ja++){ua[Ja]=Sd;for(var ga=a.e[Ja].j;ga!=s;ga=ga.G)va[Sd]=ga.k.ca,ka[Sd]=ga.k.ka*ga.i*ga.e.sa,Sd++}ua[I+1]=Sd;Ca(fc,1,
a.head,1,P);ud=0;for(xb=1;xb<=P;xb++)ha=a.k[xb],ha.l!=D&&(ud++,fc[P+ud]=xb,Ee[ud]=ha.l);for(Ja=1;Ja<=I;Ja++)ba=a.e[Ja],ba.l!=D&&(ud++,fc[P+ud]=P+Ja,Ee[ud]=ba.l);x.valid=1;a.valid=0;x.R=a.R;a.R=s;var Ob=x.f,gb=x.h,U=x.ya,Bb=x.xa,ca=x.te,Yb=x.Ed,Pb,wa,Fa,Ac,Hb;for(Pb=1;Pb<=Ob;Pb++)Yb[Pb]=1;for(wa=1;wa<=gb;wa++){Fa=U[wa];Ac=U[wa+1];for(Hb=Fa;Hb<Ac;Hb++)Yb[Bb[Hb]]++}for(Pb=ca[1]=1;Pb<=Ob;Pb++)Yb[Pb]>gb&&(Yb[Pb]=gb),ca[Pb+1]=ca[Pb]+Yb[Pb];x.se=Array(ca[Ob+1]);x.ue=Array(ca[Ob+1]);var ad=x.f,Jc=x.h,Fe=
x.head,bd=x.l,ie,cd;Da(x.Ed,1,0,ad);for(ie=1;ie<=Jc;ie++)bd[ie]!=Gc&&(cd=Fe[ad+ie],f(x,ie,cd));x.B=0;x.dc=Ga();x.Jf=x.V=a.V;x.Xd=-1;x.Lb=0;Da(Ve,1,0,P+I);for(Ja=1;Ja<=I;Ja++)We[Ja]=1;for(b.n>=Jg&&B("Objective scale factor = "+x.Va+"");;){if(0==E){var bb=x,fa=hj(bb.R,bb.f,c,bb);bb.valid=0==fa;J=fa;if(0!=J)return b.n>=Jf&&(B("Error: unable to factorize the basis matrix ("+J+")"),B("Sorry, basis recovery procedure not implemented yet")),a.R=x.R,x.R=s,a.la=a.pa=Vb,a.Y=0,a.V=x.V,a.some=0,J=bg;E=x.valid=
1;q=z=0}if(0==q){for(var qa=x,Q=x.Da,Td=qa.f,Rg=qa.h,Wa=qa.ya,Kc=qa.xa,Zb=qa.Fa,jg=qa.head,je=qa.Fc,Xa=k,Ha=k,ke=k,xa=k,cb=k,Ib=k,sb=k,Xa=1;Xa<=Td;Xa++)je[Xa]=0;for(Ha=1;Ha<=Rg;Ha++)if(ke=jg[Td+Ha],sb=g(qa,Ha),0!=sb)if(ke<=Td)je[ke]-=sb;else{xa=Wa[ke-Td];cb=Wa[ke-Td+1];for(Ib=xa;Ib<cb;Ib++)je[Kc[Ib]]+=sb*Zb[Ib]}Ca(Q,1,je,1,Td);pj(qa.R,Q);d(qa,je,Q);q=1;if(0==x.B){for(var rc=b.Ab,Bc=x.f,sc=x.h,Cb=x.type,Xe=x.c,hb=x.d,Aa=x.t,Qb=x.head,Ud=x.Da,Cc=k,nb=k,Db=0,Lc=k,rc=0.9*rc,nb=1;nb<=Bc+sc;nb++)Aa[nb]=
0;for(Cc=1;Cc<=Bc;Cc++){nb=Qb[Cc];if(Cb[nb]==Zc||Cb[nb]==R||Cb[nb]==G)Lc=rc*(1+w*Math.abs(Xe[nb])),Ud[Cc]<Xe[nb]-Lc&&(Aa[nb]=-1,Db++);if(Cb[nb]==$c||Cb[nb]==R||Cb[nb]==G)Lc=rc*(1+w*Math.abs(hb[nb])),Ud[Cc]>hb[nb]+Lc&&(Aa[nb]=1,Db++)}0<Db?x.B=1:(m(x),x.B=2);z=0;t(x,b,1)}if(n(x,b.Ab)){b.n>=Jf&&B("Warning: numerical instability (primal simplex, phase "+(1==x.B?"I":"II")+")");E=x.B=0;C=5;continue}}var tc;if(tc=1==x.B){var la;a:{for(var Ge=b.Ab,Nc=x.f,ib=x.c,da=x.d,Oc=x.t,He=x.head,jb=x.Da,db=k,Ta=k,Jb=
k,db=1;db<=Nc;db++)if(Ta=He[db],0>Oc[Ta]){if(Jb=Ge*(1+w*Math.abs(ib[Ta])),jb[db]<ib[Ta]-Jb){la=1;break a}}else if(0<Oc[Ta]&&(Jb=Ge*(1+w*Math.abs(da[Ta])),jb[db]>da[Ta]+Jb)){la=1;break a}la=0}tc=!la}tc&&(x.B=2,m(x),z=0,t(x,b,1));0==z&&(j(x),z=1);switch(b.ad){case Lg:if(0==x.Lb){var Ya=x.f,gc=x.h,hc=x.head,vd=x.cd,Vd=x.jc,ic=k,Wd=k;x.Lb=1E3;Da(vd,1,0,Ya+gc);for(ic=1;ic<=gc;ic++)Wd=hc[Ya+ic],vd[Wd]=1,Vd[ic]=1}}if(b.kc<pa&&x.V-x.Jf>=b.kc){if(1!=q||2==x.B&&1!=z){1!=q&&(q=0);2==x.B&&1!=z&&(z=0);continue}t(x,
b,1);b.n>=fg&&B("ITERATION LIMIT EXCEEDED; SEARCH TERMINATED");switch(x.B){case 1:H=$h;m(x);j(x);break;case 2:H=Bg}h(x,b.ob);O=0==x.C?Bg:$h;r(x,a,H,O,0);return J=yl}if(b.nb<pa&&1E3*La(x.dc)>=b.nb){if(1!=q||2==x.B&&1!=z){1!=q&&(q=0);2==x.B&&1!=z&&(z=0);continue}t(x,b,1);b.n>=fg&&B("TIME LIMIT EXCEEDED; SEARCH TERMINATED");switch(x.B){case 1:H=$h;m(x);j(x);break;case 2:H=Bg}h(x,b.ob);O=0==x.C?Bg:$h;r(x,a,H,O,0);return J=Sh}t(x,b,0);h(x,b.ob);if(0==x.C){if(1!=q||1!=z){1!=q&&(q=0);1!=z&&(z=0);continue}t(x,
b,1);switch(x.B){case 1:b.n>=fg&&B("PROBLEM HAS NO FEASIBLE SOLUTION");H=Gg;m(x);j(x);h(x,b.ob);O=0==x.C?Bg:$h;break;case 2:b.n>=fg&&B("OPTIMAL SOLUTION FOUND"),H=O=Bg}r(x,a,H,O,0);return J=0}for(var Na=x,Rb=Na.f,Za=Na.tb,$b=Na.Qa,Ed=Na.Qa,uc=k,Fd=k,le=k,Fd=Na.head[Rb+Na.C],uc=1;uc<=Rb;uc++)Ed[uc]=0;if(Fd<=Rb)Ed[Fd]=-1;else for(var jc=Na.ya,Dc=Na.xa,Ra=Na.Fa,Ie=k,me=k,dd=k,Ie=jc[Fd-Rb],me=jc[Fd-Rb+1],dd=Ie;dd<me;dd++)Ed[Dc[dd]]=Ra[dd];pj(Na.R,$b);le=0;for(uc=1;uc<=Rb;uc++)0!=$b[uc]&&(Za[++le]=uc);
Na.Nb=le;if(C){for(var kb=x,lb=kb.f,Pc=kb.tb,ed=kb.Qa,yb=kb.Gc,kc=k,lc=k,Gd=k,lc=kb.head[lb+kb.C],kc=1;kc<=lb;kc++)yb[kc]=0;if(lc<=lb)yb[lc]=-1;else for(var Qc=kb.ya,Mb=kb.xa,Ye=kb.Fa,Ec=k,Hd=k,ob=k,Ec=Qc[lc-lb],Hd=Qc[lc-lb+1],ob=Ec;ob<Hd;ob++)yb[Mb[ob]]=Ye[ob];d(kb,yb,ed);Gd=0;for(kc=1;kc<=lb;kc++)0!=ed[kc]&&(Pc[++Gd]=kc);kb.Nb=Gd}for(var Ka=x,zb=b.pe,ea=Ka.Nb,mb=Ka.tb,pb=Ka.Qa,tb=k,Ua=k,Sa=k,T=k,Kb=k,fd=k,T=0,Sa=1;Sa<=ea;Sa++)fd=Math.abs(pb[mb[Sa]]),T<fd&&(T=fd);Ka.eh=T;Kb=zb*(1+0.01*T);for(Ua=
0;Ua<ea;)tb=mb[ea],Math.abs(pb[tb])<Kb?ea--:(Ua++,mb[ea]=mb[Ua],mb[Ua]=tb);Ka.fh=Ua;for(var gd=x.Ma[x.C],Eb,ne=x.t,Xd=x.head,Yd=x.Nb,Sg=x.tb,xh=x.Qa,hd=k,Lb=k,id=k,id=ne[Xd[x.f+x.C]],Lb=1;Lb<=Yd;Lb++)hd=Sg[Lb],id+=ne[Xd[hd]]*xh[hd];Eb=id;if(Math.abs(gd-Eb)>1E-5*(1+Math.abs(Eb))||!(0>gd&&0>Eb||0<gd&&0<Eb))if(b.n>=Jg&&B("d1 = "+gd+"; d2 = "+Eb+""),1!=z||!C){1!=z&&(z=0);C=5;continue}x.Ma[x.C]=0<gd?0<Eb?Eb:+ra:0>Eb?Eb:-ra;switch(b.ge){case Mg:l(x,0);break;case Ng:l(x,0.3*b.Ab)}if(0==x.r){if(1!=q||1!=
z||!C){1!=q&&(q=0);1!=z&&(z=0);C=1;continue}t(x,b,1);switch(x.B){case 1:b.n>=Jf&&B("Error: unable to choose basic variable on phase I");a.R=x.R;x.R=s;a.la=a.pa=Vb;a.Y=0;a.V=x.V;a.some=0;J=bg;break;case 2:b.n>=fg&&B("PROBLEM HAS UNBOUNDED SOLUTION"),r(x,a,Bg,Gg,x.head[x.f+x.C]),J=0}return J}if(0<x.r){var vf=x.Qa[x.r],lg=1E-5*(1+0.01*x.eh);if(Math.abs(vf)<lg&&(b.n>=Jg&&B("piv = "+vf+"; eps = "+lg+""),!C)){C=5;continue}}if(0<x.r){for(var Jd=x.ag,vc=x,Ze=Jd,mg=vc.f,yh=vc.r,Je=k,Je=1;Je<=mg;Je++)Ze[Je]=
0;Ze[yh]=1;rj(vc.R,Ze);if(C){for(var ng=x,Tg=Jd,Ug=ng.f,Kd=ng.r,Sb=ng.Gc,Rc=k,Rc=1;Rc<=Ug;Rc++)Sb[Rc]=0;Sb[Kd]=1;e(ng,Sb,Tg)}for(var oe=x,Vg=Jd,og=oe.f,Sc=oe.h,Of=oe.te,pg=oe.Ed,qg=oe.se,$e=oe.ue,af=oe.Pb,Ld=oe.gb,wd=k,jd=k,Ke=k,wf=k,xd=k,Pf=k,Wg=k,jd=1;jd<=Sc;jd++)Ld[jd]=0;for(wd=1;wd<=og;wd++)if(Wg=Vg[wd],0!=Wg){Ke=Of[wd];wf=Ke+pg[wd];for(xd=Ke;xd<wf;xd++)Ld[qg[xd]]-=Wg*$e[xd]}Pf=0;for(jd=1;jd<=Sc;jd++)0!=Ld[jd]&&(af[++Pf]=jd);oe.Ac=Pf}if(0<x.r){var bf=x.Qa[x.r],Xg=x.gb[x.C];if(Math.abs(bf-Xg)>
1E-8*(1+Math.abs(bf))||!(0<bf&&0<Xg||0>bf&&0>Xg)){b.n>=Jg&&B("piv1 = "+bf+"; piv2 = "+Xg+"");if(1!=E||!C){1!=E&&(E=0);C=5;continue}0==x.gb[x.C]&&(x.Ac++,x.Pb[x.Ac]=x.C);x.gb[x.C]=bf}}var Yg=x.Da,rg=x.C,cf=x.Nb,df=x.tb,sg=x.Qa,Zd=x.r,Le=x.gh,xf=k,ef=k;0<Zd&&(Yg[Zd]=g(x,rg)+Le);if(0!=Le)for(ef=1;ef<=cf;ef++)xf=df[ef],xf!=Zd&&(Yg[xf]+=sg[xf]*Le);q=2;if(0<x.r){for(var yd=x.Ma,pe=x.C,tg=x.Ac,Nb=x.Pb,zd=x.gb,Me=k,$a=k,$d=k,$d=yd[pe]/=zd[pe],$a=1;$a<=tg;$a++)Me=Nb[$a],Me!=pe&&(yd[Me]-=zd[Me]*$d);z=2;if(1==
x.B){var mc=x.head[x.r];x.Ma[x.C]-=x.t[mc];x.t[mc]=0}}if(0<x.r)switch(b.ad){case Lg:if(0<x.Lb){var Ia=x,qe=Ia.f,Qf=Ia.type,Rf=Ia.ya,Tc=Ia.xa,yf=Ia.Fa,zf=Ia.head,Af=Ia.cd,Tb=Ia.jc,Oa=Ia.C,Uc=Ia.Nb,wc=Ia.tb,kd=Ia.Qa,ae=Ia.r,Zg=Ia.Ac,be=Ia.Pb,Ub=Ia.gb,ce=Ia.Gc,ac=k,re=k,ff=k,Vc=k,Sf=k,Bf=k,ld=k,md=k,wg=k,Ad=k,se=k,oa=k,bc=k,Tf=k;Ia.Lb--;md=wg=Af[zf[qe+Oa]]?1:0;for(ac=1;ac<=qe;ac++)ce[ac]=0;for(Vc=1;Vc<=Uc;Vc++)ac=wc[Vc],Af[zf[ac]]?(ce[ac]=oa=kd[ac],md+=oa*oa):ce[ac]=0;rj(Ia.R,ce);Ad=Ub[Oa];for(Vc=1;Vc<=
Zg;Vc++)if(re=be[Vc],re!=Oa){oa=Ub[re]/Ad;ff=zf[qe+re];if(ff<=qe)se=ce[ff];else{se=0;Sf=Rf[ff-qe];Bf=Rf[ff-qe+1];for(ld=Sf;ld<Bf;ld++)se-=yf[ld]*ce[Tc[ld]]}bc=Tb[re]+oa*oa*md+2*oa*se;Tf=(Af[ff]?1:0)+wg*oa*oa;Tb[re]=bc>=Tf?bc:Tf;Tb[re]<ra&&(Tb[re]=ra)}Qf[zf[ae]]==G?Tb[Oa]=1:(Tb[Oa]=md/(Ad*Ad),Tb[Oa]<ra&&(Tb[Oa]=ra))}}if(0<x.r){var Fb=x,ub=x.r,xg=x.head[x.f+x.C],Uf=Fb.f,Md=k,Nd=k;if(xg<=Uf){var Vf=Array(2),Md=Array(2);Vf[1]=xg;Md[1]=1;Nd=Ek(Fb.R,ub,1,Vf,0,Md)}else{for(var Cf=Fb.ya,fi=Fb.xa,te=Fb.Fa,
Md=Fb.bb,ue=k,Wf=k,de=k,Df=k,ue=Cf[xg-Uf],Wf=Cf[xg-Uf+1],Df=0,de=ue;de<Wf;de++)Md[++Df]=-te[de];Nd=Ek(Fb.R,ub,Df,fi,ue-1,Md)}Fb.valid=0==Nd;J=Nd;E=0==J?2:x.valid=0}if(0<x.r){var Wc=x,gf=x.C,Xf=x.head[x.f+x.C],$g=Wc.f,Ne=Wc.te,Oe=Wc.Ed,cc=Wc.se,yg=Wc.ue,ve=k,we=k,ee=k;if(Xf<=$g){for(ve=we=Ne[Xf];cc[ve]!=gf;ve++);ee=we+--Oe[Xf];cc[ve]=cc[ee];yg[ve]=yg[ee]}else for(var ah=Wc.ya,Yf=Wc.xa,gi=k,zh=k,hf=k,zg=k,zh=ah[Xf-$g],hf=ah[Xf-$g+1],zg=zh;zg<hf;zg++){gi=Yf[zg];for(ve=we=Ne[gi];cc[ve]!=gf;ve++);ee=we+
--Oe[gi];cc[ve]=cc[ee];yg[ve]=yg[ee]}x.type[x.head[x.r]]!=G&&f(x,x.C,x.head[x.r])}var hi=x.f,bh=x.head,ch=x.l,Ef=x.C,dh=x.r,bk=x.bf,Ti=k;if(0>dh)switch(ch[Ef]){case K:ch[Ef]=od;break;case od:ch[Ef]=K}else Ti=bh[dh],bh[dh]=bh[hi+Ef],bh[hi+Ef]=Ti,ch[Ef]=bk;x.V++;0<C&&C--}}
function ag(a,b){function c(a,b,c,d){var e=a.f,f=a.ya,g=a.xa,h=a.Fa;a=a.head[b];if(a<=e)e=1,c[1]=a,d[1]=1;else{b=f[a-e];e=f[a-e+1]-b;Ca(c,1,g,b,e);Ca(d,1,h,b,e);for(c=1;c<=e;c++)d[c]=-d[c]}return e}function d(a,b,c){var d=a.f,e=a.bb,f=a.bb,g=a.f,h=a.ya,j=a.xa,l=a.Fa,m=a.head,n,p,q;Ca(f,1,b,1,g);for(b=1;b<=g;b++)if(q=c[b],0!=q)if(n=m[b],n<=g)f[n]-=q;else{p=h[n-g];for(n=h[n-g+1];p<n;p++)f[j[p]]+=l[p]*q}pj(a.R,e);for(a=1;a<=d;a++)c[a]+=e[a]}function e(a,b,c){var d=a.f,e=a.bb,f=a.bb,g=a.f,h=a.ya,j=a.xa,
l=a.Fa,m=a.head,n,p,q,r;for(n=1;n<=g;n++){p=m[n];r=b[n];if(p<=g)r-=c[p];else{q=h[p-g];for(p=h[p-g+1];q<p;q++)r+=l[q]*c[j[q]]}f[n]=r}rj(a.R,e);for(a=1;a<=d;a++)c[a]+=e[a]}function f(a,b){var c=a.c,d=a.d,e=a.l,f,g;f=a.head[a.f+b];switch(e[b]){case K:g=c[f];break;case od:g=d[f];break;case Yc:g=0;break;case Gc:g=c[f]}return g}function g(a,b){var c=a.f,e=a.h,g=a.ya,h=a.xa,j=a.Fa,l=a.head,m=a.Fc,n,p,q,r;for(n=1;n<=c;n++)m[n]=0;for(n=1;n<=e;n++)if(p=l[c+n],r=f(a,n),0!=r)if(p<=c)m[p]-=r;else{q=g[p-c];for(p=
g[p-c+1];q<p;q++)m[h[q]]+=r*j[q]}Ca(b,1,m,1,c);pj(a.R,b);d(a,m,b)}function j(a){var b=a.h,c=a.Ma,d=a.Gc,f;f=a.f;var g=a.t,h=a.head,j=a.Fc,l;for(l=1;l<=f;l++)j[l]=g[h[l]];Ca(d,1,j,1,f);rj(a.R,d);e(a,j,d);for(f=1;f<=b;f++){g=a.f;l=a.t;j=h=k;h=a.head[g+f];j=l[h];if(h<=g)j-=d[h];else{l=a.ya;for(var m=a.xa,n=a.Fa,p=k,q=k,p=k,p=l[h-g],q=l[h-g+1];p<q;p++)j+=n[p]*d[m[p]]}c[f]=j}}function h(a,b){var c=a.l,d=a.Ma,e=a.Pb,f=a.gb,g=a.ih,h,j,l,m,n,p,q,r,t;p=0<a.Ie?1:-1;l=0;r=v;n=0;for(j=1;j<=g;j++){h=e[j];m=p*
f[h];if(0<m)if(c[h]==K||c[h]==Yc)q=(d[h]+b)/m;else continue;else if(c[h]==od||c[h]==Yc)q=(d[h]-b)/m;else continue;0>q&&(q=0);if(r>q||r==q&&n<Math.abs(m))l=h,r=q,n=Math.abs(m)}if(!(0==b||0==l||0==r)){t=r;l=0;r=v;n=0;for(j=1;j<=g;j++){h=e[j];m=p*f[h];if(0<m)if(c[h]==K||c[h]==Yc)q=d[h]/m;else continue;else if(c[h]==od||c[h]==Yc)q=d[h]/m;else continue;0>q&&(q=0);q<=t&&n<Math.abs(m)&&(l=h,r=q,n=Math.abs(m))}}a.C=l;a.Qg=p*r}function l(a,b){var c=a.f,d=a.h,e=a.Xb,f=a.head,g=a.Ma,h,j;for(h=1;h<=d;h++)if(j=
f[c+h],g[h]<-b&&(e[j]==Zc||e[j]==yc)||g[h]>+b&&(e[j]==$c||e[j]==yc))return 1;return 0}function m(a){var b=a.f,c=a.h,d=a.type,e=a.c,f=a.d,g=a.Yc,h=a.Zc,j=a.head,l=a.l,m=a.Ma;Ca(d,1,a.Xb,1,b+c);Ca(e,1,g,1,b+c);Ca(f,1,h,1,b+c);for(a=1;a<=c;a++)switch(g=j[b+a],d[g]){case yc:l[a]=Yc;break;case Zc:l[a]=K;break;case $c:l[a]=od;break;case R:l[a]=m[a]>=+ra?K:m[a]<=-ra?od:Math.abs(e[g])<=Math.abs(f[g])?K:od;break;case G:l[a]=Gc}}function n(a){var b=a.f,c=a.h,d=a.Ya,e=a.head,g=a.Da,h,j,l;l=d[0];for(h=1;h<=b;h++)j=
e[h],j>b&&(l+=d[j-b]*g[h]);for(g=1;g<=c;g++)j=e[b+g],j>b&&(l+=d[j-b]*f(a,g));return l}function p(a,b,c){var d=a.f,e=a.h,g=a.t,h=a.Xb,j=a.head,l=a.l,m=a.B,p=a.Da,q=a.Ma;if(!(b.n<Cg)&&!(0<b.Za&&1E3*La(a.dc)<b.Za)&&a.V!=a.Xd&&(c||0==a.V%b.Yb)){b=0;if(1==m){for(l=1;l<=d;l++)b-=g[j[l]]*p[l];for(p=1;p<=e;p++)b-=g[j[d+p]]*f(a,p)}else for(p=1;p<=e;p++){if(0>q[p]&&(l[p]==K||l[p]==Yc))b-=q[p];if(0<q[p]&&(l[p]==od||l[p]==Yc))b+=q[p]}e=0;for(l=1;l<=d;l++)h[j[l]]==G&&e++;1==a.B?B(" "+a.V+":  infeas = "+b+" ("+
e+")"):B("|"+a.V+": obj = "+n(a)+"  infeas = "+b+" ("+e+")");a.Xd=a.V}}function t(a,b,c,d,e){var f=a.f,g=a.h,h=a.Va,j=a.head,l=a.l,m=a.Da,p=a.Ma;b.valid=1;a.valid=0;b.R=a.R;a.R=s;Ca(b.head,1,j,1,f);b.la=c;b.pa=d;b.Y=n(a);b.V=a.V;b.some=e;for(a=1;a<=f;a++)c=j[a],c<=f?(c=b.k[c],c.l=D,c.bind=a,c.q=m[a]/c.ka):(c=b.e[c-f],c.l=D,c.bind=a,c.q=m[a]*c.sa),c.H=0;for(m=1;m<=g;m++)if(c=j[f+m],c<=f){c=b.k[c];c.l=l[m];c.bind=0;switch(l[m]){case K:c.q=c.c;break;case od:c.q=c.d;break;case Yc:c.q=0;break;case Gc:c.q=
c.c}c.H=p[m]*c.ka/h}else{c=b.e[c-f];c.l=l[m];c.bind=0;switch(l[m]){case K:c.q=c.c;break;case od:c.q=c.d;break;case Yc:c.q=0;break;case Gc:c.q=c.c}c.H=p[m]/c.sa/h}}var r=2,w=0,E=0,q=0,z,C,H,O=a.f,J=a.h,L=a.J,u={};u.f=O;u.h=J;u.type=Array(1+O+J);u.c=Array(1+O+J);u.d=Array(1+O+J);u.t=Array(1+O+J);u.Xb=Array(1+O+J);u.Yc=Array(1+O+J);u.Zc=Array(1+O+J);u.Ya=Array(1+J);u.ya=Array(1+J+1);u.xa=Array(1+L);u.Fa=Array(1+L);u.cg=Array(1+O+1);u.bg=Array(1+L);u.dg=Array(1+L);u.head=Array(1+O+J);u.bind=Array(1+O+
J);u.l=Array(1+J);u.Da=Array(1+O);u.Ma=Array(1+J);u.cd=Array(1+O+J);u.jc=Array(1+O);u.Pb=Array(1+J);u.gb=Array(1+J);u.tb=Array(1+O);u.Qa=Array(1+O);u.bb=Array(1+O);u.Fc=Array(1+O);u.Gc=Array(1+O);u.ag=Array(1+O);var F=u.f,x=u.h,P=u.type,I=u.c,X=u.d,A=u.t,M=u.Xb,N=u.Yc,za=u.Zc,ua=u.Ya,va=u.ya,ka=u.xa,fc=u.Fa,Ee=u.cg,Ve=u.bg,We=u.dg,xb=u.head,Ja=u.bind,ud=u.l,Sd=u.cd,Ic=u.jc,ha,ba,ga,Ob,gb,U,Bb,ca;for(ha=1;ha<=F;ha++)Bb=a.k[ha],P[ha]=Bb.type,I[ha]=Bb.c*Bb.ka,X[ha]=Bb.d*Bb.ka,A[ha]=0;for(ba=1;ba<=x;ba++)ca=
a.e[ba],P[F+ba]=ca.type,I[F+ba]=ca.c/ca.sa,X[F+ba]=ca.d/ca.sa,A[F+ba]=ca.t*ca.sa;Ca(M,1,P,1,F+x);Ca(N,1,I,1,F+x);Ca(za,1,X,1,F+x);ua[0]=a.da;Ca(ua,1,A,F+1,x);gb=0;for(ba=1;ba<=x;ba++)gb<Math.abs(ua[ba])&&(gb=Math.abs(ua[ba]));0==gb&&(gb=1);switch(a.dir){case Gb:u.Va=1/gb;break;case ec:u.Va=-1/gb}1>Math.abs(u.Va)&&(u.Va*=1E3);for(ba=1;ba<=x;ba++)A[F+ba]*=u.Va;for(ba=Ob=1;ba<=x;ba++){va[ba]=Ob;for(U=a.e[ba].j;U!=s;U=U.G)ka[Ob]=U.k.ca,fc[Ob]=U.k.ka*U.i*U.e.sa,Ob++}va[x+1]=Ob;for(ha=Ob=1;ha<=F;ha++){Ee[ha]=
Ob;for(U=a.k[ha].j;U!=s;U=U.w)Ve[Ob]=U.e.A,We[Ob]=U.k.ka*U.i*U.e.sa,Ob++}Ee[F+1]=Ob;Ca(xb,1,a.head,1,F);ga=0;for(ha=1;ha<=F;ha++)Bb=a.k[ha],Bb.l!=D&&(ga++,xb[F+ga]=ha,ud[ga]=Bb.l);for(ba=1;ba<=x;ba++)ca=a.e[ba],ca.l!=D&&(ga++,xb[F+ga]=F+ba,ud[ga]=ca.l);for(ga=1;ga<=F+x;ga++)Ja[xb[ga]]=ga;u.valid=1;a.valid=0;u.R=a.R;a.R=s;u.B=0;u.dc=Ga();u.Jf=u.V=a.V;u.Xd=-1;u.Lb=0;Da(Sd,1,0,F+x);for(ha=1;ha<=F;ha++)Ic[ha]=1;for(b.n>=Jg&&B("Objective scale factor = "+u.Va+"");;){if(0==r){var Yb=u,Pb=hj(Yb.R,Yb.f,c,
Yb);Yb.valid=0==Pb;H=Pb;if(0!=H)return b.n>=Jf&&(B("Error: unable to factorize the basis matrix ("+H+")"),B("Sorry, basis recovery procedure not implemented yet")),a.R=u.R,u.R=s,a.la=a.pa=Vb,a.Y=0,a.V=u.V,a.some=0,H=bg;r=u.valid=1;w=E=0}if(0==E){j(u);E=1;if(0==u.B){if(0!=l(u,0.9*b.ob)){u.B=1;for(var wa=u.f,Fa=u.h,Ac=u.type,Hb=u.c,ad=u.d,Jc=u.Xb,Fe=u.head,bd=u.l,ie=u.Ma,cd=k,bb=k,bb=1;bb<=wa+Fa;bb++)switch(Jc[bb]){case yc:Ac[bb]=R;Hb[bb]=-1E3;ad[bb]=1E3;break;case Zc:Ac[bb]=R;Hb[bb]=0;ad[bb]=1;break;
case $c:Ac[bb]=R;Hb[bb]=-1;ad[bb]=0;break;case R:case G:Ac[bb]=G,Hb[bb]=ad[bb]=0}for(cd=1;cd<=Fa;cd++)bb=Fe[wa+cd],bd[cd]=Ac[bb]==G?Gc:0<=ie[cd]?K:od}else u.B=2,m(u);w=u.Lb=0}var fa;a:{for(var qa=b.ob,Q=u.h,Td=u.l,Rg=u.Ma,Wa=k,Wa=1;Wa<=Q;Wa++)if(Rg[Wa]<-qa&&(Td[Wa]==K||Td[Wa]==Yc)||Rg[Wa]>+qa&&(Td[Wa]==od||Td[Wa]==Yc)){fa=1;break a}fa=0}if(0!=fa){b.n>=Jf&&B("Warning: numerical instability (dual simplex, phase "+(1==u.B?"I":"II")+")");if(b.Xa==$f)return t(u,a,Vb,Vb,0),H=bg;r=u.B=0;q=5;continue}}1==
u.B&&0==l(u,b.ob)&&(p(u,b,1),u.B=2,1!=E&&(j(u),E=1),m(u),w=u.Lb=0);0==w&&(g(u,u.Da),2==u.B&&(u.Da[0]=n(u)),w=1);switch(b.ad){case Lg:if(0==u.Lb){var Kc=u.f,Zb=u.h,jg=u.head,je=u.cd,Xa=u.jc,Ha=k,ke=k;u.Lb=1E3;Da(je,1,0,Kc+Zb);for(Ha=1;Ha<=Kc;Ha++)ke=jg[Ha],je[ke]=1,Xa[Ha]=1}}if(2==u.B&&0>u.Va&&b.Xe>-v&&u.Da[0]<=b.Xe){if(1!=w||1!=E){1!=w&&(w=0);1!=E&&(E=0);continue}p(u,b,1);b.n>=fg&&B("OBJECTIVE LOWER LIMIT REACHED; SEARCH TERMINATED");t(u,a,$h,Bg,0);return H=Yh}if(2==u.B&&0<u.Va&&b.Ye<+v&&u.Da[0]>=
b.Ye){if(1!=w||1!=E){1!=w&&(w=0);1!=E&&(E=0);continue}p(u,b,1);b.n>=fg&&B("OBJECTIVE UPPER LIMIT REACHED; SEARCH TERMINATED");t(u,a,$h,Bg,0);return H=Zh}if(b.kc<pa&&u.V-u.Jf>=b.kc){if(2==u.B&&1!=w||1!=E){2==u.B&&1!=w&&(w=0);1!=E&&(E=0);continue}p(u,b,1);b.n>=fg&&B("ITERATION LIMIT EXCEEDED; SEARCH TERMINATED");switch(u.B){case 1:C=$h;m(u);g(u,u.Da);break;case 2:C=Bg}t(u,a,$h,C,0);return H=yl}if(b.nb<pa&&1E3*La(u.dc)>=b.nb){if(2==u.B&&1!=w||1!=E){2==u.B&&1!=w&&(w=0);1!=E&&(E=0);continue}p(u,b,1);b.n>=
fg&&B("TIME LIMIT EXCEEDED; SEARCH TERMINATED");switch(u.B){case 1:C=$h;m(u);g(u,u.Da);break;case 2:C=Bg}t(u,a,$h,C,0);return H=Sh}p(u,b,0);for(var xa=u,cb=b.Ab,Ib=xa.f,sb=xa.type,rc=xa.c,Bc=xa.d,sc=xa.head,Cb=xa.Da,Xe=xa.jc,hb=k,Aa=k,Qb=k,Ud=k,Cc=k,nb=k,Db=k,Lc=k,Cc=Ud=Qb=0,hb=1;hb<=Ib;hb++){Aa=sc[hb];Db=0;if(sb[Aa]==Zc||sb[Aa]==R||sb[Aa]==G)nb=cb*(1+0.1*Math.abs(rc[Aa])),Cb[hb]<rc[Aa]-nb&&(Db=rc[Aa]-Cb[hb]);if(sb[Aa]==$c||sb[Aa]==R||sb[Aa]==G)nb=cb*(1+0.1*Math.abs(Bc[Aa])),Cb[hb]>Bc[Aa]+nb&&(Db=
Bc[Aa]-Cb[hb]);0!=Db&&(Lc=Xe[hb],Lc<ra&&(Lc=ra),Lc=Db*Db/Lc,Cc<Lc&&(Qb=hb,Ud=Db,Cc=Lc))}xa.r=Qb;xa.Ie=Ud;if(0==u.r){if(1!=w||1!=E){1!=w&&(w=0);1!=E&&(E=0);continue}p(u,b,1);switch(u.B){case 1:b.n>=fg&&B("PROBLEM HAS NO DUAL FEASIBLE SOLUTION");m(u);g(u,u.Da);z=$h;C=Gg;break;case 2:b.n>=fg&&B("OPTIMAL SOLUTION FOUND"),z=C=Bg}t(u,a,z,C,0);return H=0}for(var tc=u.ag,la=u,Ge=tc,Nc=la.f,ib=la.r,da=k,da=1;da<=Nc;da++)Ge[da]=0;Ge[ib]=1;rj(la.R,tc);if(q){for(var Oc=u,He=tc,jb=Oc.f,db=Oc.r,Ta=Oc.Gc,Jb=k,Jb=
1;Jb<=jb;Jb++)Ta[Jb]=0;Ta[db]=1;e(Oc,Ta,He)}for(var Ya=u,gc=tc,hc=Ya.f,vd=k,Vd=k,Vd=0,vd=1;vd<=hc;vd++)0!=gc[vd]&&Vd++;if(0.2<=Vd/hc){for(var ic=Ya,Wd=gc,Na=ic.f,Rb=ic.h,Za=ic.ya,$b=ic.xa,Ed=ic.Fa,uc=ic.head,Fd=ic.l,le=ic.Pb,jc=ic.gb,Dc=k,Ra=k,Ie=k,me=k,dd=k,kb=k,lb=k,kb=0,Dc=1;Dc<=Rb;Dc++)if(Fd[Dc]==Gc)jc[Dc]=0;else{Ra=uc[Na+Dc];if(Ra<=Na)lb=-Wd[Ra];else{Ie=Za[Ra-Na];me=Za[Ra-Na+1];lb=0;for(dd=Ie;dd<me;dd++)lb+=Wd[$b[dd]]*Ed[dd]}0!=lb&&(le[++kb]=Dc);jc[Dc]=lb}ic.Ac=kb}else{for(var Pc=Ya,ed=gc,yb=
Pc.f,kc=Pc.h,lc=Pc.cg,Gd=Pc.bg,Qc=Pc.dg,Mb=Pc.bind,Ye=Pc.l,Ec=Pc.Pb,Hd=Pc.gb,ob=k,Ka=k,zb=k,ea=k,mb=k,pb=k,tb=k,Ka=1;Ka<=kc;Ka++)Hd[Ka]=0;for(ob=1;ob<=yb;ob++)if(tb=ed[ob],0!=tb){Ka=Mb[ob]-yb;1<=Ka&&Ye[Ka]!=Gc&&(Hd[Ka]-=tb);zb=lc[ob];ea=lc[ob+1];for(mb=zb;mb<ea;mb++)Ka=Mb[yb+Gd[mb]]-yb,1<=Ka&&Ye[Ka]!=Gc&&(Hd[Ka]+=tb*Qc[mb])}pb=0;for(Ka=1;Ka<=kc;Ka++)0!=Hd[Ka]&&(Ec[++pb]=Ka);Pc.Ac=pb}for(var Ua=u,Sa=b.Ab,T=Ua.Ac,Kb=Ua.Pb,fd=Ua.gb,gd=k,Eb=k,ne=k,Xd=k,Yd=k,Sg=k,Xd=0,ne=1;ne<=T;ne++)Sg=Math.abs(fd[Kb[ne]]),
Xd<Sg&&(Xd=Sg);Ua.hh=Xd;Yd=Sa*(1+0.01*Xd);for(Eb=0;Eb<T;)gd=Kb[T],Math.abs(fd[gd])<Yd?T--:(Eb++,Kb[T]=Kb[Eb],Kb[Eb]=gd);Ua.ih=Eb;switch(b.ge){case Mg:h(u,0);break;case Ng:h(u,0.3*b.ob)}if(0==u.C){if(1!=w||1!=E||!q){1!=w&&(w=0);1!=E&&(E=0);q=1;continue}p(u,b,1);switch(u.B){case 1:b.n>=Jf&&B("Error: unable to choose basic variable on phase I");a.R=u.R;u.R=s;a.la=a.pa=Vb;a.Y=0;a.V=u.V;a.some=0;H=bg;break;case 2:b.n>=fg&&B("PROBLEM HAS NO FEASIBLE SOLUTION"),t(u,a,Gg,Bg,u.head[u.r]),H=0}return H}var xh=
u.gb[u.C],hd=1E-5*(1+0.01*u.hh);if(Math.abs(xh)<hd&&(b.n>=Jg&&B("piv = "+xh+"; eps = "+hd+""),!q)){q=5;continue}for(var Lb=u,id=Lb.f,vf=Lb.tb,lg=Lb.Qa,Jd=Lb.Qa,vc=k,Ze=k,mg=k,Ze=Lb.head[id+Lb.C],vc=1;vc<=id;vc++)Jd[vc]=0;if(Ze<=id)Jd[Ze]=-1;else for(var yh=Lb.ya,Je=Lb.xa,ng=Lb.Fa,Tg=k,Ug=k,Kd=k,Tg=yh[Ze-id],Ug=yh[Ze-id+1],Kd=Tg;Kd<Ug;Kd++)Jd[Je[Kd]]=ng[Kd];pj(Lb.R,lg);mg=0;for(vc=1;vc<=id;vc++)0!=lg[vc]&&(vf[++mg]=vc);Lb.Nb=mg;if(q){for(var Sb=u,Rc=Sb.f,oe=Sb.tb,Vg=Sb.Qa,og=Sb.Gc,Sc=k,Of=k,pg=k,Of=
Sb.head[Rc+Sb.C],Sc=1;Sc<=Rc;Sc++)og[Sc]=0;if(Of<=Rc)og[Of]=-1;else for(var qg=Sb.ya,$e=Sb.xa,af=Sb.Fa,Ld=k,wd=k,jd=k,Ld=qg[Of-Rc],wd=qg[Of-Rc+1],jd=Ld;jd<wd;jd++)og[$e[jd]]=af[jd];d(Sb,og,Vg);pg=0;for(Sc=1;Sc<=Rc;Sc++)0!=Vg[Sc]&&(oe[++pg]=Sc);Sb.Nb=pg}var Ke=u.Qa[u.r],wf=u.gb[u.C];if(Math.abs(Ke-wf)>1E-8*(1+Math.abs(Ke))||!(0<Ke&&0<wf||0>Ke&&0>wf)){b.n>=Jg&&B("piv1 = "+Ke+"; piv2 = "+wf+"");if(1!=r||!q){1!=r&&(r=0);q=5;continue}0==u.Qa[u.r]&&(u.Nb++,u.tb[u.Nb]=u.r);u.Qa[u.r]=wf}var xd=u.Da,Pf=u.r,
Wg=u.C,bf=u.Nb,Xg=u.tb,Yg=u.Qa,rg=k,cf=k,df=k,df=u.Ie/Yg[Pf];xd[Pf]=f(u,Wg)+df;if(0!=df)for(cf=1;cf<=bf;cf++)rg=Xg[cf],rg!=Pf&&(xd[rg]+=Yg[rg]*df);2==u.B&&(u.Da[0]+=u.Ma[u.C]/u.Va*(u.Ie/u.Qa[u.r]));var w=2,sg=u.Ma,Zd=u.Ac,Le=u.Pb,xf=u.gb,ef=u.C,yd=u.Qg,pe=k,tg=k;sg[ef]=yd;if(0!=yd)for(tg=1;tg<=Zd;tg++)pe=Le[tg],pe!=ef&&(sg[pe]-=xf[pe]*yd);E=2;switch(b.ad){case Lg:if(0<u.Lb){var Nb=u,zd=Nb.f,Me=Nb.type,$a=Nb.head,$d=Nb.cd,mc=Nb.jc,Ia=Nb.r,qe=Nb.Ac,Qf=Nb.Pb,Rf=Nb.gb,Tc=Nb.C,yf=Nb.Nb,zf=Nb.tb,Af=Nb.Qa,
Tb=Nb.Gc,Oa=k,Uc=k,wc=k,kd=k,ae=k,Zg=k,be=k,Ub=k,ce=k,ac=k;Nb.Lb--;ae=Zg=$d[$a[Ia]]?1:0;for(Oa=1;Oa<=zd;Oa++)Tb[Oa]=0;for(kd=1;kd<=qe;kd++)if(Uc=Qf[kd],wc=$a[zd+Uc],$d[wc])if(Ub=Rf[Uc],ae+=Ub*Ub,wc<=zd)Tb[wc]+=Ub;else{var re=Nb.ya,ff=Nb.xa,Vc=Nb.Fa,Sf,Bf,ld;Sf=re[wc-zd];Bf=re[wc-zd+1];for(ld=Sf;ld<Bf;ld++)Tb[ff[ld]]-=Ub*Vc[ld]}pj(Nb.R,Tb);be=Af[Ia];for(kd=1;kd<=yf;kd++)Oa=zf[kd],wc=$a[Oa],Oa!=Ia&&Me[$a[Oa]]!=yc&&(Ub=Af[Oa]/be,ce=mc[Oa]+Ub*Ub*ae+2*Ub*Tb[Oa],ac=($d[wc]?1:0)+Zg*Ub*Ub,mc[Oa]=ce>=ac?ce:
ac,mc[Oa]<ra&&(mc[Oa]=ra));Me[$a[zd+Tc]]==yc?mc[Ia]=1:(mc[Ia]=ae/(be*be),mc[Ia]<ra&&(mc[Ia]=ra));wc=$a[Ia];if(Me[wc]==G&&$d[wc]){$d[wc]=0;for(kd=1;kd<=yf;kd++){Oa=zf[kd];if(Oa==Ia){if(Me[$a[zd+Tc]]==yc)continue;Ub=1/Af[Ia]}else{if(Me[$a[Oa]]==yc)continue;Ub=Af[Oa]/Af[Ia]}mc[Oa]-=Ub*Ub;mc[Oa]<ra&&(mc[Oa]=ra)}}}}var md=u,wg=u.r,Ad=u.head[u.f+u.C],se=md.f,oa=k,bc=k;if(Ad<=se){var Tf=Array(2),bc=Array(2);Tf[1]=Ad;bc[1]=1;oa=Ek(md.R,wg,1,Tf,0,bc)}else{for(var Fb=md.ya,ub=md.xa,xg=md.Fa,bc=md.bb,Uf=k,Md=
k,Nd=k,Vf=k,Uf=Fb[Ad-se],Md=Fb[Ad-se+1],Vf=0,Nd=Uf;Nd<Md;Nd++)bc[++Vf]=-xg[Nd];oa=Ek(md.R,wg,Vf,ub,Uf-1,bc)}md.valid=0==oa;H=oa;r=0==H?2:u.valid=0;var Cf=u.f,fi=u.type,te=u.head,ue=u.bind,Wf=u.l,de=u.r,Df=u.Ie,Wc=u.C,gf=k,gf=te[de];te[de]=te[Cf+Wc];te[Cf+Wc]=gf;ue[te[de]]=de;ue[te[Cf+Wc]]=Cf+Wc;Wf[Wc]=fi[gf]==G?Gc:0<Df?K:od;u.V++;0<q&&q--}};
}(typeof exports === 'object' && exports || this));