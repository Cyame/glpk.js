/*! glpk.js - v4.47.0 - 2012-12-12
* https://github.com/hgourvest/glpk.js
* Copyright (c) 2012 Henri Gourvest; Licensed GPLv2 */
(function(e){function l(e){throw new Error(e)}function c(e){if(!e)throw new Error("assert")}function p(e,t){for(var n in t)e[n]=t[n]}function d(e,t,n,r,i){for(;i>0;t++,r++,i--)e[t]=n[r]}function v(e,t,n,r){for(;r>0;t++,r--)e[t]=n}function m(e,t,n){for(;n>0;t++,n--)e[t]={}}function g(){var e=new Date;return e.getTime()}function y(e,t){return(e-t)/1e3}function b(e,t,n,r){var i=new Array(n);d(i,0,e,t,n),i.sort(r),d(e,t,i,0,n)}function E(){return w}function x(e){return" 	\n\f\r".indexOf(e)>=0}function T(e){var t=typeof e=="string"?e.charCodeAt(0):-1;return t>=0&&t<=31||t==127}function N(e){var t=typeof e=="string"?e.charCodeAt(0):-1;return t>=65&&t<=90||t>=97&&t<=122}function C(e){var t=typeof e=="string"?e.charCodeAt(0):-1;return t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57}function k(e){var t=typeof e=="string"?e.charCodeAt(0):-1;return t>=48&&t<=57}function L(e,t){return e.indexOf(t)}function A(e){return e.toLowerCase()}function M(e){e.magic=O,e.parms=null,e.tree=null,e.name=null,e.obj=null,e.dir=xi,e.c0=0,e.m_max=100,e.n_max=200,e.m=e.n=0,e.nnz=0,e.row=new Array(1+e.m_max),e.col=new Array(1+e.n_max),e.r_tree={},e.c_tree={},e.valid=0,e.head=new Array(1+e.m_max),e.bfcp=null,e.bfd=null,e.pbs_stat=e.dbs_stat=Vi,e.obj_val=0,e.it_cnt=0,e.some=0,e.ipt_stat=Vi,e.ipt_obj=0,e.mip_stat=Vi,e.mip_obj=0}function Y(e){e.magic=1061109567,e.parms=null,c(e.tree==null),e.row=null,e.col=null,e.r_tree=null,e.c_tree=null,e.head=null,e.bfcp=null,e.bfd=null}function Yt(e,t,n,r){var i=e.m,s=e.n,o,u,a,f,h,p,d,v,m,g,y,b,w;t!=zi&&t!=Wi&&t!=Xi&&l("glp_check_kkt: sol = "+t+"; invalid solution indicator"),n!=po&&n!=vo&&n!=mo&&n!=go&&n!=yo&&l("glp_check_kkt: cond = "+n+"; invalid condition indicator "),b=w=0,p=d=0;if(n==po)for(f=1;f<=i;f++){o=e.row[f],m=g=0,t==zi?y=o.prim:t==Wi?y=o.pval:t==Xi?y=o.mipx:c(t!=t),y>=0?m+=y:g-=y;for(a=o.ptr;a!=null;a=a.r_next)u=a.col,t==zi?y=-a.val*u.prim:t==Wi?y=-a.val*u.pval:t==Xi?y=-a.val*u.mipx:c(t!=t),y>=0?m+=y:g-=y;v=Math.abs(m-g),b<v&&(b=v,p=f),v/=1+m+g,w<v&&(w=v,d=f)}else if(n==vo){for(f=1;f<=i;f++)o=e.row[f],t==zi?y=o.prim:t==Wi?y=o.pval:t==Xi?y=o.mipx:c(t!=t),(o.type==Ai||o.type==Mi||o.type==_i)&&y<o.lb&&(v=o.lb-y,b<v&&(b=v,p=f),v/=1+Math.abs(o.lb),w<v&&(w=v,d=f)),(o.type==Oi||o.type==Mi||o.type==_i)&&y>o.ub&&(v=y-o.ub,b<v&&(b=v,p=f),v/=1+Math.abs(o.ub),w<v&&(w=v,d=f));for(h=1;h<=s;h++)u=e.col[h],t==zi?y=u.prim:t==Wi?y=u.pval:t==Xi?y=u.mipx:c(t!=t),(u.type==Ai||u.type==Mi||u.type==_i)&&y<u.lb&&(v=u.lb-y,b<v&&(b=v,p=i+h),v/=1+Math.abs(u.lb),w<v&&(w=v,d=i+h)),(u.type==Oi||u.type==Mi||u.type==_i)&&y>u.ub&&(v=y-u.ub,b<v&&(b=v,p=i+h),v/=1+Math.abs(u.ub),w<v&&(w=v,d=i+h))}else if(n==mo)for(h=1;h<=s;h++){u=e.col[h],m=g=0,t==zi?y=u.dual-u.coef:t==Wi?y=u.dval-u.coef:c(t!=t),y>=0?m+=y:g-=y;for(a=u.ptr;a!=null;a=a.c_next)o=a.row,t==zi?y=a.val*o.dual:t==Wi?y=a.val*o.dval:c(t!=t),y>=0?m+=y:g-=y;v=Math.abs(m-g),b<v&&(b=v,p=i+h),v/=1+m+g,w<v&&(w=v,d=i+h)}else if(n==go){for(f=1;f<=i;f++)o=e.row[f],t==zi?y=o.dual:t==Wi?y=o.dval:c(t!=t),e.dir==xi?y=+y:e.dir==Ti?y=-y:c(e!=e),(o.type==Li||o.type==Ai)&&y<0&&(v=-y,b<v&&(b=w=v,p=d=f)),(o.type==Li||o.type==Oi)&&y>0&&(v=+y,b<v&&(b=w=v,p=d=f));for(h=1;h<=s;h++)u=e.col[h],t==zi?y=u.dual:t==Wi?y=u.dval:c(t!=t),e.dir==xi?y=+y:e.dir==Ti?y=-y:c(e!=e),(u.type==Li||u.type==Ai)&&y<0&&(v=-y,b<v&&(b=w=v,p=d=i+h)),(u.type==Li||u.type==Oi)&&y>0&&(v=+y,b<v&&(b=w=v,p=d=i+h))}else c(n!=n);r(b,p,w,d)}function rn(e){var t={};nn(e,t),Kn(e.bfd,t)}function yn(e,t,n,r,i,s,o,u){var a,f,h,p,d=0,v,m,g,y,b;e.pbs_stat==Vi&&l("glp_analyze_row: primal basic solution components are undefined"),e.dbs_stat!=$i&&l("glp_analyze_row: basic solution is not dual feasible"),0<=t&&t<=e.n||l("glp_analyze_row: len = "+t+"; invalid row length"),g=0;for(a=1;a<=t;a++)f=n[a],1<=f&&f<=e.m+e.n||l("glp_analyze_row: ind["+a+"] = "+f+"; row/column index out of range"),f<=e.m?(e.row[f].stat==Di&&l("glp_analyze_row: ind["+a+"] = "+f+"; basic auxiliary variable is not allowed"),v=e.row[f].prim):(e.col[f-e.m].stat==Di&&l("glp_analyze_row: ind["+a+"] = "+f+"; basic structural variable is not allowed"),v=e.col[f-e.m].prim),g+=r[a]*v;if(i==Ai){if(g>=s)return d=1,d;h=1}else if(i==Oi){if(g<=s)return d=1,d;h=-1}else l("glp_analyze_row: type = "+i+"; invalid parameter");return y=s-g,p=gn(e,t,n,r,h,o),p==0?(d=2,d):(f=n[p],c(1<=f&&f<=e.m+e.n),f<=e.m?v=e.row[f].prim:v=e.col[f-e.m].prim,c(r[p]!=0),m=y/r[p],f<=e.m?b=e.row[f].dual*m:b=e.col[f-e.m].dual*m,u(p,v,m,g,y,b),d)}function En(e){return e.reason}function Sn(e){return e.mip}function xn(e,t){t(e.a_cnt,e.n_cnt,e.t_cnt)}function Tn(e){var t=e.curr;return t==null?0:t.p}function Nn(e,t){function n(){l("glp_ios_next_node: p = "+t+"; invalid subproblem reference number")}var r;return t==0?r=e.head:(1<=t&&t<=e.nslots||n(),r=e.slot[t].node,r==null&&n(),r.count!=0&&l("glp_ios_next_node: p = "+t+"; subproblem not in the active list"),r=r.next),r==null?0:r.p}function Cn(e,t){function r(){l("glp_ios_prev_node: p = "+t+"; invalid subproblem reference number")}var n;return t==0?n=e.tail:(1<=t&&t<=e.nslots||r(),n=e.slot[t].node,n==null&&r(),n.count!=0&&l("glp_ios_prev_node: p = "+t+"; subproblem not in the active list"),n=n.prev),n==null?0:n.p}function kn(e,t){function r(){l("glp_ios_up_node: p = "+t+"; invalid subproblem reference number")}var n;return 1<=t&&t<=e.nslots||r(),n=e.slot[t].node,n==null&&r(),n=n.up,n==null?0:n.p}function Ln(e,t){function r(){l("glp_ios_node_level: p = "+t+"; invalid subproblem reference number")}var n;return 1<=t&&t<=e.nslots||r(),n=e.slot[t].node,n==null&&r(),n.level}function An(e,t){function r(){l("glp_ios_node_bound: p = "+t+"; invalid subproblem reference number")}var n;return 1<=t&&t<=e.nslots||r(),n=e.slot[t].node,n==null&&r(),n.bound}function On(e){return Mr(e)}function Mn(e){return _r(e)}function _n(e,t){function r(){l("glp_ios_node_level: p = "+t+"; invalid subproblem reference number")}var n;return 1<=t&&t<=e.nslots||r(),n=e.slot[t].node,n==null&&r(),n.data}function Dn(e,t,n){var r;1<=t&&t<=e.mip.m||l("glp_ios_row_attr: i = "+t+"; row number out of range"),r=e.mip.row[t],n.level=r.level,n.origin=r.origin,n.klass=r.klass}function Pn(e){return e.reason!=Rs&&l("glp_ios_pool_size: operation not allowed"),c(e.local!=null),e.local.size}function Hn(e,t,n,r,i,s,o,u,a){var f;return e.reason!=Rs&&l("glp_ios_add_row: operation not allowed"),c(e.local!=null),f=Hr(e,e.local,t,n,r,i,s,o,u,a),f}function Bn(e,t){e.reason!=Rs&&l("glp_ios_del_row: operation not allowed"),jr(e.local,t)}function jn(e){e.reason!=Rs&&l("glp_ios_clear_pool: operation not allowed"),Fr(e.local)}function Fn(e,t){return 1<=t&&t<=e.mip.n||l("glp_ios_can_branch: j = "+t+"; column number out of range"),e.non_int[t]}function In(e,t,n){1<=t&&t<=e.mip.n||l("glp_ios_branch_upon: j = "+t+"; column number out of range"),n!=Vs&&n!=$s&&n!=Xs&&l("glp_ios_branch_upon: sel = "+n+": invalid branch selection flag"),e.non_int[t]||l("glp_ios_branch_upon: j = "+t+"; variable cannot be used to branch upon"),e.br_var!=0&&l("glp_ios_branch_upon: branching variable already chosen"),e.br_var=t,e.br_sel=n}function qn(e,t){function r(){l("glp_ios_select_node: p = "+t+"; invalid subproblem reference number")}var n;1<=t&&t<=e.nslots||r(),n=e.slot[t].node,n==null&&r(),n.count!=0&&l("glp_ios_select_node: p = "+t+"; subproblem not in the active list"),e.next_p!=0&&l("glp_ios_select_node: subproblem already selected"),e.next_p=t}function Rn(e,t){var n=e.mip,r=e.orig_m,i=e.n,s,o,u;c(n.m>=r),c(n.n==i),u=n.c0;for(o=1;o<=i;o++){var a=n.col[o];if(a.kind==Ci&&t[o]!=Math.floor(t[o]))return 1;u+=a.coef*t[o]}if(n.mip_stat==$i)switch(n.dir){case xi:if(u>=e.mip.mip_obj)return 1;break;case Ti:if(u<=e.mip.mip_obj)return 1;break;default:c(n!=n)}e.parm.msg_lev>=rs&&h("Solution found by heuristic: "+u+""),n.mip_stat=$i,n.mip_obj=u;for(o=1;o<=i;o++)n.col[o].mipx=t[o];for(s=1;s<=r;s++){var f=n.row[s],l;f.mipx=0;for(l=f.ptr;l!=null;l=l.r_next)f.mipx+=l.val*l.col.mipx}return 0}function Un(e){e.parm.msg_lev>=ss&&h("The search is prematurely terminated due to application request"),e.stop=1}function Jn(){var e={};return e.valid=0,e.type=Yi,e.fhv=null,e.lpf=null,e.lu_size=0,e.piv_tol=.1,e.piv_lim=4,e.suhl=1,e.eps_tol=1e-15,e.max_gro=1e10,e.nfs_max=100,e.upd_tol=1e-6,e.nrs_max=100,e.rs_size=1e3,e.upd_lim=-1,e.upd_cnt=0,e}function Kn(e,t){c(e!=null),e.type=t.type,e.lu_size=t.lu_size,e.piv_tol=t.piv_tol,e.piv_lim=t.piv_lim,e.suhl=t.suhl,e.eps_tol=t.eps_tol,e.max_gro=t.max_gro,e.nfs_max=t.nfs_max,e.upd_tol=t.upd_tol,e.nrs_max=t.nrs_max,e.rs_size=t.rs_size}function Qn(e,t,n,r,i){var s,u,a;c(e!=null),c(1<=t&&t<=o),e.valid=0,u=0;switch(e.type){case Yi:e.lpf=null,e.fhv==null&&(e.fhv=cr(),u=1);break;case Zi:case es:e.fhv=null,e.lpf==null&&(e.lpf=la(),u=1);break;default:c(e!=e)}e.fhv!=null?s=e.fhv.luf:e.lpf!=null?s=e.lpf.luf:c(e!=e),u&&(s.new_sva=e.lu_size),s.piv_tol=e.piv_tol,s.piv_lim=e.piv_lim,s.suhl=e.suhl,s.eps_tol=e.eps_tol,s.max_gro=e.max_gro,e.fhv!=null&&(u&&(e.fhv.hh_max=e.nfs_max),e.fhv.upd_tol=e.upd_tol),e.lpf!=null&&(u&&(e.lpf.n_max=e.nrs_max),u&&(e.lpf.v_size=e.rs_size));if(e.fhv!=null)switch(hr(e.fhv,t,r,i)){case 0:break;case or:return a=zn,a;case ur:return a=Wn,a;default:c(e!=e)}else if(e.lpf!=null)switch(ca(e.lpf,t,n,r,i)){case 0:switch(e.type){case Zi:e.lpf.scf.t_opt=hh;break;case es:e.lpf.scf.t_opt=ph;break;default:c(e!=e)}break;case aa:return a=zn,a;case LPF_ECOND:return a=Wn,a;default:c(e!=e)}else c(e!=e);return e.valid=1,e.upd_cnt=0,a=0,a}function Gn(e,t){c(e!=null),c(e.valid),e.fhv!=null?dr(e.fhv,t):e.lpf!=null?ga(e.lpf,t):c(e!=e)}function Yn(e,t){c(e!=null),c(e.valid),e.fhv!=null?vr(e.fhv,t):e.lpf!=null?ya(e.lpf,t):c(e!=e)}function Zn(e,t,n,r,i,s,o){var u;c(e!=null),c(e.valid);if(e.fhv!=null)switch(mr(e.fhv,t,r,i,s,o)){case 0:break;case or:return e.valid=0,u=zn,u;case ar:return e.valid=0,u=Xn,u;case fr:return e.valid=0,u=Vn,u;case lr:return e.valid=0,u=$n,u;default:c(e!=e)}else if(e.lpf!=null)switch(wa(e.lpf,t,n,r,i,s,o)){case 0:break;case aa:return e.valid=0,u=zn,u;case LPF_ELIMIT:return e.valid=0,u=Vn,u;default:c(e!=e)}else c(e!=e);return e.upd_cnt++,u=0,u}function er(e){return c(e!=null),c(e.valid),e.upd_cnt}function tr(e,t){c(e!=null),c(t!=null)}function cr(){var e;return e={},e.m_max=e.m=0,e.valid=0,e.luf=Ml(),e.hh_max=50,e.hh_nfs=0,e.hh_ind=e.hh_ptr=e.hh_len=null,e.p0_row=e.p0_col=null,e.cc_ind=null,e.cc_val=null,e.upd_tol=1e-6,e.nnz_h=0,e}function hr(e,t,n,r){var i;t<1&&l("fhv_factorize: m = "+t+"; invalid parameter"),t>o&&l("fhv_factorize: m = "+t+"; matrix too big"),e.m=t,e.valid=0,e.hh_ind==null&&(e.hh_ind=new Array(1+e.hh_max)),e.hh_ptr==null&&(e.hh_ptr=new Array(1+e.hh_max)),e.hh_len==null&&(e.hh_len=new Array(1+e.hh_max)),e.m_max<t&&(e.m_max=t+100,e.p0_row=new Array(1+e.m_max),e.p0_col=new Array(1+e.m_max),e.cc_ind=new Array(1+e.m_max),e.cc_val=new Array(1+e.m_max));switch(Rl(e.luf,t,n,r)){case 0:break;case Al:return i=or,i;case Ol:return i=ur,i;default:c(e!=e)}return e.valid=1,e.hh_nfs=0,d(e.p0_row,1,e.luf.pp_row,1,t),d(e.p0_col,1,e.luf.pp_col,1,t),e.nnz_h=0,i=0,i}function pr(e,t,n){var r=e.hh_nfs,i=e.hh_ind,s=e.hh_ptr,o=e.hh_len,u=e.luf.sv_ind,a=e.luf.sv_val,f,c,h,p,d,v;e.valid||l("fhv_h_solve: the factorization is not valid");if(!t)for(c=1;c<=r;c++){f=i[c],v=n[f],h=s[c],p=h+o[c]-1;for(d=h;d<=p;d++)v-=a[d]*n[u[d]];n[f]=v}else for(c=r;c>=1;c--){f=i[c],v=n[f];if(v==0)continue;h=s[c],p=h+o[c]-1;for(d=h;d<=p;d++)n[u[d]]-=a[d]*v}}function dr(e,t){var n=e.luf.pp_row,r=e.luf.pp_col,i=e.p0_row,s=e.p0_col;e.valid||l("fhv_ftran: the factorization is not valid"),e.luf.pp_row=i,e.luf.pp_col=s,Ul(e.luf,0,t),e.luf.pp_row=n,e.luf.pp_col=r,pr(e,0,t),zl(e.luf,0,t)}function vr(e,t){var n=e.luf.pp_row,r=e.luf.pp_col,i=e.p0_row,s=e.p0_col;e.valid||l("fhv_btran: the factorization is not valid"),zl(e.luf,1,t),pr(e,1,t),e.luf.pp_row=i,e.luf.pp_col=s,Ul(e.luf,1,t),e.luf.pp_row=n,e.luf.pp_col=r}function mr(e,t,n,r,i,s){var o=e.m,u=e.luf,a=u.vr_ptr,f=u.vr_len,h=u.vr_cap,p=u.vr_piv,v=u.vc_ptr,m=u.vc_len,g=u.vc_cap,y=u.pp_row,b=u.pp_col,w=u.qq_row,E=u.qq_col,S=u.sv_ind,x=u.sv_val,T=u.work,N=u.eps_tol,C=e.hh_ind,k=e.hh_ptr,L=e.hh_len,A=e.p0_row,O=e.p0_col,M=e.cc_ind,_=e.cc_val,D=e.upd_tol,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y;e.valid||l("fhv_update_it: the factorization is not valid"),1<=t&&t<=o||l("fhv_update_it: j = "+t+"; column number out of range");if(e.hh_nfs==e.hh_max)return e.valid=0,Q=fr,Q;for(P=1;P<=o;P++)_[P]=0;for(R=1;R<=n;R++)P=r[i+R],1<=P&&P<=o||l("fhv_update_it: ind["+R+"] = "+P+"; row number out of range"),_[P]!=0&&l("fhv_update_it: ind["+R+"] = "+P+"; duplicate row index not allowed"),s[R]==0&&l("fhv_update_it: val["+R+"] = "+s[R]+"; zero element not allowed"),_[P]=s[R];e.luf.pp_row=A,e.luf.pp_col=O,Ul(e.luf,0,_),e.luf.pp_row=y,e.luf.pp_col=b,pr(e,0,_),n=0;for(P=1;P<=o;P++){Y=_[P];if(Y==0||Math.abs(Y)<N)continue;n++,M[n]=P,_[n]=Y}F=v[t],I=F+m[t]-1;for(q=F;q<=I;q++){P=S[q],H=a[P],B=H+f[P]-1;for(j=H;S[j]!=t;j++);c(j<=B),S[j]=S[B],x[j]=x[B],f[P]--}u.nnz_v-=m[t],m[t]=0,U=w[t],z=0;for(K=1;K<=n;K++){P=M[K];if(f[P]+1>h[P]&&Dl(u,P,f[P]+10))return e.valid=0,u.new_sva=u.sv_size+u.sv_size,c(u.new_sva>u.sv_size),Q=lr,Q;j=a[P]+f[P],S[j]=t,x[j]=_[K],f[P]++,z<b[P]&&(z=b[P])}if(g[t]<n&&Pl(u,t,n))return e.valid=0,u.new_sva=u.sv_size+u.sv_size,c(u.new_sva>u.sv_size),Q=lr,Q;q=v[t],d(S,q,M,1,n),d(x,q,_,1,n),m[t]=n,u.nnz_v+=n;if(U>z)return e.valid=0,Q=or,Q;P=y[U],t=E[U];for(R=U;R<z;R++)y[R]=y[R+1],b[y[R]]=R,E[R]=E[R+1],w[E[R]]=R;y[z]=P,b[P]=z,E[z]=t,w[t]=z;for(t=1;t<=o;t++)T[t]=0;H=a[P],B=H+f[P]-1;for(j=H;j<=B;j++){t=S[j],T[t]=x[j],F=v[t],I=F+m[t]-1;for(q=F;S[q]!=P;q++);c(q<=I),S[q]=S[I],x[q]=x[I],m[t]--}u.nnz_v-=f[P],f[P]=0,e.hh_nfs++,C[e.hh_nfs]=P,L[e.hh_nfs]=0;if(u.sv_end-u.sv_beg<z-U){_l(u);if(u.sv_end-u.sv_beg<z-U)return e.valid=u.valid=0,u.new_sva=u.sv_size+u.sv_size,c(u.new_sva>u.sv_size),Q=lr,Q}for(R=U;R<z;R++){W=y[R],X=E[R];if(T[X]==0)continue;G=T[X]/p[W],V=a[W],$=V+f[W]-1;for(J=V;J<=$;J++)T[S[J]]-=G*x[J];u.sv_end--,S[u.sv_end]=W,x[u.sv_end]=G,L[e.hh_nfs]++}L[e.hh_nfs]==0?e.hh_nfs--:(k[e.hh_nfs]=u.sv_end,e.nnz_h+=L[e.hh_nfs]),p[P]=T[E[z]],n=0;for(R=z+1;R<=o;R++){t=E[R],Y=T[t];if(Math.abs(Y)<N)continue;if(m[t]+1>g[t]&&Pl(u,t,m[t]+10))return e.valid=0,u.new_sva=u.sv_size+u.sv_size,c(u.new_sva>u.sv_size),Q=lr,Q;q=v[t]+m[t],S[q]=P,x[q]=Y,m[t]++,n++,M[n]=t,_[n]=Y}if(h[P]<n&&Dl(u,P,n))return e.valid=0,u.new_sva=u.sv_size+u.sv_size,c(u.new_sva>u.sv_size),Q=lr,Q;j=a[P],d(S,j,M,1,n),d(x,j,_,1,n),f[P]=n,u.nnz_v+=n,Y=0,P=y[z],H=a[P],B=H+f[P]-1;for(j=H;j<=B;j++)Y<Math.abs(x[j])&&(Y=Math.abs(x[j]));t=E[z],F=v[t],I=F+m[t]-1;for(q=F;q<=I;q++)Y<Math.abs(x[q])&&(Y=Math.abs(x[q]));return Math.abs(p[P])<D*Y?(e.valid=0,Q=ar,Q):(Q=0,Q)}function gr(e,t){function n(e,t,n,r,i,s){var o,u,a,f,h,p,d,v,m,g,y,b,w,E,S,x,T=0,N,C,k;e>0&&t>0||l("triang: m = "+e+"; n = "+t+"; invalid dimension"),o=new Array(1+(e>=t?e:t)),u=new Array(1+e),a=new Array(1+t),f=new Array(1+e),h=new Array(1+e),d=new Array(1+t),v=new Array(1+t),N=u;for(S=0;S<=e;S++)N[S]=0;for(g=1;g<=t;g++)S=r(n,-g,o),c(0<=S&&S<=e),d[g]=N[S],N[S]=g;p=0;for(S=0;S<=e;S++)for(g=N[S];g!=0;g=d[g])v[g]=p,p=g;b=0;for(g=p;g!=0;g=v[g])d[g]=b,b=g;for(S=0;S<=t;S++)a[S]=0;for(m=1;m<=e;m++)u[m]=S=r(n,+m,o),c(0<=S&&S<=t),f[m]=0,h[m]=a[S],h[m]!=0&&(f[h[m]]=m),a[S]=m;for(m=1;m<=e;m++)i[m]=0;for(g=1;g<=t;g++)s[g]=0;w=1,E=t;while(w<=E){m=a[1];if(m!=0){c(u[m]==1),g=0,x=r(n,+m,o),c(0<=x&&x<=t);for(;x>=1;x--)b=o[x],c(1<=b&&b<=t),s[b]==0&&(c(g==0),g=b);c(g!=0),i[m]=s[g]=w,w++,T++}else g=p,c(g!=0),s[g]=E,E--;d[g]==0?p=v[g]:v[d[g]]=v[g],v[g]!=0&&(d[v[g]]=d[g]),x=r(n,-g,o),c(0<=x&&x<=e);for(;x>=1;x--)m=o[x],c(1<=m&&m<=e),S=u[m],c(S>=1),f[m]==0?a[S]=h[m]:h[f[m]]=h[m],h[m]!=0&&(f[h[m]]=f[m]),u[m]=--S,f[m]=0,h[m]=a[S],h[m]!=0&&(f[h[m]]=m),a[S]=m}for(m=1;m<=e;m++)i[m]==0&&(i[m]=w++);for(g=1;g<=t;g++)c(s[g]!=0);C=u;for(y=1;y<=e;y++)C[y]=0;for(m=1;m<=e;m++)y=i[m],c(1<=y&&y<=e),c(C[y]==0),C[y]=m;k=a;for(b=1;b<=t;b++)k[b]=0;for(g=1;g<=t;g++)b=s[g],c(1<=b&&b<=t),c(k[b]==0),k[b]=g;for(y=1;y<=T;y++){var L=0;m=C[y],x=r(n,+m,o),c(0<=x&&x<=t);for(;x>=1;x--)g=o[x],c(1<=g&&g<=t),b=s[g],b<=T&&c(b<=y),b==y&&(c(!L),L=1);c(L)}return T}function r(e,t,n){var r=Ra(e),i=Ua(e),s,o,u,a=0;if(t>0){s=+t,c(1<=s&&s<=r),u=tf(e,s,n,null);for(t=1;t<=u;t++)Ya(e,n[t],function(e){e!=Oo&&(n[++a]=r+n[t])});Ja(e,s,function(e){e!=Oo&&(n[++a]=s)})}else{o=-t,c(1<=o&&o<=r+i);function f(t){t!=Oo&&(o<=r?n[++a]=o:a=nf(e,o-r,n,null))}o<=r?Ja(e,o,f):Ya(e,o-r,f)}return a}function i(e){var t=Ra(e),i=Ua(e),s,o,u,a,f,l,p,d,v,m=new Array(1+t+i);h("Constructing initial basis...");if(t==0||i==0){Lt(e);return}l=new Array(1+t),p=new Array(1+t+i),f=n(t,t+i,e,r,l,p),ll(e,Su)>=3&&h("Size of triangular part = "+f+""),d=new Array(1+t),v=new Array(1+t+i);for(s=1;s<=t;s++)d[l[s]]=s;for(o=1;o<=t+i;o++)v[p[o]]=o;for(a=1;a<=t+i;a++)m[a]=-1;for(u=1;u<=f;u++)o=v[u],m[o]=Ro;for(u=f+1;u<=t;u++)s=d[u],c(1<=s&&s<=t),c(p[s]>f),m[s]=Ro;for(a=1;a<=t+i;a++)if(m[a]!=Ro){function g(e,t,n){switch(e){case Co:m[a]=Wo;break;case ko:m[a]=Uo;break;case Lo:m[a]=zo;break;case Ao:m[a]=Math.abs(t)<=Math.abs(n)?Uo:zo;break;case Oo:m[a]=Xo;break;default:c(e!=e)}}a<=t?Ja(e,a,g):Ya(e,a-t,g)}for(a=1;a<=t+i;a++)a<=t?lf(e,a,m[a]):cf(e,a-t,m[a])}t!=0&&l("glp_adv_basis: flags = "+t+"; invalid flags"),e.m==0||e.n==0?Lt(e):i(e)}function yr(e){function _(e,t){return e.q<t.q?-1:e.q>t.q?1:0}function D(e,t,n,r){var i,s=mt(e,t,n,r),o=0;for(i=1;i<=s;i++)o<Math.abs(r[i])&&(o=Math.abs(r[i]));o==0&&(o=1);for(i=1;i<=s;i++)r[i]/=o;return s}var t,r,i,s,o,u,a,f,l,p,d,v,m,g,y,w,E,S,x,T,N,C,k,L,A,O,M;h("Constructing initial basis..."),o=rt(e),u=it(e),t=new Array(1+u),x=new Array(1+o),T=new Array(1+o),O=new Array(1+o),N=new Array(1+o),M=new Array(1+o);for(a=1;a<=o;a++)ut(e,a)!=Mi?Ct(e,a,ji):Math.abs(at(e,a))<=Math.abs(ft(e,a))?Ct(e,a,Pi):Ct(e,a,Hi);for(f=1;f<=u;f++)lt(e,f)!=Mi?kt(e,f,ji):Math.abs(ct(e,f))<=Math.abs(ht(e,f))?kt(e,f,Pi):kt(e,f,Hi);g=0,r=0;for(f=1;f<=u;f++)E=lt(e,f),E==Li&&(g++,t[r+g].j=f,t[r+g].q=0);y=0,i=r+g;for(f=1;f<=u;f++)E=lt(e,f),E==Ai?(y++,t[i+y].j=f,t[i+y].q=+ct(e,f)):E==Oi&&(y++,t[i+y].j=f,t[i+y].q=-ht(e,f));w=0,s=i+y;for(f=1;f<=u;f++)E=lt(e,f),E==Mi&&(w++,t[s+w].j=f,t[s+w].q=ct(e,f)-ht(e,f));k=0;for(f=1;f<=u;f++)A=Math.abs(pt(e,f)),k<A&&(k=A);L=k==0?1:1e3*k;switch(nt(e)){case xi:A=1;break;case Ti:A=-1;break;default:c(e!=e)}for(p=1;p<=g+y+w;p++)f=t[p].j,t[p].q+=A*pt(e,f)/L;b(t,r+1+g,_);for(p=1;p<g;p++)c(t[r+p].q<=t[r+p+1].q);b(t,i+1+y,_);for(p=1;p<y;p++)c(t[i+p].q<=t[i+p+1].q);b(t,s+1+w,_);for(p=1;p<w;p++)c(t[s+p].q<=t[s+p+1].q);for(a=1;a<=o;a++)E=ut(e,a),E!=_i?(Ct(e,a,Di),x[a]=1,T[a]=1):(x[a]=0,T[a]=0),O[a]=+n;for(p=1;p<=g+y+w;p++){l=t[p].j,S=D(e,l,N,M),C=0,v=0;for(m=1;m<=S;m++)d=N[m],T[d]==0&&C<Math.abs(M[m])&&(C=Math.abs(M[m]),v=d);if(C>=.99){kt(e,l,Di),x[v]=1,O[v]=C;for(m=1;m<=S;m++)d=N[m],M[m]!=0&&T[d]++;continue}for(m=1;m<=S;m++){d=N[m];if(Math.abs(M[m])>.01*O[d])break}if(m<=S)continue;C=0,v=0;for(m=1;m<=S;m++)d=N[m],x[d]==0&&C<Math.abs(M[m])&&(C=Math.abs(M[m]),v=d);if(C==0)continue;kt(e,l,Di),x[v]=1,O[v]=C;for(m=1;m<=S;m++)d=N[m],M[m]!=0&&T[d]++}for(a=1;a<=o;a++)x[a]==0&&Ct(e,a,Di)}function br(e){e.m==0||e.n==0?Lt(e):yr(e)}function wr(e,t){var r=Er(e),i={};return e.slot[r].node=i,i.p=r,i.up=t,i.level=t==null?0:t.level+1,i.count=0,i.b_ptr=null,i.s_ptr=null,i.r_ptr=null,i.solved=0,i.lp_obj=t==null?e.mip.dir==xi?-n:+n:t.lp_obj,i.bound=t==null?e.mip.dir==xi?-n:+n:t.bound,i.br_var=0,i.br_val=0,i.ii_cnt=0,i.ii_sum=0,i.changed=0,e.parm.cb_size==0?i.data=null:i.data={},i.temp=null,i.prev=e.tail,i.next=null,e.head==null?e.head=i:e.tail.next=i,e.tail=i,e.a_cnt++,e.n_cnt++,e.t_cnt++,t==null?c(r==1):t.count++,i}function Er(e){var t;if(e.avail==0){var n=e.nslots,r=e.slot;n==0?e.nslots=20:(e.nslots=n+n,c(e.nslots>n)),e.slot=new Array(1+e.nslots),m(e.slot,0,1+e.nslots),r!=null&&d(e.slot,1,r,1,n);for(t=e.nslots;t>n;t--)e.slot[t].node=null,e.slot[t].next=e.avail,e.avail=t}return t=e.avail,e.avail=e.slot[t].next,c(e.slot[t].node==null),e.slot[t].next=0,t}function Sr(e,t){var n=e.m,r=e.n,i,s,o;c(e.tree==null),e.tree=i={},i.n=r,i.orig_m=n,i.orig_type=new Array(1+n+r),i.orig_lb=new Array(1+n+r),i.orig_ub=new Array(1+n+r),i.orig_stat=new Array(1+n+r),i.orig_prim=new Array(1+n+r),i.orig_dual=new Array(1+n+r);for(s=1;s<=n;s++){var u=e.row[s];i.orig_type[s]=u.type,i.orig_lb[s]=u.lb,i.orig_ub[s]=u.ub,i.orig_stat[s]=u.stat,i.orig_prim[s]=u.prim,i.orig_dual[s]=u.dual}for(o=1;o<=r;o++){var a=e.col[o];i.orig_type[n+o]=a.type,i.orig_lb[n+o]=a.lb,i.orig_ub[n+o]=a.ub,i.orig_stat[n+o]=a.stat,i.orig_prim[n+o]=a.prim,i.orig_dual[n+o]=a.dual}return i.orig_obj=e.obj_val,i.nslots=0,i.avail=0,i.slot=null,i.head=i.tail=null,i.a_cnt=i.n_cnt=i.t_cnt=0,i.root_m=0,i.root_type=null,i.root_lb=i.root_ub=null,i.root_stat=null,i.curr=null,i.mip=e,i.non_int=new Array(1+r),v(i.non_int,1,0,r),i.pred_m=i.pred_max=0,i.pred_type=null,i.pred_lb=i.pred_ub=null,i.pred_stat=null,i.local=Pr(i),i.mir_gen=null,i.clq_gen=null,i.pcost=null,i.iwrk=new Array(1+r),i.dwrk=new Array(1+r),i.parm=t,i.tm_beg=g(),i.tm_lag=0,i.sol_cnt=0,i.reason=0,i.reopt=0,i.reinv=0,i.br_var=0,i.br_sel=0,i.child=0,i.next_p=0,i.stop=0,wr(i,null),i}function xr(e,t){var n=e.mip,r,i,s,o,u,a;c(1<=t&&t<=e.nslots),r=e.slot[t].node,c(r!=null),c(r.count==0),c(e.curr==null),e.curr=r,i=e.slot[1].node,c(i!=null);if(r==i)return;c(n.m==e.root_m),r.temp=null;for(;r!=null;r=r.up)r.up==null?c(r==i):r.up.temp=r;for(r=i;r!=null;r=r.temp){var f=n.m,l=n.n;if(r.temp==null){var h,p;e.pred_m=f;if(e.pred_max<f+l){var d=f+l+100;e.pred_max=d,e.pred_type=new Array(1+d),e.pred_lb=new Array(1+d),e.pred_ub=new Array(1+d),e.pred_stat=new Array(1+d)}for(h=1;h<=f;h++){var v=n.row[h];e.pred_type[h]=v.type,e.pred_lb[h]=v.lb,e.pred_ub[h]=v.ub,e.pred_stat[h]=v.stat}for(p=1;p<=l;p++){var m=n.col[p];e.pred_type[n.m+p]=m.type,e.pred_lb[n.m+p]=m.lb,e.pred_ub[n.m+p]=m.ub,e.pred_stat[n.m+p]=m.stat}}for(s=r.b_ptr;s!=null;s=s.next)s.k<=f?q(n,s.k,s.type,s.lb,s.ub):R(n,s.k-f,s.type,s.lb,s.ub);for(u=r.s_ptr;u!=null;u=u.next)u.k<=f?Ct(n,u.k,u.stat):kt(n,u.k-f,u.stat);if(r.r_ptr!=null){var g,y,b;y=new Array(1+l),b=new Array(1+l);for(o=r.r_ptr;o!=null;o=o.next){h=B(n,1),F(n,h,o.name),c(n.row[h].level==0),n.row[h].level=r.level,n.row[h].origin=o.origin,n.row[h].klass=o.klass,q(n,h,o.type,o.lb,o.ub),g=0;for(a=o.ptr;a!=null;a=a.next)g++,y[g]=a.j,b[g]=a.val;z(n,h,g,y,b),Et(n,h,o.rii),Ct(n,h,o.stat)}}}r=e.curr;while(r.b_ptr!=null)s=r.b_ptr,r.b_ptr=s.next;while(r.s_ptr!=null)u=r.s_ptr,r.s_ptr=u.next;while(r.r_ptr!=null){o=r.r_ptr,r.r_ptr=o.next,c(o.name==null);while(o.ptr!=null)a=o.ptr,o.ptr=a.next}}function Tr(e){var t=e.mip,n=t.m,r=t.n,i=e.curr;c(i!=null);var s,o,u,a;if(i.up==null){c(i.p==1),c(e.root_m==0),c(e.root_type==null),c(e.root_lb==null),c(e.root_ub==null),c(e.root_stat==null),e.root_m=n,e.root_type=new Array(1+n+r),e.root_lb=new Array(1+n+r),e.root_ub=new Array(1+n+r),e.root_stat=new Array(1+n+r);for(s=1;s<=n+r;s++)s<=n?(u=t.row[s],e.root_type[s]=u.type,e.root_lb[s]=u.lb,e.root_ub[s]=u.ub,e.root_stat[s]=u.stat):(a=t.col[s-n],e.root_type[s]=a.type,e.root_lb[s]=a.lb,e.root_ub[s]=a.ub,e.root_stat[s]=a.stat)}else{var f=e.root_m,l=e.pred_m,h;c(l<=n),c(i.b_ptr==null),c(i.s_ptr==null);for(s=1;s<=l+r;s++){var p,d,v,m,g,y,b,w;p=e.pred_type[s],g=e.pred_lb[s],y=e.pred_ub[s],d=e.pred_stat[s],s<=l?(u=t.row[s],v=u.type,b=u.lb,w=u.ub,m=u.stat):(a=t.col[s-l],v=a.type,b=a.lb,w=a.ub,m=a.stat);if(p!=v||g!=b||y!=w){var E={};E.k=s,E.type=v,E.lb=b,E.ub=w,E.next=i.b_ptr,i.b_ptr=E}if(d!=m){var S={};S.k=s,S.stat=m,S.next=i.s_ptr,i.s_ptr=S}}c(i.r_ptr==null);if(l<n){var x,T,N;T=new Array(1+r),N=new Array(1+r);for(o=n;o>l;o--){u=t.row[o];var C={},k=st(t,o);k==null?C.name=null:C.name=k,C.type=u.type,C.lb=u.lb,C.ub=u.ub,C.ptr=null,x=vt(t,o,T,N);for(s=1;s<=x;s++){var L={};L.j=T[s],L.val=N[s],L.next=C.ptr,C.ptr=L}C.rii=u.rii,C.stat=u.stat,C.next=i.r_ptr,i.r_ptr=C}}if(n!=f){var A=n-f;c(A>0);var O=new Array(1+A);for(o=1;o<=A;o++)O[o]=f+o;J(t,A,O)}n=t.m,c(n==f);for(o=1;o<=n;o++)q(t,o,e.root_type[o],e.root_lb[o],e.root_ub[o]),Ct(t,o,e.root_stat[o]);for(h=1;h<=r;h++)R(t,h,e.root_type[n+h],e.root_lb[n+h],e.root_ub[n+h]),kt(t,h,e.root_stat[n+h])}e.curr=null}function Nr(e,t,n,r){var i,s;c(1<=t&&t<=e.nslots),i=e.slot[t].node,c(i!=null),c(i.count==0),c(e.curr!=i),i.prev==null?e.head=i.next:i.prev.next=i.next,i.next==null?e.tail=i.prev:i.next.prev=i.prev,i.prev=i.next=null,e.a_cnt--,c(n>0);for(s=1;s<=n;s++)r[s]=wr(e,i).p}function Cr(e,t){var n,r;c(1<=t&&t<=e.nslots),n=e.slot[t].node,c(n!=null),c(n.count==0),c(e.curr!=n),n.prev==null?e.head=n.next:n.prev.next=n.next,n.next==null?e.tail=n.prev:n.next.prev=n.prev,n.prev=n.next=null,e.a_cnt--;for(;;){var i;while(n.b_ptr!=null)i=n.b_ptr,n.b_ptr=i.next;var s;while(n.s_ptr!=null)s=n.s_ptr,n.s_ptr=s.next;while(n.r_ptr!=null){var o;o=n.r_ptr,o.name=null;while(o.ptr!=null){var u;u=o.ptr,o.ptr=u.next}n.r_ptr=o.next}e.parm.cb_size==0&&c(n.data==null),t=n.p,c(e.slot[t].node==n),e.slot[t].node=null,e.slot[t].next=e.avail,e.avail=t,r=n.up,e.n_cnt--,n=r;if(n!=null){c(n.count>0),n.count--;if(n.count==0)continue}break}}function kr(e){var t=e.mip,n,r,i=t.m,s=t.n;c(t.tree==e);if(i!=e.orig_m){var o,u;o=i-e.orig_m,c(o>0),u=new Array(1+o);for(n=1;n<=o;n++)u[n]=e.orig_m+n;J(t,o,u)}i=e.orig_m,c(i==e.orig_m),c(s==e.n);for(n=1;n<=i;n++)q(t,n,e.orig_type[n],e.orig_lb[n],e.orig_ub[n]),Ct(t,n,e.orig_stat[n]),t.row[n].prim=e.orig_prim[n],t.row[n].dual=e.orig_dual[n];for(r=1;r<=s;r++)R(t,r,e.orig_type[i+r],e.orig_lb[i+r],e.orig_ub[i+r]),kt(t,r,e.orig_stat[i+r]),t.col[r].prim=e.orig_prim[i+r],t.col[r].dual=e.orig_dual[i+r];t.pbs_stat=t.dbs_stat=$i,t.obj_val=e.orig_obj,c(e.local!=null),Ir(e.local),c(e.mir_gen==null),c(e.clq_gen==null),t.tree=null}function Lr(e,t,r){var i=e.mip,s=i.m,o=i.n,u,a,f,l,h,p,d,v,m,g,y=e.iwrk,b=e.dwrk,w,E;c(Mt(i)==Qi),c(Zt(i)),c(1<=t&&t<=o),d=i.col[t].prim,u=Df(i,s+t,y,b);for(a=-1;a<=1;a+=2){f=Ff(i,u,y,b,a,1e-9);if(f==0){i.dir==xi?a<0?w=+n:E=+n:i.dir==Ti?a<0?w=-n:E=-n:c(i!=i);continue}c(1<=f&&f<=s+o);for(l=1;l<=u;l++)if(y[l]==f)break;c(1<=l&&l<=u),p=b[l],f<=s?(h=i.row[f].stat,v=i.row[f].dual):(h=i.col[f-s].stat,v=i.col[f-s].dual),c(h==Pi||h==Hi||h==Bi);if(i.dir==xi){if(h==Pi&&v<0||h==Hi&&v>0||h==Bi)v=0}else if(i.dir==Ti){if(h==Pi&&v>0||h==Hi&&v<0||h==Bi)v=0}else c(i!=i);m=(a<0?Math.floor(d):Math.ceil(d))-d,m/=p,g=v*m,i.dir==xi?c(g>=0):i.dir==Ti?c(g<=0):c(i!=i),a<0?w=i.obj_val+g:E=i.obj_val+g}r(w,E)}function Ar(e,t){var i=e.mip,s=i.n,o,u,a,f=e.iwrk,l,h;a=0,l=i.c0,o=0;for(u=1;u<=s;u++){var p=i.col[u];if(p.coef==0)continue;if(p.type==_i)l+=p.coef*p.prim;else{if(p.kind!=Ci)return t;if(p.coef!=Math.floor(p.coef))return t;Math.abs(p.coef)<=r?f[++a]=Math.abs(p.coef):o=1}}if(o==0){if(a==0)return t;o=oa(a,f)}return c(o>0),i.dir==xi?t!=+n&&(h=(t-l)/o,h>=Math.floor(h)+.001&&(h=Math.ceil(h),t=o*h+l)):i.dir==Ti?t!=-n&&(h=(t-l)/o,h<=Math.ceil(h)-.001&&(h=Math.floor(h),t=o*h+l)):c(i!=i),t}function Or(e,t){var r=e.mip,i=1,s;if(r.mip_stat==$i){s=e.parm.tol_obj*(1+Math.abs(r.mip_obj));switch(r.dir){case xi:t>=r.mip_obj-s&&(i=0);break;case Ti:t<=r.mip_obj+s&&(i=0);break;default:c(r!=r)}}else switch(r.dir){case xi:t==+n&&(i=0);break;case Ti:t==-n&&(i=0);break;default:c(r!=r)}return i}function Mr(e){var t,n=null;switch(e.mip.dir){case xi:for(t=e.head;t!=null;t=t.next)if(n==null||n.bound>t.bound)n=t;break;case Ti:for(t=e.head;t!=null;t=t.next)if(n==null||n.bound<t.bound)n=t;break;default:c(e!=e)}return n==null?0:n.p}function _r(e){var t=e.mip,r,s,o,u;return t.mip_stat==$i?(s=t.mip_obj,r=Mr(e),r==0?u=0:(o=e.slot[r].node.bound,u=Math.abs(s-o)/(Math.abs(s)+i))):u=n,u}function Dr(e){var t=e.mip,n={},r;c(e.curr!=null),Ot(n);switch(e.parm.msg_lev){case ts:n.msg_lev=ts;break;case ns:n.msg_lev=ns;break;case rs:case is:n.msg_lev=rs;break;case ss:n.msg_lev=is;break;default:c(e!=e)}n.meth=us,e.parm.msg_lev<ss?n.out_dly=e.parm.out_dly:n.out_dly=0;if(t.mip_stat==$i)switch(e.mip.dir){case xi:n.obj_ul=t.mip_obj;break;case Ti:n.obj_ll=t.mip_obj;break;default:c(t!=t)}return r=At(t,n),e.curr.solved++,r}function Pr(e){c(e==e);var t={};return t.size=0,t.head=t.tail=null,t.ord=0,t.curr=null,t}function Hr(e,t,n,r,i,s,o,u,a,f){var h,p,d;c(t!=null),h={},n==null||n[0]=="\0"?h.name=null:h.name=n,0<=r&&r<=255||l("glp_ios_add_row: klass = "+r+"; invalid cut class"),h.klass=r,i!=0&&l("glp_ios_add_row: flags = "+i+"; invalid cut flags"),h.ptr=null,0<=s&&s<=e.n||l("glp_ios_add_row: len = "+s+"; invalid cut length");for(d=1;d<=s;d++)p={},1<=o[d]&&o[d]<=e.n||l("glp_ios_add_row: ind["+d+"] = "+o[d]+"; column index out of range"),p.j=o[d],p.val=u[d],p.next=h.ptr,h.ptr=p;return a!=Ai&&a!=Oi&&a!=_i&&l("glp_ios_add_row: type = "+a+"; invalid cut type"),h.type=a,h.rhs=f,h.prev=t.tail,h.next=null,h.prev==null?t.head=h:h.prev.next=h,t.tail=h,t.size++,t.size}function Br(e,t){c(e!=null),c(1<=t&&t<=e.size),e.ord==0&&(c(e.curr==null),e.ord=1,e.curr=e.head),c(e.curr!=null);if(t<e.ord)if(t<e.ord-t){e.ord=1,e.curr=e.head;while(e.ord!=t)e.ord++,c(e.curr!=null),e.curr=e.curr.next}else while(e.ord!=t)e.ord--,c(e.curr!=null),e.curr=e.curr.prev;else if(t>e.ord)if(t-e.ord<e.size-t)while(e.ord!=t)e.ord++,c(e.curr!=null),e.curr=e.curr.next;else{e.ord=e.size,e.curr=e.tail;while(e.ord!=t)e.ord--,c(e.curr!=null),e.curr=e.curr.prev}return c(e.ord==t),c(e.curr!=null),e.curr}function jr(e,t){var n,r;c(e!=null),1<=t&&t<=e.size||l("glp_ios_del_row: i = "+t+"; cut number out of range"),n=Br(e,t),c(e.curr==n),n.next!=null?e.curr=n.next:n.prev!=null?(e.ord--,e.curr=n.prev):(e.ord=0,e.curr=null),n.prev==null?(c(e.head==n),e.head=n.next):(c(n.prev.next==n),n.prev.next=n.next),n.next==null?(c(e.tail==n),e.tail=n.prev):(c(n.next.prev==n),n.next.prev=n.prev);while(n.ptr!=null)r=n.ptr,n.ptr=r.next;e.size--}function Fr(e){c(e!=null);while(e.head!=null){var t=e.head;e.head=t.next;while(t.ptr!=null){var n=t.ptr;t.ptr=n.next}}e.size=0,e.head=e.tail=null,e.ord=0,e.curr=null}function Ir(e){c(e!=null),Fr(e)}function qr(e,t){function r(e,t,r,i,s){var o,u,a,f,l;c(e>=0),f=0,u=0;for(o=1;o<=e;o++)if(t[o]>0)if(r[o]==-n){if(u!=0){f=-n,u=0;break}u=o}else f+=t[o]*r[o];else if(t[o]<0)if(i[o]==+n){if(u!=0){f=-n,u=0;break}u=o}else f+=t[o]*i[o];else c(t!=t);s.f_min=f,s.j_min=u,l=0,a=0;for(o=1;o<=e;o++)if(t[o]>0)if(i[o]==+n){if(a!=0){l=+n,a=0;break}a=o}else l+=t[o]*i[o];else if(t[o]<0)if(r[o]==-n){if(a!=0){l=+n,a=0;break}a=o}else l+=t[o]*r[o];else c(t!=t);s.f_max=l,s.j_max=a}function i(e,t){t(e.j_min==0?e.f_min:-n,e.j_max==0?e.f_max:+n)}function s(e,t,r,i,s,o,u,a,f){var l,h,p,d;c(t>=0),c(1<=a&&a<=t),i==-n||e.f_max==+n?l=-n:e.j_max==0?r[a]>0?(c(u[a]!=+n),l=i-(e.f_max-r[a]*u[a])):r[a]<0?(c(o[a]!=-n),l=i-(e.f_max-r[a]*o[a])):c(r!=r):e.j_max==a?l=i-e.f_max:l=-n,s==+n||e.f_min==-n?h=+n:e.j_min==0?r[a]>0?(c(o[a]!=-n),h=s-(e.f_min-r[a]*o[a])):r[a]<0?(c(u[a]!=+n),h=s-(e.f_min-r[a]*u[a])):c(r!=r):e.j_min==a?h=s-e.f_min:h=+n,Math.abs(r[a])<1e-6?(p=-n,d=+n):r[a]>0?(p=l==-n?-n:l/r[a],d=h==+n?+n:h/r[a]):r[a]<0?(p=h==+n?-n:h/r[a],d=l==-n?+n:l/r[a]):c(r!=r),f(p,d)}function o(e,t,r,s,o){var u,a=0,f=t[r],l=s[o],c=null,h=null;i(e,function(e,t){c=e,h=t});if(f!=-n){u=.001*(1+Math.abs(f));if(h<f-u)return a=1,a}if(l!=+n){u=.001*(1+Math.abs(l));if(c>l+u)return a=1,a}return f!=-n&&(u=1e-12*(1+Math.abs(f)),c>f-u&&(t[r]=-n)),l!=+n&&(u=1e-12*(1+Math.abs(l)),h<l+u&&(s[o]=+n)),a}function u(e,t,r,i,o,u,a,f,l,h){var p,d=0,v,m,g=null,y=null;c(t>=0),c(1<=l&&l<=t),v=u[l],m=a[l],s(e,t,r,i,o,u,a,l,function(e,t){g=e,y=t}),f&&(g!=-n&&(g=g-Math.floor(g)<.001?Math.floor(g):Math.ceil(g)),y!=+n&&(y=Math.ceil(y)-y<.001?Math.ceil(y):Math.floor(y)));if(v!=-n){p=.001*(1+Math.abs(v));if(y<v-p)return d=1,d}if(m!=+n){p=.001*(1+Math.abs(m));if(g>m+p)return d=1,d}g!=-n&&(p=.001*(1+Math.abs(g)),v<g-p&&(v=g)),y!=+n&&(p=.001*(1+Math.abs(y)),m>y+p&&(m=y));if(v!=-n&&m!=+n){var b=Math.abs(v),w=Math.abs(m);p=1e-10*(1+(b<=w?b:w)),v>m-p&&(v==u[l]?m=v:m==a[l]?v=m:b<=w?m=v:v=m)}return h(v,m),d}function a(e,t,r,i,s){var o,u=0;return t<i&&(e||t==-n?u++:(r==+n?o=1+Math.abs(t):o=1+(r-t),i-t>=.25*o&&u++)),r>s&&(e||r==+n?u++:(t==-n?o=1+Math.abs(r):o=1+(r-t),r-s>=.25*o&&u++)),u}function f(e,t,i,s,f,l,h,p){var d=e.m,m=e.n,g={},y,b,w,E,S,x=0,T,N,C,k,L,A,O,M,_;c(0<=l&&l<=d+1),c(p>0),T=new Array(1+m),N=new Array(1+d+1),C=new Array(1+d+1),v(C,0,0,d+1),k=new Array(1+d+1),v(k,0,0,d+1),L=new Array(1+m),A=new Array(1+m),O=new Array(1+m),S=0;for(w=1;w<=l;w++)y=h[w],c(0<=y&&y<=d),c(!C[y]),N[++S]=y,C[y]=1;c(S==l);while(S>0){y=N[S--],C[y]=0,k[y]++;if(t[y]==-n&&i[y]==+n)continue;E=0;if(y==0)for(b=1;b<=m;b++)_=e.col[b],_.coef!=0&&(E++,T[E]=b,L[E]=_.coef);else{var D=e.row[y];for(M=D.ptr;M!=null;M=M.r_next)E++,T[E]=M.col.j,L[E]=M.val}for(w=1;w<=E;w++)b=T[w],A[w]=s[b],O[w]=f[b];r(E,L,A,O,g);if(o(g,t,y,i,y))return x=1,x;if(t[y]==-n&&i[y]==+n)continue;for(w=1;w<=E;w++){var P,H,B=null,j=null;b=T[w],_=e.col[b],P=_.kind!=Ni;if(u(g,E,L,t[y],i[y],A,O,P,w,function(e,t){B=e,j=t}))return x=1,x;H=a(P,s[b],f[b],B,j),s[b]=B,f[b]=j;if(H>0)for(M=_.ptr;M!=null;M=M.c_next){var F=M.row.i;if(k[F]>=p)continue;if(t[F]==-n&&i[F]==+n)continue;C[F]==0&&(c(S<=d),N[++S]=F,C[F]=1)}}}return x}var l=e.mip,h=l.m,p=l.n,d,m,g,y,b=0,w,E,S,x;c(e.curr!=null),w=new Array(1+h),E=new Array(1+h);switch(l.mip_stat){case Vi:w[0]=-n,E[0]=+n;break;case $i:switch(l.dir){case xi:w[0]=-n,E[0]=l.mip_obj-l.c0;break;case Ti:w[0]=l.mip_obj-l.c0,E[0]=+n;break;default:c(l!=l)}break;default:c(l!=l)}for(d=1;d<=h;d++)w[d]=at(l,d),E[d]=ft(l,d);S=new Array(1+p),x=new Array(1+p);for(m=1;m<=p;m++)S[m]=ct(l,m),x[m]=ht(l,m);g=h+1,y=new Array(1+g);for(d=1;d<=g;d++)y[d]=d-1;if(f(l,w,E,S,x,g,y,t))return b=1,b;for(d=1;d<=h;d++)Ht(l,d)==Di&&(w[d]==-n&&E[d]==+n?q(l,d,Li,0,0):E[d]==+n?q(l,d,Ai,w[d],0):w[d]==-n&&q(l,d,Oi,0,E[d]));for(m=1;m<=p;m++){var T;S[m]==-n&&x[m]==+n?T=Li:x[m]==+n?T=Ai:S[m]==-n?T=Oi:S[m]!=x[m]?T=Mi:T=_i,R(l,m,T,S[m],x[m])}return b}function Rr(e){function t(e,t){var r,i,s,o,u,a;e.mip.mip_stat==$i?s=String(e.mip.mip_obj):s="not found yet",r=Mr(e),r==0?o="tree is empty":(i=e.slot[r].node.bound,i==-n?o="-inf":i==+n?o="+inf":o=i),e.mip.dir==xi?u=">=":e.mip.dir==Ti?u="<=":c(e!=e),i=_r(e),i==0?a="  0.0%%":i<.001?a=" < 0.1%%":i<=9.999?a=100*i:a="",h("+"+e.mip.it_cnt+": "+(t?">>>>>":"mip =")+" "+s+" "+u+" "+o+" "+a+" ("+e.a_cnt+"; "+(e.t_cnt-e.n_cnt)+")"),e.tm_lag=g()}function i(e,t){return c(1<=t&&t<=e.nslots),c(e.slot[t].node!=null),Or(e,e.slot[t].node.bound)}function s(e){var t=e.mip,n,r,i=0,s,o,u,a,f,l=0;for(n=1;n<=t.n;n++){var p=t.col[n];e.non_int[n]=0;if(p.kind!=Ci)continue;if(p.stat!=Di)continue;r=p.type,s=p.lb,o=p.ub,u=p.prim;if(r==Ai||r==Mi||r==_i){a=s-e.parm.tol_int,f=s+e.parm.tol_int;if(a<=u&&u<=f)continue;if(u<s)continue}if(r==Oi||r==Mi||r==_i){a=o-e.parm.tol_int,f=o+e.parm.tol_int;if(a<=u&&u<=f)continue;if(u>o)continue}a=Math.floor(u+.5)-e.parm.tol_int,f=Math.floor(u+.5)+e.parm.tol_int;if(a<=u&&u<=f)continue;e.non_int[n]=1,i++,a=u-Math.floor(u),f=Math.ceil(u)-u,c(a>0&&f>0),l+=a<=f?a:f}c(e.curr!=null),e.curr.ii_cnt=i,e.curr.ii_sum=l,e.parm.msg_lev>=ss&&(i==0?h("There are no fractional columns"):i==1?h("There is one fractional column, integer infeasibility is "+l+""):h("There are "+i+" fractional columns, integer infeasibility is "+l+""))}function o(e){var t=e.mip,n,r;t.mip_stat=$i,t.mip_obj=t.obj_val;for(n=1;n<=t.m;n++){var i=t.row[n];i.mipx=i.prim}for(r=1;r<=t.n;r++){var s=t.col[r];s.kind==Ni?s.mipx=s.prim:s.kind==Ci?s.mipx=Math.floor(s.prim+.5):c(s!=s)}e.sol_cnt++}function u(e,t,n){var r=e.mip,i,s=r.m,o=r.n,u,a,f,l,p,d,v,m=new Array(3),g,y,b,w,E,S=null,x=null,T,N;c(1<=t&&t<=o),u=r.col[t].type,g=r.col[t].lb,y=r.col[t].ub,b=r.col[t].prim,w=Math.floor(b),E=Math.ceil(b);switch(u){case Li:a=Oi,f=Ai;break;case Ai:c(g<=w),a=g==w?_i:Mi,c(g+1<=E),f=Ai;break;case Oi:c(w<=y-1),a=Oi,c(E<=y),f=E==y?_i:Mi;break;case Mi:c(g<=w&&w<=y-1),a=g==w?_i:Mi,c(g+1<=E&&E<=y),f=E==y?_i:Mi;break;default:c(u!=u)}return Lr(e,t,function(e,t){S=e,x=t}),T=Ar(e,S),N=Ar(e,x),l=!Or(e,T),p=!Or(e,N),l&&p?(e.parm.msg_lev>=ss&&h("Both down- and up-branches are hopeless"),v=2,v):p?(e.parm.msg_lev>=ss&&h("Up-branch is hopeless"),R(r,t,a,g,w),e.curr.lp_obj=S,r.dir==xi?e.curr.bound<T&&(e.curr.bound=T):r.dir==Ti?e.curr.bound>T&&(e.curr.bound=T):c(r!=r),v=1,v):l?(e.parm.msg_lev>=ss&&h("Down-branch is hopeless"),R(r,t,f,E,y),e.curr.lp_obj=x,r.dir==xi?e.curr.bound<N&&(e.curr.bound=N):r.dir==Ti?e.curr.bound>N&&(e.curr.bound=N):c(r!=r),v=1,v):(e.parm.msg_lev>=ss&&h("Branching on column "+t+", primal value is "+b+""),c(e.curr!=null),d=e.curr.p,e.curr.br_var=t,e.curr.br_val=b,Tr(e),Nr(e,d,2,m),e.parm.msg_lev>=ss&&h("Node "+m[1]+" begins down branch, node "+m[2]+" begins up branch "),i=e.slot[m[1]].node,c(i!=null),c(i.up!=null),c(i.b_ptr==null),i.b_ptr={},i.b_ptr.k=s+t,i.b_ptr.type=a,i.b_ptr.lb=g,i.b_ptr.ub=w,i.b_ptr.next=null,i.lp_obj=S,r.dir==xi?i.bound<T&&(i.bound=T):r.dir==Ti?i.bound>T&&(i.bound=T):c(r!=r),i=e.slot[m[2]].node,c(i!=null),c(i.up!=null),c(i.b_ptr==null),i.b_ptr={},i.b_ptr.k=s+t,i.b_ptr.type=f,i.b_ptr.lb=E,i.b_ptr.ub=y,i.b_ptr.next=null,i.lp_obj=x,r.dir==xi?i.bound<N&&(i.bound=N):r.dir==Ti?i.bound>N&&(i.bound=N):c(r!=r),c(e.child==0),n==Xs?e.child=0:n==Vs?e.child=m[1]:n==$s?e.child=m[2]:c(n!=n),v=0,v)}function a(e){var t=e.mip,n,r,i=0,s,o,u,a;c(e.mip.mip_stat==$i),c(t.pbs_stat==$i&&t.dbs_stat==$i),s=t.obj_val;for(n=1;n<=t.n;n++){var f=t.col[n];if(f.kind!=Ci)continue;o=f.lb,u=f.ub,r=f.stat,a=f.dual;switch(t.dir){case xi:r==Pi?(a<0&&(a=0),s+a>=t.mip_obj&&(R(t,n,_i,o,o),i++)):r==Hi&&(a>0&&(a=0),s-a>=t.mip_obj&&(R(t,n,_i,u,u),i++));break;case Ti:r==Pi?(a>0&&(a=0),s+a<=t.mip_obj&&(R(t,n,_i,o,o),i++)):r==Hi&&(a<0&&(a=0),s-a<=t.mip_obj&&(R(t,n,_i,u,u),i++));break;default:c(e!=e)}}e.parm.msg_lev>=ss&&i!=0&&(i==1?h("One column has been fixed by reduced cost"):h(i+" columns have been fixed by reduced costs")),c(t.pbs_stat==$i&&t.dbs_stat==$i)}function f(e){var t,n=0,r=null;c(e.curr!=null);for(t=e.orig_m+1;t<=e.mip.m;t++)e.mip.row[t].origin==Ms&&e.mip.row[t].level==e.curr.level&&e.mip.row[t].stat==Di&&(r==null&&(r=new Array(1+e.mip.m)),r[++n]=t);n>0&&(J(e.mip,n,r),c(en(e.mip)==0))}function l(e){var t=e.mip,n,r=0,i=0,s=0,o=0,u=0;for(n=t.m;n>0;n--){var a=t.row[n];a.origin==Ms&&(a.klass==_s?r++:a.klass==Ds?i++:a.klass==Ps?s++:a.klass==Hs?o++:u++)}c(e.curr!=null),r+i+s+o+u>0&&(h("Cuts on level "+e.curr.level+":"),r>0&&h(" gmi = "+r+";"),i>0&&h(" mir = "+i+";"),s>0&&h(" cov = "+s+";"),o>0&&h(" clq = "+o+";"),u>0&&h(" app = "+u+";"),h(""))}function p(e){if(e.parm.mir_cuts!=Bs&&e.parm.gmi_cuts!=Bs&&e.parm.cov_cuts!=Bs&&e.parm.clq_cuts!=Bs)return;var t,n,r;n=e.n,n<1e3&&(n=1e3),r=0;for(t=e.orig_m+1;t<=e.mip.m;t++)e.mip.row[t].origin==Ms&&r++;if(r>=n)return;e.parm.gmi_cuts==Bs&&e.curr.changed<5&&Qr(e),e.parm.mir_cuts==Bs&&(c(e.mir_gen!=null),ei(e,e.mir_gen)),e.parm.cov_cuts==Bs&&ri(e),e.parm.clq_cuts==Bs&&e.clq_gen!=null&&(e.curr.level==0&&e.curr.changed<50||e.curr.level>0&&e.curr.changed<5)&&ai(e,e.clq_gen)}function d(e){var t,n,r=0;c(e.mip.mip_stat==$i);for(t=e.head;t!=null;t=n)n=t.next,i(e,t.p)||(Cr(e,t.p),r++);e.parm.msg_lev>=ss&&(r==1?h("One hopeless branch has been pruned"):r>1&&h(r+" hopeless branches have been pruned"))}var v,m,b,w,E,S=0,x=e.tm_beg;const T=0,N=1,C=2,k=3;var L=T;for(;;){var A=null;switch(L){case T:c(e.curr==null);if(e.head==null){e.parm.msg_lev>=ss&&h("Active list is empty!"),E=0,A=k;break}c(e.next_p==0);if(e.parm.cb_func!=null){c(e.reason==0),e.reason=zs,e.parm.cb_func(e,e.parm.cb_info),e.reason=0;if(e.stop){E=oo,A=k;break}}e.next_p==0&&(e.a_cnt==1?(c(e.head.next==null),e.next_p=e.head.p):e.child!=0?e.next_p=e.child:e.next_p=wi(e)),xr(e,e.next_p),e.next_p=e.child=0,e.curr.up!=null&&e.curr.up.p!=S&&(S=0),v=e.curr.p,e.parm.msg_lev>=ss&&(h("------------------------------------------------------------------------"),h("Processing node "+v+" at level "+e.curr.level+"")),v==1&&(e.parm.gmi_cuts==Bs&&e.parm.msg_lev>=is&&h("Gomory's cuts enabled"),e.parm.mir_cuts==Bs&&(e.parm.msg_lev>=is&&h("MIR cuts enabled"),c(e.mir_gen==null),e.mir_gen=Zr(e)),e.parm.cov_cuts==Bs&&e.parm.msg_lev>=is&&h("Cover cuts enabled"),e.parm.clq_cuts==Bs&&(c(e.clq_gen==null),e.parm.msg_lev>=is&&h("Clique cuts enabled"),e.clq_gen=ui(e)));case N:(e.parm.msg_lev>=ss||e.parm.msg_lev>=rs&&e.parm.out_frq-1<=1e3*y(g(),e.tm_lag))&&t(e,0),e.parm.msg_lev>=is&&y(g(),x)>=60&&(h("Time used: "+y(g(),e.tm_beg)+" secs"),x=g());if(e.parm.mip_gap>0&&_r(e)<=e.parm.mip_gap){e.parm.msg_lev>=ss&&h("Relative gap tolerance reached; search terminated "),E=uo,A=k;break}if(e.parm.tm_lim<r&&e.parm.tm_lim-1<=1e3*y(g(),e.tm_beg)){e.parm.msg_lev>=ss&&h("Time limit exhausted; search terminated"),E=no,A=k;break}if(e.parm.cb_func!=null){c(e.reason==0),e.reason=Ws,e.parm.cb_func(e,e.parm.cb_info),e.reason=0;if(e.stop){E=oo,A=k;break}}if(e.parm.pp_tech!=Cs)if(e.parm.pp_tech==ks){if(e.curr.level==0&&qr(e,100)){A=C;break}}else if(e.parm.pp_tech==Ls){if(qr(e,e.curr.level==0?100:10)){A=C;break}}else c(e!=e);if(!i(e,v)){h("*** not tested yet ***"),A=C;break}e.parm.msg_lev>=ss&&h("Solving LP relaxation..."),E=Dr(e);if(E!=0&&E!=Zs&&E!=eo){e.parm.msg_lev>=ns&&h("ios_driver: unable to solve current LP relaxation; glp_simplex returned "+E+""),E=Ys,A=k;break}b=e.mip.pbs_stat,w=e.mip.dbs_stat;if(b==$i&&w==$i)e.parm.msg_lev>=ss&&h("Found optimal solution to LP relaxation");else{if(w==Ki){e.parm.msg_lev>=ns&&h("ios_driver: current LP relaxation has no dual feasible solution"),E=Ys,A=k;break}if(b==Ji&&w==$i){c(e.mip.mip_stat==$i),e.parm.msg_lev>=ss&&h("LP relaxation has no solution better than incumbent objective value"),A=C;break}if(b==Ki){e.parm.msg_lev>=ss&&h("LP relaxation has no feasible solution"),A=C;break}c(e.mip!=e.mip)}c(b==$i&&w==$i),c(e.curr!=null),e.curr.lp_obj=e.mip.obj_val;var O=e.mip.obj_val;O=Ar(e,O),e.mip.dir==xi?e.curr.bound<O&&(e.curr.bound=O):e.mip.dir==Ti?e.curr.bound>O&&(e.curr.bound=O):c(e.mip!=e.mip),e.parm.msg_lev>=ss&&h("Local bound is "+O+"");if(!i(e,v)){e.parm.msg_lev>=ss&&h("Current branch is hopeless and can be pruned"),A=C;break}c(e.reopt==0),c(e.reinv==0);if(e.parm.cb_func!=null){c(e.reason==0),e.reason=Fs,e.parm.cb_func(e,e.parm.cb_info),e.reason=0;if(e.stop){E=oo,A=k;break}if(e.reopt){e.reopt=e.reinv=0,A=N;break}e.reinv&&(e.reinv=0,c(en(e.mip)==0))}s(e);if(e.curr.ii_cnt==0){e.parm.msg_lev>=ss&&h("New integer feasible solution found"),e.parm.msg_lev>=is&&l(e),o(e),e.parm.msg_lev>=rs&&t(e,1);if(e.parm.cb_func!=null){c(e.reason==0),e.reason=Is,e.parm.cb_func(e,e.parm.cb_info),e.reason=0;if(e.stop){E=oo,A=k;break}}A=C;break}e.mip.mip_stat==$i&&a(e);if(e.parm.cb_func!=null){c(e.reason==0),e.reason=qs,e.parm.cb_func(e,e.parm.cb_info),e.reason=0;if(e.stop){E=oo,A=k;break}if(!i(e,v)){e.parm.msg_lev>=ss&&h("Current branch became hopeless and can be pruned"),A=C;break}}if(e.parm.fp_heur){c(e.reason==0),e.reason=qs,yi(e),e.reason=0;if(!i(e,v)){e.parm.msg_lev>=ss&&h("Current branch became hopeless and can be pruned"),A=C;break}}c(e.local!=null),c(e.local.size==0);if(e.parm.cb_func!=null){c(e.reason==0),e.reason=Rs,e.parm.cb_func(e,e.parm.cb_info),e.reason=0;if(e.stop){E=oo,A=k;break}}if(e.curr.level==0||S==0)c(e.reason==0),e.reason=Rs,p(e),e.reason=0;e.local.size>0&&(c(e.reason==0),e.reason=Rs,bi(e),e.reason=0),Fr(e.local);if(e.reopt){e.reopt=0,e.curr.changed++,A=N;break}f(e),e.parm.msg_lev>=is&&e.curr.level==0&&l(e),e.pcost!=null&&vi(e),c(e.br_var==0),c(e.br_sel==0);if(e.parm.cb_func!=null){c(e.reason==0),c(e.br_var==0),c(e.br_sel==0),e.reason=Us,e.parm.cb_func(e,e.parm.cb_info),e.reason=0;if(e.stop){E=oo,A=k;break}}e.br_var==0&&(e.br_var=fi(e,function(t){e.br_sel=t})),m=e.curr.p,E=u(e,e.br_var,e.br_sel),e.br_var=e.br_sel=0;if(E==0){S=m,A=T;break}if(E==1){e.curr.solved=e.curr.changed=0,A=N;break}if(E==2){A=C;break}c(E!=E);case C:e.parm.msg_lev>=ss&&h("Node "+v+" fathomed"),Tr(e),Cr(e,v),e.mip.mip_stat==$i&&d(e),S=0,A=T;break;case k:return e.parm.msg_lev>=rs&&t(e,0),e.mir_gen=null,e.clq_gen=null,E}if(A==null)break;L=A}}function Ur(e){var t;return c(e>=0),t={},t.n=e,t.nnz=0,t.pos=new Array(1+e),v(t.pos,1,0,e),t.ind=new Array(1+e),t.val=new Array(1+e),t}function zr(e){var t,n,r;c(e.n>=0),r=0;for(t=e.n;t>=1;t--)n=e.pos[t],c(0<=n&&n<=e.nnz),n!=0&&(c(e.ind[n]==t),r++);c(e.nnz==r)}function Wr(e,t){var n;return c(1<=t&&t<=e.n),n=e.pos[t],c(0<=n&&n<=e.nnz),n==0?0:e.val[n]}function Xr(e,t,n){c(1<=t&&t<=e.n);var r=e.pos[t];n==0?r!=0&&(e.pos[t]=0,r<e.nnz&&(e.pos[e.ind[e.nnz]]=r,e.ind[r]=e.ind[e.nnz],e.val[r]=e.val[e.nnz]),e.nnz--):(r==0&&(r=++e.nnz,e.pos[t]=r,e.ind[r]=t),e.val[r]=n)}function Vr(e){for(var t=1;t<=e.nnz;t++)e.pos[e.ind[t]]=0;e.nnz=0}function $r(e,t){var n=0;for(var r=1;r<=e.nnz;r++)Math.abs(e.val[r])==0||Math.abs(e.val[r])<t?e.pos[e.ind[r]]=0:(n++,e.pos[e.ind[r]]=n,e.ind[n]=e.ind[r],e.val[n]=e.val[r]);e.nnz=n}function Jr(e,t){c(e!=t),c(e.n==t.n),Vr(e),e.nnz=t.nnz,d(e.ind,1,t.ind,1,e.nnz),d(e.val,1,t.val,1,e.nnz);for(var n=1;n<=e.nnz;n++)e.pos[e.ind[n]]=n}function Kr(e,t,n){var r,i,s;c(e!=n),c(e.n==n.n);for(var o=1;o<=n.nnz;o++)r=n.ind[o],i=Wr(e,r),s=n.val[o],Xr(e,r,i+t*s)}function Qr(e){function n(e){return e-Math.floor(e)}function r(e,t,r){var i=e.mip,s=i.m,o=i.n,u=t.ind,a=t.val,f=t.phi,l,h,p,d,v,m,g,y,b,w,E,S,x,T;p=hn(i,s+r,u,a),b=i.col[r].prim;for(h=1;h<=s+o;h++)f[h]=0;S=n(b);for(r=1;r<=p;r++){h=u[r],c(1<=h&&h<=s+o),h<=s?(x=i.row[h],d=Ni,m=x.lb,g=x.ub,v=x.stat):(T=i.col[h-s],d=T.kind,m=T.lb,g=T.ub,v=T.stat),c(v!=Di),w=a[r];if(Math.abs(w)>1e5)return;if(Math.abs(w)<1e-10)continue;switch(v){case Bi:return;case Pi:y=-w;break;case Hi:y=+w;break;case ji:continue;default:c(v!=v)}switch(d){case Ci:if(Math.abs(y-Math.floor(y+.5))<1e-10)continue;n(y)<=n(b)?E=n(y):E=n(b)/(1-n(b))*(1-n(y));break;case Ni:y>=0?E=+y:E=n(b)/(1-n(b))*-y;break;default:c(d!=d)}switch(v){case Pi:f[h]=+E,S+=E*m;break;case Hi:f[h]=-E,S-=E*g;break;default:c(v!=v)}}for(l=1;l<=s;l++){var N;if(Math.abs(f[l])<1e-10)continue;x=i.row[l],c(x.type!=_i);for(N=x.ptr;N!=null;N=N.r_next)f[s+N.col.j]+=f[l]*N.val}p=0;for(r=1;r<=o;r++){if(Math.abs(f[s+r])<1e-10)continue;T=i.col[r],T.type==_i?S-=f[s+r]*T.lb:(p++,u[p]=r,a[p]=f[s+r])}Math.abs(S)<1e-12&&(S=0);for(h=1;h<=p;h++){if(Math.abs(a[h])<.001)return;if(Math.abs(a[h])>1e3)return}Hn(e,null,_s,0,p,u,a,Ai,S)}const t=50;var i=e.mip,s=i.m,o=i.n,u,a,f,l,h,p={};u=new Array(1+o),p.ind=new Array(1+o),p.val=new Array(1+o),p.phi=new Array(1+s+o),f=0;for(l=1;l<=o;l++){var d=i.col[l],v;if(d.kind!=Ci)continue;if(d.type==_i)continue;if(d.stat!=Di)continue;v=n(d.prim);if(!(.05<=v&&v<=.95))continue;f++,u[f].j=l,u[f].f=v}b(u,1,f,function(e,t){return e.f>t.f?-1:e.f<t.f?1:0}),h=Pn(e);for(a=1;a<=f;a++){if(Pn(e)-h>=t)break;r(e,p,u[a].j)}}function Zr(e){function t(e,t){var r=e.mip,i=t.m,s;for(s=1;s<=i;s++){var o=r.row[s];t.skip[s]=0,t.isint[s]=0;switch(o.type){case Li:t.lb[s]=-n,t.ub[s]=+n;break;case Ai:t.lb[s]=o.lb,t.ub[s]=+n;break;case Oi:t.lb[s]=-n,t.ub[s]=o.ub;break;case Mi:t.lb[s]=o.lb,t.ub[s]=o.ub;break;case _i:t.lb[s]=t.ub[s]=o.lb;break;default:c(o!=o)}t.vlb[s]=t.vub[s]=0}}function r(e,t){var r=e.mip,i=t.m,s=t.n,o;for(o=i+1;o<=i+s;o++){var u=r.col[o-i];switch(u.kind){case Ni:t.isint[o]=0;break;case Ci:t.isint[o]=1;break;default:c(u!=u)}switch(u.type){case Li:t.lb[o]=-n,t.ub[o]=+n;break;case Ai:t.lb[o]=u.lb,t.ub[o]=+n;break;case Oi:t.lb[o]=-n,t.ub[o]=u.ub;break;case Mi:t.lb[o]=u.lb,t.ub[o]=u.ub;break;case _i:t.lb[o]=t.ub[o]=u.lb;break;default:c(u!=u)}t.vlb[o]=t.vub[o]=0}}function i(e,t){var r=e.mip,i=t.m,s,o,u,a,f,l;for(o=1;o<=i;o++){if(!(t.lb[o]==0&&t.ub[o]==+n||t.lb[o]==-n&&t.ub[o]==0))continue;s=r.row[o].ptr;if(s==null)continue;u=i+s.col.j,f=s.val,s=s.r_next;if(s==null)continue;a=i+s.col.j,l=s.val;if(s.r_next!=null)continue;if(!!t.isint[u]||!t.isint[a]){if(!t.isint[u]||!!t.isint[a])continue;a=u,l=f,u=i+s.col.j,f=s.val}if(t.lb[a]==-n||t.ub[a]==+n||t.lb[a]==t.ub[a])continue;t.ub[o]==0&&(f=-f,l=-l),f>0?t.vlb[u]==0&&(t.lb[u]=-l/f,t.vlb[u]=a,t.skip[o]=1):t.vub[u]==0&&(t.ub[u]=-l/f,t.vub[u]=a,t.skip[o]=1)}}function s(e,t){var r=e.mip,i=t.m,s,o,u,a;for(o=1;o<=i;o++){if(t.lb[o]==-n&&t.ub[o]==+n){t.skip[o]=1;continue}a=0;for(s=r.row[o].ptr;s!=null;s=s.r_next){u=i+s.col.j;if(t.lb[u]==-n&&t.ub[u]==+n){t.skip[o]=1;break}if(t.isint[u]&&t.lb[u]==-n||t.isint[u]&&t.ub[u]==+n){t.skip[o]=1;break}(t.vlb[u]!=0||t.vub[u]!=0||t.lb[u]!=t.ub[u])&&a++}a==0&&(t.skip[o]=1)}}var o=e.mip,u=o.m,a=o.n,f;return Gr&&h("ios_mir_init: warning: debug mode enabled"),f={},f.m=u,f.n=a,f.skip=new Array(1+u),f.isint=new Array(1+u+a),f.lb=new Array(1+u+a),f.vlb=new Array(1+u+a),f.ub=new Array(1+u+a),f.vub=new Array(1+u+a),f.x=new Array(1+u+a),f.agg_row=new Array(1+Yr),f.agg_vec=Ur(u+a),f.subst=new Array(1+u+a),f.mod_vec=Ur(u+a),f.cut_vec=Ur(u+a),t(e,f),r(e,f),i(e,f),s(e,f),f}function ei(e,t){function o(e,t,n,i,o,u,a){function f(e,t){return e.v<t.v?-1:e.v>t.v?1:0}function l(e,t,n,i,o,u,a){function f(e,t,n,i){var o,u,a;if(Math.abs(n-Math.floor(n+.5))<.01)return 1;u=n-Math.floor(n);for(o=1;o<=e;o++)a=t[o]-Math.floor(t[o])-u,a<=0?i[o]=Math.floor(t[o]):i[o]=Math.floor(t[o])+a/(1-u);return r=Math.floor(n),s=1/(1-u),0}var l,c,h;c=a,h=n;for(l=1;l<=e;l++)c[l]=t[l]/u,o[l]&&(c[l]=-c[l]),h-=t[l]*i[l];h/=u;if(f(e,c,h,a))return 1;for(l=1;l<=e;l++)o[l]&&(a[l]=-a[l],r+=a[l]*i[l]);return s/=u,0}var h,p,d,v,m,g,y,w=new Array(4),E,S,x,T;x=new Array(1+e),T=new Array(1+e);for(p=1;p<=e;p++)x[p]=o[p]>=.5*i[p];S=g=0;for(p=1;p<=e;p++){c(t[p]!=0),y=1e-9*(1+Math.abs(i[p]));if(o[p]<y||o[p]>i[p]-y)continue;h=l(e,t,n,i,x,Math.abs(t[p]),a);if(h)continue;E=-r-s*u;for(d=1;d<=e;d++)E+=a[d]*o[d];S<E&&(S=E,g=Math.abs(t[p]))}S<.001&&(S=0);if(S==0)return S;c(g>0),w[1]=g/2,w[2]=g/4,w[3]=g/8;for(p=1;p<=3;p++){h=l(e,t,n,i,x,w[p],a);if(h)continue;E=-r-s*u;for(d=1;d<=e;d++)E+=a[d]*o[d];S<E&&(S=E,g=w[p])}v=0;for(p=1;p<=e;p++){y=1e-9*(1+Math.abs(i[p]));if(o[p]<y||o[p]>i[p]-y)continue;v++,T[v].j=p,T[v].v=Math.abs(o[p]-.5*i[p])}b(T,1,v,f);for(m=1;m<=v;m++){p=T[m].j,x[p]=!x[p],h=l(e,t,n,i,x,g,a),x[p]=!x[p];if(h)continue;E=-r-s*u;for(d=1;d<=e;d++)E+=a[d]*o[d];S<E&&(S=E,x[p]=!x[p])}return h=l(e,t,n,i,x,g,a),c(!h),S}function u(e,t){var n=e.mip,r=t.m,i=t.n,s;for(s=1;s<=r;s++)t.x[s]=n.row[s].prim;for(s=r+1;s<=r+i;s++)t.x[s]=n.col[s-r].prim}function f(e,t,n){var r=e.mip,i=t.m,s;c(1<=n&&n<=i),c(!t.skip[n]),t.skip[n]=2,t.agg_cnt=1,t.agg_row[1]=n,Vr(t.agg_vec),Xr(t.agg_vec,n,1);for(s=r.row[n].ptr;s!=null;s=s.r_next)Xr(t.agg_vec,i+s.col.j,-s.val);t.agg_rhs=0,Gr&&zr(t.agg_vec)}function h(e){var t=e.m,n=e.n,r,s;for(r=1;r<=e.agg_vec.nnz;r++)s=e.agg_vec.ind[r],c(1<=s&&s<=t+n),e.vlb[s]==0&&e.vub[s]==0&&e.lb[s]==e.ub[s]&&(e.agg_rhs-=e.agg_vec.val[r]*e.lb[s],e.agg_vec.val[r]=0);$r(e.agg_vec,i),Gr&&zr(e.agg_vec)}function p(e){var t=e.m,r=e.n,i,s,o,u,a;for(i=1;i<=e.agg_vec.nnz;i++){s=e.agg_vec.ind[i],c(1<=s&&s<=t+r);if(e.isint[s])continue;o=e.vlb[s],o==0?e.lb[s]==-n?u=n:u=e.x[s]-e.lb[s]:(c(1<=o&&o<=t+r),c(e.isint[o]),c(e.lb[s]!=-n),u=e.x[s]-e.lb[s]*e.x[o]),o=e.vub[s],o==0?e.vub[s]==+n?a=n:a=e.ub[s]-e.x[s]:(c(1<=o&&o<=t+r),c(e.isint[o]),c(e.ub[s]!=+n),a=e.ub[s]*e.x[o]-e.x[s]),c(u!=n||a!=n),c(e.subst[s]=="?"),u<=a?e.subst[s]="L":e.subst[s]="U"}}function d(e){var t=e.m,r=e.n,i,s,o,u;Jr(e.mod_vec,e.agg_vec),e.mod_rhs=e.agg_rhs,Gr&&zr(e.mod_vec);for(i=e.mod_vec.nnz;i>=1;i--){o=e.mod_vec.ind[i],c(1<=o&&o<=t+r);if(e.isint[o])continue;e.subst[o]=="L"?(c(e.lb[o]!=-n),u=e.vlb[o],u==0?e.mod_rhs-=e.mod_vec.val[i]*e.lb[o]:(c(e.isint[u]),s=e.mod_vec.pos[u],s==0&&(Xr(e.mod_vec,u,1),s=e.mod_vec.pos[u],e.mod_vec.val[s]=0),e.mod_vec.val[s]+=e.mod_vec.val[i]*e.lb[o])):e.subst[o]=="U"?(c(e.ub[o]!=+n),u=e.vub[o],u==0?e.mod_rhs-=e.mod_vec.val[i]*e.ub[o]:(c(e.isint[u]),s=e.mod_vec.pos[u],s==0&&(Xr(e.mod_vec,u,1),s=e.mod_vec.pos[u],e.mod_vec.val[s]=0),e.mod_vec.val[s]+=e.mod_vec.val[i]*e.ub[o]),e.mod_vec.val[i]=-e.mod_vec.val[i]):c(o!=o)}Gr&&zr(e.mod_vec);for(i=1;i<=e.mod_vec.nnz;i++){o=e.mod_vec.ind[i],c(1<=o&&o<=t+r);if(!e.isint[o])continue;c(e.subst[o]=="?"),c(e.vlb[o]==0&&e.vub[o]==0),c(e.lb[o]!=-n&&e.ub[o]!=+n),Math.abs(e.lb[o])<=Math.abs(e.ub[o])?(e.subst[o]="L",e.mod_rhs-=e.mod_vec.val[i]*e.lb[o]):(e.subst[o]="U",e.mod_rhs-=e.mod_vec.val[i]*e.ub[o],e.mod_vec.val[i]=-e.mod_vec.val[i])}Gr&&zr(e.mod_vec)}function g(e){var t=e.m,r=e.n,s,u,a,f,l,h,p,d,v=0,m,g=null,y=null;Jr(e.cut_vec,e.mod_vec),e.cut_rhs=e.mod_rhs,$r(e.cut_vec,i),Gr&&zr(e.cut_vec);for(s=1;s<=e.cut_vec.nnz;s++)u=e.cut_vec.ind[s],c(1<=u&&u<=t+r),!e.isint[u]&&e.cut_vec.val[s]>0&&(e.cut_vec.val[s]=0);$r(e.cut_vec,0),Gr&&zr(e.cut_vec),f=0;for(s=1;s<=e.cut_vec.nnz;s++){u=e.cut_vec.ind[s],c(1<=u&&u<=t+r);if(e.isint[u]){var b;f++,a=e.cut_vec.ind[f],e.cut_vec.pos[u]=f,e.cut_vec.pos[a]=s,e.cut_vec.ind[f]=u,e.cut_vec.ind[s]=a,b=e.cut_vec.val[f],e.cut_vec.val[f]=e.cut_vec.val[s],e.cut_vec.val[s]=b}}Gr&&zr(e.cut_vec);if(f==0)return v;h=new Array(1+f),p=new Array(1+f),d=new Array(1+f);for(s=1;s<=f;s++)u=e.cut_vec.ind[s],c(t+1<=u&&u<=t+r),c(e.isint[u]),h[s]=e.ub[u]-e.lb[u],c(h[s]>=1),e.subst[u]=="L"?p[s]=e.x[u]-e.lb[u]:e.subst[u]=="U"?p[s]=e.ub[u]-e.x[u]:c(u!=u),c(p[s]>=-0.001),p[s]<0&&(p[s]=0);l=0;for(s=f+1;s<=e.cut_vec.nnz;s++)u=e.cut_vec.ind[s],c(1<=u&&u<=t+r),c(!e.isint[u]),e.subst[u]=="L"?(c(e.lb[u]!=-n),a=e.vlb[u],a==0?p=e.x[u]-e.lb[u]:p=e.x[u]-e.lb[u]*e.x[a]):e.subst[u]=="U"?(c(e.ub[u]!=+n),a=e.vub[u],a==0?p=e.ub[u]-e.x[u]:p=e.ub[u]*e.x[a]-e.x[u]):c(u!=u),c(p>=-0.001),p<0&&(p=0),l-=e.cut_vec.val[s]*p;c(l>=0),m=e.cut_rhs,v=o(f,e.cut_vec.val,m,h,p,l,d);if(v==0)return v;c(v>0);for(s=1;s<=f;s++)e.cut_vec.val[s]=d[s];for(s=f+1;s<=e.cut_vec.nnz;s++)u=e.cut_vec.ind[s],u<=t+r&&(e.cut_vec.val[s]*=y);return e.cut_rhs=g,Gr&&zr(e.cut_vec),v}function w(e){var t=e.m,r=e.n,i,s,o,u;for(i=1;i<=e.cut_vec.nnz;i++){o=e.cut_vec.ind[i],c(1<=o&&o<=t+r);if(!e.isint[o])continue;e.subst[o]=="L"?(c(e.lb[o]!=-n),c(e.vlb[o]==0),e.cut_rhs+=e.cut_vec.val[i]*e.lb[o]):e.subst[o]=="U"?(c(e.ub[o]!=+n),c(e.vub[o]==0),e.cut_rhs-=e.cut_vec.val[i]*e.ub[o],e.cut_vec.val[i]=-e.cut_vec.val[i]):c(o!=o)}for(i=1;i<=e.cut_vec.nnz;i++){o=e.cut_vec.ind[i],c(1<=o&&o<=t+r);if(e.isint[o])continue;e.subst[o]=="L"?(c(e.lb[o]!=-n),u=e.vlb[o],u==0?e.cut_rhs+=e.cut_vec.val[i]*e.lb[o]:(s=e.cut_vec.pos[u],s==0&&(Xr(e.cut_vec,u,1),s=e.cut_vec.pos[u],c(s!=0),e.cut_vec.val[s]=0),e.cut_vec.val[s]-=e.cut_vec.val[i]*e.lb[o])):e.subst[o]=="U"?(c(e.ub[o]!=+n),u=e.vub[o],u==0?e.cut_rhs-=e.cut_vec.val[i]*e.ub[o]:(s=e.cut_vec.pos[u],s==0&&(Xr(e.cut_vec,u,1),s=e.cut_vec.pos[u],c(s!=0),e.cut_vec.val[s]=0),e.cut_vec.val[s]+=e.cut_vec.val[i]*e.ub[o]),e.cut_vec.val[i]=-e.cut_vec.val[i]):c(o!=o)}Gr&&zr(e.cut_vec)}function S(e,t){var n=e.mip,r=t.m,i=t.n,s,o,u,a,f;for(o=t.cut_vec.nnz;o>=1;o--){u=t.cut_vec.ind[o],c(1<=u&&u<=r+i);if(u>r)continue;for(s=n.row[u].ptr;s!=null;s=s.r_next)a=r+s.col.j,f=t.cut_vec.pos[a],f==0&&(Xr(t.cut_vec,a,1),f=t.cut_vec.pos[a],t.cut_vec.val[f]=0),t.cut_vec.val[f]+=t.cut_vec.val[o]*s.val;t.cut_vec.val[o]=0}$r(t.cut_vec,0)}function x(e,t){var n=t.m,r=t.n,i,s,o,u=new Array(1+r),a=new Array(1+r);o=0;for(i=t.cut_vec.nnz;i>=1;i--)s=t.cut_vec.ind[i],c(n+1<=s&&s<=n+r),o++,u[o]=s-n,a[o]=t.cut_vec.val[i];Hn(e,null,Ds,0,o,u,a,Oi,t.cut_rhs)}function T(e,t){var r=e.mip,i=t.m,s=t.n,o,u,a,f,l,h,p,d=0,v=0,m,g,y,b=0;for(f=1;f<=t.agg_vec.nnz;f++){h=t.agg_vec.ind[f],c(1<=h&&h<=i+s);if(h<=i)continue;if(t.isint[h])continue;if(Math.abs(t.agg_vec.val[f])<.001)continue;p=t.vlb[h],p==0?t.lb[h]==-n?m=n:m=t.x[h]-t.lb[h]:(c(1<=p&&p<=i+s),c(t.isint[p]),c(t.lb[h]!=-n),m=t.x[h]-t.lb[h]*t.x[p]),p=t.vub[h],p==0?t.vub[h]==+n?g=n:g=t.ub[h]-t.x[h]:(c(1<=p&&p<=i+s),c(t.isint[p]),c(t.ub[h]!=+n),g=t.ub[h]*t.x[p]-t.x[h]),c(m!=n||g!=n),y=m<=g?m:g,c(y!=n);if(y<.001)continue;b<y&&(b=y,d=h)}if(d==0)return v=1,v;c(i+1<=d&&d<=i+s),c(!t.isint[d]);for(a=1;a<=i;a++){if(t.skip[a])continue;for(o=r.row[a].ptr;o!=null;o=o.r_next)if(o.col.j==d-i)break;if(o!=null&&Math.abs(o.val)>=.001)break}if(a>i)return v=2,v;t.agg_cnt++,c(t.agg_cnt<=Yr),t.agg_row[t.agg_cnt]=a,t.skip[a]=2,u=Ur(i+s),Xr(u,a,1);for(o=r.row[a].ptr;o!=null;o=o.r_next)Xr(u,i+o.col.j,-o.val);return Gr&&zr(u),f=t.agg_vec.pos[d],c(f!=0),l=u.pos[d],c(l!=0),Kr(t.agg_vec,-t.agg_vec.val[f]/u.val[l],u),Xr(t.agg_vec,d,0),Gr&&zr(t.agg_vec),v}var r,s;if(Gr)function a(e){var t=e.m,r=e.n,i,s,o,u,a;for(i=1;i<=t+r;i++)o=e.lb[i],s=e.vlb[i],s!=0&&(c(o!=-n),c(!e.isint[i]),c(e.isint[s]),o*=e.x[s]),o!=-n&&(a=1e-6*(1+Math.abs(o)),c(e.x[i]>=o-a)),u=e.ub[i],s=e.vub[i],s!=0&&(c(u!=+n),c(!e.isint[i]),c(e.isint[s]),u*=e.x[s]),u!=+n&&(a=1e-6*(1+Math.abs(u)),c(e.x[i]<=u+a))}if(Gr)function l(e){var t=e.m,n=e.n,r,i,s,o;s=0,o=1;for(r=1;r<=e.agg_vec.nnz;r++)i=e.agg_vec.ind[r],c(1<=i&&i<=t+n),s+=e.agg_vec.val[r]*e.x[i],o<Math.abs(e.agg_vec.val[r])&&(o=Math.abs(e.agg_vec.val[r]));s-=e.agg_rhs,o<Math.abs(e.agg_rhs)&&(o=Math.abs(e.agg_rhs)),c(Math.abs(s)<=1e-6*o)}if(Gr)function m(e){var t=e.m,r=e.n,i,s,o,u,a,f;u=0,a=1;for(i=1;i<=e.mod_vec.nnz;i++)s=e.mod_vec.ind[i],c(1<=s&&s<=t+r),e.subst[s]=="L"?(c(e.lb[s]!=-n),o=e.vlb[s],o==0?f=e.x[s]-e.lb[s]:f=e.x[s]-e.lb[s]*e.x[o]):e.subst[s]=="U"?(c(e.ub[s]!=+n),o=e.vub[s],o==0?f=e.ub[s]-e.x[s]:f=e.ub[s]*e.x[o]-e.x[s]):c(s!=s),u+=e.mod_vec.val[i]*f,a<Math.abs(e.mod_vec.val[i])&&(a=Math.abs(e.mod_vec.val[i]));u-=e.mod_rhs,a<Math.abs(e.mod_rhs)&&(a=Math.abs(e.mod_rhs)),c(Math.abs(u)<=1e-6*a)}if(Gr)function y(e,t){var r=e.m,i=e.n,s,o,u,a,f,l;a=0,f=1;for(s=1;s<=e.cut_vec.nnz;s++)o=e.cut_vec.ind[s],c(1<=o&&o<=r+i),e.subst[o]=="L"?(c(e.lb[o]!=-n),u=e.vlb[o],u==0?l=e.x[o]-e.lb[o]:l=e.x[o]-e.lb[o]*e.x[u]):e.subst[o]=="U"?(c(e.ub[o]!=+n),u=e.vub[o],u==0?l=e.ub[o]-e.x[o]:l=e.ub[o]*e.x[u]-e.x[o]):c(o!=o),a+=e.cut_vec.val[s]*l,f<Math.abs(e.cut_vec.val[s])&&(f=Math.abs(e.cut_vec.val[s]));a-=e.cut_rhs,f<Math.abs(e.cut_rhs)&&(f=Math.abs(e.cut_rhs)),c(Math.abs(a-t)<=1e-6*f)}if(Gr)function E(e,t){var n=e.m,r=e.n,i,s,o,u;o=0,u=1;for(i=1;i<=e.cut_vec.nnz;i++)s=e.cut_vec.ind[i],c(1<=s&&s<=n+r),o+=e.cut_vec.val[i]*e.x[s],u<Math.abs(e.cut_vec.val[i])&&(u=Math.abs(e.cut_vec.val[i]));o-=e.cut_rhs,u<Math.abs(e.cut_rhs)&&(u=Math.abs(e.cut_rhs)),c(Math.abs(o-t)<=1e-6*u)}var N=e.mip,C=t.m,k=t.n,L,A,O;c(N.m>=C),c(N.n==k),u(e,t),Gr&&a(t),v(t.subst,1,"?",C+k);for(L=1;L<=C;L++){if(t.skip[L])continue;f(e,t,L);for(;;){Gr&&l(t),h(t);if(Gr){l(t);for(A=1;A<=C+k;A++)c(t.subst[A]=="?")}p(t),d(t),Gr&&m(t),O=g(t),O>0&&(Gr&&y(t,O),w(t),Gr&&E(t,O),S(e,t),Gr&&E(t,O),x(e,t));for(var M=1;M<=t.mod_vec.nnz;M++)A=t.mod_vec.ind[M],c(1<=A&&A<=C+k),c(t.subst[A]!="?"),t.subst[A]="?";if(O==0&&t.agg_cnt<Yr&&T(e,t)==0)continue;break}var _;for(A=1;A<=t.agg_cnt;A++)_=t.agg_row[A],c(1<=_&&_<=C),c(t.skip[_]==2),t.skip[_]=0}}function ti(e,t,n,r,i){function a(e,t,n,r,i,a,f){var l,c,h=0,p=0,d,v,m=.001;d=.001*(1+Math.abs(n));for(l=1;l<=e;l++)for(c=l+1;c<=e;c++){h++;if(h>u)return p;t[l]+t[c]+a>n+d&&(v=t[l]+t[c]-n,s=1/(v+r),o=2-s*v,v=i[l]+i[c]+s*a-o,m<v&&(m=v,f[1]=l,f[2]=c,p=1))}return p}function f(e,t,n,r,i,a,f){var l,c,h,p=0,d=0,v,m,g=.001;v=.001*(1+Math.abs(n));for(l=1;l<=e;l++)for(c=l+1;c<=e;c++)for(h=c+1;h<=e;h++){p++;if(p>u)return d;t[l]+t[c]+t[h]+a>n+v&&(m=t[l]+t[c]+t[h]-n,s=1/(m+r),o=3-s*m,m=i[l]+i[c]+i[h]+s*a-o,g<m&&(g=m,f[1]=l,f[2]=c,f[3]=h,d=1))}return d}function l(e,t,n,r,i,a,f){var l,c,h,p,d=0,v=0,m,g,y=.001;m=.001*(1+Math.abs(n));for(l=1;l<=e;l++)for(c=l+1;c<=e;c++)for(h=c+1;h<=e;h++)for(p=h+1;p<=e;p++){d++;if(d>u)return v;t[l]+t[c]+t[h]+t[p]+a>n+m&&(g=t[l]+t[c]+t[h]+t[p]-n,s=1/(g+r),o=4-s*g,g=i[l]+i[c]+i[h]+i[p]+s*a-o,y<g&&(y=g,f[1]=l,f[2]=c,f[3]=h,f[4]=p,v=1))}return v}function h(e,t,n,r,i,s,o){var u;c(e>=2);for(u=1;u<=e;u++)c(t[u]>0);c(n>-0.00001),c(r>=0);for(u=1;u<=e;u++)c(0<=i[u]&&i[u]<=1);return c(0<=s&&s<=r),a(e,t,n,r,i,s,o)?2:f(e,t,n,r,i,s,o)?3:l(e,t,n,r,i,s,o)?4:0}var s=null,o=null;const u=1e3;var p=new Array(5),d,v,m,g,y,b,w,E,S;g=0;for(v=1;v<=t;v++)d=n[v],Ka(e,d)==Oo?r[0]-=r[v]*Qa(e,d):(g++,n[g]=n[v],r[g]=r[v]);t=g,m=0;for(v=1;v<=t;v++){d=n[v];if(Kf(e,d)==Ko&&Ka(e,d)==Ao&&Qa(e,d)==0&&Ga(e,d)==1){var x,T;m++,x=n[m],T=r[m],n[m]=n[v],r[m]=r[v],n[v]=x,r[v]=T}}if(m<2)return 0;b=w=0;for(v=m+1;v<=t;v++){d=n[v];if(Ka(e,d)!=Ao)return 0;r[v]>0?(b+=r[v]*Qa(e,d),w+=r[v]*Ga(e,d)):(b+=r[v]*Ga(e,d),w+=r[v]*Qa(e,d))}E=w-b,S=0;for(v=m+1;v<=t;v++)d=n[v],S+=r[v]*kf(e,d);S-=b,S<0&&(S=0),S>E&&(S=E),r[0]-=b;for(v=1;v<=m;v++)d=n[v],i[v]=kf(e,d),i[v]<0&&(i[v]=0),i[v]>1&&(i[v]=1);for(v=1;v<=m;v++)r[v]<0&&(n[v]=-n[v],r[v]=-r[v],r[0]+=r[v],i[v]=1-i[v]);y=h(m,r,r[0],E,i,S,p);if(y==0)return 0;c(2<=y&&y<=4),n[0]=0,r[0]=o;for(d=1;d<=y;d++)p[d]=n[p[d]];c(y<=m);for(v=1;v<=y;v++)p[v]>0?(n[v]=+p[v],r[v]=1):(n[v]=-p[v],r[v]=-1,r[0]-=1);for(v=m+1;v<=t;v++)y++,n[y]=n[v],r[y]=s*r[v];return r[0]+=s*b,c(y<=t),t=y,t}function ni(e,t,n,r){var i=Ua(e),s,o,u=0;t<0&&l("lpx_eval_row: len = "+t+"; invalid row length");for(o=1;o<=t;o++)s=n[o],1<=s&&s<=i||l("lpx_eval_row: j = "+s+"; column number out of range"),u+=r[o]*kf(e,s);return u}function ri(e){var t=e.mip,n=Ra(t),r=Ua(t),i,s,o,u,a,f,l,h,p;c(yf(t)==eu),f=new Array(1+r),h=new Array(1+r),p=new Array(1+r);for(i=1;i<=n;i++)for(u=1;u<=2;u++){o=Xa(t,i);if(u==1){if(o!=Lo&&o!=Ao)continue;a=tf(t,i,f,h),h[0]=$a(t,i)}else{if(o!=ko&&o!=Ao)continue;a=tf(t,i,f,h);for(s=1;s<=a;s++)h[s]=-h[s];h[0]=-Va(t,i)}a=ti(t,a,f,h,p);if(a==0)continue;l=ni(t,a,f,h)-h[0];if(l<.001)continue;Hn(e,null,Ps,0,a,f,h,Oi,h[0])}}function ii(e){function i(e,t){var r;switch(Xa(e,t)){case Co:case Lo:r=-n;break;case ko:case Ao:case Oo:r=Va(e,t);break;default:c(e!=e)}return r}function o(e,t){var r;switch(Xa(e,t)){case Co:case ko:r=+n;break;case Lo:case Ao:case Oo:r=$a(e,t);break;default:c(e!=e)}return r}function u(e,t){var r;switch(Ka(e,t)){case Co:case Lo:r=-n;break;case ko:case Ao:case Oo:r=Qa(e,t);break;default:c(e!=e)}return r}function a(e,t){var r;switch(Ka(e,t)){case Co:case ko:r=+n;break;case Lo:case Ao:case Oo:r=Ga(e,t);break;default:c(e!=e)}return r}function f(e,t){return Kf(e,t)==Ko&&Ka(e,t)==Ao&&Qa(e,t)==0&&Ga(e,t)==1}function l(e,t,r,i){var s,o,f,l,h;h=0;for(o=1;o<=t;o++){s=r[o];if(i[o]>0){f=u(e,s);if(f==-n){h=-n;break}h+=i[o]*f}else if(i[o]<0){l=a(e,s);if(l==+n){h=-n;break}h+=i[o]*l}else c(i!=i)}return h}function p(e,t,r,i){var s,o,f,l,h;h=0;for(o=1;o<=t;o++){s=r[o];if(i[o]>0){l=a(e,s);if(l==+n){h=+n;break}h+=i[o]*l}else if(i[o]<0){f=u(e,s);if(f==-n){h=+n;break}h+=i[o]*f}else c(i!=i)}return h}function d(e,t,r,i,s,o,u,a,f){var l;return c(1<=u&&u<f&&f<=e),r!=-n&&a&&(r-=t[u]),i!=+n&&a&&(i-=t[u]),s!=-n&&(t[u]<0&&(s-=t[u]),t[f]<0&&(s-=t[f])),o!=+n&&(t[u]>0&&(o-=t[u]),t[f]>0&&(o-=t[f])),t[f]>0?r==-n||o==+n?l=-n:l=(r-o)/t[f]:i==+n||s==-n?l=-n:l=(i-s)/t[f],l>.001?2:(t[f]>0?i==+n||s==-n?l=+n:l=(i-s)/t[f]:r==-n||o==+n?l=+n:l=(r-o)/t[f],l<.999?1:0)}const t=4e3,r=500;var m=null,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_;h("Creating the conflict graph..."),g=Ra(e),y=Ua(e),b=0,C=new Array(1+y);for(E=1;E<=y;E++)C[E]=0;k=new Array(1+y),N=new Array(1+y),_=new Array(1+y);for(w=1;w<=g;w++){L=i(e,w),A=o(e,w);if(L==-n&&A==+n)continue;T=tf(e,w,N,_);if(T>r)continue;O=l(e,T,N,_),M=p(e,T,N,_);for(S=1;S<=T;S++){if(!f(e,N[S]))continue;for(x=S+1;x<=T;x++){if(!f(e,N[x]))continue;if(d(T,_,L,A,O,M,S,0,x)||d(T,_,L,A,O,M,S,1,x))E=N[S],C[E]==0&&(b++,C[E]=b,k[b]=E),E=N[x],C[E]==0&&(b++,C[E]=b,k[b]=E)}}}if(b==0||b>t)return h("The conflict graph is either empty or too big"),m;m={},m.n=y,m.nb=b,m.ne=0,m.vert=C,m.orig=k,T=b+b,T=T*(T-1)/2,T=(T+(s-1))/s,m.a=new Array(T),v(m.a,0,0,T);for(E=1;E<=b;E++)si(m,+k[E],-k[E]);for(w=1;w<=g;w++){L=i(e,w),A=o(e,w);if(L==-n&&A==+n)continue;T=tf(e,w,N,_);if(T>r)continue;O=l(e,T,N,_),M=p(e,T,N,_);for(S=1;S<=T;S++){if(!f(e,N[S]))continue;for(x=S+1;x<=T;x++){if(!f(e,N[x]))continue;switch(d(T,_,L,A,O,M,S,0,x)){case 0:break;case 1:si(m,-N[S],+N[x]);break;case 2:si(m,-N[S],-N[x]);break;default:c(e!=e)}switch(d(T,_,L,A,O,M,S,1,x)){case 0:break;case 1:si(m,+N[S],+N[x]);break;case 2:si(m,+N[S],-N[x]);break;default:c(e!=e)}}}}return h("The conflict graph has 2*"+m.nb+" vertices and "+m.ne+" edges"),m}function si(e,t,n){var r;c(t!=n),t>0?(c(1<=t&&t<=e.n),t=e.vert[t],c(t!=0)):(t=-t,c(1<=t&&t<=e.n),t=e.vert[t],c(t!=0),t+=e.nb),n>0?(c(1<=n&&n<=e.n),n=e.vert[n],c(n!=0)):(n=-n,c(1<=n&&n<=e.n),n=e.vert[n],c(n!=0),n+=e.nb),t<n&&(r=t,t=n,n=r),r=(t-1)*(t-2)/2+(n-1),e.a[r/s]|=1<<s-1-r%s,e.ne++}function oi(e,t,n,r){function i(e,t,n){return t==n?0:t>n?o(e,t,n):o(e,n,t)}function o(e,t,n){return u(e,t*(t-1)/2+n)}function u(e,t){return e.a[t/s]&1<<s-1-t%s}function a(e,t,n,r,s,o){var u,f,l,c,h,p,d,v;v=new Array(e.n);if(t<=0){t==0&&(e.set[r++]=n[0],s+=o);if(s>e.record){e.record=s,e.rec_level=r;for(u=0;u<r;u++)e.rec[u+1]=e.set[u]}return}for(u=t;u>=0;u--){if(r==0&&u<t)return;l=n[u];if(r>0&&e.clique[l]<=e.record-s)return;e.set[r]=l,c=s+e.wt[l+1],o-=e.wt[l+1];if(o<=e.record-c)return;p=0,d=0,h=0;while(d<n+u)f=n[d],d++,i(e,f,l)&&(v[p]=f,p++,h+=e.wt[f+1]);if(h<=e.record-c)continue;a(e,p-1,v,r+1,c,h)}}function f(e,t,n,r){var s={},o,u,f,l,c,p,d,v,m,b;s.n=e,s.wt=t,s.a=n,s.record=0,s.rec_level=0,s.rec=r,s.clique=new Array(s.n),s.set=new Array(s.n),d=new Array(s.n),v=new Array(s.n),m=new Array(s.n),b=g();for(o=0;o<s.n;o++){v[o]=0;for(u=0;u<s.n;u++)i(s,o,u)&&(v[o]+=s.wt[u+1])}for(o=0;o<s.n;o++)d[o]=0;for(o=s.n-1;o>=0;o--){l=-1,c=-1;for(u=0;u<s.n;u++)!d[u]&&(s.wt[u+1]>l||s.wt[u+1]==l&&v[u]>c)&&(l=s.wt[u+1],c=v[u],f=u);m[o]=f,d[f]=1;for(u=0;u<s.n;u++)!d[u]&&u!=f&&i(s,f,u)&&(v[u]-=s.wt[f+1])}p=0;for(o=0;o<s.n;o++)p+=s.wt[m[o]+1],a(s,o,m,0,0,p),s.clique[m[o]]=s.record,y(g(),b)>=4.999&&(h("level = "+o+1+" ("+s.n+"); best = "+s.record+""),b=g());for(o=1;o<=s.rec_level;o++)r[o]++;return s.rec_level}var l=Ua(e),p,d,v,m,b,w=0,E,S,x,T,N,C;E=new Array(1+2*t.nb),S=new Array(1+2*t.nb),C=new Array(1+l);for(d=1;d<=t.nb;d++)p=t.orig[d],x=kf(e,p),b=100*x+.5,b<0&&(b=0),b>100&&(b=100),E[d]=b,E[t.nb+d]=100-b;m=f(2*t.nb,E,t.a,S),T=0;for(d=1;d<=m;d++)v=S[d],c(1<=v&&v<=2*t.nb),v<=t.nb?(p=t.orig[v],x=kf(e,p),T+=x):(p=t.orig[v-t.nb],x=kf(e,p),T+=1-x);if(T>=1.01){for(p=1;p<=l;p++)C[p]=0;N=1;for(d=1;d<=m;d++)v=S[d],v<=t.nb?(p=t.orig[v],c(1<=p&&p<=l),C[p]+=1):(p=t.orig[v-t.nb],c(1<=p&&p<=l),C[p]-=1,N-=1);c(w==0);for(p=1;p<=l;p++)C[p]!=0&&(w++,n[w]=p,r[w]=C[p]);n[0]=0,r[0]=N}return w}function ui(e){var t=e.mip;return c(t!=null),ii(t)}function ai(e,t){var n=Ua(e.mip),r,i,s;c(t!=null),i=new Array(1+n),s=new Array(1+n),r=oi(e.mip,t,i,s),r>0&&Hn(e,null,Hs,0,r,i,s,Oi,s[0])}function fi(e,t){var n;return e.parm.br_tech==gs?n=li(e,t):e.parm.br_tech==ys?n=ci(e,t):e.parm.br_tech==bs?n=hi(e,t):e.parm.br_tech==ws?n=pi(e,t):e.parm.br_tech==Es?n=gi(e,t):c(e!=e),n}function li(e,t){var n,r,i;for(n=1;n<=e.n;n++)if(e.non_int[n])break;return c(1<=n&&n<=e.n),i=It(e.mip,n),i-Math.floor(i)<Math.ceil(i)-i?r=Vs:r=$s,t(r),n}function ci(e,t){var n,r,i;for(n=e.n;n>=1;n--)if(e.non_int[n])break;return c(1<=n&&n<=e.n),i=It(e.mip,n),i-Math.floor(i)<Math.ceil(i)-i?r=Vs:r=$s,t(r),n}function hi(e,t){var r,i,s,o,u,a;i=0,u=n;for(r=1;r<=e.n;r++)e.non_int[r]&&(o=It(e.mip,r),a=Math.floor(o)+.5,u>Math.abs(o-a)&&(i=r,u=Math.abs(o-a),o<a?s=Vs:s=$s));return t(s),i}function pi(e,t){var r=e.mip,i=r.m,s=r.n,o=e.non_int,u,a,f,l,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A;c(Mt(r)==Qi),g=new Array(1+s),A=new Array(1+s),a=0,L=-1;for(u=1;u<=s;u++){if(!o[u])continue;y=It(r,u),v=hn(r,i+u,g,A);for(d=-1;d<=1;d+=2){f=gn(r,v,g,A,d,1e-9),f!=0&&(f=g[f]);if(f==0)x=e.mip.dir==xi?+n:-n;else{for(l=1;l<=v;l++)if(g[l]==f)break;c(1<=l&&l<=v),w=A[l],E=(d<0?Math.floor(y):Math.ceil(y))-y,S=E/w,f>i&&zt(r,f-i)!=Ni&&Math.abs(S-Math.floor(S+.5))>.001&&(S>0?S=Math.ceil(S):S=Math.floor(S)),f<=i?(m=Ht(r,f),b=jt(r,f)):(m=Ft(r,f-i),b=qt(r,f-i));switch(e.mip.dir){case xi:if(m==Pi&&b<0||m==Hi&&b>0||m==Bi)b=0;break;case Ti:if(m==Pi&&b>0||m==Hi&&b<0||m==Bi)b=0;break;default:c(e!=e)}x=b*S}switch(e.mip.dir){case xi:c(x>=0);break;case Ti:c(x<=0);break;default:c(e!=e)}d<0?T=x:N=x}if(L<Math.abs(T)||L<Math.abs(N)){a=u,Math.abs(T)<Math.abs(N)?(p=Vs,L=Math.abs(N)):(p=$s,L=Math.abs(T)),C=T,k=N;if(L==n)break}}return c(1<=a&&a<=s),L<1e-6*(1+.001*Math.abs(r.obj_val))?(a=hi(e,t),a):(e.parm.msg_lev>=ss&&(h("branch_drtom: column "+a+" chosen to branch on"),Math.abs(C)==n?h("branch_drtom: down-branch is infeasible"):h("branch_drtom: down-branch bound is "+(Ef(r)+C)+""),Math.abs(k)==n?h("branch_drtom: up-branch   is infeasible"):h("branch_drtom: up-branch   bound is "+(Ef(r)+k)+"")),t(p),a)}function di(e){var t=e.n,n,r={};r.dn_cnt=new Array(1+t),r.dn_sum=new Array(1+t),r.up_cnt=new Array(1+t),r.up_sum=new Array(1+t);for(n=1;n<=t;n++)r.dn_cnt[n]=r.up_cnt[n]=0,r.dn_sum[n]=r.up_sum[n]=0;return r}function vi(e){var t,n,r,i,s=e.pcost;c(s!=null),c(e.curr!=null);if(e.curr.up==null)return;t=e.curr.up.br_var,c(1<=t&&t<=e.n),n=e.mip.col[t].prim-e.curr.up.br_val,c(n!=0),r=e.mip.obj_val-e.curr.up.lp_obj,i=Math.abs(r/n),n<0?(s.dn_cnt[t]++,s.dn_sum[t]+=i):(s.up_cnt[t]++,s.up_sum[t]+=i)}function mi(e){var t=e.pcost;c(t!=null),e.pcost=null}function gi(e,t){function r(e,t,r){var i,s={},o,u;return c(Mt(e)==Qi),i=_(),Q(i,e,0),R(i,t,_i,r,r),Ot(s),s.msg_lev=ts,s.meth=as,s.it_lim=30,s.out_dly=1e3,s.meth=as,o=At(i,s),o==0||o==to?_t(i)==Ki?u=n:Dt(i)==$i?(e.dir==xi?u=i.obj_val-e.obj_val:e.dir==Ti?u=e.obj_val-i.obj_val:c(e!=e),u<1e-6*(1+.001*Math.abs(e.obj_val))&&(u=0)):u=0:u=0,Z(i),u}function i(e,t,i){var s=e.pcost,o,u,a;c(s!=null),c(1<=t&&t<=e.n);if(i==Vs){if(s.dn_cnt[t]==0){o=e.mip.col[t].prim,u=r(e.mip,t,Math.floor(o));if(u==n)return a=n,a;s.dn_cnt[t]=1,s.dn_sum[t]=u/(o-Math.floor(o))}a=s.dn_sum[t]/s.dn_cnt[t]}else if(i==$s){if(s.up_cnt[t]==0){o=e.mip.col[t].prim,u=r(e.mip,t,Math.ceil(o));if(u==n)return a=n,a;s.up_cnt[t]=1,s.up_sum[t]=u/(Math.ceil(o)-o)}a=s.up_sum[t]/s.up_cnt[t]}else c(i!=i);return a}function s(e){var t=e.pcost,n,r=0,i=0;for(n=1;n<=e.n;n++)Fn(e,n)&&(r++,t.dn_cnt[n]>0&&t.up_cnt[n]>0&&i++);h("Pseudocosts initialized for "+i+" of "+r+" variables")}var o=g(),u,a,f,l,p,d,v,m,b;e.pcost==null&&(e.pcost=di(e)),a=0,b=-1;for(u=1;u<=e.n;u++){if(!Fn(e,u))continue;l=e.mip.col[u].prim,p=i(e,u,Vs);if(p==n)return a=u,f=Vs,t(f),a;d=p*(l-Math.floor(l)),p=i(e,u,$s);if(p==n)return a=u,f=$s,t(f),a;v=p*(Math.ceil(l)-l),m=d>v?d:v,b<m&&(b=m,a=u,f=d<=v?Vs:$s),e.parm.msg_lev>=Bs&&y(g(),o)>=10&&(s(e),o=g())}return b==0?(a=hi(e,t),a):(t(f),a)}function yi(e){var t=e.mip,i=t.n,s=null,o=null,u=null,a,f={},l,p,d,v,w,E,S,x,T,N;const C=0,k=1,L=2,A=3,O=4,M=5;var D=C;for(;;){var P=null;switch(D){case C:c(Mt(t)==Qi);if(e.curr.level!=0||e.curr.solved!=1){P=M;break}E=0;for(l=1;l<=i;l++){a=t.col[l];if(a.kind==Ni)continue;if(a.type==_i)continue;c(a.kind==Ci);if(a.type!=Mi||a.lb!=0||a.ub!=1){e.parm.msg_lev>=is&&h("FPUMP heuristic cannot be applied due to general integer variables"),P=M;break}E++}if(P!=null)break;if(E==0){P=M;break}e.parm.msg_lev>=is&&h("Applying FPUMP heuristic..."),o=new Array(1+E),m(o,1,E),p=0;for(l=1;l<=i;l++)a=t.col[l],a.kind==Ci&&a.type==Mi&&(o[++p].j=l);c(p==E),s=_();case k:Q(s,t,js);if(t.mip_stat==$i){var H,j,F;B(s,1),H=new Array(1+i),j=new Array(1+i);for(l=1;l<=i;l++)H[l]=l,j[l]=t.col[l].coef;z(s,s.m,i,H,j),F=.1*t.obj_val+.9*t.mip_obj,t.dir==xi?q(s,s.m,Oi,0,F-t.c0):t.dir==Ti?q(s,s.m,Ai,F-t.c0,0):c(t!=t)}w=0;for(p=1;p<=E;p++)o[p].x=-1;case L:w++,e.parm.msg_lev>=is&&h("Pass "+w+""),T=n,v=0;if(w>1){var I,R;u==null&&(u=oh());for(p=1;p<=E;p++)l=o[p].j,a=s.col[l],I=ch(u,-0.3,.7),I<0&&(I=0),R=Math.abs(o[p].x-a.prim),R+I>.5&&(o[p].x=1-o[p].x);P=O;break};case A:x=1;for(p=1;p<=E;p++)a=s.col[o[p].j],a.prim<.5?d=0:d=1,o[p].x!=d&&(x=0,o[p].x=d);if(x){for(p=1;p<=E;p++)a=s.col[o[p].j],o[p].d=Math.abs(a.prim-o[p].x);b(o,1,E,function(e,t){return e.d>t.d?-1:e.d<t.d?1:0});for(p=1;p<=E;p++){if(p>=5&&o[p].d<.35||p>=10)break;o[p].x=1-o[p].x}};case O:if(e.parm.tm_lim<r&&e.parm.tm_lim-1<=1e3*y(g(),e.tm_beg)){P=M;break}s.dir=xi,s.c0=0;for(l=1;l<=i;l++)s.col[l].coef=0;for(p=1;p<=E;p++)l=o[p].j,o[p].x==0?s.col[l].coef=1:(s.col[l].coef=-1,s.c0+=1);Ot(f),e.parm.msg_lev<=ns?f.msg_lev=e.parm.msg_lev:e.parm.msg_lev<=is&&(f.msg_lev=rs,f.out_dly=1e4),S=At(s,f);if(S!=0){e.parm.msg_lev>=ns&&h("Warning: glp_simplex returned "+S+""),P=M;break}S=Mt(s);if(S!=Qi){e.parm.msg_lev>=ns&&h("Warning: glp_get_status returned "+S+""),P=M;break}e.parm.msg_lev>=ss&&h("delta = "+s.obj_val+""),N=.3*e.parm.tol_int;for(p=1;p<=E;p++){a=s.col[o[p].j];if(N<a.prim&&a.prim<1-N)break}if(p>E){var U=new Array(1+i);for(l=1;l<=i;l++)U[l]=s.col[l].prim,t.col[l].kind==Ci&&(U[l]=Math.floor(U[l]+.5));s.c0=t.c0,s.dir=t.dir;for(p=1;p<=E;p++)s.col[o[p].j].lb=U[o[p].j],s.col[o[p].j].ub=U[o[p].j],s.col[o[p].j].type=_i;for(l=1;l<=i;l++)s.col[l].coef=t.col[l].coef;S=At(s,f);if(S!=0){e.parm.msg_lev>=ns&&h("Warning: glp_simplex returned "+S+""),P=M;break}S=Mt(s);if(S!=Qi){e.parm.msg_lev>=ns&&h("Warning: glp_get_status returned "+S+""),P=M;break}for(l=1;l<=i;l++)t.col[l].kind!=Ci&&(U[l]=s.col[l].prim);S=Rn(e,U);if(S==0){if(Or(e,e.curr.bound)){P=k;break}P=M;break}}T==n||s.obj_val<=T-1e-6*(1+T)?(v=0,T=s.obj_val):v++;if(v<3){P=A;break}if(w<5){P=L;break};case M:s!=null&&Z(s)}if(P==null)break;D=P}}function bi(e){function t(e,t,n){var r,s=0,o=0,u=0,a;for(r=e.ptr;r!=null;r=r.next)n[r.j]=r.val,o+=r.val*r.val;for(r=t.ptr;r!=null;r=r.next)s+=n[r.j]*r.val,u+=r.val*r.val;for(r=e.ptr;r!=null;r=r.next)n[r.j]=0;return a=Math.sqrt(o)*Math.sqrt(u),a<i*i&&(a=i),s/a}var r,s,o,u,a,f,l,h,p,d,v,m;c(e.curr!=null),r=e.local,c(r!=null),c(r.size>0),u=new Array(1+r.size),d=new Array(1+e.n),v=new Array(1+e.n),m=new Array(1+e.n);for(a=1;a<=e.n;a++)m[a]=0;for(a=0,s=r.head;s!=null;s=s.next)a++,u[a].cut=s,u[a].flag=0;c(a==r.size);for(a=1;a<=r.size;a++){var g,y=null,w=null;s=u[a].cut,h=0,g=0;for(o=s.ptr;o!=null;o=o.next)c(1<=o.j&&o.j<=e.n),h++,d[h]=o.j,v[h]=o.val,g+=o.val*o.val;g<i*i&&(g=i),h=dn(e.mip,h,d,v),p=yn(e.mip,h,d,v,s.type,s.rhs,1e-9,function(e,t,n,r,i,s){y=i,w=s}),p==0?(u[a].eff=Math.abs(y)/Math.sqrt(g),e.mip.dir==xi?(w<0&&(w=0),u[a].deg=+w):(w>0&&(w=0),u[a].deg=-w)):p==1?u[a].eff=u[a].deg=0:p==2?(u[a].eff=1,u[a].deg=n):c(p!=p),u[a].deg<.01&&(u[a].deg=0)}b(u,1,r.size,function(e,t){if(e.deg==0&&t.deg==0){if(e.eff>t.eff)return-1;if(e.eff<t.eff)return 1}else{if(e.deg>t.deg)return-1;if(e.deg<t.deg)return 1}return 0}),l=e.curr.level==0?90:10,l>r.size&&(l=r.size);for(a=1;a<=l;a++){var E;if(u[a].deg<.01&&u[a].eff<.01)continue;for(f=1;f<a;f++)if(u[f].flag&&t(u[a].cut,u[f].cut,m)>.9)break;if(f<a)continue;s=u[a].cut,u[a].flag=1,E=B(e.mip,1),s.name!=null&&F(e.mip,E,s.name),c(e.mip.row[E].origin==Ms),e.mip.row[E].klass=s.klass,h=0;for(o=s.ptr;o!=null;o=o.next)h++,d[h]=o.j,v[h]=o.val;z(e.mip,E,h,d,v),c(s.type==Ai||s.type==Oi),q(e.mip,E,s.type,s.rhs,s.rhs)}}function wi(e){function t(e){var t,r,i;r=0,i=n;for(t=e.head;t!=null;t=t.next)c(t.up!=null),i>t.up.ii_sum&&(r=t.p,i=t.up.ii_sum);return r}function r(e){var t,r,i,s,o,u;c(e.mip.mip_stat==$i),t=e.slot[1].node,c(t!=null),c(t.ii_sum>0),o=(e.mip.mip_obj-t.bound)/t.ii_sum,i=0,s=n;for(r=e.head;r!=null;r=r.next)c(r.up!=null),u=r.up.bound+o*r.up.ii_sum,e.mip.dir==Ti&&(u=-u),s>u&&(i=r.p,s=u);return i}function i(e){var t,r=null,i,s;switch(e.mip.dir){case xi:i=+n;for(t=e.head;t!=null;t=t.next)i>t.bound&&(i=t.bound);c(i!=+n),s=.001*(1+Math.abs(i));for(t=e.head;t!=null;t=t.next)if(t.bound<=i+s){c(t.up!=null);if(r==null||r.up.ii_sum>t.up.ii_sum)r=t}break;case Ti:i=-n;for(t=e.head;t!=null;t=t.next)i<t.bound&&(i=t.bound);c(i!=-n),s=.001*(1+Math.abs(i));for(t=e.head;t!=null;t=t.next)if(t.bound>=i-s){c(t.up!=null);if(r==null||r.lp_obj<t.lp_obj)r=t}break;default:c(e!=e)}return c(r!=null),r.p}var s;return e.parm.bt_tech==Ss?(c(e.tail!=null),s=e.tail.p):e.parm.bt_tech==xs?(c(e.head!=null),s=e.head.p):e.parm.bt_tech==Ts?s=i(e):e.parm.bt_tech==Ns?e.mip.mip_stat==Vi?s=t(e):s=r(e):c(e!=e),s}function sa(e,t){var n;c(e>0&&t>0);while(t>0)n=e%t,e=t,t=n;return e}function oa(e,t){var n=0,r;c(e>0);for(r=1;r<=e;r++){c(t[r]>0),r==1?n=t[1]:n=sa(n,t[r]);if(n==1)break}return n}function ua(e){c(e>0);var t=Math.floor(Math.log(e)/Math.log(2))+1,n=e/Math.pow(2,t);return Math.pow(2,n<=.75?t-1:t)}function la(){var e;return fa&&h("lpf_create_it: warning: debug mode enabled"),e={},e.valid=0,e.m0_max=e.m0=0,e.luf=Ml(),e.m=0,e.B=null,e.n_max=50,e.n=0,e.R_ptr=e.R_len=null,e.S_ptr=e.S_len=null,e.scf=null,e.P_row=e.P_col=null,e.Q_row=e.Q_col=null,e.v_size=1e3,e.v_ptr=0,e.v_ind=null,e.v_val=null,e.work1=e.work2=null,e}function ca(e,t,n,r,i){var s,u;if(fa)var a,f,h,p,d,v;c(n==n),t<1&&l("lpf_factorize: m = "+t+"; invalid parameter"),t>o&&l("lpf_factorize: m = "+t+"; matrix too big"),e.m0=e.m=t,e.valid=0,e.R_ptr==null&&(e.R_ptr=new Array(1+e.n_max)),e.R_len==null&&(e.R_len=new Array(1+e.n_max)),e.S_ptr==null&&(e.S_ptr=new Array(1+e.n_max)),e.S_len==null&&(e.S_len=new Array(1+e.n_max)),e.scf==null&&(e.scf=yh(e.n_max)),e.v_ind==null&&(e.v_ind=new Array(1+e.v_size)),e.v_val==null&&(e.v_val=new Array(1+e.v_size)),e.m0_max<t&&(e.m0_max=t+100,e.P_row=new Array(1+e.m0_max+e.n_max),e.P_col=new Array(1+e.m0_max+e.n_max),e.Q_row=new Array(1+e.m0_max+e.n_max),e.Q_col=new Array(1+e.m0_max+e.n_max),e.work1=new Array(1+e.m0_max+e.n_max),e.work2=new Array(1+e.m0_max+e.n_max));switch(Rl(e.luf,t,r,i)){case 0:break;case Al:return u=aa,u;case Ol:return u=LPF_ECOND,u;default:c(e!=e)}e.valid=1;if(fa){c(t<=32767),e.B=d=new Array(1+t*t),p=new Array(1+t),v=new Array(1+t);for(s=1;s<=t*t;s++)d[s]=0;for(f=1;f<=t;f++){h=r(i,f,p,v),c(0<=h&&h<=t);for(s=1;s<=h;s++)a=p[s],c(1<=a&&a<=t),c(d[(a-1)*t+f]==0),c(v[s]!=0),d[(a-1)*t+f]=v[s]}}e.n=0,Oh(e.scf);for(s=1;s<=t;s++)e.P_row[s]=e.P_col[s]=s,e.Q_row[s]=e.Q_col[s]=s;return e.v_ptr=1,u=0,u}function ha(e,t,n,r,i){var s=e.n,o=e.R_ptr,u=e.R_len,a=e.v_ind,f=e.v_val,l,c,h,p,d;for(l=1;l<=s;l++){if(r[l+i]==0)continue;d=n*r[l+i],c=o[l],h=c+u[l];for(p=c;p<h;p++)t[a[p]]+=d*f[p]}}function pa(e,t,n,r,i){var s=e.n,o=e.R_ptr,u=e.R_len,a=e.v_ind,f=e.v_val,l,c,h,p,d;for(l=1;l<=s;l++){d=0,c=o[l],h=c+u[l];for(p=c;p<h;p++)d+=f[p]*i[a[p]];t[l+n]+=r*d}}function da(e,t,n,r,i){var s=e.n,o=e.S_ptr,u=e.S_len,a=e.v_ind,f=e.v_val,l,c,h,p,d;for(l=1;l<=s;l++){d=0,c=o[l],h=c+u[l];for(p=c;p<h;p++)d+=f[p]*i[a[p]];t[l+n]+=r*d}}function va(e,t,n,r,i){var s=e.n,o=e.S_ptr,u=e.S_len,a=e.v_ind,f=e.v_val,l,c,h,p,d;for(l=1;l<=s;l++){if(r[l+i]==0)continue;d=n*r[l+i],c=o[l],h=c+u[l];for(p=c;p<h;p++)t[a[p]]+=d*f[p]}}function ga(e,t){var n=e.m0,r=e.m,i=e.n,s=e.P_col,o=e.Q_col,u=e.work1,a=u,f=u,h,p;if(fa)var d;e.valid||l("lpf_ftran: the factorization is not valid"),c(0<=r&&r<=n+i);if(fa){d=new Array(1+r);for(h=1;h<=r;h++)d[h]=t[h]}for(h=1;h<=n+i;h++)u[h]=(p=s[h])<=r?t[p]:0;Ul(e.luf,0,a),da(e,f,n,-1,a),Ah(e.scf,0,f,n),ha(e,a,-1,f,n),zl(e.luf,0,a);for(h=1;h<=r;h++)t[h]=u[o[h]];fa&&ma(e,0,t,d)}function ya(e,t){var n=e.m0,r=e.m,i=e.n,s=e.P_row,o=e.Q_row,u=e.work1,a=u,f=u,h,p;if(fa)var d;e.valid||l("lpf_btran: the factorization is not valid"),c(0<=r&&r<=n+i);if(fa){d=new Array(1+r);for(h=1;h<=r;h++)d[h]=t[h]}for(h=1;h<=n+i;h++)u[h]=(p=o[h])<=r?t[p]:0;zl(e.luf,1,a),pa(e,f,n,-1,a),Ah(e.scf,1,f,n),va(e,a,-1,f,n),Ul(e.luf,1,a);for(h=1;h<=r;h++)t[h]=u[s[h]];fa&&ma(e,1,t,d)}function ba(e,t){var n=e.v_size,r=e.v_ptr-1,i=e.v_ind,s=e.v_val;c(n<t);while(n<t)n+=n;e.v_size=n,e.v_ind=new Array(1+n),e.v_val=new Array(1+n),c(r>=0),d(e.v_ind,1,i,1,r),d(e.v_val,1,s,1,r)}function wa(e,t,n,r,i,s,o){var u=e.m0,a=e.m;if(fa)var f=e.B;var h=e.n,p=e.R_ptr,d=e.R_len,v=e.S_ptr,m=e.S_len,g=e.P_row,y=e.P_col,b=e.Q_row,w=e.Q_col,E=e.v_ptr,S=e.v_ind,x=e.v_val,T=e.work2,N=e.work1,C=N,k=N,L=e.work2,A=L,O=L,M=k,_=O,D,P,H,B,j;c(n==n),e.valid||l("lpf_update_it: the factorization is not valid"),1<=t&&t<=a||l("lpf_update_it: j = "+t+"; column number out of range"),c(0<=a&&a<=u+h);if(h==e.n_max)return e.valid=0,j=LPF_ELIMIT,j;for(P=1;P<=a;P++)T[P]=0;for(B=1;B<=r;B++)P=i[s+B],1<=P&&P<=a||l("lpf_update_it: ind["+B+"] = "+P+"; row number out of range"),T[P]!=0&&l("lpf_update_it: ind["+B+"] = "+P+"; duplicate row index not allowed"),o[B]==0&&l("lpf_update_it: val["+B+"] = "+o[B]+"; zero element not allowed"),T[P]=o[B];if(fa)for(P=1;P<=a;P++)f[(P-1)*a+t]=T[P];for(P=1;P<=u+h;P++)N[P]=(H=y[P])<=a?T[H]:0;for(P=1;P<=u+h;P++)L[P]=0;L[w[t]]=1,Ul(e.luf,0,C),zl(e.luf,1,A),e.v_size<E+u+u&&(ba(e,E+u+u),S=e.v_ind,x=e.v_val),p[h+1]=E;for(P=1;P<=u;P++)C[P]!=0&&(S[E]=P,x[E]=C[P],E++);d[h+1]=E-e.v_ptr,e.v_ptr=E,v[h+1]=E;for(P=1;P<=u;P++)A[P]!=0&&(S[E]=P,x[E]=A[P],E++);m[h+1]=E-e.v_ptr,e.v_ptr=E,da(e,M,0,-1,C),pa(e,_,0,-1,A),D=0;for(P=1;P<=u;P++)D-=A[P]*C[P];switch(Ch(e.scf,M,u,_,u,D)){case 0:break;case dh:return e.valid=0,j=aa,j;case vh:c(e!=e);default:c(e!=e)}return g[u+h+1]=y[u+h+1]=u+h+1,b[u+h+1]=w[u+h+1]=u+h+1,P=w[t],H=w[u+h+1],b[P]=u+h+1,w[u+h+1]=P,b[H]=t,w[t]=H,e.n++,c(e.n<=e.n_max),j=0,j}function Ea(){return _()}function Sa(e,t){D(e,t)}function xa(e,t){P(e,t)}function Ta(e,t){H(e,t-Mo+xi)}function Na(e,t){return B(e,t)}function Ca(e,t){return j(e,t)}function ka(e,t,n){F(e,t,n)}function La(e,t,n){I(e,t,n)}function Aa(e,t,n,r,i){q(e,t,n-Co+Li,r,i)}function Oa(e,t,n,r,i){R(e,t,n-Co+Li,r,i)}function Ma(e,t,n){U(e,t,n)}function _a(e,t,n,r,i){z(e,t,n,r,i)}function Da(e,t,n,r,i){W(e,t,n,r,i)}function Pa(e,t,n,r,i){X(e,t,n,r,i)}function Ha(e,t,n){J(e,t,n)}function Ba(e,t,n){K(e,t,n)}function ja(e){Z(e)}function Fa(e){return et(e)}function Ia(e){return tt(e)}function qa(e){return nt(e)-xi+Mo}function Ra(e){return rt(e)}function Ua(e){return it(e)}function za(e,t){return st(e,t)}function Wa(e,t){return ot(e,t)}function Xa(e,t){return ut(e,t)-Li+Co}function Va(e,t){var r=at(e,t);return r==-n&&(r=0),r}function $a(e,t){var r=ft(e,t);return r==+n&&(r=0),r}function Ja(e,t,n){n(Xa(e,t),Va(e,t),$a(e,t))}function Ka(e,t){return lt(e,t)-Li+Co}function Qa(e,t){var r=ct(e,t);return r==-n&&(r=0),r}function Ga(e,t){var r=ht(e,t);return r==+n&&(r=0),r}function Ya(e,t,n){n(Ka(e,t),Qa(e,t),Ga(e,t))}function Za(e,t){return pt(e,t)}function ef(e){return dt(e)}function tf(e,t,n,r){return vt(e,t,n,r)}function nf(e,t,n,r){return mt(e,t,n,r)}function rf(e){gt(e)}function sf(e,t){return yt(e,t)}function of(e,t){return bt(e,t)}function uf(e){wt(e)}function af(e){switch(ll(e,xu)){case 0:Nt(e);break;case 1:Mh(e,Ii);break;case 2:Mh(e,Fi);break;case 3:Mh(e,Fi|Ii);break;default:c(e!=e)}}function ff(e){Nt(e)}function lf(e,t,n){Ct(e,t,n-Ro+Di)}function cf(e,t,n){kt(e,t,n-Ro+Di)}function hf(e){Lt(e)}function pf(e){gr(e,0)}function df(e){br(e)}function vf(e,t){Ot(t);switch(ll(e,Su)){case 0:t.msg_lev=ts;break;case 1:t.msg_lev=ns;break;case 2:t.msg_lev=rs;break;case 3:t.msg_lev=is;break;default:c(e!=e)}switch(ll(e,Tu)){case 0:t.meth=os;break;case 1:t.meth=as;break;default:c(e!=e)}switch(ll(e,Nu)){case 0:t.pricing=fs;break;case 1:t.pricing=ls;break;default:c(e!=e)}hl(e,Cu)==0?t.r_test=cs:t.r_test=hs,t.tol_bnd=hl(e,ku),t.tol_dj=hl(e,Lu),t.tol_piv=hl(e,Au),t.obj_ll=hl(e,Mu),t.obj_ul=hl(e,_u),ll(e,Du)<0?t.it_lim=r:t.it_lim=ll(e,Du),hl(e,Hu)<0?t.tm_lim=r:t.tm_lim=1e3*hl(e,Hu),t.out_frq=ll(e,Bu),t.out_dly=1e3*hl(e,ju);switch(ll(e,Ku)){case 0:t.presolve=js;break;case 1:t.presolve=Bs;break;default:c(e!=e)}}function mf(e){var t={},n;vf(e,t),n=At(e,t);switch(n){case 0:n=ou;break;case Js:case Ks:case Qs:case Gs:n=lu;break;case Ys:n=gu;break;case Zs:n=cu;break;case eo:n=hu;break;case to:n=pu;break;case no:n=du;break;case ro:n=bu;break;case io:n=wu;break;default:c(n!=n)}return n}function gf(e){var t={},n;vf(e,t),n=glp_exact(e,t);switch(n){case 0:n=ou;break;case Js:case Ks:case Gs:case Ys:n=lu;break;case to:n=pu;break;case no:n=du;break;default:c(n!=n)}return n}function yf(e){var t;switch(Mt(e)){case Qi:t=eu;break;case $i:t=tu;break;case Ji:t=nu;break;case Ki:t=ru;break;case Gi:t=iu;break;case Vi:t=su;break;default:c(e!=e)}return t}function bf(e){return _t(e)-Vi+Do}function wf(e){return Dt(e)-Vi+jo}function Ef(e){return Pt(e)}function Sf(e,t){return Ht(e,t)-Di+Ro}function xf(e,t){return Bt(e,t)}function Tf(e,t){return jt(e,t)}function Nf(e,t,n){n(Sf(e,t),xf(e,t),Tf(e,t))}function Cf(e,t){return Ft(e,t)-Di+Ro}function kf(e,t){return It(e,t)}function Lf(e,t){return qt(e,t)}function Af(e,t,n){n(Cf(e,t),kf(e,t),Lf(e,t))}function Of(e){return Rt(e)}function Mf(e,t,n){c(t==t),Yt(e,zi,po,function(e,t,r,i){n.pe_ae_max=e,n.pe_ae_row=t,n.pe_re_max=r,n.pe_re_row=i,r<=1e-9?n.pe_quality="H":r<=1e-6?n.pe_quality="M":r<=.001?n.pe_quality="L":n.pe_quality="?"}),Yt(e,zi,vo,function(e,t,r,i){n.pb_ae_max=e,n.pb_ae_ind=t,n.pb_re_max=r,n.pb_re_ind=i,r<=1e-9?n.pb_quality="H":r<=1e-6?n.pb_quality="M":r<=.001?n.pb_quality="L":n.pb_quality="?"}),Yt(e,zi,mo,function(t,r,i,s){n.de_ae_max=t,r==0?n.de_ae_col=0:n.de_ae_col=r-e.m,n.de_re_max=i,s==0?n.de_re_col=0:n.de_re_col=r-e.m,i<=1e-9?n.de_quality="H":i<=1e-6?n.de_quality="M":i<=.001?n.de_quality="L":n.de_quality="?"}),Yt(e,zi,go,function(e,t,r,i){n.db_ae_max=e,n.db_ae_ind=t,n.db_re_max=r,n.db_re_ind=i,r<=1e-9?n.db_quality="H":r<=1e-6?n.db_quality="M":r<=.001?n.db_quality="L":n.db_quality="?",n.cs_ae_max=0,n.cs_ae_ind=0,n.cs_re_max=0,n.cs_re_ind=0,n.cs_quality="H"})}function _f(e){var t=cn(e);return t==0?t=ou:t==Js?t=au:t==Ks?t=gu:t==Qs?t=gu:c(t!=t),t}function Df(e,t,n,r){return hn(e,t,n,r)}function Pf(e,t,n,r){return pn(e,t,n,r)}function Hf(e,t,n,r){return dn(e,t,n,r)}function Bf(e,t,n,r){return vn(e,t,n,r)}function jf(e,t,n,r,i,s){var o=mn(e,t,n,r,i,s);return c(0<=o&&o<=t),o==0?0:n[o]}function Ff(e,t,n,r,i,s){var o=gn(e,t,n,r,i,s);return c(0<=o&&o<=t),o==0?0:n[o]}function If(e){var t=glp_interior(e,null);switch(t){case 0:t=ou;break;case Ys:t=lu;break;case ao:t=vu;break;case fo:t=yu;break;case to:t=pu;break;case lo:t=mu;break;default:c(t!=t)}return t}function qf(e){var t;switch(glp_ipt_status(e)){case Vi:t=Vo;break;case Qi:t=$o;break;default:c(e!=e)}return t}function Rf(e){return glp_ipt_obj_val(e)}function Uf(e,t){return glp_ipt_row_prim(e,t)}function zf(e,t){return glp_ipt_row_dual(e,t)}function Wf(e,t){return glp_ipt_col_prim(e,t)}function Xf(e,t){return glp_ipt_col_dual(e,t)}function Vf(e,t){c(e==e),t!=To&&t!=No&&l("lpx_set_class: invalid problem class")}function $f(e){return Wt(e)==0?To:No}function Jf(e,t,n){Ut(e,t,n-Jo+Ni)}function Kf(e,t){return zt(e,t)==Ni?Jo:Ko}function Qf(e){return Wt(e)}function Gf(e){return Xt(e)}function Yf(e,t){var n={},i;$t(n);switch(ll(e,Su)){case 0:n.msg_lev=ts;break;case 1:n.msg_lev=ns;break;case 2:n.msg_lev=rs;break;case 3:n.msg_lev=is;break;default:c(e!=e)}switch(ll(e,Fu)){case 0:n.br_tech=gs;break;case 1:n.br_tech=ys;break;case 2:n.br_tech=ws;break;case 3:n.br_tech=bs;break;default:c(e!=e)}switch(ll(e,Iu)){case 0:n.bt_tech=Ss;break;case 1:n.bt_tech=xs;break;case 2:n.bt_tech=Ns;break;case 3:n.bt_tech=Ts;break;default:c(e!=e)}n.tol_int=hl(e,qu),n.tol_obj=hl(e,Ru),hl(e,Hu)<0||hl(e,Hu)>1e6?n.tm_lim=r:n.tm_lim=1e3*hl(e,Hu),n.mip_gap=hl(e,Zu),ll(e,Gu)&na?n.gmi_cuts=Bs:n.gmi_cuts=js,ll(e,Gu)&ra?n.mir_cuts=Bs:n.mir_cuts=js,ll(e,Gu)&ea?n.cov_cuts=Bs:n.cov_cuts=js,ll(e,Gu)&ta?n.clq_cuts=Bs:n.clq_cuts=js,n.presolve=t,ll(e,Qu)&&(n.binarize=Bs),i=Vt(e,n);switch(i){case 0:i=ou;break;case ro:i=bu;break;case io:i=wu;break;case Gs:case so:i=lu;break;case Ys:i=gu;break;case uo:i=Eu;break;case no:i=du;break;default:c(i!=i)}return i}function Zf(e){return Yf(e,js)}function el(e){return Yf(e,Bs)}function tl(e){var t;switch(Jt(e)){case Vi:t=Qo;break;case Qi:t=Go;break;case $i:t=Yo;break;case Ki:t=Zo;break;default:c(e!=e)}return t}function nl(e){return Kt(e)}function rl(e,t){return Qt(e,t)}function il(e,t){return Gt(e,t)}function sl(e,t){Yt(e,Xi,po,function(e,n,r,i){t.pe_ae_max=e,t.pe_ae_row=n,t.pe_re_max=r,t.pe_re_row=i,r<=1e-9?t.pe_quality="H":r<=1e-6?t.pe_quality="M":r<=.001?t.pe_quality="L":t.pe_quality="?"}),Yt(e,Xi,vo,function(e,n,r,i){t.pb_ae_max=e,t.pb_ae_ind=n,t.pb_re_max=r,t.pb_re_ind=i,r<=1e-9?t.pb_quality="H":r<=1e-6?t.pb_quality="M":r<=.001?t.pb_quality="L":t.pb_quality="?"})}function ol(e){var t=e.parms;c(t!=null),t.msg_lev=3,t.scale=1,t.dual=0,t.price=1,t.relax=.07,t.tol_bnd=1e-7,t.tol_dj=1e-7,t.tol_piv=1e-9,t.round=0,t.obj_ll=-n,t.obj_ul=+n,t.it_lim=-1,t.tm_lim=-1,t.out_frq=200,t.out_dly=0,t.branch=2,t.btrack=3,t.tol_int=1e-5,t.tol_obj=1e-7,t.mps_info=1,t.mps_obj=2,t.mps_orig=0,t.mps_wide=1,t.mps_free=0,t.mps_skip=0,t.lpt_orig=0,t.presol=0,t.binarize=0,t.use_cuts=0,t.mip_gap=0}function ul(e){return e.parms==null&&(e.parms={},ol(e)),e.parms}function al(e){ul(e),ol(e)}function fl(e,t,n){var r=ul(e);switch(t){case Su:0<=n&&n<=3||l("lpx_set_int_parm: MSGLEV = "+n+"; invalid value"),r.msg_lev=n;break;case xu:0<=n&&n<=3||l("lpx_set_int_parm: SCALE = "+n+"; invalid value"),r.scale=n;break;case Tu:n!=0&&n!=1&&l("lpx_set_int_parm: DUAL = "+n+"; invalid value"),r.dual=n;break;case Nu:n!=0&&n!=1&&l("lpx_set_int_parm: PRICE = "+n+"; invalid value"),r.price=n;break;case Ou:n!=0&&n!=1&&l("lpx_set_int_parm: ROUND = "+n+"; invalid value"),r.round=n;break;case Du:r.it_lim=n;break;case Pu:e.it_cnt=n;break;case Bu:n>0||l("lpx_set_int_parm: OUTFRQ = "+n+"; invalid value"),r.out_frq=n;break;case Fu:n!=0&&n!=1&&n!=2&&n!=3&&l("lpx_set_int_parm: BRANCH = "+n+"; invalid value"),r.branch=n;break;case Iu:n!=0&&n!=1&&n!=2&&n!=3&&l("lpx_set_int_parm: BTRACK = "+n+"; invalid value"),r.btrack=n;break;case Uu:n!=0&&n!=1&&l("lpx_set_int_parm: MPSINFO = "+n+"; invalid value"),r.mps_info=n;break;case zu:n!=0&&n!=1&&n!=2&&l("lpx_set_int_parm: MPSOBJ = "+n+"; invalid value"),r.mps_obj=n;break;case Wu:n!=0&&n!=1&&l("lpx_set_int_parm: MPSORIG = "+n+"; invalid value"),r.mps_orig=n;break;case Xu:n!=0&&n!=1&&l("lpx_set_int_parm: MPSWIDE = "+n+"; invalid value"),r.mps_wide=n;break;case Vu:n!=0&&n!=1&&l("lpx_set_int_parm: MPSFREE = "+n+"; invalid value"),r.mps_free=n;break;case $u:n!=0&&n!=1&&l("lpx_set_int_parm: MPSSKIP = "+n+"; invalid value"),r.mps_skip=n;break;case Ju:n!=0&&n!=1&&l("lpx_set_int_parm: LPTORIG = "+n+"; invalid value"),r.lpt_orig=n;break;case Ku:n!=0&&n!=1&&l("lpx_set_int_parm: PRESOL = "+n+"; invalid value"),r.presol=n;break;case Qu:n!=0&&n!=1&&l("lpx_set_int_parm: BINARIZE = "+n+"; invalid value"),r.binarize=n;break;case Gu:n&~ia&&l("lpx_set_int_parm: USECUTS = "+n+"; invalid value"),r.use_cuts=n;break;case Yu:t={},nn(e,t);switch(n){case 1:t.type=Yi;break;case 2:t.type=Zi;break;case 3:t.type=es;break;default:l("lpx_set_int_parm: BFTYPE = "+n+"; invalid value")}sn(e,t);break;default:l("lpx_set_int_parm: parm = "+t+"; invalid parameter")}}function ll(e,t){var n=ul(e),r=0;switch(t){case Su:r=n.msg_lev;break;case xu:r=n.scale;break;case Tu:r=n.dual;break;case Nu:r=n.price;break;case Ou:r=n.round;break;case Du:r=n.it_lim;break;case Pu:r=e.it_cnt;break;case Bu:r=n.out_frq;break;case Fu:r=n.branch;break;case Iu:r=n.btrack;break;case Uu:r=n.mps_info;break;case zu:r=n.mps_obj;break;case Wu:r=n.mps_orig;break;case Xu:r=n.mps_wide;break;case Vu:r=n.mps_free;break;case $u:r=n.mps_skip;break;case Ju:r=n.lpt_orig;break;case Ku:r=n.presol;break;case Qu:r=n.binarize;break;case Gu:r=n.use_cuts;break;case Yu:t={},nn(e,t);switch(t.type){case Yi:r=1;break;case Zi:r=2;break;case es:r=3;break;default:c(e!=e)}break;default:l("lpx_get_int_parm: parm = "+t+"; invalid parameter")}return r}function cl(e,t,n){var r=ul(e);switch(t){case Cu:0<=n&&n<=1||l("lpx_set_real_parm: RELAX = "+n+"; invalid value"),r.relax=n;break;case ku:i<=n&&n<=.001||l("lpx_set_real_parm: TOLBND = "+n+"; invalid value"),r.tol_bnd=n;break;case Lu:i<=n&&n<=.001||l("lpx_set_real_parm: TOLDJ = "+n+"; invalid value"),r.tol_dj=n;break;case Au:i<=n&&n<=.001||l("lpx_set_real_parm: TOLPIV = "+n+"; invalid value"),r.tol_piv=n;break;case Mu:r.obj_ll=n;break;case _u:r.obj_ul=n;break;case Hu:r.tm_lim=n;break;case ju:r.out_dly=n;break;case qu:i<=n&&n<=.001||l("lpx_set_real_parm: TOLINT = "+n+"; invalid value"),r.tol_int=n;break;case Ru:i<=n&&n<=.001||l("lpx_set_real_parm: TOLOBJ = "+n+"; invalid value"),r.tol_obj=n;break;case Zu:n<0&&l("lpx_set_real_parm: MIPGAP = "+n+"; invalid value"),r.mip_gap=n;break;default:l("lpx_set_real_parm: parm = "+t+"; invalid parameter")}}function hl(e,t){var n=ul(e),r=0;switch(t){case Cu:r=n.relax;break;case ku:r=n.tol_bnd;break;case Lu:r=n.tol_dj;break;case Au:r=n.tol_piv;break;case Mu:r=n.obj_ll;break;case _u:r=n.obj_ul;break;case Hu:r=n.tm_lim;break;case ju:r=n.out_dly;break;case qu:r=n.tol_int;break;case Ru:r=n.tol_obj;break;case Zu:r=n.mip_gap;break;default:l("lpx_get_real_parm: parm = "+t+"; invalid parameter")}return r}function pl(e){var t=Ea();return glp_read_mps(t,bo,null,e)&&(ja(t),t=null),t}function dl(e,t){return glp_write_mps(e,bo,null,t)}function vl(e,t){return c(e==e),c(t==t),l("lpx_read_bas: operation not supported"),0}function ml(e,t){return c(e==e),c(t==t),l("lpx_write_bas: operation not supported"),0}function gl(e){var t=Ea();return glp_read_mps(t,wo,null,e)&&(ja(t),t=null),t}function yl(e,t){return glp_write_mps(e,wo,null,t)}function bl(e){var t=Ea();return rr(t,null,e)&&(ja(t),t=null),t}function wl(e,t){return ir(e,null,t)}function El(e,t,n){function s(){return glp_mpl_free_wksp(i),r}var r=null,i=glp_mpl_alloc_wksp();return glp_mpl_read_model(i,e,t!=null)?s():t!=null&&glp_mpl_read_data(i,t)?s():glp_mpl_generate(i,n)?s():(r=_(),glp_mpl_build_prob(i,r),s())}function Sl(e,t){return ir(e,null,t)}function xl(e,t){return glp_print_sol(e,t)}function Tl(e,t){return Mt(e)==Qi&&!Zt(e)&&en(e),glp_print_ranges(e,0,null,0,t)}function Nl(e,t){return glp_print_ipt(e,t)}function Cl(e,t){return glp_print_mip(e,t)}function kl(e){return Zt(e)}function Ll(e,t){return glp_main(e,t)}function Ml(){var e={};return e.n_max=e.n=0,e.valid=0,e.fr_ptr=e.fr_len=null,e.fc_ptr=e.fc_len=null,e.vr_ptr=e.vr_len=e.vr_cap=null,e.vr_piv=null,e.vc_ptr=e.vc_len=e.vc_cap=null,e.pp_row=e.pp_col=null,e.qq_row=e.qq_col=null,e.sv_size=0,e.sv_beg=e.sv_end=0,e.sv_ind=null,e.sv_val=null,e.sv_head=e.sv_tail=0,e.sv_prev=e.sv_next=null,e.vr_max=null,e.rs_head=e.rs_prev=e.rs_next=null,e.cs_head=e.cs_prev=e.cs_next=null,e.flag=null,e.work=null,e.new_sva=0,e.piv_tol=.1,e.piv_lim=4,e.suhl=1,e.eps_tol=1e-15,e.max_gro=1e10,e.nnz_a=e.nnz_f=e.nnz_v=0,e.max_a=e.big_v=0,e.rank=0,e}function _l(e){var t=e.n,n=e.vr_ptr,r=e.vr_len,i=e.vr_cap,s=e.vc_ptr,o=e.vc_len,u=e.vc_cap,a=e.sv_ind,f=e.sv_val,l=e.sv_next,c=1,h,p,v;for(v=e.sv_head;v!=0;v=l[v])if(v<=t){h=v;if(n[h]!=c)break;i[h]=r[h],c+=i[h]}else{p=v-t;if(s[p]!=c)break;u[p]=o[p],c+=u[p]}for(;v!=0;v=l[v])v<=t?(h=v,d(a,c,a,n[h],r[h]),d(f,c,f,n[h],r[h]),n[h]=c,i[h]=r[h],c+=i[h]):(p=v-t,d(a,c,a,s[p],o[p]),d(f,c,f,s[p],o[p]),s[p]=c,u[p]=o[p],c+=u[p]);e.sv_beg=c}function Dl(e,t,n){var r=e.n,i=e.vr_ptr,s=e.vr_len,o=e.vr_cap,u=e.vc_cap,a=e.sv_ind,f=e.sv_val,l=e.sv_prev,h=e.sv_next,p=0,v,m,g;c(1<=t&&t<=r),c(o[t]<n);if(e.sv_end-e.sv_beg<n){_l(e);if(e.sv_end-e.sv_beg<n)return p=1,p}return v=o[t],d(a,e.sv_beg,a,i[t],s[t]),d(f,e.sv_beg,f,i[t],s[t]),i[t]=e.sv_beg,o[t]=n,e.sv_beg+=n,m=t,l[m]==0?e.sv_head=h[m]:(g=l[m],g<=r?o[g]+=v:u[g-r]+=v,h[l[m]]=h[m]),h[m]==0?e.sv_tail=l[m]:l[h[m]]=l[m],l[m]=e.sv_tail,h[m]=0,l[m]==0?e.sv_head=m:h[l[m]]=m,e.sv_tail=m,p}function Pl(e,t,n){var r=e.n,i=e.vr_cap,s=e.vc_ptr,o=e.vc_len,u=e.vc_cap,a=e.sv_ind,f=e.sv_val,l=e.sv_prev,h=e.sv_next,p=0,v,m,g;c(1<=t&&t<=r),c(u[t]<n);if(e.sv_end-e.sv_beg<n){_l(e);if(e.sv_end-e.sv_beg<n)return p=1,p}return v=u[t],d(a,e.sv_beg,a,s[t],o[t]),d(f,e.sv_beg,f,s[t],o[t]),s[t]=e.sv_beg,u[t]=n,e.sv_beg+=n,m=r+t,l[m]==0?e.sv_head=h[m]:(g=l[m],g<=r?i[g]+=v:u[g-r]+=v,h[l[m]]=h[m]),h[m]==0?e.sv_tail=l[m]:l[h[m]]=l[m],l[m]=e.sv_tail,h[m]=0,l[m]==0?e.sv_head=m:h[l[m]]=m,e.sv_tail=m,p}function Hl(e,t){var n=e.n_max;e.n=t;if(t<=n)return;e.n_max=n=t+100,e.fr_ptr=new Array(1+n),e.fr_len=new Array(1+n),e.fc_ptr=new Array(1+n),e.fc_len=new Array(1+n),e.vr_ptr=new Array(1+n),e.vr_len=new Array(1+n),e.vr_cap=new Array(1+n),e.vr_piv=new Array(1+n),e.vc_ptr=new Array(1+n),e.vc_len=new Array(1+n),e.vc_cap=new Array(1+n),e.pp_row=new Array(1+n),e.pp_col=new Array(1+n),e.qq_row=new Array(1+n),e.qq_col=new Array(1+n),e.sv_prev=new Array(1+n+n),e.sv_next=new Array(1+n+n),e.vr_max=new Array(1+n),e.rs_head=new Array(1+n),e.rs_prev=new Array(1+n),e.rs_next=new Array(1+n),e.cs_head=new Array(1+n),e.cs_prev=new Array(1+n),e.cs_next=new Array(1+n),e.flag=new Array(1+n),e.work=new Array(1+n)}function Bl(e,t,n){var r=e.n,i=e.fc_ptr,s=e.fc_len,o=e.vr_ptr,u=e.vr_len,a=e.vr_cap,f=e.vc_ptr,c=e.vc_len,h=e.vc_cap,p=e.pp_row,d=e.pp_col,v=e.qq_row,m=e.qq_col,g=e.sv_ind,y=e.sv_val,b=e.sv_prev,w=e.sv_next,E=e.vr_max,S=e.rs_head,x=e.rs_prev,T=e.rs_next,N=e.cs_head,C=e.cs_prev,k=e.cs_next,L=e.flag,A=e.work,O=0,M,_,D,P,H,B,j,F,I,q,R,U,z;I=1,q=e.sv_size+1;for(D=1;D<=r;D++)i[D]=q,s[D]=0;for(M=1;M<=r;M++)u[M]=a[M]=0,L[M]=0;F=0,U=0;for(D=1;D<=r;D++){var W=p,X=A;j=t(n,D,W,X),0<=j&&j<=r||l("luf_factorize: j = "+D+"; len = "+j+"; invalid column length");if(q-I<j)return O=1,O;f[D]=I,c[D]=h[D]=j,F+=j;for(R=1;R<=j;R++)M=W[R],z=X[R],1<=M&&M<=r||l("luf_factorize: i = "+M+"; j = "+D+"; invalid row index"),L[M]&&l("luf_factorize: i = "+M+"; j = "+D+"; duplicate element not allowed"),z==0&&l("luf_factorize: i = "+M+"; j = "+D+"; zero element not allowed"),g[I]=M,y[I]=z,I++,z<0&&(z=-z),U<z&&(U=z),L[M]=1,a[M]++;for(R=1;R<=j;R++)L[W[R]]=0}for(M=1;M<=r;M++){j=a[M];if(q-I<j)return O=1,O;o[M]=I,I+=j}for(D=1;D<=r;D++){P=f[D],H=P+c[D]-1;for(B=P;B<=H;B++)M=g[B],z=y[B],_=o[M]+u[M],g[_]=D,y[_]=z,u[M]++}for(B=1;B<=r;B++)p[B]=d[B]=v[B]=m[B]=B;e.sv_beg=I,e.sv_end=q,e.sv_head=r+1,e.sv_tail=r;for(M=1;M<=r;M++)b[M]=M-1,w[M]=M+1;b[1]=r+r,w[r]=0;for(D=1;D<=r;D++)b[r+D]=r+D-1,w[r+D]=r+D+1;b[r+1]=0,w[r+r]=1;for(B=1;B<=r;B++)L[B]=0,A[B]=0;e.nnz_a=F,e.nnz_f=0,e.nnz_v=F,e.max_a=U,e.big_v=U,e.rank=-1;for(M=1;M<=r;M++)E[M]=-1;for(j=0;j<=r;j++)S[j]=0;for(M=1;M<=r;M++)j=u[M],x[M]=0,T[M]=S[j],T[M]!=0&&(x[T[M]]=M),S[j]=M;for(j=0;j<=r;j++)N[j]=0;for(D=1;D<=r;D++)j=c[D],C[D]=0,k[D]=N[j],k[D]!=0&&(C[k[D]]=D),N[j]=D;return O}function jl(e,t){function R(){return t(E,S),E==0}var i=e.n,s=e.vr_ptr,o=e.vr_len,u=e.vc_ptr,a=e.vc_len,f=e.sv_ind,l=e.sv_val,h=e.vr_max,p=e.rs_head,d=e.rs_next,v=e.cs_head,m=e.cs_prev,g=e.cs_next,y=e.piv_tol,b=e.piv_lim,w=e.suhl,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q;E=S=0,j=n,_=0,L=v[1];if(L!=0)return c(a[L]==1),E=f[u[L]],S=L,R();T=p[1];if(T!=0)return c(o[T]==1),E=T,S=f[s[T]],R();for(x=2;x<=i;x++){for(L=v[x];L!=0;L=D){A=u[L],O=A+a[L]-1,D=g[L],P=H=0,B=r;for(M=A;M<=O;M++){T=f[M],N=s[T],C=N+o[T]-1;if(o[T]>=B)continue;I=h[T];if(I<0){for(k=N;k<=C;k++)q=l[k],q<0&&(q=-q),I<q&&(I=q);h[T]=I}for(k=s[T];f[k]!=L;k++);c(k<=C),q=l[k],q<0&&(q=-q);if(q<y*I)continue;P=T,H=L,B=o[T];if(B<=x)return E=P,S=H,R()}if(P!=0){_++,F=(B-1)*(x-1),F<j&&(E=P,S=H,j=F);if(_==b)return R()}else w&&(m[L]==0?v[x]=g[L]:g[m[L]]=g[L],g[L]!=0&&(m[g[L]]=m[L]),m[L]=g[L]=L)}for(T=p[x];T!=0;T=d[T]){N=s[T],C=N+o[T]-1,I=h[T];if(I<0){for(k=N;k<=C;k++)q=l[k],q<0&&(q=-q),I<q&&(I=q);h[T]=I}P=H=0,B=r;for(k=N;k<=C;k++){L=f[k];if(a[L]>=B)continue;q=l[k],q<0&&(q=-q);if(q<y*I)continue;P=T,H=L,B=a[L];if(B<=x)return E=P,S=H,R()}if(P!=0){_++,F=(x-1)*(B-1),F<j&&(E=P,S=H,j=F);if(_==b)return R()}else c(P!=P)}}return R()}function Fl(e,t,n){var r=e.n,i=e.fc_ptr,s=e.fc_len,o=e.vr_ptr,u=e.vr_len,a=e.vr_cap,f=e.vr_piv,l=e.vc_ptr,h=e.vc_len,p=e.vc_cap,d=e.sv_ind,v=e.sv_val,m=e.sv_prev,g=e.sv_next,y=e.vr_max,b=e.rs_head,w=e.rs_prev,E=e.rs_next,S=e.cs_head,x=e.cs_prev,T=e.cs_next,N=e.flag,C=e.work,k=e.eps_tol,L=e.fr_len,A=0,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q;c(1<=t&&t<=r),c(1<=n&&n<=r),w[t]==0?b[u[t]]=E[t]:E[w[t]]=E[t],E[t]!=0&&(w[E[t]]=w[t]),x[n]==0?S[h[n]]=T[n]:T[x[n]]=T[n],T[n]!=0&&(x[T[n]]=x[n]),R=o[t],U=R+u[t]-1;for(z=R;d[z]!=n;z++);c(z<=U),K=f[t]=v[z],d[z]=d[U],v[z]=v[U],u[t]--,U--,W=l[n],X=W+h[n]-1;for(V=W;d[V]!=t;V++);c(V<=X),d[V]=d[X],h[n]--,X--;for(z=R;z<=U;z++){B=d[z],N[B]=1,C[B]=v[z],x[B]==0?S[h[B]]=T[B]:T[x[B]]=T[B],T[B]!=0&&(x[T[B]]=x[B]),j=l[B],F=j+h[B]-1;for(I=j;d[I]!=t;I++);c(I<=F),d[I]=d[F],h[B]--}while(W<=X){_=d[W],w[_]==0?b[u[_]]=E[_]:E[w[_]]=E[_],E[_]!=0&&(w[E[_]]=w[_]),D=o[_],P=D+u[_]-1;for(H=D;d[H]!=n;H++);c(H<=P),$=v[H]/K,d[H]=d[P],v[H]=v[P],u[_]--,P--,d[W]=d[X],h[n]--,X--,M=u[t];for(H=D;H<=P;H++){B=d[H];if(N[B]){Q=v[H]-=$*C[B],Q<0&&(Q=-Q),N[B]=0,M--;if(Q==0||Q<k){d[H]=d[P],v[H]=v[P],u[_]--,H--,P--,j=l[B],F=j+h[B]-1;for(I=j;d[I]!=_;I++);c(I<=F),d[I]=d[F],h[B]--}else e.big_v<Q&&(e.big_v=Q)}}if(u[_]+M>a[_]){if(Dl(e,_,u[_]+M))return A=1,A;R=o[t],U=R+u[t]-1,W=l[n],X=W+h[n]-1}O=0;for(z=R;z<=U;z++)B=d[z],N[B]?(Q=J=-$*C[B],Q<0&&(Q=-Q),Q==0||Q<k||(H=o[_]+u[_],d[H]=B,v[H]=J,u[_]++,L[++O]=B,e.big_v<Q&&(e.big_v=Q))):N[B]=1;for(q=1;q<=O;q++){B=L[q];if(h[B]+1>p[B]){if(Pl(e,B,h[B]+10))return A=1,A;R=o[t],U=R+u[t]-1,W=l[n],X=W+h[n]-1}I=l[B]+h[B],d[I]=_,h[B]++}w[_]=0,E[_]=b[u[_]],E[_]!=0&&(w[E[_]]=_),b[u[_]]=_,y[_]=-1;if(e.sv_end-e.sv_beg<1){_l(e);if(e.sv_end-e.sv_beg<1)return A=1,A;R=o[t],U=R+u[t]-1,W=l[n],X=W+h[n]-1}e.sv_end--,d[e.sv_end]=_,v[e.sv_end]=$,s[t]++}c(h[n]==0),p[n]=0,q=r+n,m[q]==0?e.sv_head=g[q]:g[m[q]]=g[q],g[q]==0?e.sv_tail=m[q]:m[g[q]]=m[q],i[t]=e.sv_end;for(z=R;z<=U;z++){B=d[z],N[B]=0,C[B]=0;if(h[B]==1||x[B]!=B||T[B]!=B)x[B]=0,T[B]=S[h[B]],T[B]!=0&&(x[T[B]]=B),S[h[B]]=B}return A}function Il(e){var t=e.n,n=e.vr_ptr,r=e.vr_len,i=e.vc_ptr,s=e.vc_len,o=e.vc_cap,u=e.sv_ind,a=e.sv_val,f=e.sv_prev,l=e.sv_next,c=0,h,p,d,v,m,g,y,b;b=0;for(h=1;h<=t;h++){p=n[h],d=p+r[h]-1;for(v=p;v<=d;v++)o[u[v]]++;b+=r[h]}e.nnz_v=b;if(e.sv_end-e.sv_beg<b)return c=1,c;for(m=1;m<=t;m++)i[m]=e.sv_beg,e.sv_beg+=o[m];for(h=1;h<=t;h++){p=n[h],d=p+r[h]-1;for(v=p;v<=d;v++)m=u[v],g=i[m]+s[m],u[g]=h,a[g]=a[v],s[m]++}for(y=t+1;y<=t+t;y++)f[y]=y-1,l[y]=y+1;return f[t+1]=e.sv_tail,l[e.sv_tail]=t+1,l[t+t]=0,e.sv_tail=t+t,c}function ql(e){var t=e.n,n=e.fr_ptr,r=e.fr_len,i=e.fc_ptr,s=e.fc_len,o=e.sv_ind,u=e.sv_val,a=0,f,l,c,h,p,d,v;for(f=1;f<=t;f++)r[f]=0;v=0;for(l=1;l<=t;l++){c=i[l],h=c+s[l]-1;for(p=c;p<=h;p++)r[o[p]]++;v+=s[l]}e.nnz_f=v;if(e.sv_end-e.sv_beg<v)return a=1,a;for(f=1;f<=t;f++)n[f]=e.sv_end,e.sv_end-=r[f];for(l=1;l<=t;l++){c=i[l],h=c+s[l]-1;for(p=c;p<=h;p++)f=o[p],d=--n[f],o[d]=l,u[d]=u[p]}return a}function Rl(e,t,n,r){function b(){e.new_sva>0&&(e.sv_size=e.new_sva,e.sv_ind=new Array(1+e.sv_size),e.sv_val=new Array(1+e.sv_size),e.new_sva=0);if(Bl(e,n,r))return e.new_sva=e.sv_size+e.sv_size,c(e.new_sva>e.sv_size),!0;for(d=1;d<=t;d++){if(jl(e,function(e,t){v=e,m=t}))return e.rank=d-1,y=Al,!1;h=s[v],p=o[m],c(d<=h&&h<=t&&d<=p&&p<=t),g=i[d],i[h]=g,s[g]=h,i[d]=v,s[v]=d,g=a[d],a[p]=g,o[g]=p,a[d]=m,o[m]=d;if(Fl(e,v,m))return e.new_sva=e.sv_size+e.sv_size,c(e.new_sva>e.sv_size),!0;if(e.big_v>f*e.max_a)return e.rank=d-1,y=Ol,!1}return _l(e),Il(e)?(e.new_sva=e.sv_size+e.sv_size,c(e.new_sva>e.sv_size),!0):ql(e)?(e.new_sva=e.sv_size+e.sv_size,c(e.new_sva>e.sv_size),!0):!1}var i,s,o,a,f=e.max_gro,h,p,d,v,m,g,y=null;t<1&&l("luf_factorize: n = "+t+"; invalid parameter"),t>u&&l("luf_factorize: n = "+t+"; matrix too big"),e.valid=0,Hl(e,t),i=e.pp_row,s=e.pp_col,o=e.qq_row,a=e.qq_col,e.sv_size==0&&e.new_sva==0&&(e.new_sva=5*(t+10));while(b());if(y!=null)return y;e.valid=1,e.rank=t,y=0,g=3*(t+e.nnz_v)+2*e.nnz_f;if(e.sv_size<g){e.new_sva=e.sv_size;while(e.new_sva<g)d=e.new_sva,e.new_sva=d+d,c(e.new_sva>d)}return y}function Ul(e,t,n){var r=e.n,i=e.fr_ptr,s=e.fr_len,o=e.fc_ptr,u=e.fc_len,a=e.pp_row,f=e.sv_ind,c=e.sv_val,h,p,d,v,m,g,y;e.valid||l("luf_f_solve: LU-factorization is not valid");if(!t)for(p=1;p<=r;p++){d=a[p],y=n[d];if(y!=0){v=o[d],m=v+u[d]-1;for(g=v;g<=m;g++)n[f[g]]-=c[g]*y}}else for(h=r;h>=1;h--){d=a[h],y=n[d];if(y!=0){v=i[d],m=v+s[d]-1;for(g=v;g<=m;g++)n[f[g]]-=c[g]*y}}}function zl(e,t,n){var r=e.n,i=e.vr_ptr,s=e.vr_len,o=e.vr_piv,u=e.vc_ptr,a=e.vc_len,f=e.pp_row,c=e.qq_col,h=e.sv_ind,p=e.sv_val,d=e.work,v,m,g,y,b,w,E;e.valid||l("luf_v_solve: LU-factorization is not valid");for(g=1;g<=r;g++)d[g]=n[g],n[g]=0;if(!t)for(g=r;g>=1;g--){v=f[g],m=c[g],E=d[v];if(E!=0){n[m]=E/=o[v],y=u[m],b=y+a[m]-1;for(w=y;w<=b;w++)d[h[w]]-=p[w]*E}}else for(g=1;g<=r;g++){v=f[g],m=c[g],E=d[m];if(E!=0){n[v]=E/=o[v],y=i[v],b=y+s[v]-1;for(w=y;w<=b;w++)d[h[w]]-=p[w]*E}}}function Wl(e,t,n){e.valid||l("luf_a_solve: LU-factorization is not valid"),t?(zl(e,1,n),Ul(e,1,n)):(Ul(e,0,n),zl(e,0,n))}function Xl(){}function Vl(){var e={};return e.orig_dir=0,e.orig_m=e.orig_n=e.orig_nnz=0,e.name=e.obj=null,e.c0=0,e.nrows=e.ncols=0,e.r_head=e.r_tail=null,e.c_head=e.c_tail=null,e.top=null,e.m=e.n=e.nnz=0,e.row_ref=e.col_ref=null,e.sol=e.scaling=0,e.p_stat=e.d_stat=e.t_stat=e.i_stat=0,e.r_stat=null,e.r_pi=null,e.c_stat=null,e.c_value=null,e}function $l(e,t,n){n==0?(t.prev=null,t.next=e.r_head,t.next==null?e.r_tail=t:t.next.prev=t,e.r_head=t):(t.prev=e.r_tail,t.next=null,t.prev==null?e.r_head=t:t.prev.next=t,e.r_tail=t)}function Jl(e,t){t.prev==null?e.r_head=t.next:t.prev.next=t.next,t.next==null?e.r_tail=t.prev:t.next.prev=t.prev}function Kl(e,t){t.temp||(t.temp=1,Jl(e,t),$l(e,t,0))}function Ql(e,t){t.temp&&(t.temp=0,Jl(e,t),$l(e,t,1))}function Gl(e,t,n){n==0?(t.prev=null,t.next=e.c_head,t.next==null?e.c_tail=t:t.next.prev=t,e.c_head=t):(t.prev=e.c_tail,t.next=null,t.prev==null?e.c_head=t:t.prev.next=t,e.c_tail=t)}function Yl(e,t){t.prev==null?e.c_head=t.next:t.prev.next=t.next,t.next==null?e.c_tail=t.prev:t.next.prev=t.prev}function Zl(e,t){t.temp||(t.temp=1,Yl(e,t),Gl(e,t,0))}function ec(e,t){t.temp&&(t.temp=0,Yl(e,t),Gl(e,t,1))}function tc(e){var t={};return t.i=++e.nrows,t.name=null,t.lb=-n,t.ub=+n,t.ptr=null,t.temp=0,$l(e,t,1),t}function nc(e){var t={};return t.j=++e.ncols,t.name=null,t.is_int=0,t.lb=t.ub=t.coef=0,t.ptr=null,t.temp=0,t.ll={},t.uu={},Gl(e,t,1),t}function rc(e,t,n){var r={};return r.row=e,r.col=t,r.val=n,r.r_prev=null,r.r_next=e.ptr,r.c_prev=null,r.c_next=t.ptr,r.r_next!=null&&(r.r_next.r_prev=r),r.c_next!=null&&(r.c_next.c_prev=r),e.ptr=t.ptr=r,r}function ic(e){var t=0;for(var n=e.ptr;n!=null;n=n.r_next)t++;return t}function sc(e){var t=0;for(var n=e.ptr;n!=null;n=n.c_next)t++;return t}function oc(e,t){var n;return n={},n.func=t,n.info={},n.link=e.top,e.top=n,n.info}function uc(e){var t;while(e.ptr!=null)t=e.ptr,e.ptr=t.r_next,t.c_prev==null?t.col.ptr=t.c_next:t.c_prev.c_next=t.c_next,t.c_next!=null&&(t.c_next.c_prev=t.c_prev)}function ac(e,t){uc(t),Jl(e,t)}function fc(e,t){var n;while(t.ptr!=null)n=t.ptr,t.ptr=n.c_next,n.r_prev==null?n.row.ptr=n.r_next:n.r_prev.r_next=n.r_next,n.r_next!=null&&(n.r_next.r_prev=n.r_prev);Yl(e,t)}function lc(e){e.r_prev==null?e.row.ptr=e.r_next:e.r_prev.r_next=e.r_next,e.r_next!=null&&(e.r_next.r_prev=e.r_prev),e.c_prev==null?e.col.ptr=e.c_next:e.c_prev.c_next=e.c_next,e.c_next!=null&&(e.c_next.c_prev=e.c_prev)}function cc(e,t,r,i,s){var o=t.m,u=t.n,a,f,l,h;c(r==js||r==Bs),c(i==zi||i==Wi||i==Xi),c(s==js||s==Bs),i==Xi&&c(!s),e.orig_dir=t.dir,e.orig_dir==xi?h=1:e.orig_dir==Ti?h=-1:c(e!=e),e.orig_m=o,e.orig_n=u,e.orig_nnz=t.nnz,r&&t.name!=null&&(e.name=t.name),r&&t.obj!=null&&(e.obj=t.obj),e.c0=h*t.c0,a=new Array(1+o);for(f=1;f<=o;f++){var p=t.row[f],d;a[f]=d=tc(e),c(d.i==f),r&&p.name!=null&&(d.name=p.name);if(!s)p.type==Li?(d.lb=-n,d.ub=+n):p.type==Ai?(d.lb=p.lb,d.ub=+n):p.type==Oi?(d.lb=-n,d.ub=p.ub):p.type==Mi?(d.lb=p.lb,d.ub=p.ub):p.type==_i?d.lb=d.ub=p.lb:c(p!=p);else{var v=p.rii;p.type==Li?(d.lb=-n,d.ub=+n):p.type==Ai?(d.lb=p.lb*v,d.ub=+n):p.type==Oi?(d.lb=-n,d.ub=p.ub*v):p.type==Mi?(d.lb=p.lb*v,d.ub=p.ub*v):p.type==_i?d.lb=d.ub=p.lb*v:c(p!=p)}}for(l=1;l<=u;l++){var m=t.col[l],g,y;y=nc(e),c(y.j==l),r&&m.name!=null&&(y.name=m.name),i==Xi&&(y.is_int=Number(m.kind==Ci));if(!s){m.type==Li?(y.lb=-n,y.ub=+n):m.type==Ai?(y.lb=m.lb,y.ub=+n):m.type==Oi?(y.lb=-n,y.ub=m.ub):m.type==Mi?(y.lb=m.lb,y.ub=m.ub):m.type==_i?y.lb=y.ub=m.lb:c(m!=m),y.coef=h*m.coef;for(g=m.ptr;g!=null;g=g.c_next)rc(a[g.row.i],y,g.val)}else{var b=m.sjj;m.type==Li?(y.lb=-n,y.ub=+n):m.type==Ai?(y.lb=m.lb/b,y.ub=+n):m.type==Oi?(y.lb=-n,y.ub=m.ub/b):m.type==Mi?(y.lb=m.lb/b,y.ub=m.ub/b):m.type==_i?y.lb=y.ub=m.lb/b:c(m!=m),y.coef=h*m.coef*b;for(g=m.ptr;g!=null;g=g.c_next)rc(a[g.row.i],y,g.row.rii*g.val*b)}}e.sol=i,e.scaling=s}function hc(e,t){var r,i,s,o,u,a,f,l,h,p;G(t),D(t,e.name),P(t,e.obj),H(t,e.orig_dir),e.orig_dir==xi?h=1:e.orig_dir==Ti?h=-1:c(e!=e),U(t,0,h*e.c0);for(r=e.r_head;r!=null;r=r.next)r.temp=o=B(t,1),F(t,o,r.name),r.lb==-n&&r.ub==+n?a=Li:r.ub==+n?a=Ai:r.lb==-n?a=Oi:r.lb!=r.ub?a=Mi:a=_i,q(t,o,a,r.lb,r.ub);l=new Array(1+t.m),p=new Array(1+t.m);for(i=e.c_head;i!=null;i=i.next){u=j(t,1),I(t,u,i.name),Ut(t,u,i.is_int?Ci:Ni),i.lb==-n&&i.ub==+n?a=Li:i.ub==+n?a=Ai:i.lb==-n?a=Oi:i.lb!=i.ub?a=Mi:a=_i,R(t,u,a,i.lb,i.ub),U(t,u,h*i.coef),f=0;for(s=i.ptr;s!=null;s=s.c_next)f++,l[f]=s.row.temp,p[f]=s.val;W(t,u,f,l,p)}e.m=t.m,e.n=t.n,e.nnz=t.nnz,e.row_ref=new Array(1+e.m),e.col_ref=new Array(1+e.n);for(r=e.r_head,o=0;r!=null;r=r.next)e.row_ref[++o]=r.i;for(i=e.c_head,u=0;i!=null;i=i.next)e.col_ref[++u]=i.j;e.name=e.obj=null,e.c0=0,e.r_head=e.r_tail=null,e.c_head=e.c_tail=null}function pc(e,t){var r,i,s,o,u,a,f;c(e.orig_dir==t.dir),e.orig_dir==xi?f=1:e.orig_dir==Ti?f=-1:c(e!=e),c(e.m==t.m),c(e.n==t.n),c(e.nnz==t.nnz),e.sol==zi?(e.p_stat=t.pbs_stat,e.d_stat=t.dbs_stat):e.sol==Wi?e.t_stat=t.ipt_stat:e.sol==Xi?e.i_stat=t.mip_stat:c(e!=e);if(e.sol==zi){e.r_stat==null&&(e.r_stat=new Array(1+e.nrows));for(o=1;o<=e.nrows;o++)e.r_stat[o]=0;e.c_stat==null&&(e.c_stat=new Array(1+e.ncols));for(u=1;u<=e.ncols;u++)e.c_stat[u]=0}e.c_value==null&&(e.c_value=new Array(1+e.ncols));for(u=1;u<=e.ncols;u++)e.c_value[u]=n;if(e.sol!=Xi){e.r_pi==null&&(e.r_pi=new Array(1+e.nrows));for(o=1;o<=e.nrows;o++)e.r_pi[o]=n}if(e.sol==zi){for(o=1;o<=e.m;o++)r=t.row[o],a=e.row_ref[o],e.r_stat[a]=r.stat,e.r_pi[a]=f*r.dual;for(u=1;u<=e.n;u++)i=t.col[u],a=e.col_ref[u],e.c_stat[a]=i.stat,e.c_value[a]=i.prim}else if(e.sol==Wi){for(o=1;o<=e.m;o++)r=t.row[o],a=e.row_ref[o],e.r_pi[a]=f*r.dval;for(u=1;u<=e.n;u++)i=t.col[u],a=e.col_ref[u],e.c_value[a]=i.pval}else if(e.sol==Xi)for(u=1;u<=e.n;u++)i=t.col[u],a=e.col_ref[u],e.c_value[a]=i.mipx;else c(e!=e);for(s=e.top;s!=null;s=s.link)c(s.func!=null),c(s.func(e,s.info)==0)}function dc(e,t){var n,r,i,s,o,u,a;c(e.orig_dir==t.dir),e.orig_dir==xi?o=1:e.orig_dir==Ti?o=-1:c(e!=e),c(e.orig_m==t.m),c(e.orig_n==t.n),c(e.orig_nnz==t.nnz);if(e.sol==zi){t.valid=0,t.pbs_stat=e.p_stat,t.dbs_stat=e.d_stat,t.obj_val=t.c0,t.some=0;for(i=1;i<=t.m;i++)n=t.row[i],n.stat=e.r_stat[i],e.scaling?n.dual=o*e.r_pi[i]*n.rii:n.dual=o*e.r_pi[i],n.stat==Di?n.dual=0:n.stat==Pi?(c(n.type==Ai||n.type==Mi),n.prim=n.lb):n.stat==Hi?(c(n.type==Oi||n.type==Mi),n.prim=n.ub):n.stat==Bi?(c(n.type==Li),n.prim=0):n.stat==ji?(c(n.type==_i),n.prim=n.lb):c(n!=n);for(s=1;s<=t.n;s++)r=t.col[s],r.stat=e.c_stat[s],e.scaling?r.prim=e.c_value[s]*r.sjj:r.prim=e.c_value[s],r.stat==Di?r.dual=0:r.stat==Pi?(c(r.type==Ai||r.type==Mi),r.prim=r.lb):r.stat==Hi?(c(r.type==Oi||r.type==Mi),r.prim=r.ub):r.stat==Bi?(c(r.type==Li),r.prim=0):r.stat==ji?(c(r.type==_i),r.prim=r.lb):c(r!=r),t.obj_val+=r.coef*r.prim;for(i=1;i<=t.m;i++){n=t.row[i];if(n.stat==Di){a=0;for(u=n.ptr;u!=null;u=u.r_next)a+=u.val*u.col.prim;n.prim=a}}for(s=1;s<=t.n;s++){r=t.col[s];if(r.stat!=Di){a=r.coef;for(u=r.ptr;u!=null;u=u.c_next)a-=u.val*u.row.dual;r.dual=a}}}else if(e.sol==Wi){t.ipt_stat=e.t_stat,t.ipt_obj=t.c0;for(i=1;i<=t.m;i++)n=t.row[i],e.scaling?n.dval=o*e.r_pi[i]*n.rii:n.dval=o*e.r_pi[i];for(s=1;s<=t.n;s++)r=t.col[s],e.scaling?r.pval=e.c_value[s]*r.sjj:r.pval=e.c_value[s],t.ipt_obj+=r.coef*r.pval;for(i=1;i<=t.m;i++){n=t.row[i],a=0;for(u=n.ptr;u!=null;u=u.r_next)a+=u.val*u.col.pval;n.pval=a}for(s=1;s<=t.n;s++){r=t.col[s],a=r.coef;for(u=r.ptr;u!=null;u=u.c_next)a-=u.val*u.row.dval;r.dval=a}}else if(e.sol==Xi){c(!e.scaling),t.mip_stat=e.i_stat,t.mip_obj=t.c0;for(s=1;s<=t.n;s++)r=t.col[s],r.mipx=e.c_value[s],r.kind==Ci&&c(r.mipx==Math.floor(r.mipx)),t.mip_obj+=r.coef*r.mipx;for(i=1;i<=t.m;i++){n=t.row[i],a=0;for(u=n.ptr;u!=null;u=u.r_next)a+=u.val*u.col.mipx;n.mipx=a}}else c(e!=e)}function vc(e,t){var r;c(t.lb==-n&&t.ub==+n),r=oc(e,function(e,t){return e.sol==zi&&(e.r_stat[t.p]=Di),e.sol!=Xi&&(e.r_pi[t.p]=0),0}),r.p=t.i,ac(e,t)}function mc(e,t){var r,i;c(t.lb!=-n),c(t.lb<t.ub),i=nc(e),i.lb=0,i.ub=t.ub==+n?+n:t.ub-t.lb,rc(t,i,-1),r=oc(e,function(t,n){if(t.sol==zi)if(t.r_stat[n.p]==Di){if(t.c_stat[n.s]==Di)return Xl(),1;if(t.c_stat[n.s]!=Pi&&t.c_stat[n.s]!=Hi)return Xl(),1;t.r_stat[n.p]=Di}else{if(t.r_stat[n.p]!=ji)return Xl(),1;if(t.c_stat[n.s]==Di)t.r_stat[n.p]=Di;else if(t.c_stat[n.s]==Pi)t.r_stat[n.p]=Pi;else{if(t.c_stat[n.s]!=Hi)return Xl(),1;t.r_stat[n.p]=Hi}}return 0}),r.p=t.i,r.s=i.j,t.ub=t.lb}function gc(e,t){var r,i;c(t.ub!=+n),c(t.lb<t.ub),i=nc(e),i.lb=0,i.ub=t.lb==-n?+n:t.ub-t.lb,rc(t,i,1),r=oc(e,function(e,t){if(e.sol==zi)if(e.r_stat[t.p]==Di){if(e.c_stat[t.s]==Di)return Xl(),1;if(e.c_stat[t.s]!=Pi&&e.c_stat[t.s]!=Hi)return Xl(),1;e.r_stat[t.p]=Di}else{if(e.r_stat[t.p]!=ji)return Xl(),1;if(e.c_stat[t.s]==Di)e.r_stat[t.p]=Di;else if(e.c_stat[t.s]==Pi)e.r_stat[t.p]=Hi;else{if(e.c_stat[t.s]!=Hi)return Xl(),1;e.r_stat[t.p]=Pi}}return 0}),r.p=t.i,r.s=i.j,t.lb=t.ub}function yc(e,t){var r,i,s;c(t.lb==-n&&t.ub==+n),t.lb=0,t.ub=+n,i=nc(e),i.is_int=t.is_int,i.lb=0,i.ub=+n,i.coef=-t.coef;for(s=t.ptr;s!=null;s=s.c_next)rc(s.row,i,-s.val);r=oc(e,function(e,t){if(e.sol==zi)if(e.c_stat[t.q]==Di){if(e.c_stat[t.s]==Di)return Xl(),1;if(e.c_stat[t.s]!=Pi)return Xl(),-1;e.c_stat[t.q]=Di}else{if(e.c_stat[t.q]!=Pi)return Xl(),-1;if(e.c_stat[t.s]==Di)e.c_stat[t.q]=Di;else{if(e.c_stat[t.s]!=Pi)return Xl(),-1;e.c_stat[t.q]=Bi}}return e.c_value[t.q]-=e.c_value[t.s],0}),r.q=t.j,r.s=i.j}function bc(e,t){var r,i,s;c(t.lb!=0),c(t.lb!=-n),c(t.lb<t.ub),r=oc(e,function(e,t){if(e.sol==zi){if(e.c_stat[t.q]!=Di&&e.c_stat[t.q]!=Pi&&e.c_stat[t.q]!=Hi)return Xl(),1;e.c_stat[t.q]=e.c_stat[t.q]}return e.c_value[t.q]=t.bnd+e.c_value[t.q],0}),r.q=t.j,r.bnd=t.lb,e.c0+=t.coef*t.lb;for(s=t.ptr;s!=null;s=s.c_next)i=s.row,i.lb==i.ub?i.ub=i.lb-=s.val*t.lb:(i.lb!=-n&&(i.lb-=s.val*t.lb),i.ub!=+n&&(i.ub-=s.val*t.lb));t.ub!=+n&&(t.ub-=t.lb),t.lb=0}function wc(e,t){var r,i,s;c(t.ub!=+n),c(t.lb<t.ub),r=oc(e,function(e,t){if(e.sol==Di)if(e.c_stat[t.q]==Di)e.c_stat[t.q]=Di;else if(e.c_stat[t.q]==Pi)e.c_stat[t.q]=Hi;else{if(e.c_stat[t.q]!=Hi)return Xl(),1;e.c_stat[t.q]=Pi}return e.c_value[t.q]=t.bnd-e.c_value[t.q],0}),r.q=t.j,r.bnd=t.ub,e.c0+=t.coef*t.ub,t.coef=-t.coef;for(s=t.ptr;s!=null;s=s.c_next)i=s.row,i.lb==i.ub?i.ub=i.lb-=s.val*t.ub:(i.lb!=-n&&(i.lb-=s.val*t.ub),i.ub!=+n&&(i.ub-=s.val*t.ub)),s.val=-s.val;t.lb!=-n?t.ub-=t.lb:t.ub=+n,t.lb=0}function Ec(e,t){var r,i,s;c(t.lb==0),c(t.ub>0),c(t.ub!=+n),s=nc(e),s.is_int=t.is_int,s.lb=0,s.ub=+n,i=tc(e),i.lb=i.ub=t.ub,rc(i,t,1),rc(i,s,1),r=oc(e,function(e,t){if(e.sol==Di)if(e.c_stat[t.q]==Di)if(e.c_stat[t.s]==Di)e.c_stat[t.q]=Di;else{if(e.c_stat[t.s]!=Pi)return Xl(),1;e.c_stat[t.q]=Hi}else{if(e.c_stat[t.q]!=Pi)return Xl(),1;if(e.c_stat[t.s]!=Di&&e.c_stat[t.s]!=Pi)return Xl(),1;e.c_stat[t.q]=Pi}return 0}),r.q=t.j,r.s=s.j,t.ub=+n}function Sc(e,t){var r,i,s;c(t.lb==t.ub),r=oc(e,function(e,t){return e.sol==zi&&(e.c_stat[t.q]=ji),e.c_value[t.q]=t.s,0}),r.q=t.j,r.s=t.lb,e.c0+=t.coef*t.lb;for(s=t.ptr;s!=null;s=s.c_next)i=s.row,i.lb==i.ub?i.ub=i.lb-=s.val*t.lb:(i.lb!=-n&&(i.lb-=s.val*t.lb),i.ub!=+n&&(i.ub-=s.val*t.lb));fc(e,t)}function xc(e,t){var r,i,s,o;return c(t.lb!=-n),c(t.ub!=+n),c(t.lb<t.ub),s=1e-9+1e-12*Math.abs(t.lb),t.ub-t.lb>s?0:(r=oc(e,function(e,t){if(e.sol==zi)if(e.r_stat[t.p]==Di)e.r_stat[t.p]=Di;else{if(e.r_stat[t.p]!=ji)return Xl(),1;e.r_pi[t.p]>=0?e.r_stat[t.p]=Pi:e.r_stat[t.p]=Hi}return 0}),r.p=t.i,i=.5*(t.ub+t.lb),o=Math.floor(i+.5),Math.abs(i-o)<=s&&(i=o),t.lb=t.ub=i,1)}function Tc(e,t){var r,i,s,o,u,a;c(t.lb!=-n),c(t.ub!=+n),c(t.lb<t.ub),u=1e-9+1e-12*Math.abs(t.lb);if(t.ub-t.lb>u)return 0;r=oc(e,function(e,t){var n,r;if(e.sol==zi)if(e.c_stat[t.q]==Di)e.c_stat[t.q]=Di;else{if(e.c_stat[t.q]!=ji)return Xl(),1;r=t.c;for(n=t.ptr;n!=null;n=n.next)r-=n.val*e.r_pi[n.ref];r>=0?e.c_stat[t.q]=Pi:e.c_stat[t.q]=Hi}return 0}),r.q=t.j,r.c=t.coef,r.ptr=null;if(e.sol==zi)for(i=t.ptr;i!=null;i=i.c_next)s={},s.ref=i.row.i,s.val=i.val,s.next=r.ptr,r.ptr=s;return o=.5*(t.ub+t.lb),a=Math.floor(o+.5),Math.abs(o-a)<=u&&(o=a),t.lb=t.ub=o,1}function Nc(e,t){var r=.001;return c(t.ptr==null),t.lb>+r||t.ub<-r?1:(t.lb=-n,t.ub=+n,vc(e,t),0)}function Cc(e,t){function o(){r.stat=Pi,t.ub=t.lb}function u(){r.stat=Hi,t.lb=t.ub}var r,s=.001;return c(t.ptr==null),t.coef>+s&&t.lb==-n?1:t.coef<-s&&t.ub==+n?1:(r=oc(e,function(e,t){return e.sol==zi&&(e.c_stat[t.q]=t.stat),0}),r.q=t.j,t.lb==-n&&t.ub==+n?(r.stat=Bi,t.lb=t.ub=0):t.ub==+n?o():t.lb==-n?u():t.lb!=t.ub?t.coef>=+i?o():t.coef<=-i?u():Math.abs(t.lb)<=Math.abs(t.ub)?o():u():r.stat=ji,Sc(e,t),0)}function kc(e,t,r){var i,s;c(e==e),c(t.lb<t.ub);if(t.is_int){s=Math.floor(r+.5);if(!(Math.abs(r-s)<=1e-5))return 2;r=s}if(t.lb!=-n){i=t.is_int?1e-5:1e-5+1e-8*Math.abs(t.lb);if(r<t.lb-i)return 1;if(r<t.lb+.001*i)return t.ub=t.lb,0}if(t.ub!=+n){i=t.is_int?1e-5:1e-5+1e-8*Math.abs(t.ub);if(r>t.ub+i)return 1;if(r>t.ub-.001*i)return t.lb=t.ub,0}return t.lb=t.ub=r,0}function Lc(e,t){var n,r,i,s,o,u;c(t.lb==t.ub),c(t.ptr!=null&&t.ptr.r_next==null),i=t.ptr,r=i.col,u=t.lb/i.val,o=kc(e,r,u),c(0<=o&&o<=2);if(o!=0)return o;n=oc(e,function(e,t){var n,r;if(e.sol==zi){if(e.c_stat[t.q]!=ji)return Xl(),1;e.r_stat[t.p]=ji,e.c_stat[t.q]=Di}if(e.sol!=Xi){r=t.c;for(n=t.ptr;n!=null;n=n.next)r-=n.val*e.r_pi[n.ref];e.r_pi[t.p]=r/t.apq}return 0}),n.p=t.i,n.q=r.j,n.apq=i.val,n.c=r.coef,n.ptr=null;if(e.sol!=Xi)for(i=r.ptr;i!=null;i=i.c_next){if(i.row==t)continue;s={},s.ref=i.row.i,s.val=i.val,s.next=n.ptr,n.ptr=s}return ac(e,t),0}function Ac(e,t,r){var i,s,o;c(e==e),c(t.lb<t.ub),c(r!=-n),t.is_int&&(o=Math.floor(r+.5),Math.abs(r-o)<=1e-5?r=o:r=Math.ceil(r));if(t.lb!=-n){s=t.is_int?.001:.001+1e-6*Math.abs(t.lb);if(r<t.lb+s)return i=0,i}if(t.ub!=+n){s=t.is_int?1e-5:1e-5+1e-8*Math.abs(t.ub);if(r>t.ub+s)return i=4,i;if(r>t.ub-.001*s)return t.lb=t.ub,i=3,i}return t.lb==-n?i=2:t.is_int&&r>t.lb+.5?i=2:r>t.lb+.3*(1+Math.abs(t.lb))?i=2:i=1,t.lb=r,i}function Oc(e,t,r){var i,s,o;c(e==e),c(t.lb<t.ub),c(r!=+n),t.is_int&&(o=Math.floor(r+.5),Math.abs(r-o)<=1e-5?r=o:r=Math.floor(r));if(t.ub!=+n){s=t.is_int?.001:.001+1e-6*Math.abs(t.ub);if(r>t.ub-s)return i=0,i}if(t.lb!=-n){s=t.is_int?1e-5:1e-5+1e-8*Math.abs(t.lb);if(r<t.lb-s)return i=4,i;if(r<t.lb+.001*s)return t.ub=t.lb,i=3,i}return t.ub==+n?i=2:t.is_int&&r<t.ub-.5?i=2:r<t.ub-.3*(1+Math.abs(t.ub))?i=2:i=1,t.ub=r,i}function Mc(e,t){var r,s,o,u,a,f,l,h,p;c(t.lb!=-n||t.ub!=+n),c(t.lb<t.ub),c(t.ptr!=null&&t.ptr.r_next==null),o=t.ptr,s=o.col,c(s.lb<s.ub),o.val>0?(h=t.lb==-n?-n:t.lb/o.val,p=t.ub==+n?+n:t.ub/o.val):(h=t.ub==+n?-n:t.ub/o.val,p=t.lb==-n?+n:t.lb/o.val);if(h==-n)f=0;else{f=Ac(e,s,h),c(0<=f&&f<=4);if(f==4)return 4}if(p==+n)l=0;else if(f==3)l=0;else{l=Oc(e,s,p),c(0<=l&&l<=4);if(l==4)return 4}if(!f&&!l)return t.lb=-n,t.ub=+n,vc(e,t),0;r=oc(e,function(e,t){var r,s;if(e.sol==Xi)return 0;s=t.c;for(r=t.ptr;r!=null;r=r.next)s-=r.val*e.r_pi[r.ref];if(e.sol==zi){function o(){return t.lb_changed?(e.r_stat[t.p]=t.apq>0?Pi:Hi,e.c_stat[t.q]=Di,e.r_pi[t.p]=s/t.apq):(e.r_stat[t.p]=Di,e.r_pi[t.p]=0),0}function u(){return t.ub_changed?(e.r_stat[t.p]=t.apq>0?Hi:Pi,e.c_stat[t.q]=Di,e.r_pi[t.p]=s/t.apq):(e.r_stat[t.p]=Di,e.r_pi[t.p]=0),0}if(e.c_stat[t.q]==Di)e.r_stat[t.p]=Di,e.r_pi[t.p]=0;else if(e.c_stat[t.q]==Pi)o();else if(e.c_stat[t.q]==Hi)u();else{if(e.c_stat[t.q]!=ji)return Xl(),1;if(s>1e-7)if(t.apq>0&&t.lb!=-n||t.apq<0&&t.ub!=+n||!t.lb_changed)return e.c_stat[t.q]=Pi,o();if(s<-1e-7)if(t.apq>0&&t.ub!=+n||t.apq<0&&t.lb!=-n||!t.ub_changed)return e.c_stat[t.q]=Hi,u();if(t.lb!=-n&&t.ub==+n)e.r_stat[t.p]=Pi;else if(t.lb==-n&&t.ub!=+n)e.r_stat[t.p]=Hi;else{if(t.lb==-n||t.ub==+n)return Xl(),1;t.apq*e.c_value[t.q]<=.5*(t.lb+t.ub)?e.r_stat[t.p]=Pi:e.r_stat[t.p]=Hi}e.c_stat[t.q]=Di,e.r_pi[t.p]=s/t.apq}}return e.sol==Wi&&(s>+i&&t.lb_changed||s<-i&&t.ub_changed?e.r_pi[t.p]=s/t.apq:e.r_pi[t.p]=0),0}),r.p=t.i,r.q=s.j,r.apq=o.val,r.c=s.coef,r.lb=t.lb,r.ub=t.ub,r.lb_changed=f,r.ub_changed=l,r.ptr=null;if(e.sol!=Xi)for(u=s.ptr;u!=null;u=u.c_next){if(u==o)continue;a={},a.ref=u.row.i,a.val=u.val,a.next=r.ptr,r.ptr=a}return ac(e,t),f>=l?f:l}function _c(e,t){var r,i,s,o;c(!t.is_int),c(t.lb<t.ub),c(t.ptr!=null&&t.ptr.c_next==null),s=t.ptr,i=s.row,c(i.lb==i.ub),r=oc(e,function(e,t){var n,r;if(e.sol==zi){if(e.r_stat[t.p]==Di||e.r_stat[t.p]==Bi)e.c_stat[t.q]=e.r_stat[t.p];else if(e.r_stat[t.p]==Pi)e.c_stat[t.q]=t.apq>0?Hi:Pi;else{if(e.r_stat[t.p]!=Hi)return Xl(),1;e.c_stat[t.q]=t.apq>0?Pi:Hi}e.r_stat[t.p]=ji}e.sol!=Xi&&(e.r_pi[t.p]+=t.c/t.apq),n=t.b;for(r=t.ptr;r!=null;r=r.next)n-=r.val*e.c_value[r.ref];return e.c_value[t.q]=n/t.apq,0}),r.p=i.i,r.q=t.j,r.apq=s.val,r.b=i.lb,r.c=t.coef,r.ptr=null;for(s=i.ptr;s!=null;s=s.r_next){if(s.col==t)continue;o={},o.ref=s.col.j,o.val=s.val,o.next=r.ptr,r.ptr=o,s.col.coef-=r.c*(s.val/r.apq)}e.c0+=r.c*(r.b/r.apq),r.apq>0?(i.lb=t.ub==+n?-n:r.b-r.apq*t.ub,i.ub=t.lb==-n?+n:r.b-r.apq*t.lb):(i.lb=t.lb==-n?-n:r.b-r.apq*t.lb,i.ub=t.ub==+n?+n:r.b-r.apq*t.ub),fc(e,t)}function Dc(e,t){function v(){r.stat=Pi,s.ub=s.lb}function m(){r.stat=Hi,s.lb=s.ub}var r,s,o,u,a,f,l,h,p,d;c(t.lb<t.ub),c(t.ptr!=null&&t.ptr.c_next==null),o=t.ptr,s=o.row,c(s.lb!=-n||s.ub!=+n),c(s.lb<s.ub),a=s.lb;if(a!=-n)for(u=s.ptr;u!=null;u=u.r_next){if(u==o)continue;if(u.val>0){if(u.col.ub==+n){a=-n;break}a-=u.val*u.col.ub}else{if(u.col.lb==-n){a=-n;break}a-=u.val*u.col.lb}}f=s.ub;if(f!=+n)for(u=s.ptr;u!=null;u=u.r_next){if(u==o)continue;if(u.val>0){if(u.col.lb==-n){f=+n;break}f-=u.val*u.col.lb}else{if(u.col.ub==+n){f=+n;break}f-=u.val*u.col.ub}}o.val>0?l=a==-n?-n:a/o.val:l=f==+n?-n:f/o.val,o.val>0?h=f==+n?+n:f/o.val:h=a==-n?+n:a/o.val;if(t.lb!=-n){d=1e-9+1e-12*Math.abs(t.lb);if(l<t.lb-d)return 1}if(t.ub!=+n){d=1e-9+1e-12*Math.abs(t.ub);if(h>t.ub+d)return 1}t.lb=-n,t.ub=+n,r=oc(e,function(e,t){if(e.sol==zi)if(e.r_stat[t.p]==Di)e.r_stat[t.p]=Di;else{if(e.r_stat[t.p]!=ji)return Xl(),1;c(t.stat==Pi||t.stat==Hi),e.r_stat[t.p]=t.stat}return 0}),r.p=s.i,r.stat=-1,p=t.coef/o.val;if(p>+i)if(s.lb!=-n)v();else{if(p>1e-5)return 2;c(s.ub!=+n),m()}else if(p<-i)if(s.ub!=+n)m();else{if(p<-0.00001)return 2;c(s.lb!=-n),v()}else s.ub==+n?(c(s.lb!=-n),v()):s.lb==-n?(c(s.ub!=+n),m()):Math.abs(s.lb)<=Math.abs(s.ub)?v():m();return 0}function Pc(e,t){var r,i,s,o,u,a,f,l,h,p,d;c(t.lb==t.ub),c(t.ptr!=null&&t.ptr.r_next!=null&&t.ptr.r_next.r_next==null);var v,m;v=t.ptr,m=v.r_next,Math.abs(m.val)<.001*Math.abs(v.val)?(u=v,a=m):Math.abs(v.val)<.001*Math.abs(m.val)?(u=m,a=v):sc(v.col)<=sc(m.col)?(u=v,a=m):(u=m,a=v),s=u.col,o=a.col,r=oc(e,function(e,t){var n,r,i;if(e.sol==zi&&e.r_stat[t.p]!=ji)return Xl(),1;if(e.sol!=Xi){i=e.r_pi[t.p];for(n=t.ptr;n!=null;n=n.next)r=n.val/t.apq,i-=r*e.r_pi[n.ref];e.r_pi[t.p]=i}return 0}),r.p=t.i,r.apq=u.val,r.ptr=null;for(f=s.ptr;f!=null;f=h){h=f.c_next;if(f==u)continue;i=f.row,e.sol!=Xi&&(p={},p.ref=i.i,p.val=f.val,p.next=r.ptr,r.ptr=p);for(l=i.ptr;l!=null;l=l.r_next)if(l.col==o)break;l==null&&(l=rc(i,o,0)),d=f.val/u.val,lc(f),l.val-=d*a.val,Math.abs(l.val)<=1e-10&&lc(l),i.lb==i.ub?i.lb=i.ub=i.lb-d*t.lb:(i.lb!=-n&&(i.lb-=d*t.lb),i.ub!=+n&&(i.ub-=d*t.lb))}return s}function Hc(e,t,r){var i,s=null,o,u,a,f,l;c(r==0||r==1),l=1;for(u=t.ptr;u!=null;u=u.r_next)l<Math.abs(u.val)&&(l=Math.abs(u.val));for(u=t.ptr;u!=null;u=u.r_next)if(Math.abs(u.val)<1e-7*l)return 1;i=oc(e,function(e,t){var n,r,i,s,o,u;if(e.sol==Xi)return 0;if(e.sol==zi){if(e.r_stat[t.p]!=Di)return Xl(),1;for(n=t.ptr;n!=null;n=n.next){if(e.c_stat[n.j]!=ji)return Xl(),1;e.c_stat[n.j]=n.stat}}for(n=t.ptr;n!=null;n=n.next){s=n.c;for(i=n.ptr;i!=null;i=i.next)s-=i.val*e.r_pi[i.ref];n.c=s}r=null,o=0;for(n=t.ptr;n!=null;n=n.next){s=n.c,u=Math.abs(s/n.a);if(n.stat==Pi)s<0&&o<u&&(r=n,o=u);else{if(n.stat!=Hi)return Xl(),1;s>0&&o<u&&(r=n,o=u)}}return r!=null&&(e.sol==zi&&(e.r_stat[t.p]=t.stat,e.c_stat[r.j]=Di),e.r_pi[t.p]=r.c/r.a),0}),i.p=t.i,t.lb==t.ub?i.stat=ji:r==0?(i.stat=Pi,c(t.lb!=-n)):(i.stat=Hi,c(t.ub!=+n)),i.ptr=null;for(u=t.ptr;u!=null;u=u.r_next){o=u.col,c(o.lb<o.ub),e.sol!=Xi&&(s={},s.j=o.j,s.stat=-1,s.a=u.val,s.c=o.coef,s.ptr=null,s.next=i.ptr,i.ptr=s),r==0&&u.val<0||r!=0&&u.val>0?(e.sol!=Xi&&(s.stat=Pi),c(o.lb!=-n),o.ub=o.lb):(e.sol!=Xi&&(s.stat=Hi),c(o.ub!=+n),o.lb=o.ub);if(e.sol!=Xi)for(a=o.ptr;a!=null;a=a.c_next){if(a==u)continue;f={},f.ref=a.row.i,f.val=a.val,f.next=s.ptr,s.ptr=f}}return t.lb=-n,t.ub=+n,0}function Bc(e,t){var r,i=0,s,o,u;c(e==e),s=0;for(r=t.ptr;r!=null;r=r.r_next)if(r.val>0){if(r.col.lb==-n){s=-n;break}s+=r.val*r.col.lb}else{if(r.col.ub==+n){s=-n;break}s+=r.val*r.col.ub}o=0;for(r=t.ptr;r!=null;r=r.r_next)if(r.val>0){if(r.col.ub==+n){o=+n;break}o+=r.val*r.col.ub}else{if(r.col.lb==-n){o=+n;break}o+=r.val*r.col.lb}if(t.lb!=-n){u=.001+1e-6*Math.abs(t.lb);if(t.lb-u>o)return i=51,i}if(t.ub!=+n){u=.001+1e-6*Math.abs(t.ub);if(t.ub+u<s)return i=51,i}return t.lb!=-n&&(u=1e-9+1e-12*Math.abs(t.lb),t.lb-u>s&&(t.lb+u<=o?i|=1:i|=2)),t.ub!=+n&&(u=1e-9+1e-12*Math.abs(t.ub),t.ub+u<o&&(t.ub-u>=s?i|=16:i|=32)),i}function jc(e,t,r){var i;e.sol==zi&&(i=oc(e,function(e,t){return e.sol!=zi?(Xl(),1):(e.r_stat[t.p]==Di?e.r_stat[t.p]=Di:e.r_stat[t.p]=t.stat,0)}),i.p=t.i,t.ub==+n?i.stat=Pi:t.lb==-n?i.stat=Hi:t.lb!=t.ub?i.stat=r==0?Hi:Pi:i.stat=ji),r==0?(c(t.lb!=-n),t.lb=-n):r==1?(c(t.ub!=+n),t.ub=+n):c(r!=r)}function Fc(e,t){var r,i,s,o,u,a=!1;c(e==e),s=1;for(r=t.ptr;r!=null;r=r.r_next)r.col.ll.ll=-n,r.col.uu.uu=+n,s<Math.abs(r.val)&&(s=Math.abs(r.val));o=1e-6*s;if(t.lb!=-n){i=null;for(r=t.ptr;r!=null;r=r.r_next)if(r.val>0&&r.col.ub==+n||r.val<0&&r.col.lb==-n){if(i!=null){a=!0;break}i=r}if(!a){u=t.lb;for(r=t.ptr;r!=null;r=r.r_next)r!=i&&(r.val>0?u-=r.val*r.col.ub:u-=r.val*r.col.lb);if(i==null)for(r=t.ptr;r!=null;r=r.r_next)r.val>=+o?r.col.ll.ll=r.col.ub+u/r.val:r.val<=-o&&(r.col.uu.uu=r.col.lb+u/r.val);else i.val>=+o?i.col.ll.ll=u/i.val:i.val<=-o&&(i.col.uu.uu=u/i.val)}}a=!1;if(t.ub!=+n){i=null;for(r=t.ptr;r!=null;r=r.r_next)if(r.val>0&&r.col.lb==-n||r.val<0&&r.col.ub==+n){if(i!=null){a=!0;break}i=r}if(!a){u=t.ub;for(r=t.ptr;r!=null;r=r.r_next)r!=i&&(r.val>0?u-=r.val*r.col.lb:u-=r.val*r.col.ub);if(i==null)for(r=t.ptr;r!=null;r=r.r_next)r.val>=+o?r.col.uu.uu=r.col.lb+u/r.val:r.val<=-o&&(r.col.ll.ll=r.col.ub+u/r.val);else i.val>=+o?i.col.uu.uu=u/i.val:i.val<=-o&&(i.col.ll.ll=u/i.val)}}}function Ic(e){var t,r,i,s,o,u,a,f,l,p,d,v,m;p=d=v=m=0;for(i=e.c_tail;i!=null;i=i.prev){if(!i.is_int)continue;if(i.lb==i.ub)continue;if(i.lb==0&&i.ub==1)continue;if(i.lb<-1e6||i.ub>1e6||i.ub-i.lb>4095){p++;continue}d++,i.lb!=0&&bc(e,i),c(i.lb==0),u=i.ub,c(i.ub==u);if(u==1)continue;a=2,l=4;while(u>=l)a++,l+=l;v+=a,t=oc(e,function(e,t){var n,r,i=e.c_value[t.q];for(n=1,r=2;n<t.n;n++,r+=r)i+=r*e.c_value[t.j+(n-1)];return e.c_value[t.q]=i,0}),t.q=i.j,t.j=0,t.n=a,u<l-1?(r=tc(e),m++,r.lb=-n,r.ub=u):r=null,i.ub=1,r!=null&&rc(r,i,1);for(f=1,l=2;f<a;f++,l+=l){s=nc(e),s.is_int=1,s.lb=0,s.ub=1,s.coef=l*i.coef,t.j==0?t.j=s.j:c(t.j+(f-1)==s.j);for(o=i.ptr;o!=null;o=o.c_next)rc(o.row,s,l*o.val)}}return d>0&&h(d+" integer variable(s) were replaced by "+v+" binary ones"),m>0&&h(m+" row(s) were added due to binarization"),p>0&&h("Binarization failed for "+p+" integer variable(s)"),p}function qc(e,t){var n,r,i;r=null;for(n=e.ptr;n!=null;n=n.r_next)i={},i.aj=t*n.val,i.xj=n.col,i.next=r,r=i;return r}function Rc(e,t){var r,i,s;c(e==e);if(t.lb!=-n||t.ub==+n)return 0;s=1;for(i=t.ptr;i!=null;i=i.r_next){r=i.col;if(!r.is_int||r.lb!=0||r.ub!=1)return 0;if(i.val!=+1){if(i.val!=-1)return 0;s--}}return t.ub!=s?0:1}function Uc(e,t,n,r){var i,s,o,u,a;c(e==e);for(i=t;i!=null;i=i.next)c(i.aj!=0),c(i.xj.is_int),c(i.xj.lb==0&&i.xj.ub==1);u=0;for(i=t;i!=null;i=i.next)if(i.aj!=+1){if(i.aj!=-1)break;u++}if(i==null&&n==1-u)return 1;for(i=t;i!=null;i=i.next)i.aj<0&&(n-=i.aj);for(i=t;i!=null;i=i.next)if(Math.abs(i.aj)>n)return 0;s=null;for(i=t;i!=null;i=i.next)if(s==null||Math.abs(s.aj)>Math.abs(i.aj))s=i;c(s!=null),o=null;for(i=t;i!=null;i=i.next)i!=s&&(o==null||Math.abs(o.aj)>Math.abs(i.aj))&&(o=i);c(o!=null),a=.001+1e-6*Math.abs(n);if(Math.abs(s.aj)+Math.abs(o.aj)<=n+a)return 0;n=1;for(i=t;i!=null;i=i.next)i.aj>0?i.aj=1:(i.aj=-1,n-=1);return r(n),2}function zc(e,r){var i,s,o,u,a,f,l=0,p;c(r.lb<r.ub);for(a=0;a<=1;a++){if(a==0){if(r.ub==+n)continue;o=qc(r,1),p=+r.ub}else{if(r.lb==-n)continue;o=qc(r,-1),p=-r.lb}f=Uc(e,o,p,function(e){p=e}),c(0<=f&&f<=2);if(a==1&&f==1||f==2){l++;if(t){h("Original constraint:");for(s=r.ptr;s!=null;s=s.r_next)h(" "+s.val+" x"+s.col.j);r.lb!=-n&&h(", >= "+r.lb),r.ub!=+n&&h(", <= "+r.ub),h(""),h("Equivalent packing inequality:");for(u=o;u!=null;u=u.next)h(" "+(u.aj>0?"+":"-")+"x"+u.xj.j);h(", <= "+p+"")}if(r.lb==-n||r.ub==+n)i=null;else{i=tc(e),a==0?(i.lb=r.lb,i.ub=+n):(i.lb=-n,i.ub=r.ub);for(s=r.ptr;s!=null;s=s.r_next)rc(i,s.col,s.val)}uc(r),r.lb=-n,r.ub=p;for(u=o;u!=null;u=u.next)rc(r,u.xj,u.aj);i!=null&&(r=i)}}return l}function Wc(e,t,r,i){var s,o,u,a,f=0,l,h;t==0?(s=qc(e,-1),c(e.lb!=-n),l=-e.lb):t==1&&(s=qc(e,1),c(e.ub!=+n),l=+e.ub);for(o=s;o!=null;o=o.next)if(!o.xj.is_int||o.xj.lb!=0||o.xj.ub!=1){if(o.aj>0){if(o.xj.lb==-n)return f;l-=o.aj*o.xj.lb}else{if(o.xj.ub==+n)return f;l-=o.aj*o.xj.ub}o.aj=0}for(o=s;o!=null;o=o.next)o.aj<0&&(l-=o.aj);if(l<.001)return f;h=.001+1e-6*l,u=a=null;for(o=s;o!=null;o=o.next)if(Math.abs(o.aj)>.5*(l+h)){r[++f]=o.xj,i[f]=o.aj>0?0:1;if(u==null||Math.abs(u.aj)>Math.abs(o.aj))u=o}else Math.abs(o.aj)>=.001&&(a==null||Math.abs(a.aj)<Math.abs(o.aj))&&(a=o);return u!=null&&a!=null&&Math.abs(u.aj)+Math.abs(a.aj)>l+h&&(r[++f]=a.xj,i[f]=a.aj>0?0:1),f<2&&(f=0),f}function Xc(e,t){var r,i,s;c(e==e);if(t.lb==-n||t.ub!=+n)return 0;s=1;for(i=t.ptr;i!=null;i=i.r_next){r=i.col;if(!r.is_int||r.lb!=0||r.ub!=1)return 0;if(i.val!=+1){if(i.val!=-1)return 0;s--}}return t.lb!=s?0:1}function Vc(e,t,n,r){var i,s,o;c(e==e);for(i=t;i!=null;i=i.next)c(i.aj!=0),c(i.xj.is_int),c(i.xj.lb==0&&i.xj.ub==1);s=0;for(i=t;i!=null;i=i.next)if(i.aj!=+1){if(i.aj!=-1)break;s++}if(i==null&&n==1-s)return 1;for(i=t;i!=null;i=i.next)i.aj<0&&(n-=i.aj);if(n<.001)return 0;o=1e-9+1e-12*Math.abs(n);for(i=t;i!=null;i=i.next)if(Math.abs(i.aj)<n-o)return 0;n=1;for(i=t;i!=null;i=i.next)i.aj>0?i.aj=1:(i.aj=-1,n-=1);return r(n),2}function $c(e,r){var i,s,o,u,a,f,l=0,p;c(r.lb<r.ub);for(a=0;a<=1;a++){if(a==0){if(r.lb==-n)continue;o=qc(r,1),p=+r.lb}else{if(r.ub==+n)continue;o=qc(r,-1),p=-r.ub}f=Vc(e,o,p,function(e){p=e}),c(0<=f&&f<=2);if(a==1&&f==1||f==2){l++;if(t){h("Original constraint:");for(s=r.ptr;s!=null;s=s.r_next)h(" "+s.val+" x"+s.col.j);r.lb!=-n&&h(", >= "+r.lb),r.ub!=+n&&h(", <= "+r.ub),h(""),h("Equivalent covering inequality:");for(u=o;u!=null;u=u.next)h(" "+(u.aj>0?"+":"-")+"x"+u.xj.j);h(", >= "+p+"")}if(r.lb==-n||r.ub==+n)i=null;else{i=tc(e),a==0?(i.lb=-n,i.ub=r.ub):(i.lb=r.lb,i.ub=+n);for(s=r.ptr;s!=null;s=s.r_next)rc(i,s.col,s.val)}uc(r),r.lb=p,r.ub=+n;for(u=o;u!=null;u=u.next)rc(r,u.xj,u.aj);i!=null&&(r=i)}}return l}function Jc(e,t){var n,r,i;c(e==e);if(t.lb!=t.ub)return 0;i=1;for(r=t.ptr;r!=null;r=r.r_next){n=r.col;if(!n.is_int||n.lb!=0||n.ub!=1)return 0;if(r.val!=+1){if(r.val!=-1)return 0;i--}}return t.lb!=i?0:1}function Kc(e,r,i,s){var o,u=0,a,f,l;c(e==e),a=0;for(o=r;o!=null;o=o.next)if(o.aj>0){if(o.xj.lb==-n)return u;a+=o.aj*o.xj.lb}else{if(o.xj.ub==+n)return u;a+=o.aj*o.xj.ub}for(o=r;o!=null;o=o.next){if(!o.xj.is_int||o.xj.lb!=0||o.xj.ub!=1)continue;o.aj>0?(f=a,i-o.aj<f&&f<i&&(l=i-f,l>=.001&&o.aj-l>=.01*(1+o.aj)&&(t&&h("+"),o.aj=l,u++))):(f=a-o.aj,i<f&&f<i-o.aj&&(l=o.aj+(f-i),l<=-0.001&&l-o.aj>=.01*(1-o.aj)&&(t&&h("-"),o.aj=l,a+=f-i,i=f,u++)))}return s(i),u}function Qc(e,r){var i,s,o,u,a,f=new Array(2),l;c(r.lb<r.ub),f[0]=f[1]=0;for(a=0;a<=1;a++){if(a==0){if(r.lb==-n)continue;t&&h("L"),o=qc(r,1),l=+r.lb}else{if(r.ub==+n)continue;t&&h("U"),o=qc(r,-1),l=-r.ub}f[a]=Kc(e,o,l,function(e){l=e});if(f[a]>0){if(r.lb==-n||r.ub==+n)i=null;else{t&&h("*"),i=tc(e),a==0?(i.lb=-n,i.ub=r.ub):(i.lb=r.lb,i.ub=+n);for(s=r.ptr;s!=null;s=s.r_next)rc(i,s.col,s.val)}uc(r),r.lb=l,r.ub=+n;for(u=o;u!=null;u=u.next)rc(r,u.xj,u.aj);i!=null&&(r=i)}}return f[0]+f[1]}function Gc(e){var r,i,s,o,u;c(e==e);for(r=e.r_head;r!=null;r=i)i=r.next,r.lb==-n&&r.ub==+n&&(t&&h("1"),vc(e,r));for(r=e.r_head;r!=null;r=i)i=r.next,r.lb!=-n&&r.ub!=+n&&r.lb<r.ub&&(u=xc(e,r),u==1?t&&h("2"):c(u!=u));for(s=e.c_head;s!=null;s=o)o=s.next,s.lb==s.ub&&(t&&h("3"),Sc(e,s));for(s=e.c_head;s!=null;s=o)o=s.next,s.lb!=-n&&s.ub!=+n&&s.lb<s.ub&&(u=Tc(e,s),u!=0&&u==1&&(t&&h("4"),Sc(e,s)))}function Yc(e,r,i){function l(){for(o=r.ptr;o!=null;o=u){t&&h("H"),s=o.col,u=o.r_next;for(a=s.ptr;a!=null;a=a.c_next)Kl(e,a.row);Sc(e,s)}return vc(e,r),0}var s,o,u,a,f;c(r.lb!=-n||r.ub!=+n);if(r.ptr==null){f=Nc(e,r);if(f==0)return t&&h("A"),0;if(f==1)return ro;c(f!=f)}if(r.ptr.r_next==null){s=r.ptr.col;if(r.lb==r.ub){f=Lc(e,r);if(f==0){t&&h("B");for(o=s.ptr;o!=null;o=o.c_next)Kl(e,o.row);return Sc(e,s),0}if(f==1||f==2)return ro;c(f!=f)}else{f=Mc(e,r);if(0<=f&&f<=3){t&&h("C"),Zl(e,s);if(f>=2)for(o=s.ptr;o!=null;o=o.c_next)Kl(e,o.row);return f==3&&(t&&h("D"),Sc(e,s)),0}if(f==4)return ro;c(f!=f)}}f=Bc(e,r),c(0<=f&&f<=255);if(f==51)return ro;if((f&15)==0)r.lb!=-n&&(t&&h("F"),jc(e,r,0));else if((f&15)!=1)if((f&15)==2){t&&h("G");if(Hc(e,r,0)==0)return l()}else c(f!=f);if((f&240)==0)r.ub!=+n&&(t&&h("I"),jc(e,r,1));else if((f&240)!=16)if((f&240)==32){t&&h("J");if(Hc(e,r,1)==0)return l()}else c(f!=f);if(r.lb==-n&&r.ub==+n){t&&h("K");for(o=r.ptr;o!=null;o=o.r_next)Zl(e,o.col);return vc(e,r),0}return e.sol==Xi&&i&&Zc(e,r,1)<0?ro:0}function Zc(e,r,i){var s,o,u,a,f,l,p=0,d,v;c(e.sol==Xi),c(r.lb!=-n||r.ub!=+n),Fc(e,r);for(o=r.ptr;o!=null;o=u){s=o.col,u=o.r_next;for(f=0;f<=1;f++){d=s.lb,v=s.ub;if(f==0){if(s.ll.ll==-n)continue;l=Ac(e,s,s.ll.ll)}else{if(s.uu.uu==+n)continue;l=Oc(e,s,s.uu.uu)}if(l==0||l==1)s.lb=d,s.ub=v;else if(l==2||l==3){t&&h("L"),p++;if(i)for(a=s.ptr;a!=null;a=a.c_next)a.row!=r&&Kl(e,a.row);if(l==3){t&&h("M"),Sc(e,s);break}}else{if(l==4)return-1;c(l!=l)}}}return p}function eh(e,r){var i,s,o;c(r.lb<r.ub);if(r.ptr==null){o=Cc(e,r);if(o==0)return t&&h("N"),0;if(o==1)return io;c(o!=o)}if(r.ptr.c_next==null){i=r.ptr.row;function u(){t&&h("O"),_c(e,r);if(i.lb==-n&&i.ub==+n){t&&h("P");for(s=i.ptr;s!=null;s=s.r_next)Zl(e,s.col);vc(e,i)}else Kl(e,i);return 0}if(i.lb==i.ub){if(!r.is_int)return u()}else if(!r.is_int){o=Dc(e,r);if(o==0)return t&&h("Q"),u();if(o!=1&&o==2)return io}}return 0}function th(e,n){function u(){return c(o==0||o==ro||o==io),t&&h(""),o}var r,i,s,o;Gc(e);for(r=e.r_head;r!=null;r=r.next)r.temp=1;for(i=e.c_head;i!=null;i=i.next)i.temp=1;s=1;while(s){s=0;for(;;){r=e.r_head;if(r==null||!r.temp)break;Ql(e,r),o=Yc(e,r,n);if(o!=0)return u();s=1}for(;;){i=e.c_head;if(i==null||!i.temp)break;ec(e,i),o=eh(e,i);if(o!=0)return u();s=1}}if(e.sol==Xi&&!n)for(r=e.r_head;r!=null;r=r.next)if(Zc(e,r,0)<0)return o=ro,u();return o=0,u()}function nh(e,t){return c(e.sol==zi),c(t==t),th(e,0)}function rh(e,t){var r,i,s,o,u,a;c(e.sol==Xi),c(t==t),a=th(e,1);if(a!=0)return a;t.binarize&&Ic(e),u=0;for(r=e.r_tail;r!=null;r=i){i=r.prev;if(r.lb==-n&&r.ub==+n)continue;if(r.lb==r.ub)continue;if(r.ptr==null||r.ptr.r_next==null)continue;for(o=r.ptr;o!=null;o=o.r_next){s=o.col;if(!s.is_int||s.lb!=0||s.ub!=1)break}if(o!=null)continue;u+=zc(e,r)}u>0&&h(u+" hidden packing inequaliti(es) were detected"),u=0;for(r=e.r_tail;r!=null;r=i){i=r.prev;if(r.lb==-n&&r.ub==+n)continue;if(r.lb==r.ub)continue;if(r.ptr==null||r.ptr.r_next==null||r.ptr.r_next.r_next==null)continue;for(o=r.ptr;o!=null;o=o.r_next){s=o.col;if(!s.is_int||s.lb!=0||s.ub!=1)break}if(o!=null)continue;u+=$c(e,r)}u>0&&h(u+" hidden covering inequaliti(es) were detected"),u=0;for(r=e.r_tail;r!=null;r=i){i=r.prev;if(r.lb==r.ub)continue;u+=Qc(e,r)}return u>0&&h(u+" constraint coefficient(s) were reduced"),a=0,a}function ih(e,t){return e-t&2147483647}function sh(e){var t,n;for(t=1,n=32;n<=55;t++,n++)e.A[t]=ih(e.A[t],e.A[n]);for(n=1;t<=55;t++,n++)e.A[t]=ih(e.A[t],e.A[n]);return e.fptr=54,e.A[55]}function oh(){var e={},t;e.A=new Array(56),e.A[0]=-1;for(t=1;t<=55;t++)e.A[t]=0;return e.fptr=0,uh(e,1),e}function uh(e,t){var n,r=t,i=1;t=r=ih(r,0),e.A[55]=r;for(n=21;n;n=(n+21)%55)e.A[n]=i,i=ih(r,i),t&1?t=1073741824+(t>>1):t>>=1,i=ih(i,t),r=e.A[n];sh(e),sh(e),sh(e),sh(e),sh(e)}function ah(e){return e.A[e.fptr]>=0?e.A[e.fptr--]:sh(e)}function fh(e,t){const n=2147483648;var r=n-n%t,i;c(t>0);do i=ah(e);while(r<=i);return i%t}function lh(e){var t=ah(e)/2147483647;return c(0<=t&&t<=1),t}function ch(e,t,n){t>=n&&l("rng_uniform: a = "+t+", b = "+n+"; invalid range");var r=lh(e);return r=t*(1-r)+n*r,c(t<=r&&r<=n),r}function yh(e){mh&&h("scf_create_it: warning: debug mode enabled"),1<=e&&e<=32767||l("scf_create_it: n_max = "+e+"; invalid parameter");var t={};return t.n_max=e,t.n=0,t.f=new Array(1+e*e),t.u=new Array(1+e*(e+1)/2),t.p=new Array(1+e),t.t_opt=hh,t.rank=0,mh?t.c=new Array(1+e*e):t.c=null,t.w=new Array(1+e),t}function bh(e,t,n){var r=e.n_max,i=e.n;return c(1<=t&&t<=i),c(1<=n&&n<=i),(t-1)*r+n}function wh(e,t,n){var r=e.n_max,i=e.n;return c(1<=t&&t<=i),c(t<=n&&n<=i),(t-1)*r+n-t*(t-1)/2}function Eh(e,t,n){var r=e.n,i=e.f,s=e.u,o,u,a,f,l,h,p;c(1<=t&&t<=r);for(;t<r;t++){f=wh(e,t,t),u=bh(e,t,1),l=bh(e,r,1);if(Math.abs(s[f])<Math.abs(n[t])){for(o=t,a=f;o<=r;o++,a++)p=s[a],s[a]=n[o],n[o]=p;for(o=1,a=u,h=l;o<=r;o++,a++,h++)p=i[a],i[a]=i[h],i[h]=p}Math.abs(s[f])<gh&&(s[f]=n[t]=0);if(n[t]==0)continue;p=n[t]/s[f];for(o=t+1,a=f+1;o<=r;o++,a++)n[o]-=p*s[a];for(o=1,a=u,h=l;o<=r;o++,a++,h++)i[h]-=p*i[a]}Math.abs(n[r])<gh&&(n[r]=0),s[wh(e,r,r)]=n[r]}function Sh(e,t,n){var r,i,s;t==0?(i=1,s=0):Math.abs(e)<=Math.abs(t)?(r=-e/t,s=1/Math.sqrt(1+r*r),i=s*r):(r=-t/e,i=1/Math.sqrt(1+r*r),s=i*r),n(i,s)}function xh(e,t,n){var r=e.n,i=e.f,s=e.u,o,u,a,f,l,h;c(1<=t&&t<=r);for(;t<r;t++){f=wh(e,t,t),u=bh(e,t,1),l=bh(e,r,1),Math.abs(s[f])<gh&&Math.abs(n[t])<gh&&(s[f]=n[t]=0);if(n[t]==0)continue;Sh(s[f],n[t],function(e,c){for(o=t,a=f;o<=r;o++,a++){var p=s[a],d=n[o];s[a]=e*p-c*d,n[o]=c*p+e*d}for(o=1,a=u,h=l;o<=r;o++,a++,h++){var v=i[a],m=i[h];i[a]=e*v-c*m,i[h]=c*v+e*m}})}Math.abs(n[r])<gh&&(n[r]=0),s[wh(e,r,r)]=n[r]}function Th(e,t,n){switch(e.t_opt){case hh:Eh(e,t,n);break;case ph:xh(e,t,n);break;default:c(e!=e)}}function Nh(e){var t=e.n_max,n=e.n,r=e.u,i,s,o,u=0;for(i=1,s=wh(e,i,i),o=t;i<=n;i++,s+=o,o--)r[s]!=0&&u++;return u}function Ch(e,t,n,r,i,s){var o=e.n_max,u=e.n,a=e.f,f=e.u,l=e.p;if(mh)var c=e.c;var h=e.w,p,d,v,m,g,y,b=0,w;if(u==o)return b=vh,b;e.n=++u;for(p=1,v=bh(e,p,u);p<u;p++,v+=o)a[v]=0;for(m=1,y=bh(e,u,m);m<u;m++,y++)a[y]=0;a[bh(e,u,u)]=1;for(p=1;p<u;p++){w=0;for(m=1,d=bh(e,p,1);m<u;m++,d++)w+=a[d]*t[m+n];f[wh(e,p,u)]=w}for(m=1;m<u;m++)h[m]=r[l[m]+i];h[u]=s,l[u]=u;if(mh){for(p=1,v=bh(e,p,u);p<u;p++,v+=o)c[v]=t[p+n];for(m=1,y=bh(e,u,m);m<u;m++,y++)c[y]=r[m+i];c[bh(e,u,u)]=s}for(g=1;g<u;g++)if(h[g]!=0)break;return Th(e,g,h),e.rank=Nh(e),e.rank!=u&&(b=dh),mh&&ma(e,"scf_update_exp"),b}function kh(e,t,n){var r=e.n,i=e.f,s=e.u,o=e.p,u=e.w,a,f,l,c;for(a=1;a<=r;a++){c=0;for(f=1,l=bh(e,a,1);f<=r;f++,l++)c+=i[l]*t[f+n];u[a]=c}for(a=r;a>=1;a--){c=u[a];for(f=r,l=wh(e,a,r);f>a;f--,l--)c-=s[l]*u[f];u[a]=c/s[l]}for(a=1;a<=r;a++)t[o[a]+n]=u[a]}function Lh(e,t,n){var r=e.n,i=e.f,s=e.u,o=e.p,u=e.w,a,f,l,c;for(a=1;a<=r;a++)u[a]=t[o[a]+n];for(a=1;a<=r;a++){l=wh(e,a,a),c=u[a]/=s[l];for(f=a+1,l++;f<=r;f++,l++)u[f]-=s[l]*c}for(f=1;f<=r;f++)t[f+n]=0;for(a=1;a<=r;a++){c=u[a];for(f=1,l=bh(e,a,1);f<=r;f++,l++)t[f+n]+=i[l]*c}}function Ah(e,t,n,r){e.rank<e.n&&l("scf_solve_it: singular matrix"),t?Lh(e,n,r):kh(e,n,r)}function Oh(e){e.n=e.rank=0}function _h(e,s){function u(e){var t=e.m,n=e.n,r=e.nnz,i={};return c(t>0&&n>0),i.m=t,i.n=n,i.type=new Array(1+t+n),i.lb=new Array(1+t+n),i.ub=new Array(1+t+n),i.coef=new Array(1+t+n),i.obj=new Array(1+n),i.A_ptr=new Array(1+n+1),i.A_ind=new Array(1+r),i.A_val=new Array(1+r),i.head=new Array(1+t+n),i.stat=new Array(1+n),i.N_ptr=new Array(1+t+1),i.N_len=new Array(1+t),i.N_ind=null,i.N_val=null,i.bbar=new Array(1+t),i.cbar=new Array(1+n),i.refsp=new Array(1+t+n),i.gamma=new Array(1+n),i.tcol_ind=new Array(1+t),i.tcol_vec=new Array(1+t),i.trow_ind=new Array(1+n),i.trow_vec=new Array(1+n),i.work1=new Array(1+t),i.work2=new Array(1+t),i.work3=new Array(1+t),i.work4=new Array(1+t),i}function a(e,t){var n=e.m,r=e.n,i=e.type,s=e.lb,o=e.ub,u=e.coef,a=e.obj,f=e.A_ptr,l=e.A_ind,h=e.A_val,p=e.head,m=e.stat,y=e.refsp,b=e.gamma,w,E,x,T,C,k,L;for(w=1;w<=n;w++)k=t.row[w],i[w]=k.type,s[w]=k.lb*k.rii,o[w]=k.ub*k.rii,u[w]=0;for(E=1;E<=r;E++)L=t.col[E],i[n+E]=L.type,s[n+E]=L.lb/L.sjj,o[n+E]=L.ub/L.sjj,u[n+E]=L.coef*L.sjj;a[0]=t.c0,d(a,1,u,n+1,r),C=0;for(E=1;E<=r;E++)C<Math.abs(a[E])&&(C=Math.abs(a[E]));C==0&&(C=1);switch(t.dir){case xi:e.zeta=1/C;break;case Ti:e.zeta=-1/C;break;default:c(t!=t)}Math.abs(e.zeta)<1&&(e.zeta*=1e3),T=1;for(E=1;E<=r;E++){f[E]=T;for(var A=t.col[E].ptr;A!=null;A=A.c_next)l[T]=A.row.i,h[T]=A.row.rii*A.val*A.col.sjj,T++}f[r+1]=T,c(T==t.nnz+1),c(t.valid),d(p,1,t.head,1,n),x=0;for(w=1;w<=n;w++)k=t.row[w],k.stat!=Di&&(x++,c(x<=r),p[n+x]=w,m[x]=k.stat);for(E=1;E<=r;E++)L=t.col[E],L.stat!=Di&&(x++,c(x<=r),p[n+x]=n+E,m[x]=L.stat);c(x==r),e.valid=1,t.valid=0,e.bfd=t.bfd,t.bfd=null,S(e),N(e),e.phase=0,e.tm_beg=g(),e.it_beg=e.it_cnt=t.it_cnt,e.it_dpy=-1,e.refct=0,v(y,1,0,n+r);for(E=1;E<=r;E++)b[E]=1}function f(e,n,r,i){var s=e.m;if(t)var o=e.n;var u=e.A_ptr,a=e.A_ind,f=e.A_val,l=e.head,h,p,v,m;t&&c(1<=n&&n<=s),h=l[n],t&&c(1<=h&&h<=s+o);if(h<=s)p=1,r[1]=h,i[1]=1;else{v=u[h-s],p=u[h-s+1]-v,d(r,1,a,v,p),d(i,1,f,v,p);for(m=1;m<=p;m++)i[m]=-i[m]}return p}function l(e){var t=Qn(e.bfd,e.m,null,f,e);return e.valid=t==0,t}function p(e,n,r){var i=e.m;if(t)var s=e.n;var o,u;t&&(c(1<=n&&n<=i),c(1<=r&&r<=i+s));if(r<=i){var a=new Array(2);o=new Array(2),a[1]=r,o[1]=1,c(e.valid),u=Zn(e.bfd,n,0,1,a,0,o)}else{var f=e.A_ptr,l=e.A_ind,h=e.A_val;o=e.work1;var p,d,v,m;p=f[r-i],d=f[r-i+1],m=0;for(v=p;v<d;v++)o[++m]=-h[v];c(e.valid),u=Zn(e.bfd,n,0,m,l,p-1,o)}return e.valid=u==0,u}function m(e,n,r,i){var s=e.m;if(t)var o=e.n;var u=e.A_ptr,a=e.A_ind,f=e.A_val,l=e.head,h,p,v,m,g,y;d(i,1,n,1,s);for(h=1;h<=s;h++){y=r[h];if(y==0)continue;p=l[h],t&&c(1<=p&&p<=s+o);if(p<=s)i[p]-=y;else{v=u[p-s],m=u[p-s+1];for(g=v;g<m;g++)i[a[g]]+=f[g]*y}}}function b(e,t,n){var r=e.m,i=e.work1,s=e.work1,o;m(e,t,n,i),c(e.valid),Gn(e.bfd,s);for(o=1;o<=r;o++)n[o]+=s[o]}function w(e,n,r,i){var s=e.m;if(t)var o=e.n;var u=e.A_ptr,a=e.A_ind,f=e.A_val,l=e.head,h,p,d,v,m,g;for(h=1;h<=s;h++){p=l[h],t&&c(1<=p&&p<=s+o),g=n[h];if(p<=s)g-=r[p];else{d=u[p-s],v=u[p-s+1];for(m=d;m<v;m++)g+=f[m]*r[a[m]]}i[h]=g}}function E(e,t,n){var r=e.m,i=e.work1,s=e.work1,o;w(e,t,n,i),c(e.valid),Yn(e.bfd,s);for(o=1;o<=r;o++)n[o]+=s[o]}function S(e){var t=e.m,n=e.n,r=e.A_ptr,i=e.A_ind,s=e.N_ptr,o=e.N_len,u,a,f,l,c;for(u=1;u<=t;u++)o[u]=1;for(a=1;a<=n;a++){f=r[a],l=r[a+1];for(c=f;c<l;c++)o[i[c]]++}s[1]=1;for(u=1;u<=t;u++)o[u]>n&&(o[u]=n),s[u+1]=s[u]+o[u];e.N_ind=new Array(s[t+1]),e.N_val=new Array(s[t+1])}function x(e,n,r){var i=e.m;if(t)var s=e.n;var o=e.N_ptr,u=e.N_len,a=e.N_ind,f=e.N_val,l;t&&(c(1<=n&&n<=s),c(1<=r&&r<=i+s));if(r<=i)l=o[r]+u[r]++,t&&c(l<o[r+1]),a[l]=n,f[l]=1;else{var h=e.A_ptr,p=e.A_ind,d=e.A_val,v,m,g,y;m=h[r-i],g=h[r-i+1];for(y=m;y<g;y++)v=p[y],l=o[v]+u[v]++,t&&c(l<o[v+1]),a[l]=n,f[l]=-d[y]}}function T(e,n,r){var i=e.m;if(t)var s=e.n;var o=e.N_ptr,u=e.N_len,a=e.N_ind,f=e.N_val,l,h,p;t&&(c(1<=n&&n<=s),c(1<=r&&r<=i+s));if(r<=i){h=o[r];for(l=h;a[l]!=n;l++);p=h+ --u[r],t&&c(l<=p),a[l]=a[p],f[l]=f[p]}else{var d=e.A_ptr,v=e.A_ind,m,g,y,b;g=d[r-i],y=d[r-i+1];for(b=g;b<y;b++){m=v[b],h=o[m];for(l=h;a[l]!=n;l++);p=h+ --u[m],t&&c(l<=p),a[l]=a[p],f[l]=f[p]}}}function N(e){var n=e.m,r=e.n,i=e.head,s=e.stat,o=e.N_len,u,a;v(o,1,0,n);for(u=1;u<=r;u++)s[u]!=ji&&(a=i[n+u],t&&c(1<=a&&a<=n+r),x(e,u,a))}function C(e,n){var r=e.m;if(t)var i=e.n;var s=e.lb,o=e.ub,u=e.head,a=e.stat,f,l;t&&c(1<=n&&n<=i),f=u[r+n],t&&c(1<=f&&f<=r+i);switch(a[n]){case Pi:l=s[f];break;case Hi:l=o[f];break;case Bi:l=0;break;case ji:l=s[f];break;default:c(a!=a)}return l}function k(e,n){var r=e.m,i=e.n,s=e.A_ptr,o=e.A_ind,u=e.A_val,a=e.head,f=e.work2,l,h,p,v,m,g,y;for(l=1;l<=r;l++)f[l]=0;for(h=1;h<=i;h++){p=a[r+h],t&&c(1<=p&&p<=r+i),y=C(e,h);if(y==0)continue;if(p<=r)f[p]-=y;else{v=s[p-r],m=s[p-r+1];for(g=v;g<m;g++)f[o[g]]+=y*u[g]}}d(n,1,f,1,r),c(e.valid),Gn(e.bfd,n),b(e,f,n)}function L(e,t){var n=e.m,r=e.coef,i=e.head,s=e.work2,o;for(o=1;o<=n;o++)s[o]=r[i[o]];d(t,1,s,1,n),c(e.valid),Yn(e.bfd,t),E(e,s,t)}function A(e,n,r){var i=e.m;if(t)var s=e.n;var o=e.coef,u=e.head,a,f;t&&c(1<=r&&r<=s),a=u[i+r],t&&c(1<=a&&a<=i+s),f=o[a];if(a<=i)f-=n[a];else{var l=e.A_ptr,h=e.A_ind,p=e.A_val,d,v,m;d=l[a-i],v=l[a-i+1];for(m=d;m<v;m++)f+=p[m]*n[h[m]]}return f}function O(e){k(e,e.bbar)}function M(e){if(t)var n=e.m;var r=e.n;if(t)var i=e.head;var s=e.cbar,o=e.work3,u;if(t)var a;L(e,o);for(u=1;u<=r;u++)t&&(a=i[n+u],c(1<=a&&a<=n+r)),s[u]=A(e,o,u)}function _(e){var t=e.m,n=e.n,r=e.head,i=e.refsp,s=e.gamma,o,u;c(e.refct==0),e.refct=1e3,v(i,1,0,t+n);for(o=1;o<=n;o++)u=r[t+o],i[u]=1,s[o]=1}function D(e,n){var r=e.m;if(t)var i=e.n;var s=e.head,o=e.refsp,u=e.work3,a=e.work3,f,l,h;t&&c(1<=n&&n<=i),l=s[r+n],t&&c(1<=l&&l<=r+i);for(f=1;f<=r;f++)a[f]=0;if(l<=r)a[l]=-1;else{var p=e.A_ptr,d=e.A_ind,v=e.A_val,m,g,y;m=p[l-r],g=p[l-r+1];for(y=m;y<g;y++)a[d[y]]=v[y]}c(e.valid),Gn(e.bfd,u),h=o[l]?1:0;for(f=1;f<=r;f++)l=s[f],t&&c(1<=l&&l<=r+i),o[l]&&(h+=u[f]*u[f]);return h}function P(e,n){var r=e.n,i=e.stat,s=e.cbar,o=e.gamma,u,a,f,l,h;a=0,l=0;for(u=1;u<=r;u++){f=s[u];switch(i[u]){case Pi:if(f>=-n)continue;break;case Hi:if(f<=+n)continue;break;case Bi:if(-n<=f&&f<=+n)continue;break;case ji:continue;default:c(i!=i)}t&&c(o[u]>0),h=f*f/o[u],l<h&&(a=u,l=h)}e.q=a}function H(e){var n=e.m;if(t)var r=e.n;var i=e.head,s=e.q,o=e.tcol_ind,u=e.tcol_vec,a=e.tcol_vec,f,l,h;t&&c(1<=s&&s<=r),l=i[n+s],t&&c(1<=l&&l<=n+r);for(f=1;f<=n;f++)a[f]=0;if(l<=n)a[l]=-1;else{var p=e.A_ptr,d=e.A_ind,v=e.A_val,m,g,y;m=p[l-n],g=p[l-n+1];for(y=m;y<g;y++)a[d[y]]=v[y]}c(e.valid),Gn(e.bfd,u),h=0;for(f=1;f<=n;f++)u[f]!=0&&(o[++h]=f);e.tcol_nnz=h}function B(e){var n=e.m;if(t)var r=e.n;var i=e.head,s=e.q,o=e.tcol_ind,u=e.tcol_vec,a=e.work3,f,l,h;t&&c(1<=s&&s<=r),l=i[n+s],t&&c(1<=l&&l<=n+r);for(f=1;f<=n;f++)a[f]=0;if(l<=n)a[l]=-1;else{var p=e.A_ptr,d=e.A_ind,v=e.A_val,m,g,y;m=p[l-n],g=p[l-n+1];for(y=m;y<g;y++)a[d[y]]=v[y]}b(e,a,u),h=0;for(f=1;f<=n;f++)u[f]!=0&&(o[++h]=f);e.tcol_nnz=h}function j(e,n){if(t)var r=e.m;var i=e.tcol_nnz,s=e.tcol_ind,o=e.tcol_vec,u,a,f,l,h,p;l=0;for(f=1;f<=i;f++)t&&(u=s[f],c(1<=u&&u<=r)),p=Math.abs(o[s[f]]),l<p&&(l=p);e.tcol_max=l,h=n*(1+.01*l);for(a=0;a<i;)u=s[i],Math.abs(o[u])<h?i--:(a++,s[i]=s[a],s[a]=u);e.tcol_num=a}function F(e,r){function D(){e.p=x,x>0&&u[h[x]]==_i?e.p_stat=ji:e.p_stat=T,t&&c(M>=0),e.teta=A*M}var i=e.m;if(t)var s=e.n;var u=e.type,a=e.lb,f=e.ub,l=e.coef,h=e.head,p=e.phase,d=e.bbar,v=e.cbar,m=e.q,g=e.tcol_ind,y=e.tcol_vec,b=e.tcol_num,w,E,S,x,T,N,C,k,L,A,O,M,_;t&&c(1<=m&&m<=s),t&&c(v[m]!=0),A=v[m]>0?-1:1,S=h[i+m],t&&c(1<=S&&S<=i+s),u[S]==Mi?(x=-1,T=0,M=f[S]-a[S],k=1):(x=0,T=0,M=n,k=0);for(N=1;N<=b;N++){w=g[N],t&&c(1<=w&&w<=i),S=h[w],t&&c(1<=S&&S<=i+s),C=A*y[w],t&&c(C!=0);if(C>0)if(p==1&&l[S]<0)L=r*(1+o*Math.abs(a[S])),O=(a[S]+L-d[w])/C,E=Pi;else{if(p==1&&l[S]>0)continue;if(u[S]!=Oi&&u[S]!=Mi&&u[S]!=_i)continue;L=r*(1+o*Math.abs(f[S])),O=(f[S]+L-d[w])/C,E=Hi}else if(p==1&&l[S]>0)L=r*(1+o*Math.abs(f[S])),O=(f[S]-L-d[w])/C,E=Hi;else{if(p==1&&l[S]<0)continue;if(u[S]!=Ai&&u[S]!=Mi&&u[S]!=_i)continue;L=r*(1+o*Math.abs(a[S])),O=(a[S]-L-d[w])/C,E=Pi}O<0&&(O=0);if(M>O||M==O&&k<Math.abs(C))x=w,T=E,M=O,k=Math.abs(C)}if(r==0)return D();if(x<=0)return D();if(M==0)return D();_=M,x=0,T=0,M=n,k=0;for(N=1;N<=b;N++){w=g[N],t&&c(1<=w&&w<=i),S=h[w],t&&c(1<=S&&S<=i+s),C=A*y[w],t&&c(C!=0);if(C>0)if(p==1&&l[S]<0)O=(a[S]-d[w])/C,E=Pi;else{if(p==1&&l[S]>0)continue;if(u[S]!=Oi&&u[S]!=Mi&&u[S]!=_i)continue;O=(f[S]-d[w])/C,E=Hi}else if(p==1&&l[S]>0)O=(f[S]-d[w])/C,E=Hi;else{if(p==1&&l[S]<0)continue;if(u[S]!=Ai&&u[S]!=Mi&&u[S]!=_i)continue;O=(a[S]-d[w])/C,E=Pi}O<0&&(O=0),O<=_&&k<Math.abs(C)&&(x=w,T=E,M=O,k=Math.abs(C))}c(x!=0),D()}function I(e,n){var r=e.m,i=e.p,s;t&&c(1<=i&&i<=r);for(s=1;s<=r;s++)n[s]=0;n[i]=1,c(e.valid),Yn(e.bfd,n)}function q(e,n){var r=e.m,i=e.p,s=e.work3,o;t&&c(1<=i&&i<=r);for(o=1;o<=r;o++)s[o]=0;s[i]=1,E(e,s,n)}function R(e,n){var r=e.m,i=e.n;if(t)var s=e.stat;var o=e.N_ptr,u=e.N_len,a=e.N_ind,f=e.N_val,l=e.trow_ind,h=e.trow_vec,p,d,v,m,g,y,b;for(d=1;d<=i;d++)h[d]=0;for(p=1;p<=r;p++){b=n[p];if(b==0)continue;v=o[p],m=v+u[p];for(g=v;g<m;g++)t&&(d=a[g],c(1<=d&&d<=i),c(s[d]!=ji)),h[a[g]]-=b*f[g]}y=0;for(d=1;d<=i;d++)h[d]!=0&&(l[++y]=d);e.trow_nnz=y}function U(e){if(t)var n=e.m,r=e.n;var i=e.bbar,s=e.q,o=e.tcol_nnz,u=e.tcol_ind,a=e.tcol_vec,f=e.p,l=e.teta,h,p;t&&(c(1<=s&&s<=r),c(f<0||1<=f&&f<=n)),f>0&&(i[f]=C(e,s)+l);if(l==0)return;for(p=1;p<=o;p++){h=u[p];if(h==f)continue;i[h]+=a[h]*l}}function z(e){var n=e.m;if(t)var r=e.n;var i=e.coef,s=e.head,o=e.q,u=e.tcol_nnz,a=e.tcol_ind,f=e.tcol_vec,l,h,p;t&&c(1<=o&&o<=r),p=i[s[n+o]];for(h=1;h<=u;h++)l=a[h],t&&c(1<=l&&l<=n),p+=i[s[l]]*f[l];return p}function W(e){if(t)var n=e.n;var r=e.cbar,i=e.q,s=e.trow_nnz,o=e.trow_ind,u=e.trow_vec,a,f,l;t&&c(1<=i&&i<=n),t&&c(u[i]!=0),l=r[i]/=u[i];for(f=1;f<=s;f++){a=o[f];if(a==i)continue;r[a]-=u[a]*l}}function X(e){var n=e.m;if(t)var r=e.n;var s=e.type,o=e.A_ptr,u=e.A_ind,a=e.A_val,f=e.head,l=e.refsp,h=e.gamma,p=e.q,d=e.tcol_nnz,v=e.tcol_ind,m=e.tcol_vec,g=e.p,y=e.trow_nnz,b=e.trow_ind,w=e.trow_vec,E=e.work3,S,x,T,N,C,k,L,A,O,M,_,D,P,H;t&&(c(1<=g&&g<=n),c(1<=p&&p<=r)),c(e.refct>0),e.refct--,A=O=l[f[n+p]]?1:0;for(S=1;S<=n;S++)E[S]=0;for(N=1;N<=d;N++)S=v[N],l[f[S]]?(E[S]=D=m[S],A+=D*D):E[S]=0;c(e.valid),Yn(e.bfd,E),M=w[p],t&&c(M!=0);for(N=1;N<=y;N++){x=b[N];if(x==p)continue;D=w[x]/M,T=f[n+x];if(T<=n)_=E[T];else{_=0,C=o[T-n],k=o[T-n+1];for(L=C;L<k;L++)_-=a[L]*E[u[L]]}P=h[x]+D*D*A+2*D*_,H=(l[T]?1:0)+O*D*D,h[x]=P>=H?P:H,h[x]<i&&(h[x]=i)}s[f[g]]==_i?h[p]=1:(h[p]=A/(M*M),h[p]<i&&(h[p]=i))}function V(e){var t=e.m,n=e.bbar,r,i,s,o;o=new Array(1+t),k(e,o),s=0;for(r=1;r<=t;r++)i=Math.abs(o[r]-n[r])/(1+Math.abs(o[r])),s<i&&(s=i);return s}function $(e){var t=e.m,n=e.n,r=e.stat,i=e.cbar,s,o,u,a,f;f=new Array(1+t),L(e,f),u=0;for(s=1;s<=n;s++){if(r[s]==ji)continue;a=A(e,f,s),o=Math.abs(a-i[s])/(1+Math.abs(a)),u<o&&(u=o)}return u}function J(e){var t=e.n,n=e.stat,r=e.gamma,i,s,o,u;o=0;for(i=1;i<=t;i++){if(n[i]==ji){c(r[i]==1);continue}u=D(e,i),s=Math.abs(u-r[i])/(1+Math.abs(u)),o<s&&(o=s)}return o}function K(e){var n=e.m;if(t)var r=e.n,i=e.type;var s=e.head,o=e.stat,u=e.q,a=e.p,f=e.p_stat,l;t&&c(1<=u&&u<=r);if(a<0){t&&(l=s[n+u],c(1<=l&&l<=n+r),c(i[l]==Mi));switch(o[u]){case Pi:o[u]=Hi;break;case Hi:o[u]=Pi;break;default:c(o!=o)}}else{if(t){c(1<=a&&a<=n),l=s[a];switch(f){case Pi:c(i[l]==Ai||i[l]==Mi);break;case Hi:c(i[l]==Oi||i[l]==Mi);break;case ji:c(i[l]==ji);break;default:c(f!=f)}}l=s[a],s[a]=s[n+u],s[n+u]=l,o[u]=f}}function Q(e,t){var n=e.m,r=e.n,i=e.type,s=e.lb,u=e.ub,a=e.coef,f=e.head,l=e.bbar,c,h,p=0,d;t*=.9;for(h=1;h<=n+r;h++)a[h]=0;for(c=1;c<=n;c++){h=f[c];if(i[h]==Ai||i[h]==Mi||i[h]==_i)d=t*(1+o*Math.abs(s[h])),l[c]<s[h]-d&&(a[h]=-1,p++);if(i[h]==Oi||i[h]==Mi||i[h]==_i)d=t*(1+o*Math.abs(u[h])),l[c]>u[h]+d&&(a[h]=1,p++)}return p}function G(e){var t=e.m,n=e.n,r=e.coef,i=e.obj,s=e.zeta,o,u;for(o=1;o<=t;o++)r[o]=0;for(u=1;u<=n;u++)r[t+u]=s*i[u]}function Y(e,n){var r=e.m;if(t)var i=e.n;var s=e.type,u=e.lb,a=e.ub,f=e.coef,l=e.head,h=e.phase,p=e.bbar,d,v,m;for(d=1;d<=r;d++){v=l[d],t&&c(1<=v&&v<=r+i);if(h==1&&f[v]<0){t&&c(s[v]==Ai||s[v]==Mi||s[v]==_i),m=n*(1+o*Math.abs(u[v]));if(p[d]>u[v]+m)return 1}else if(h==1&&f[v]>0){t&&c(s[v]==Oi||s[v]==Mi||s[v]==_i),m=n*(1+o*Math.abs(a[v]));if(p[d]<a[v]-m)return 1}else{if(s[v]==Ai||s[v]==Mi||s[v]==_i){m=n*(1+o*Math.abs(u[v]));if(p[d]<u[v]-m)return 1}if(s[v]==Oi||s[v]==Mi||s[v]==_i){m=n*(1+o*Math.abs(a[v]));if(p[d]>a[v]+m)return 1}}}return 0}function Z(e,n){var r=e.m;if(t)var i=e.n,s=e.type;var u=e.lb,a=e.ub,f=e.coef,l=e.head,h=e.bbar,p,d,v;c(e.phase==1);for(p=1;p<=r;p++){d=l[p],t&&c(1<=d&&d<=r+i);if(f[d]<0){t&&c(s[d]==Ai||s[d]==Mi||s[d]==_i),v=n*(1+o*Math.abs(u[d]));if(h[p]<u[d]-v)return 1}else if(f[d]>0){t&&c(s[d]==Oi||s[d]==Mi||s[d]==_i),v=n*(1+o*Math.abs(a[d]));if(h[p]>a[d]+v)return 1}}return 0}function et(e){var n=e.m,r=e.n,i=e.obj,s=e.head,o=e.bbar,u,a,f,l;l=i[0];for(u=1;u<=n;u++)f=s[u],t&&c(1<=f&&f<=n+r),f>n&&(l+=i[f-n]*o[u]);for(a=1;a<=r;a++)f=s[n+a],t&&c(1<=f&&f<=n+r),f>n&&(l+=i[f-n]*C(e,a));return l}function tt(e,n,r){var i=e.m;if(t)var s=e.n;var o=e.type,u=e.lb,a=e.ub,f=e.phase,l=e.head,p=e.bbar,d,v,m,b;if(n.msg_lev<rs)return;if(n.out_dly>0&&1e3*y(g(),e.tm_beg)<n.out_dly)return;if(e.it_cnt==e.it_dpy)return;if(!r&&e.it_cnt%n.out_frq!=0)return;b=0,m=0;for(d=1;d<=i;d++)v=l[d],t&&c(1<=v&&v<=i+s),(o[v]==Ai||o[v]==Mi||o[v]==_i)&&p[d]<u[v]&&(b+=u[v]-p[d]),(o[v]==Oi||o[v]==Mi||o[v]==_i)&&p[d]>a[v]&&(b+=p[d]-a[v]),o[v]==_i&&m++;h((f==1?" ":"*")+e.it_cnt+": obj = "+et(e)+"  infeas = "+b+" ("+m+")"),e.it_dpy=e.it_cnt}function nt(e,n,r,i,s){var o=e.m,u=e.n,a=e.zeta,f=e.head,l=e.stat,h=e.bbar,p=e.cbar,v,m,g,y,b;t&&(c(n.m==o),c(n.n==u),c(!n.valid&&n.bfd==null),c(e.valid&&e.bfd!=null)),n.valid=1,e.valid=0,n.bfd=e.bfd,e.bfd=null,d(n.head,1,f,1,o),n.pbs_stat=r,n.dbs_stat=i,n.obj_val=et(e),n.it_cnt=e.it_cnt,n.some=s;for(v=1;v<=o;v++)g=f[v],t&&c(1<=g&&g<=o+u),g<=o?(y=n.row[g],y.stat=Di,y.bind=v,y.prim=h[v]/y.rii,y.dual=0):(b=n.col[g-o],b.stat=Di,b.bind=v,b.prim=h[v]*b.sjj,b.dual=0);for(m=1;m<=u;m++){g=f[o+m],t&&c(1<=g&&g<=o+u);if(g<=o){y=n.row[g],y.stat=l[m],y.bind=0;switch(l[m]){case Pi:y.prim=y.lb;break;case Hi:y.prim=y.ub;break;case Bi:y.prim=0;break;case ji:y.prim=y.lb;break;default:c(l!=l)}y.dual=p[m]*y.rii/a}else{b=n.col[g-o],b.stat=l[m],b.bind=0;switch(l[m]){case Pi:b.prim=b.lb;break;case Hi:b.prim=b.ub;break;case Bi:b.prim=0;break;case ji:b.prim=b.lb;break;default:c(l!=l)}b.dual=p[m]/b.sjj/a}}}const o=.1;var rt,it=2,st=0,ot=0,ut=0,at=0,ft,lt,ct;rt=u(e),a(rt,e),s.msg_lev>=ss&&h("Objective scale factor = "+rt.zeta+"");for(;;){if(it==0){ct=l(rt);if(ct!=0)return s.msg_lev>=ns&&(h("Error: unable to factorize the basis matrix ("+ct+")"),h("Sorry, basis recovery procedure not implemented yet")),c(!e.valid&&e.bfd==null),e.bfd=rt.bfd,rt.bfd=null,e.pbs_stat=e.dbs_stat=Vi,e.obj_val=0,e.it_cnt=rt.it_cnt,e.some=0,ct=Ys,ct;rt.valid=1,it=1,st=ot=0}if(st==0){O(rt),st=1,rt.phase==0&&(Q(rt,s.tol_bnd)>0?rt.phase=1:(G(rt),rt.phase=2),c(Y(rt,s.tol_bnd)==0),ot=0,tt(rt,s,1));if(Y(rt,s.tol_bnd)){s.msg_lev>=ns&&h("Warning: numerical instability (primal simplex, phase "+(rt.phase==1?"I":"II")+")"),rt.phase=0,it=0,ut=5;continue}}c(rt.phase==1||rt.phase==2),rt.phase==1&&!Z(rt,s.tol_bnd)&&(rt.phase=2,G(rt),ot=0,tt(rt,s,1)),ot==0&&(M(rt),ot=1);switch(s.pricing){case fs:break;case ls:rt.refct==0&&_(rt);break;default:c(s!=s)}c(it&&st&&ot);if(at){var ht=V(rt),pt=$(rt),dt=s.pricing==ls?J(rt):0;h("e_bbar = "+ht+"; e_cbar = "+pt+"; e_gamma = "+dt+""),c(ht<=1e-5&&pt<=1e-5&&dt<=.001)}if(s.it_lim<r&&rt.it_cnt-rt.it_beg>=s.it_lim){if(st!=1||rt.phase==2&&ot!=1){st!=1&&(st=0),rt.phase==2&&ot!=1&&(ot=0);continue}tt(rt,s,1),s.msg_lev>=is&&h("ITERATION LIMIT EXCEEDED; SEARCH TERMINATED");switch(rt.phase){case 1:ft=Ji,G(rt),M(rt);break;case 2:ft=$i;break;default:c(rt!=rt)}return P(rt,s.tol_dj),lt=rt.q==0?$i:Ji,nt(rt,e,ft,lt,0),ct=to,ct}if(s.tm_lim<r&&1e3*y(g(),rt.tm_beg)>=s.tm_lim){if(st!=1||rt.phase==2&&ot!=1){st!=1&&(st=0),rt.phase==2&&ot!=1&&(ot=0);continue}tt(rt,s,1),s.msg_lev>=is&&h("TIME LIMIT EXCEEDED; SEARCH TERMINATED");switch(rt.phase){case 1:ft=Ji,G(rt),M(rt);break;case 2:ft=$i;break;default:c(rt!=rt)}return P(rt,s.tol_dj),lt=rt.q==0?$i:Ji,nt(rt,e,ft,lt,0),ct=no,ct}tt(rt,s,0),P(rt,s.tol_dj);if(rt.q==0){if(st!=1||ot!=1){st!=1&&(st=0),ot!=1&&(ot=0);continue}tt(rt,s,1);switch(rt.phase){case 1:s.msg_lev>=is&&h("PROBLEM HAS NO FEASIBLE SOLUTION"),ft=Ki,G(rt),M(rt),P(rt,s.tol_dj),lt=rt.q==0?$i:Ji;break;case 2:s.msg_lev>=is&&h("OPTIMAL SOLUTION FOUND"),ft=lt=$i;break;default:c(rt!=rt)}return nt(rt,e,ft,lt,0),ct=0,ct}H(rt),ut&&B(rt),j(rt,s.tol_piv);var vt=rt.cbar[rt.q],mt=z(rt);c(vt!=0);if(Math.abs(vt-mt)>1e-5*(1+Math.abs(mt))||!(vt<0&&mt<0||vt>0&&mt>0)){s.msg_lev>=ss&&h("d1 = "+vt+"; d2 = "+mt+"");if(ot!=1||!ut){ot!=1&&(ot=0),ut=5;continue}}vt>0?rt.cbar[rt.q]=mt>0?mt:+i:rt.cbar[rt.q]=mt<0?mt:-i;switch(s.r_test){case cs:F(rt,0);break;case hs:F(rt,.3*s.tol_bnd);break;default:c(s!=s)}if(rt.p==0){if(st!=1||ot!=1||!ut){st!=1&&(st=0),ot!=1&&(ot=0),ut=1;continue}tt(rt,s,1);switch(rt.phase){case 1:s.msg_lev>=ns&&h("Error: unable to choose basic variable on phase I"),c(!e.valid&&e.bfd==null),e.bfd=rt.bfd,rt.bfd=null,e.pbs_stat=e.dbs_stat=Vi,e.obj_val=0,e.it_cnt=rt.it_cnt,e.some=0,ct=Ys;break;case 2:s.msg_lev>=is&&h("PROBLEM HAS UNBOUNDED SOLUTION"),nt(rt,e,$i,Ki,rt.head[rt.m+rt.q]),ct=0;break;default:c(rt!=rt)}return ct}if(rt.p>0){var gt=rt.tcol_vec[rt.p],yt=1e-5*(1+.01*rt.tcol_max);if(Math.abs(gt)<yt){s.msg_lev>=ss&&h("piv = "+gt+"; eps = "+yt+"");if(!ut){ut=5;continue}}}if(rt.p>0){var bt=rt.work4;I(rt,bt),ut&&q(rt,bt),R(rt,bt)}if(rt.p>0){var wt=rt.tcol_vec[rt.p],Et=rt.trow_vec[rt.q];c(wt!=0);if(Math.abs(wt-Et)>1e-8*(1+Math.abs(wt))||!(wt>0&&Et>0||wt<0&&Et<0)){s.msg_lev>=ss&&h("piv1 = "+wt+"; piv2 = "+Et+"");if(it!=1||!ut){it!=1&&(it=0),ut=5;continue}rt.trow_vec[rt.q]==0&&(rt.trow_nnz++,c(rt.trow_nnz<=rt.n),rt.trow_ind[rt.trow_nnz]=rt.q),rt.trow_vec[rt.q]=wt}}U(rt),st=2;if(rt.p>0){W(rt),ot=2;if(rt.phase==1){var St=rt.head[rt.p];rt.cbar[rt.q]-=rt.coef[St],rt.coef[St]=0}}if(rt.p>0)switch(s.pricing){case fs:break;case ls:rt.refct>0&&X(rt);break;default:c(s!=s)}rt.p>0&&(ct=p(rt,rt.p,rt.head[rt.m+rt.q]),ct==0?it=2:(rt.valid=0,it=0)),rt.p>0&&(T(rt,rt.q,rt.head[rt.m+rt.q]),rt.type[rt.head[rt.p]]!=_i&&x(rt,rt.q,rt.head[rt.p])),K(rt),rt.it_cnt++,ut>0&&ut--;continue}return ct}function Dh(e,s){function u(e){var t=e.m,n=e.n,r=e.nnz,i={};return c(t>0&&n>0),i.m=t,i.n=n,i.type=new Array(1+t+n),i.lb=new Array(1+t+n),i.ub=new Array(1+t+n),i.coef=new Array(1+t+n),i.orig_type=new Array(1+t+n),i.orig_lb=new Array(1+t+n),i.orig_ub=new Array(1+t+n),i.obj=new Array(1+n),i.A_ptr=new Array(1+n+1),i.A_ind=new Array(1+r),i.A_val=new Array(1+r),i.AT_ptr=new Array(1+t+1),i.AT_ind=new Array(1+r),i.AT_val=new Array(1+r),i.head=new Array(1+t+n),i.bind=new Array(1+t+n),i.stat=new Array(1+n),i.bbar=new Array(1+t),i.cbar=new Array(1+n),i.refsp=new Array(1+t+n),i.gamma=new Array(1+t),i.trow_ind=new Array(1+n),i.trow_vec=new Array(1+n),i.tcol_ind=new Array(1+t),i.tcol_vec=new Array(1+t),i.work1=new Array(1+t),i.work2=new Array(1+t),i.work3=new Array(1+t),i.work4=new Array(1+t),i}function a(e,t){var n=e.m,r=e.n,i=e.type,s=e.lb,o=e.ub,u=e.coef,a=e.orig_type,f=e.orig_lb,l=e.orig_ub,h=e.obj,p=e.A_ptr,m=e.A_ind,y=e.A_val,b=e.AT_ptr,w=e.AT_ind,E=e.AT_val,S=e.head,x=e.bind,T=e.stat,N=e.refsp,C=e.gamma,k,L,A,O,M,_,D,P;for(k=1;k<=n;k++)D=t.row[k],i[k]=D.type,s[k]=D.lb*D.rii,o[k]=D.ub*D.rii,u[k]=0;for(L=1;L<=r;L++)P=t.col[L],i[n+L]=P.type,s[n+L]=P.lb/P.sjj,o[n+L]=P.ub/P.sjj,u[n+L]=P.coef*P.sjj;d(a,1,i,1,n+r),d(f,1,s,1,n+r),d(l,1,o,1,n+r),h[0]=t.c0,d(h,1,u,n+1,r),M=0;for(L=1;L<=r;L++)M<Math.abs(h[L])&&(M=Math.abs(h[L]));M==0&&(M=1);switch(t.dir){case xi:e.zeta=1/M;break;case Ti:e.zeta=-1/M;break;default:c(t!=t)}Math.abs(e.zeta)<1&&(e.zeta*=1e3);for(L=1;L<=r;L++)u[n+L]*=e.zeta;O=1;for(L=1;L<=r;L++){p[L]=O;for(_=t.col[L].ptr;_!=null;_=_.c_next)m[O]=_.row.i,y[O]=_.row.rii*_.val*_.col.sjj,O++}p[r+1]=O,c(O-1==t.nnz),O=1;for(k=1;k<=n;k++){b[k]=O;for(_=t.row[k].ptr;_!=null;_=_.r_next)w[O]=_.col.j,E[O]=_.row.rii*_.val*_.col.sjj,O++}b[n+1]=O,c(O-1==t.nnz),c(t.valid),d(S,1,t.head,1,n),A=0;for(k=1;k<=n;k++)D=t.row[k],D.stat!=Di&&(A++,c(A<=r),S[n+A]=k,T[A]=D.stat);for(L=1;L<=r;L++)P=t.col[L],P.stat!=Di&&(A++,c(A<=r),S[n+A]=n+L,T[A]=P.stat);c(A==r);for(A=1;A<=n+r;A++)x[S[A]]=A;e.valid=1,t.valid=0,e.bfd=t.bfd,t.bfd=null,e.phase=0,e.tm_beg=g(),e.it_beg=e.it_cnt=t.it_cnt,e.it_dpy=-1,e.refct=0,v(N,1,0,n+r);for(k=1;k<=n;k++)C[k]=1}function f(e,n,r,i){var s=e.m;if(t)var o=e.n;var u=e.A_ptr,a=e.A_ind,f=e.A_val,l=e.head,h,p,v,m;t&&c(1<=n&&n<=s),h=l[n],t&&c(1<=h&&h<=s+o);if(h<=s)p=1,r[1]=h,i[1]=1;else{v=u[h-s],p=u[h-s+1]-v,d(r,1,a,v,p),d(i,1,f,v,p);for(m=1;m<=p;m++)i[m]=-i[m]}return p}function l(e){var t=Qn(e.bfd,e.m,null,f,e);return e.valid=t==0,t}function p(e,n,r){var i=e.m;if(t)var s=e.n;var o,u;t&&(c(1<=n&&n<=i),c(1<=r&&r<=i+s));if(r<=i){var a=new Array(2);u=new Array(2),a[1]=r,u[1]=1,c(e.valid),o=Zn(e.bfd,n,0,1,a,0,u)}else{var f=e.A_ptr,l=e.A_ind,h=e.A_val;u=e.work1;var p,d,v,m;p=f[r-i],d=f[r-i+1],m=0;for(v=p;v<d;v++)u[++m]=-h[v];c(e.valid),o=Zn(e.bfd,n,0,m,l,p-1,u)}return e.valid=o==0,o}function m(e,n,r,i){var s=e.m;if(t)var o=e.n;var u=e.A_ptr,a=e.A_ind,f=e.A_val,l=e.head,h,p,v,m,g,y;d(i,1,n,1,s);for(h=1;h<=s;h++){y=r[h];if(y==0)continue;p=l[h],t&&c(1<=p&&p<=s+o);if(p<=s)i[p]-=y;else{v=u[p-s],m=u[p-s+1];for(g=v;g<m;g++)i[a[g]]+=f[g]*y}}}function b(e,t,n){var r=e.m,i=e.work1,s=e.work1,o;m(e,t,n,i),c(e.valid),Gn(e.bfd,s);for(o=1;o<=r;o++)n[o]+=s[o]}function w(e,n,r,i){var s=e.m;if(t)var o=e.n;var u=e.A_ptr,a=e.A_ind,f=e.A_val,l=e.head,h,p,d,v,m,g;for(h=1;h<=s;h++){p=l[h],t&&c(1<=p&&p<=s+o),g=n[h];if(p<=s)g-=r[p];else{d=u[p-s],v=u[p-s+1];for(m=d;m<v;m++)g+=f[m]*r[a[m]]}i[h]=g}}function E(e,t,n){var r=e.m,i=e.work1,s=e.work1,o;w(e,t,n,i),c(e.valid),Yn(e.bfd,s);for(o=1;o<=r;o++)n[o]+=s[o]}function S(e,n){var r=e.m;if(t)var i=e.n;var s=e.lb,o=e.ub,u=e.head,a=e.stat,f,l;t&&c(1<=n&&n<=i),f=u[r+n],t&&c(1<=f&&f<=r+i);switch(a[n]){case Pi:l=s[f];break;case Hi:l=o[f];break;case Bi:l=0;break;case ji:l=s[f];break;default:c(a!=a)}return l}function x(e,n){var r=e.m,i=e.n,s=e.A_ptr,o=e.A_ind,u=e.A_val,a=e.head,f=e.work2,l,h,p,v,m,g,y;for(l=1;l<=r;l++)f[l]=0;for(h=1;h<=i;h++){p=a[r+h],t&&c(1<=p&&p<=r+i),y=S(e,h);if(y==0)continue;if(p<=r)f[p]-=y;else{v=s[p-r],m=s[p-r+1];for(g=v;g<m;g++)f[o[g]]+=y*u[g]}}d(n,1,f,1,r),c(e.valid),Gn(e.bfd,n),b(e,f,n)}function T(e,t){var n=e.m,r=e.coef,i=e.head,s=e.work2,o;for(o=1;o<=n;o++)s[o]=r[i[o]];d(t,1,s,1,n),c(e.valid),Yn(e.bfd,t),E(e,s,t)}function N(e,n,r){var i=e.m;if(t)var s=e.n;var o=e.coef,u=e.head,a,f;t&&c(1<=r&&r<=s),a=u[i+r],t&&c(1<=a&&a<=i+s),f=o[a];if(a<=i)f-=n[a];else{var l=e.A_ptr,h=e.A_ind,p=e.A_val,d,v,m;d=l[a-i],v=l[a-i+1];for(m=d;m<v;m++)f+=p[m]*n[h[m]]}return f}function C(e){x(e,e.bbar)}function k(e){if(t)var n=e.m;var r=e.n;if(t)var i=e.head;var s=e.cbar,o=e.work3,u;if(t)var a;T(e,o);for(u=1;u<=r;u++)t&&(a=i[n+u],c(1<=a&&a<=n+r)),s[u]=N(e,o,u)}function L(e){var t=e.m,n=e.n,r=e.head,i=e.refsp,s=e.gamma,o,u;c(e.refct==0),e.refct=1e3,v(i,1,0,t+n);for(o=1;o<=t;o++)u=r[o],i[u]=1,s[o]=1}function A(e,n){var r=e.m,i=e.n,s=e.type,o=e.head,u=e.refsp,a=e.work3,f=e.work3,l,h,p;for(l=1;l<=r;l++)p=o[l],t&&c(1<=p&&p<=r+i),s[p]==Li?n[l]=1:n[l]=u[p]?1:0;for(h=1;h<=i;h++){p=o[r+h],t&&c(1<=p&&p<=r+i);if(!u[p])continue;t&&c(s[p]!=_i);for(l=1;l<=r;l++)f[l]=0;if(p<=r)f[p]=-1;else{var d=e.A_ptr,v=e.A_ind,m=e.A_val,g,y,b;g=d[p-r],y=d[p-r+1];for(b=g;b<y;b++)f[v[b]]=m[b]}c(e.valid),Gn(e.bfd,a);for(l=1;l<=r;l++)p=o[l],s[p]!=Li&&(n[l]+=a[l]*a[l])}}function O(e,n){var r=e.m;if(t)var s=e.n;var u=e.type,a=e.lb,f=e.ub,l=e.head,h=e.bbar,p=e.gamma,d,v,m,g,y,b,w,E;m=0,g=0,y=0;for(d=1;d<=r;d++){v=l[d],t&&c(1<=v&&v<=r+s),w=0;if(u[v]==Ai||u[v]==Mi||u[v]==_i)b=n*(1+o*Math.abs(a[v])),h[d]<a[v]-b&&(w=a[v]-h[d]);if(u[v]==Oi||u[v]==Mi||u[v]==_i)b=n*(1+o*Math.abs(f[v])),h[d]>f[v]+b&&(w=f[v]-h[d]);if(w==0)continue;t&&c(p[d]>=0),E=p[d],E<i&&(E=i),E=w*w/E,y<E&&(m=d,g=w,y=E)}e.p=m,e.delta=g}function M(e,n){var r=e.m,i=e.p,s;t&&c(1<=i&&i<=r);for(s=1;s<=r;s++)n[s]=0;n[i]=1,c(e.valid),Yn(e.bfd,ht)}function _(e,n){var r=e.m,i=e.p,s=e.work3,o;t&&c(1<=i&&i<=r);for(o=1;o<=r;o++)s[o]=0;s[i]=1,E(e,s,n)}function D(e,t){var n=e.m,r=e.n,i=e.A_ptr,s=e.A_ind,o=e.A_val,u=e.head,a=e.stat,f=e.trow_ind,l=e.trow_vec,c,h,p,d,v,m,g;m=0;for(c=1;c<=r;c++){if(a[c]==ji){l[c]=0;continue}h=u[n+c];if(h<=n)g=-t[h];else{p=i[h-n],d=i[h-n+1],g=0;for(v=p;v<d;v++)g+=t[s[v]]*o[v]}g!=0&&(f[++m]=c),l[c]=g}e.trow_nnz=m}function P(e,t){var n=e.m,r=e.n,i=e.AT_ptr,s=e.AT_ind,o=e.AT_val,u=e.bind,a=e.stat,f=e.trow_ind,l=e.trow_vec,c,h,p,d,v,m,g;for(h=1;h<=r;h++)l[h]=0;for(c=1;c<=n;c++){g=t[c];if(g==0)continue;h=u[c]-n,h>=1&&a[h]!=ji&&(l[h]-=g),p=i[c],d=i[c+1];for(v=p;v<d;v++)h=u[n+s[v]]-n,h>=1&&a[h]!=ji&&(l[h]+=g*o[v])}m=0;for(h=1;h<=r;h++)l[h]!=0&&(f[++m]=h);e.trow_nnz=m}function H(e,t){var n=e.m,r,i,s;i=0;for(r=1;r<=n;r++)t[r]!=0&&i++;s=i/n,s>=.2?D(e,t):P(e,t)}function B(e,n){if(t)var r=e.n,i=e.stat;var s=e.trow_nnz,o=e.trow_ind,u=e.trow_vec,a,f,l,h,p,d;h=0;for(l=1;l<=s;l++)t&&(a=o[l],c(1<=a&&a<=r),c(i[a]!=ji)),d=Math.abs(u[o[l]]),h<d&&(h=d);e.trow_max=h,p=n*(1+.01*h);for(f=0;f<s;)a=o[s],Math.abs(u[a])<p?s--:(f++,o[s]=o[f],o[f]=a);e.trow_num=f}function j(e,r){function x(){e.q=m,e.new_dq=b*E}if(t)var i=e.m,s=e.n;var o=e.stat,u=e.cbar;if(t)var a=e.p;var f=e.delta,l=e.trow_ind,h=e.trow_vec,p=e.trow_num,d,v,m,g,y,b,w,E,S;t&&c(1<=a&&a<=i),t&&c(f!=0),b=f>0?1:-1,m=0,E=n,y=0;for(v=1;v<=p;v++){d=l[v],t&&c(1<=d&&d<=s),g=b*h[d],t&&c(g!=0);if(g>0){if(o[d]!=Pi&&o[d]!=Bi)continue;w=(u[d]+r)/g}else{if(o[d]!=Hi&&o[d]!=Bi)continue;w=(u[d]-r)/g}w<0&&(w=0);if(E>w||E==w&&y<Math.abs(g))m=d,E=w,y=Math.abs(g)}if(r==0)return x();if(m==0)return x();if(E==0)return x();S=E,m=0,E=n,y=0;for(v=1;v<=p;v++){d=l[v],t&&c(1<=d&&d<=s),g=b*h[d],t&&c(g!=0);if(g>0){if(o[d]!=Pi&&o[d]!=Bi)continue;w=u[d]/g}else{if(o[d]!=Hi&&o[d]!=Bi)continue;w=u[d]/g}w<0&&(w=0),w<=S&&y<Math.abs(g)&&(m=d,E=w,y=Math.abs(g))}c(m!=0),x()}function F(e){var n=e.m;if(t)var r=e.n;var i=e.head,s=e.q,o=e.tcol_ind,u=e.tcol_vec,a=e.tcol_vec,f,l,h;t&&c(1<=s&&s<=r),l=i[n+s],t&&c(1<=l&&l<=n+r);for(f=1;f<=n;f++)a[f]=0;if(l<=n)a[l]=-1;else{var p=e.A_ptr,d=e.A_ind,v=e.A_val,m,g,y;m=p[l-n],g=p[l-n+1];for(y=m;y<g;y++)a[d[y]]=v[y]}c(e.valid),Gn(e.bfd,u),h=0;for(f=1;f<=n;f++)u[f]!=0&&(o[++h]=f);e.tcol_nnz=h}function I(e){var n=e.m;if(t)var r=e.n;var i=e.head,s=e.q,o=e.tcol_ind,u=e.tcol_vec,a=e.work3,f,l,h;t&&c(1<=s&&s<=r),l=i[n+s],t&&c(1<=l&&l<=n+r);for(f=1;f<=n;f++)a[f]=0;if(l<=n)a[l]=-1;else{var p=e.A_ptr,d=e.A_ind,v=e.A_val,m,g,y;m=p[l-n],g=p[l-n+1];for(y=m;y<g;y++)a[d[y]]=v[y]}b(e,a,u),h=0;for(f=1;f<=n;f++)u[f]!=0&&(o[++h]=f);e.tcol_nnz=h}function q(e){if(t)var n=e.n;var r=e.cbar,i=e.trow_nnz,s=e.trow_ind,o=e.trow_vec,u=e.q,a=e.new_dq,f,l;t&&c(1<=u&&u<=n),r[u]=a;if(a==0)return;for(l=1;l<=i;l++)f=s[l],t&&c(1<=f&&f<=n),f!=u&&(r[f]-=o[f]*a)}function R(e){if(t)var n=e.m,r=e.n;var i=e.bbar,s=e.p,o=e.delta,u=e.q,a=e.tcol_nnz,f=e.tcol_ind,l=e.tcol_vec,h,p,d;t&&(c(1<=s&&s<=n),c(1<=u&&u<=r),c(l[s]!=0)),d=o/l[s],i[s]=S(e,u)+d;if(d==0)return;for(p=1;p<=a;p++)h=f[p],t&&c(1<=h&&h<=n),h!=s&&(i[h]+=l[h]*d)}function U(e){var n=e.m;if(t)var r=e.n;var s=e.type,o=e.head,u=e.refsp,a=e.gamma,f=e.p,l=e.trow_nnz,h=e.trow_ind,p=e.trow_vec,d=e.q,v=e.tcol_nnz,m=e.tcol_ind,g=e.tcol_vec,y=e.work3,b,w,E,S,x,T,N,C,k,L;t&&(c(1<=f&&f<=n),c(1<=d&&d<=r)),c(e.refct>0),e.refct--,t&&c(s[o[f]]!=Li),x=T=u[o[f]]?1:0;for(b=1;b<=n;b++)y[b]=0;for(S=1;S<=l;S++){w=h[S],t&&c(1<=w&&w<=r),E=o[n+w],t&&(c(1<=E&&E<=n+r),c(s[E]!=_i));if(!u[E])continue;C=p[w],x+=C*C;if(E<=n)y[E]+=C;else{var A=e.A_ptr,O=e.A_ind,M=e.A_val,_,D,P;_=A[E-n],D=A[E-n+1];for(P=_;P<D;P++)y[O[P]]-=C*M[P]}}c(e.valid),Gn(e.bfd,y),N=g[f],t&&c(N!=0);for(S=1;S<=v;S++){b=m[S],t&&c(1<=b&&b<=n),E=o[b],t&&c(1<=E&&E<=n+r);if(b==f)continue;if(s[o[b]]==Li){t&&c(a[b]==1);continue}C=g[b]/N,k=a[b]+C*C*x+2*C*y[b],L=(u[E]?1:0)+T*C*C,a[b]=k>=L?k:L,a[b]<i&&(a[b]=i)}s[o[n+d]]==Li?a[f]=1:(a[f]=x/(N*N),a[f]<i&&(a[f]=i)),E=o[f];if(s[E]==_i&&u[E]){u[E]=0;for(S=1;S<=v;S++){b=m[S];if(b==f){if(s[o[n+d]]==Li)continue;C=1/g[f]}else{if(s[o[b]]==Li)continue;C=g[b]/g[f]}a[b]-=C*C,a[b]<i&&(a[b]=i)}}}function z(e){var t=e.m,n=e.bbar,r,i,s,o=new Array(1+t);x(e,o),s=0;for(r=1;r<=t;r++)i=Math.abs(o[r]-n[r])/(1+Math.abs(o[r])),s<i&&(s=i);return s}function W(e){var t=e.m,n=e.n,r=e.stat,i=e.cbar,s,o,u,a,f=new Array(1+t);T(e,f),u=0;for(s=1;s<=n;s++){if(r[s]==ji)continue;a=N(e,f,s),o=Math.abs(a-i[s])/(1+Math.abs(a)),u<o&&(u=o)}return u}function X(e){var t=e.m,n=e.type,r=e.head,i=e.gamma,s=e.work4,o,u,a,f;A(e,s),a=0;for(o=1;o<=t;o++){if(n[r[o]]==Li){c(i[o]==1),c(s[o]==1);continue}f=s[o],u=Math.abs(f-i[o])/(1+Math.abs(f)),a<u&&(a=u)}return a}function V(e){var n=e.m;if(t)var r=e.n;var i=e.type,s=e.head,o=e.bind,u=e.stat,a=e.p,f=e.delta,l=e.q,h;t&&(c(1<=a&&a<=n),c(1<=l&&l<=r)),h=s[a],s[a]=s[n+l],s[n+l]=h,o[s[a]]=a,o[s[n+l]]=n+l,i[h]==_i?u[l]=ji:f>0?(t&&c(i[h]==Ai||i[h]==Mi),u[l]=Pi):(t&&c(i[h]==Oi||i[h]==Mi),u[l]=Hi)}function $(e,n){var r=e.m,i=e.n,s=e.orig_type,o=e.head,u=e.cbar,a,f;for(a=1;a<=i;a++){f=o[r+a],t&&c(1<=f&&f<=r+i);if(u[a]<-n)if(s[f]==Ai||s[f]==Li)return 1;if(u[a]>+n)if(s[f]==Oi||s[f]==Li)return 1}return 0}function J(e){var n=e.m,r=e.n,i=e.type,s=e.lb,o=e.ub,u=e.orig_type,a=e.head,f=e.stat,l=e.cbar,h,p;for(p=1;p<=n+r;p++)switch(u[p]){case Li:i[p]=Mi,s[p]=-1e3,o[p]=1e3;break;case Ai:i[p]=Mi,s[p]=0,o[p]=1;break;case Oi:i[p]=Mi,s[p]=-1,o[p]=0;break;case Mi:case _i:i[p]=_i,s[p]=o[p]=0;break;default:c(u!=u)}for(h=1;h<=r;h++)p=a[n+h],t&&c(1<=p&&p<=n+r),i[p]==_i?f[h]=ji:l[h]>=0?f[h]=Pi:f[h]=Hi}function K(e){var n=e.m,r=e.n,s=e.type,o=e.lb,u=e.ub,a=e.orig_type,f=e.orig_lb,l=e.orig_ub,h=e.head,p=e.stat,v=e.cbar,m,g;d(s,1,a,1,n+r),d(o,1,f,1,n+r),d(u,1,l,1,n+r);for(m=1;m<=r;m++){g=h[n+m],t&&c(1<=g&&g<=n+r);switch(s[g]){case Li:p[m]=Bi;break;case Ai:p[m]=Pi;break;case Oi:p[m]=Hi;break;case Mi:v[m]>=+i?p[m]=Pi:v[m]<=-i?p[m]=Hi:Math.abs(o[g])<=Math.abs(u[g])?p[m]=Pi:p[m]=Hi;break;case _i:p[m]=ji;break;default:c(s!=s)}}}function Q(e,t){var n=e.n,r=e.stat,i=e.cbar,s;for(s=1;s<=n;s++){if(i[s]<-t)if(r[s]==Pi||r[s]==Bi)return 1;if(i[s]>+t)if(r[s]==Hi||r[s]==Bi)return 1}return 0}function G(e){var n=e.m,r=e.n,i=e.obj,s=e.head,o=e.bbar,u,a,f,l;l=i[0];for(u=1;u<=n;u++)f=s[u],t&&c(1<=f&&f<=n+r),f>n&&(l+=i[f-n]*o[u]);for(a=1;a<=r;a++)f=s[n+a],t&&c(1<=f&&f<=n+r),f>n&&(l+=i[f-n]*S(e,a));return l}function Y(e,t,n){var r=e.m,i=e.n,s=e.coef,o=e.orig_type,u=e.head,a=e.stat,f=e.phase,l=e.bbar,c=e.cbar,p,d,v,m;if(t.msg_lev<rs)return;if(t.out_dly>0&&1e3*y(g(),e.tm_beg)<t.out_dly)return;if(e.it_cnt==e.it_dpy)return;if(!n&&e.it_cnt%t.out_frq!=0)return;m=0;if(f==1){for(p=1;p<=r;p++)m-=s[u[p]]*l[p];for(d=1;d<=i;d++)m-=s[u[r+d]]*S(e,d)}else for(d=1;d<=i;d++)c[d]<0&&(a[d]==Pi||a[d]==Bi)&&(m-=c[d]),c[d]>0&&(a[d]==Hi||a[d]==Bi)&&(m+=c[d]);v=0;for(p=1;p<=r;p++)o[u[p]]==_i&&v++;e.phase==1?h(" "+e.it_cnt+":  infeas = "+m+" ("+v+")"):h("|"+e.it_cnt+": obj = "+G(e)+"  infeas = "+m+" ("+v+")"),e.it_dpy=e.it_cnt}function Z(e,n,r,i,s){var o=e.m,u=e.n,a=e.zeta,f=e.head,l=e.stat,h=e.bbar,p=e.cbar,v,m,g,y,b;t&&(c(n.m==o),c(n.n==u),c(!n.valid&&n.bfd==null),c(e.valid&&e.bfd!=null)),n.valid=1,e.valid=0,n.bfd=e.bfd,e.bfd=null,d(n.head,1,f,1,o),n.pbs_stat=r,n.dbs_stat=i,n.obj_val=G(e),n.it_cnt=e.it_cnt,n.some=s;for(v=1;v<=o;v++)g=f[v],t&&c(1<=g&&g<=o+u),g<=o?(b=n.row[g],b.stat=Di,b.bind=v,b.prim=h[v]/b.rii,b.dual=0):(y=n.col[g-o],y.stat=Di,y.bind=v,y.prim=h[v]*y.sjj,y.dual=0);for(m=1;m<=u;m++){g=f[o+m],t&&c(1<=g&&g<=o+u);if(g<=o){b=n.row[g],b.stat=l[m],b.bind=0;switch(l[m]){case Pi:b.prim=b.lb;break;case Hi:b.prim=b.ub;break;case Bi:b.prim=0;break;case ji:b.prim=b.lb;break;default:c(l!=l)}b.dual=p[m]*b.rii/a}else{y=n.col[g-o],y.stat=l[m],y.bind=0;switch(l[m]){case Pi:y.prim=y.lb;break;case Hi:y.prim=y.ub;break;case Bi:y.prim=0;break;case ji:y.prim=y.lb;break;default:c(l!=l)}y.dual=p[m]/y.sjj/a}}}const o=.1;var et,tt=2,nt=0,rt=0,it=0,st=0,ot,ut,at;et=u(e),a(et,e),s.msg_lev>=ss&&h("Objective scale factor = "+et.zeta+"");for(;;){if(tt==0){at=l(et);if(at!=0)return s.msg_lev>=ns&&(h("Error: unable to factorize the basis matrix ("+at+")"),h("Sorry, basis recovery procedure not implemented yet")),c(!e.valid&&e.bfd==null),e.bfd=et.bfd,et.bfd=null,e.pbs_stat=e.dbs_stat=Vi,e.obj_val=0,e.it_cnt=et.it_cnt,e.some=0,at=Ys,at;et.valid=1,tt=1,nt=rt=0}if(rt==0){k(et),rt=1,et.phase==0&&($(et,.9*s.tol_dj)!=0?(et.phase=1,J(et)):(et.phase=2,K(et)),c(Q(et,s.tol_dj)==0),et.refct=0,nt=0);if(Q(et,s.tol_dj)!=0){s.msg_lev>=ns&&h("Warning: numerical instability (dual simplex, phase "+(et.phase==1?"I":"II")+")");if(s.meth==us)return Z(et,e,Vi,Vi,0),at=Ys,at;et.phase=0,tt=0,it=5;continue}}c(et.phase==1||et.phase==2),et.phase==1&&$(et,s.tol_dj)==0&&(Y(et,s,1),et.phase=2,rt!=1&&(k(et),rt=1),K(et),et.refct=0,nt=0),nt==0&&(C(et),et.phase==2&&(et.bbar[0]=G(et)),nt=1);switch(s.pricing){case fs:break;case ls:et.refct==0&&L(et);break;default:c(s!=s)}c(tt&&nt&&rt);if(st){var ft=z(et),lt=W(et),ct=s.pricing==ls?X(et):0;h("e_bbar = "+ft+"; e_cbar = "+lt+"; e_gamma = "+ct+""),c(ft<=1e-5&&lt<=1e-5&&ct<=.001)}if(et.phase==2&&et.zeta<0&&s.obj_ll>-n&&et.bbar[0]<=s.obj_ll){if(nt!=1||rt!=1){nt!=1&&(nt=0),rt!=1&&(rt=0);continue}return Y(et,s,1),s.msg_lev>=is&&h("OBJECTIVE LOWER LIMIT REACHED; SEARCH TERMINATED"),Z(et,e,Ji,$i,0),at=Zs,at}if(et.phase==2&&et.zeta>0&&s.obj_ul<+n&&et.bbar[0]>=s.obj_ul){if(nt!=1||rt!=1){nt!=1&&(nt=0),rt!=1&&(rt=0);continue}return Y(et,s,1),s.msg_lev>=is&&h("OBJECTIVE UPPER LIMIT REACHED; SEARCH TERMINATED"),Z(et,e,Ji,$i,0),at=eo,at}if(s.it_lim<r&&et.it_cnt-et.it_beg>=s.it_lim){if(et.phase==2&&nt!=1||rt!=1){et.phase==2&&nt!=1&&(nt=0),rt!=1&&(rt=0);continue}Y(et,s,1),s.msg_lev>=is&&h("ITERATION LIMIT EXCEEDED; SEARCH TERMINATED");switch(et.phase){case 1:ut=Ji,K(et),C(et);break;case 2:ut=$i;break;default:c(et!=et)}return Z(et,e,Ji,ut,0),at=to,at}if(s.tm_lim<r&&1e3*y(g(),et.tm_beg)>=s.tm_lim){if(et.phase==2&&nt!=1||rt!=1){et.phase==2&&nt!=1&&(nt=0),rt!=1&&(rt=0);continue}Y(et,s,1),s.msg_lev>=is&&h("TIME LIMIT EXCEEDED; SEARCH TERMINATED");switch(et.phase){case 1:ut=Ji,K(et),C(et);break;case 2:ut=$i;break;default:c(et!=et)}return Z(et,e,Ji,ut,0),at=no,at}Y(et,s,0),O(et,s.tol_bnd);if(et.p==0){if(nt!=1||rt!=1){nt!=1&&(nt=0),rt!=1&&(rt=0);continue}Y(et,s,1);switch(et.phase){case 1:s.msg_lev>=is&&h("PROBLEM HAS NO DUAL FEASIBLE SOLUTION"),K(et),C(et),ot=Ji,ut=Ki;break;case 2:s.msg_lev>=is&&h("OPTIMAL SOLUTION FOUND"),ot=ut=$i;break;default:c(et!=et)}return Z(et,e,ot,ut,0),at=0,at}var ht=et.work4;M(et,ht),it&&_(et,ht),H(et,ht),B(et,s.tol_bnd);switch(s.r_test){case cs:j(et,0);break;case hs:j(et,.3*s.tol_dj);break;default:c(s!=s)}if(et.q==0){if(nt!=1||rt!=1||!it){nt!=1&&(nt=0),rt!=1&&(rt=0),it=1;continue}Y(et,s,1);switch(et.phase){case 1:s.msg_lev>=ns&&h("Error: unable to choose basic variable on phase I"),c(!e.valid&&e.bfd==null),e.bfd=et.bfd,et.bfd=null,e.pbs_stat=e.dbs_stat=Vi,e.obj_val=0,e.it_cnt=et.it_cnt,e.some=0,at=Ys;break;case 2:s.msg_lev>=is&&h("PROBLEM HAS NO FEASIBLE SOLUTION"),Z(et,e,Ki,$i,et.head[et.p]),at=0;break;default:c(et!=et)}return at}var pt=et.trow_vec[et.q],dt=1e-5*(1+.01*et.trow_max);if(Math.abs(pt)<dt){s.msg_lev>=ss&&h("piv = "+pt+"; eps = "+dt+"");if(!it){it=5;continue}}F(et),it&&I(et);var vt=et.tcol_vec[et.p],mt=et.trow_vec[et.q];c(vt!=0);if(Math.abs(vt-mt)>1e-8*(1+Math.abs(vt))||!(vt>0&&mt>0||vt<0&&mt<0)){s.msg_lev>=ss&&h("piv1 = "+vt+"; piv2 = "+mt+"");if(tt!=1||!it){tt!=1&&(tt=0),it=5;continue}et.tcol_vec[et.p]==0&&(et.tcol_nnz++,c(et.tcol_nnz<=et.m),et.tcol_ind[et.tcol_nnz]=et.p),et.tcol_vec[et.p]=mt}R(et),et.phase==2&&(et.bbar[0]+=et.cbar[et.q]/et.zeta*(et.delta/et.tcol_vec[et.p])),nt=2,q(et),rt=2;switch(s.pricing){case fs:break;case ls:et.refct>0&&U(et);break;default:c(s!=s)}at=p(et,et.p,et.head[et.m+et.q]),at==0?tt=2:(et.valid=0,tt=0),V(et),et.it_cnt++,it>0&&it--}}const t=!1,n=Number.MAX_VALUE,r=2147483647,i=2.220446049250313e-16,s=1,o=1e8,u=1e8,a=5e8,f=-1;var h=function(e){console.log(e)};e.__defineGetter__("glp_print_func",function(){return h}),e.__defineSetter__("glp_print_func",function(e){h=e});var w={},S=e.glp_version=function(){return Ei+"."+Si},O=3621377730,_=e.glp_create_prob=function(){var e={};return M(e),e},D=e.glp_set_prob_name=function(e,t){var n=e.tree;n!=null&&n.reason!=0&&l("glp_set_prob_name: operation not allowed"),e.name=t},P=e.glp_set_obj_name=function(e,t){var n=e.tree;n!=null&&n.reason!=0&&l("glp_set_obj_name: operation not allowed"),e.obj=t},H=e.glp_set_obj_dir=function(e,t){var n=e.tree;n!=null&&n.reason!=0&&l("glp_set_obj_dir: operation not allowed"),t!=xi&&t!=Ti&&l("glp_set_obj_dir: dir = "+t+"; invalid direction flag"),e.dir=t},B=e.glp_add_rows=function(e,t){var n=e.tree,r;t<1&&l("glp_add_rows: nrs = "+t+"; invalid number of rows"),t>o-e.m&&l("glp_add_rows: nrs = "+t+"; too many rows");var i=e.m+t;if(e.m_max<i){while(e.m_max<i)e.m_max+=e.m_max,c(e.m_max>0);e.row.length=1+e.m_max,e.head=new Array(1+e.m_max)}for(var s=e.m+1;s<=i;s++){e.row[s]=r={},r.i=s,r.name=null,r.node=null,r.level=0,r.origin=0,r.klass=0;if(n!=null)switch(n.reason){case 0:break;case Fs:c(n.curr!=null),r.level=n.curr.level,r.origin=Os;break;case Rs:c(n.curr!=null),r.level=n.curr.level,r.origin=Ms;break;default:c(n!=n)}r.type=Li,r.lb=r.ub=0,r.ptr=null,r.rii=1,r.stat=Di,r.bind=0,r.prim=r.dual=0,r.pval=r.dval=0,r.mipx=0}return e.m=i,e.valid=0,n!=null&&n.reason!=0&&(n.reopt=1),i-t+1},j=e.glp_add_cols=function(e,t){var n=e.tree,r;n!=null&&n.reason!=0&&l("glp_add_cols: operation not allowed"),t<1&&l("glp_add_cols: ncs = "+t+"; invalid number of columns"),t>u-e.n&&l("glp_add_cols: ncs = "+t+"; too many columns");var i=e.n+t;if(e.n_max<i){while(e.n_max<i)e.n_max+=e.n_max,c(e.n_max>0);e.col.length=1+e.n_max}for(var s=e.n+1;s<=i;s++)e.col[s]=r={},r.j=s,r.name=null,r.node=null,r.kind=Ni,r.type=_i,r.lb=r.ub=0,r.coef=0,r.ptr=null,r.sjj=1,r.stat=ji,r.bind=0,r.prim=r.dual=0,r.pval=r.dval=0,r.mipx=0;return e.n=i,i-t+1},F=e.glp_set_row_name=function(e,t,n){var r=e.tree;1<=t&&t<=e.m||l("glp_set_row_name: i = "+t+"; row number out of range");var i=e.row[t];r!=null&&r.reason!=0&&(c(r.curr!=null),c(i.level==r.curr.level)),i.name!=null&&(delete e.r_tree[i.name],i.name=null),n!=null&&(i.name=n,e.r_tree[i.name]=i)},I=e.glp_set_col_name=function(e,t,n){var r=e.tree;r!=null&&r.reason!=0&&l("glp_set_col_name: operation not allowed"),1<=t&&t<=e.n||l("glp_set_col_name: j = "+t+"; column number out of range");var i=e.col[t];i.name!=null&&(delete e.c_tree[i.name],i.name=null),n!=null&&(i.name=n,e.c_tree[i.name]=i)},q=e.glp_set_row_bnds=function(e,t,n,r,i){1<=t&&t<=e.m||l("glp_set_row_bnds: i = "+t+"; row number out of range");var s=e.row[t];s.type=n;switch(n){case Li:s.lb=s.ub=0,s.stat!=Di&&(s.stat=Bi);break;case Ai:s.lb=r,s.ub=0,s.stat!=Di&&(s.stat=Pi);break;case Oi:s.lb=0,s.ub=i,s.stat!=Di&&(s.stat=Hi);break;case Mi:s.lb=r,s.ub=i,s.stat!=Di&&s.stat!=Pi&&s.stat!=Hi&&(s.stat=Math.abs(r)<=Math.abs(i)?Pi:Hi);break;case _i:s.lb=s.ub=r,s.stat!=Di&&(s.stat=ji);break;default:l("glp_set_row_bnds: i = "+t+"; type = "+n+"; invalid row type")}},R=e.glp_set_col_bnds=function(e,t,n,r,i){1<=t&&t<=e.n||l("glp_set_col_bnds: j = "+t+"; column number out of range");var s=e.col[t];s.type=n;switch(n){case Li:s.lb=s.ub=0,s.stat!=Di&&(s.stat=Bi);break;case Ai:s.lb=r,s.ub=0,s.stat!=Di&&(s.stat=Pi);break;case Oi:s.lb=0,s.ub=i,s.stat!=Di&&(s.stat=Hi);break;case Mi:s.lb=r,s.ub=i,s.stat!=Di&&s.stat!=Pi&&s.stat!=Hi&&(s.stat=Math.abs(r)<=Math.abs(i)?Pi:Hi);break;case _i:s.lb=s.ub=r,s.stat!=Di&&(s.stat=ji);break;default:l("glp_set_col_bnds: j = "+t+"; type = "+n+"; invalid column type")}},U=e.glp_set_obj_coef=function(e,t,n){var r=e.tree;r!=null&&r.reason!=0&&l("glp_set_obj_coef: operation not allowed"),0<=t&&t<=e.n||l("glp_set_obj_coef: j = "+t+"; column number out of range"),t==0?e.c0=n:e.col[t].coef=n},z=e.glp_set_mat_row=function(e,t,n,r,i){var s=e.tree,o,u,f,h,p;1<=t&&t<=e.m||l("glp_set_mat_row: i = "+t+"; row number out of range");var d=e.row[t];s!=null&&s.reason!=0&&(c(s.curr!=null),c(d.level==s.curr.level));while(d.ptr!=null)u=d.ptr,d.ptr=u.r_next,o=u.col,u.c_prev==null?o.ptr=u.c_next:u.c_prev.c_next=u.c_next,u.c_next!=null&&(u.c_next.c_prev=u.c_prev),e.nnz--,o.stat==Di&&(e.valid=0);0<=n&&n<=e.n||l("glp_set_mat_row: i = "+t+"; len = "+n+"; invalid row length "),n>a-e.nnz&&l("glp_set_mat_row: i = "+t+"; len = "+n+"; too many constraint coefficients");for(p=1;p<=n;p++)h=r[p],1<=h&&h<=e.n||l("glp_set_mat_row: i = "+t+"; ind["+p+"] = "+h+"; column index out of range"),o=e.col[h],o.ptr!=null&&o.ptr.row.i==t&&l("glp_set_mat_row: i = "+t+"; ind["+p+"] = "+h+"; duplicate column indices not allowed"),u={},e.nnz++,u.row=d,u.col=o,u.val=i[p],u.r_prev=null,u.r_next=d.ptr,u.c_prev=null,u.c_next=o.ptr,u.r_next!=null&&(u.r_next.r_prev=u),u.c_next!=null&&(u.c_next.c_prev=u),d.ptr=o.ptr=u,o.stat==Di&&u.val!=0&&(e.valid=0);for(u=d.ptr;u!=null;u=f)f=u.r_next,u.val==0&&(u.r_prev==null?d.ptr=f:u.r_prev.r_next=f,f!=null&&(f.r_prev=u.r_prev),c(u.c_prev==null),u.col.ptr=u.c_next,u.c_next!=null&&(u.c_next.c_prev=null),e.nnz--)},W=e.glp_set_mat_col=function(e,t,n,r,i){var s=e.tree,o,u,f,h,p;s!=null&&s.reason!=0&&l("glp_set_mat_col: operation not allowed"),1<=t&&t<=e.n||l("glp_set_mat_col: j = "+t+"; column number out of range");var d=e.col[t];while(d.ptr!=null)u=d.ptr,d.ptr=u.c_next,o=u.row,u.r_prev==null?o.ptr=u.r_next:u.r_prev.r_next=u.r_next,u.r_next!=null&&(u.r_next.r_prev=u.r_prev),e.nnz--;0<=n&&n<=e.m||l("glp_set_mat_col: j = "+t+"; len = "+n+"; invalid column length"),n>a-e.nnz&&l("glp_set_mat_col: j = "+t+"; len = "+n+"; too many constraint coefficients");for(p=1;p<=n;p++)h=r[p],1<=h&&h<=e.m||l("glp_set_mat_col: j = "+t+"; ind["+p+"] = "+h+"; row index out of range"),o=e.row[h],o.ptr!=null&&o.ptr.col.j==t&&l("glp_set_mat_col: j = "+t+"; ind["+p+"] = "+h+"; duplicate row indices not allowed"),u={},e.nnz++,u.row=o,u.col=d,u.val=i[p],u.r_prev=null,u.r_next=o.ptr,u.c_prev=null,u.c_next=d.ptr,u.r_next!=null&&(u.r_next.r_prev=u),u.c_next!=null&&(u.c_next.c_prev=u),o.ptr=d.ptr=u;for(u=d.ptr;u!=null;u=f)f=u.c_next,u.val==0&&(c(u.r_prev==null),u.row.ptr=u.r_next,u.r_next!=null&&(u.r_next.r_prev=null),u.c_prev==null?d.ptr=f:u.c_prev.c_next=f,f!=null&&(f.c_prev=u.c_prev),e.nnz--);d.stat==Di&&(e.valid=0)},X=e.glp_load_matrix=function(e,t,n,r,i){var s=e.tree,o,u,f,h,p,d,v;s!=null&&s.reason!=0&&l("glp_load_matrix: operation not allowed");for(p=1;p<=e.m;p++){o=e.row[p];while(o.ptr!=null)f=o.ptr,o.ptr=f.r_next,e.nnz--}c(e.nnz==0);for(d=1;d<=e.n;d++)e.col[d].ptr=null;t<0&&l("glp_load_matrix: ne = "+t+"; invalid number of constraint coefficients"),t>a&&l("glp_load_matrix: ne = "+t+"; too many constraint coefficients");for(v=1;v<=t;v++)p=n[v],d=r[v],1<=p&&p<=e.m||l("glp_load_matrix: ia["+v+"] = "+p+"; row index out of range"),o=e.row[p],1<=d&&d<=e.n||l("glp_load_matrix: ja["+v+"] = "+d+"; column index out of range"),u=e.col[d],f={},e.nnz++,f.row=o,f.col=u,f.val=i[v],f.r_prev=null,f.r_next=o.ptr,f.r_next!=null&&(f.r_next.r_prev=f),o.ptr=f;c(e.nnz==t);for(p=1;p<=e.m;p++)for(f=e.row[p].ptr;f!=null;f=f.r_next){u=f.col;if(u.ptr!=null&&u.ptr.row.i==p){for(v=1;v<=t;v++)if(n[v]==p&&r[v]==u.j)break;l("glp_load_mat: ia["+v+"] = "+p+"; ja["+v+"] = "+u.j+"; duplicate indices not allowed")}f.c_prev=null,f.c_next=u.ptr,f.c_next!=null&&(f.c_next.c_prev=f),u.ptr=f}for(p=1;p<=e.m;p++){o=e.row[p];for(f=o.ptr;f!=null;f=h)h=f.r_next,f.val==0&&(f.r_prev==null?o.ptr=h:f.r_prev.r_next=h,h!=null&&(h.r_prev=f.r_prev),f.c_prev==null?f.col.ptr=f.c_next:f.c_prev.c_next=f.c_next,f.c_next!=null&&(f.c_next.c_prev=f.c_prev),e.nnz--)}e.valid=0},V=e.glp_check_dup=function(e,t,n,r,i){var s,o,u,a,f,h,p;e<0&&l("glp_check_dup: m = %d; invalid parameter"),t<0&&l("glp_check_dup: n = %d; invalid parameter"),n<0&&l("glp_check_dup: ne = %d; invalid parameter"),n>0&&r==null&&l("glp_check_dup: ia = "+r+"; invalid parameter"),n>0&&i==null&&l("glp_check_dup: ja = "+i+"; invalid parameter");for(u=1;u<=n;u++){s=r[u],o=i[u];if(!(1<=s&&s<=e&&1<=o&&o<=t))return h=-u,h}if(e==0||t==0)return h=0,h;a=new Array(1+e),f=new Array(1+n),p=new Array(1+t);for(s=1;s<=e;s++)a[s]=0;for(u=1;u<=n;u++)s=r[u],f[u]=a[s],a[s]=u;for(o=1;o<=t;o++)p[o]=0;for(s=1;s<=e;s++){for(u=a[s];u!=0;u=f[u]){o=i[u];if(p[o]){for(u=1;u<=n;u++)if(r[u]==s&&i[u]==o)break;c(u<=n);for(u++;u<=n;u++)if(r[u]==s&&i[u]==o)break;return c(u<=n),h=+u,h}p[o]=1}for(u=a[s];u!=0;u=f[u])p[i[u]]=0}return h=0,h},$=e.glp_sort_matrix=function(e){var t,n,r;(e==null||e.magic!=O)&&l("glp_sort_matrix: P = "+e+"; invalid problem object");for(n=e.m;n>=1;n--)e.row[n].ptr=null;for(r=e.n;r>=1;r--)for(t=e.col[r].ptr;t!=null;t=t.c_next)n=t.row.i,t.r_prev=null,t.r_next=e.row[n].ptr,t.r_next!=null&&(t.r_next.r_prev=t),e.row[n].ptr=t;for(r=e.n;r>=1;r--)e.col[r].ptr=null;for(n=e.m;n>=1;n--)for(t=e.row[n].ptr;t!=null;t=t.r_next)r=t.col.j,t.c_prev=null,t.c_next=e.col[r].ptr,t.c_next!=null&&(t.c_next.c_prev=t),e.col[r].ptr=t},J=e.glp_del_rows=function(e,t,n){var r=e.tree,i,s,o,u;1<=t&&t<=e.m||l("glp_del_rows: nrs = "+t+"; invalid number of rows");for(o=1;o<=t;o++)s=n[o],1<=s&&s<=e.m||l("glp_del_rows: num["+o+"] = "+s+"; row number out of range"),i=e.row[s],r!=null&&r.reason!=0&&(r.reason!=Fs&&r.reason!=Rs&&l("glp_del_rows: operation not allowed"),c(r.curr!=null),i.level!=r.curr.level&&l("glp_del_rows: num["+o+"] = "+s+"; invalid attempt to delete row created not in current subproblem"),i.stat!=Di&&l("glp_del_rows: num["+o+"] = "+s+"; invalid attempt to delete active row (constraint)"),r.reinv=1),i.i==0&&l("glp_del_rows: num["+o+"] = "+s+"; duplicate row numbers not allowed"),F(e,s,null),c(i.node==null),z(e,s,0,null,null),c(i.ptr==null),i.i=0;u=0;for(s=1;s<=e.m;s++)i=e.row[s],i.i!=0&&(i.i=++u,e.row[i.i]=i);e.m=u,e.valid=0},K=e.glp_del_cols=function(e,t,n){var r=e.tree,i,s,o,u;r!=null&&r.reason!=0&&l("glp_del_cols: operation not allowed"),1<=t&&t<=e.n||l("glp_del_cols: ncs = "+t+"; invalid number of columns");for(o=1;o<=t;o++)s=n[o],1<=s&&s<=e.n||l("glp_del_cols: num["+o+"] = "+s+"; column number out of range"),i=e.col[s],i.j==0&&l("glp_del_cols: num["+o+"] = "+s+"; duplicate column numbers not allowed"),I(e,s,null),c(i.node==null),W(e,s,0,null,null),c(i.ptr==null),i.j=0,i.stat==Di&&(e.valid=0);u=0;for(s=1;s<=e.n;s++)i=e.col[s],i.j!=0&&(i.j=++u,e.col[i.j]=i);e.n=u;if(e.valid){var a=e.m,f=e.head;for(s=1;s<=u;s++)o=e.col[s].bind,o!=0&&(c(1<=o&&o<=a),f[o]=a+s)}},Q=e.glp_copy_prob=function(e,t,n){var r=e.tree,i={},s,o,u,a,f;r!=null&&r.reason!=0&&l("glp_copy_prob: operation not allowed"),e==t&&l("glp_copy_prob: copying problem object to itself not allowed"),n!=Bs&&n!=js&&l("glp_copy_prob: names = "+n+"; invalid parameter"),G(e),n&&t.name!=null&&D(e,t.name),n&&t.obj!=null&&P(e,t.obj),e.dir=t.dir,e.c0=t.c0,t.m>0&&B(e,t.m),t.n>0&&j(e,t.n),nn(t,i),sn(e,i),e.pbs_stat=t.pbs_stat,e.dbs_stat=t.dbs_stat,e.obj_val=t.obj_val,e.some=t.some,e.ipt_stat=t.ipt_stat,e.ipt_obj=t.ipt_obj,e.mip_stat=t.mip_stat,e.mip_obj=t.mip_obj;var c,h;for(s=1;s<=t.m;s++)c=e.row[s],h=t.row[s],n&&h.name!=null&&F(e,s,h.name),c.type=h.type,c.lb=h.lb,c.ub=h.ub,c.rii=h.rii,c.stat=h.stat,c.prim=h.prim,c.dual=h.dual,c.pval=h.pval,c.dval=h.dval,c.mipx=h.mipx;a=new Array(1+t.m),f=new Array(1+t.m);for(o=1;o<=t.n;o++)c=e.col[o],h=t.col[o],n&&h.name!=null&&I(e,o,h.name),c.kind=h.kind,c.type=h.type,c.lb=h.lb,c.ub=h.ub,c.coef=h.coef,u=mt(t,o,a,f),W(e,o,u,a,f),c.sjj=h.sjj,c.stat=h.stat,c.prim=h.prim,c.dual=h.dual,c.pval=h.pval,c.dval=h.dval,c.mipx=h.mipx},G=e.glp_erase_prob=function(e){var t=e.tree;t!=null&&t.reason!=0&&l("glp_erase_prob: operation not allowed"),Y(e),M(e)},Z=e.glp_delete_prob=function(e){var t=e.tree;t!=null&&t.reason!=0&&l("glp_delete_prob: operation not allowed"),Y(e)},et=e.glp_get_prob_name=function(e){return e.name},tt=e.glp_get_obj_name=function(e){return e.obj},nt=e.glp_get_obj_dir=function(e){return e.dir},rt=e.glp_get_num_rows=function(e){return e.m},it=e.glp_get_num_cols=function(e){return e.n},st=e.glp_get_row_name=function(e,t){return 1<=t&&t<=e.m||l("glp_get_row_name: i = "+t+"; row number out of range"),e.row[t].name},ot=e.glp_get_col_name=function(e,t){return 1<=t&&t<=e.n||l("glp_get_col_name: j = "+t+"; column number out of range"),e.col[t].name},ut=e.glp_get_row_type=function(e,t){return 1<=t&&t<=e.m||l("glp_get_row_type: i = "+t+"; row number out of range"),e.row[t].type},at=e.glp_get_row_lb=function(e,t){var r;1<=t&&t<=e.m||l("glp_get_row_lb: i = "+t+"; row number out of range");switch(e.row[t].type){case Li:case Oi:r=-n;break;case Ai:case Mi:case _i:r=e.row[t].lb;break;default:c(e!=e)}return r},ft=e.glp_get_row_ub=function(e,t){var r;1<=t&&t<=e.m||l("glp_get_row_ub: i = "+t+"; row number out of range");switch(e.row[t].type){case Li:case Ai:r=+n;break;case Oi:case Mi:case _i:r=e.row[t].ub;break;default:c(e!=e)}return r},lt=e.glp_get_col_type=function(e,t){return 1<=t&&t<=e.n||l("glp_get_col_type: j = "+t+"; column number out of range"),e.col[t].type},ct=e.glp_get_col_lb=function(e,t){var r;1<=t&&t<=e.n||l("glp_get_col_lb: j = "+t+"; column number out of range");switch(e.col[t].type){case Li:case Oi:r=-n;break;case Ai:case Mi:case _i:r=e.col[t].lb;break;default:c(e!=e)}return r},ht=e.glp_get_col_ub=function(e,t){var r;1<=t&&t<=e.n||l("glp_get_col_ub: j = "+t+"; column number out of range");switch(e.col[t].type){case Li:case Ai:r=+n;break;case Oi:case Mi:case _i:r=e.col[t].ub;break;default:c(e!=e)}return r},pt=e.glp_get_obj_coef=function(e,t){return 0<=t&&t<=e.n||l("glp_get_obj_coef: j = "+t+"; column number out of range"),t==0?e.c0:e.col[t].coef},dt=e.glp_get_num_nz=function(e){return e.nnz},vt=e.glp_get_mat_row=function(e,t,n,r){var i,s;1<=t&&t<=e.m||l("glp_get_mat_row: i = "+t+"; row number out of range"),s=0;for(i=e.row[t].ptr;i!=null;i=i.r_next)s++,n!=null&&(n[s]=i.col.j),r!=null&&(r[s]=i.val);return c(s<=e.n),s},mt=e.glp_get_mat_col=function(e,t,n,r){var i,s;1<=t&&t<=e.n||l("glp_get_mat_col: j = "+t+"; column number out of range"),s=0;for(i=e.col[t].ptr;i!=null;i=i.c_next)s++,n!=null&&(n[s]=i.row.i),r!=null&&(r[s]=i.val);return c(s<=e.m),s},gt=e.glp_create_index=function(e){var t,n,r,i;if(e.r_tree==null){e.r_tree={};for(r=1;r<=e.m;r++)t=e.row[r],t.name!=null&&(e.r_tree[t.name]=t)}if(e.c_tree==null){e.c_tree={};for(i=1;i<=e.n;i++)n=e.col[i],n.name!=null&&(e.c_tree[n.name]=n)}},yt=e.glp_find_row=function(e,t){var n=0;e.r_tree==null&&l("glp_find_row: row name index does not exist");var r=e.r_tree[t];return r&&(n=r.i),n},bt=e.glp_find_col=function(e,t){var n=0;e.c_tree==null&&l("glp_find_col: column name index does not exist");var r=e.c_tree[t];return r&&(n=r.j),n},wt=e.glp_delete_index=function(e){e.r_tree=null,e.r_tree=null},Et=e.glp_set_rii=function(e,t,n){1<=t&&t<=e.m||l("glp_set_rii: i = "+t+"; row number out of range"),n<=0&&l("glp_set_rii: i = "+t+"; rii = "+n+"; invalid scale factor");if(e.valid&&e.row[t].rii!=n)for(var r=e.row[t].ptr;r!=null;r=r.r_next)if(r.col.stat==Di){e.valid=0;break}e.row[t].rii=n},St=e.glp_set_sjj=function(e,t,n){1<=t&&t<=e.n||l("glp_set_sjj: j = "+t+"; column number out of range"),n<=0&&l("glp_set_sjj: j = "+t+"; sjj = "+n+"; invalid scale factor"),e.valid&&e.col[t].sjj!=n&&e.col[t].stat==Di&&(e.valid=0),e.col[t].sjj=n},xt=e.glp_get_rii=function(e,t){return 1<=t&&t<=e.m||l("glp_get_rii: i = "+t+"; row number out of range"),e.row[t].rii},Tt=e.glp_get_sjj=function(e,t){return 1<=t&&t<=e.n||l("glp_get_sjj: j = "+t+"; column number out of range"),e.col[t].sjj},Nt=e.glp_unscale_prob=function(e){var t=rt(e),n=it(e),r,i;for(r=1;r<=t;r++)Et(e,r,1);for(i=1;i<=n;i++)St(e,i,1)},Ct=e.glp_set_row_stat=function(e,t,n){var r;1<=t&&t<=e.m||l("glp_set_row_stat: i = "+t+"; row number out of range"),n!=Di&&n!=Pi&&n!=Hi&&n!=Bi&&n!=ji&&l("glp_set_row_stat: i = "+t+"; stat = "+n+"; invalid status"),r=e.row[t];if(n!=Di)switch(r.type){case Li:n=Bi;break;case Ai:n=Pi;break;case Oi:n=Hi;break;case Mi:n!=Hi&&(n=Pi);break;case _i:n=ji;break;default:c(r!=r)}if(r.stat==Di&&n!=Di||r.stat!=Di&&n==Di)e.valid=0;r.stat=n},kt=e.glp_set_col_stat=function(e,t,n){var r;1<=t&&t<=e.n||l("glp_set_col_stat: j = "+t+"; column number out of range"),n!=Di&&n!=Pi&&n!=Hi&&n!=Bi&&n!=ji&&l("glp_set_col_stat: j = "+t+"; stat = "+n+"; invalid status"),r=e.col[t];if(n!=Di)switch(r.type){case Li:n=Bi;break;case Ai:n=Pi;break;case Oi:n=Hi;break;case Mi:n!=Hi&&(n=Pi);break;case _i:n=ji;break;default:c(r!=r)}if(r.stat==Di&&n!=Di||r.stat!=Di&&n==Di)e.valid=0;r.stat=n},Lt=e.glp_std_basis=function(e){var t,n;for(t=1;t<=e.m;t++)Ct(e,t,Di);for(n=1;n<=e.n;n++){var r=e.col[n];r.type==Mi&&Math.abs(r.lb)>Math.abs(r.ub)?kt(e,n,Hi):kt(e,n,Pi)}},At=e.glp_simplex=function(e,t){function n(e,t){var n;if(!Zt(e)){n=en(e),n!=0&&(n==Js?t.msg_lev>=ns&&h("glp_simplex: initial basis is invalid"):n==Ks?t.msg_lev>=ns&&h("glp_simplex: initial basis is singular"):n==Qs?t.msg_lev>=ns&&h("glp_simplex: initial basis is ill-conditioned"):c(n!=n));if(n!=0)return n}return t.meth==os?n=_h(e,t):t.meth==us?(n=Dh(e,t),n==Ys&&e.valid&&(n=_h(e,t))):t.meth==as?n=Dh(e,t):c(t!=t),n}function r(e,t){function u(){return i!=null&&Z(i),o}function a(){return pc(r,i),Z(i),i=null,dc(r,e),o=0,u()}var r,i=null,s={},o;t.msg_lev>=is&&h("Preprocessing..."),r=Vl(),cc(r,e,js,zi,js),o=nh(r,t),o!=0&&(o==ro?t.msg_lev>=is&&h("PROBLEM HAS NO PRIMAL FEASIBLE SOLUTION"):o==io?t.msg_lev>=is&&h("PROBLEM HAS NO DUAL FEASIBLE SOLUTION"):c(o!=o));if(o!=0)return u();i=_(),hc(r,i);if(i.m==0&&i.n==0)return i.pbs_stat=i.dbs_stat=$i,i.obj_val=i.c0,t.msg_lev>=rs&&t.out_dly==0&&h(e.it_cnt+": obj = "+i.obj_val+"  infeas = 0.0"),t.msg_lev>=is&&h("OPTIMAL SOLUTION FOUND BY LP PREPROCESSOR"),a();t.msg_lev>=is&&h(i.m+" row"+(i.m==1?"":"s")+", "+i.n+" column"+(i.n==1?"":"s")+", "+i.nnz+" non-zero"+(i.nnz==1?"":"s")+""),nn(e,s),sn(i,s);var f=E(),l=f.term_out;return!l||t.msg_lev<is?f.term_out=js:f.term_out=Bs,Mh(i,Ui),f.term_out=l,f=E(),l=f.term_out,!l||t.msg_lev<is?f.term_out=js:f.term_out=Bs,gr(i,0),f.term_out=l,i.it_cnt=e.it_cnt,o=n(i,t),e.it_cnt=i.it_cnt,o!=0||i.pbs_stat!=$i||i.dbs_stat!=$i?(t.msg_lev>=ns&&h("glp_simplex: unable to recover undefined or non-optimal solution"),o==0&&(i.pbs_stat==Ki?o=ro:i.dbs_stat==Ki?o=io:c(i!=i)),u()):a()}function i(e,t){function f(){r.stat=Pi,r.prim=r.lb}function l(){r.stat=Hi,r.prim=r.ub}var n,r,i,s,o,u,a;e.valid=0,e.pbs_stat=e.dbs_stat=$i,e.obj_val=e.c0,e.some=0,o=u=0;for(i=1;i<=e.m;i++){n=e.row[i],n.stat=Di,n.prim=n.dual=0;if(n.type==Ai||n.type==Mi||n.type==_i)n.lb>+t.tol_bnd&&(e.pbs_stat=Ki,e.some==0&&t.meth!=os&&(e.some=i)),o<+n.lb&&(o=+n.lb);if(n.type==Oi||n.type==Mi||n.type==_i)n.ub<-t.tol_bnd&&(e.pbs_stat=Ki,e.some==0&&t.meth!=os&&(e.some=i)),o<-n.ub&&(o=-n.ub)}a=1;for(s=1;s<=e.n;s++)r=e.col[s],a<Math.abs(r.coef)&&(a=Math.abs(r.coef));a=(e.dir==xi?1:-1)/a;for(s=1;s<=e.n;s++){r=e.col[s],r.type==Li?(r.stat=Bi,r.prim=0):r.type==Ai?f():r.type==Oi?l():r.type==Mi?a*r.coef>0?f():a*r.coef<0?l():Math.abs(r.lb)<=Math.abs(r.ub)?f():l():r.type==_i&&(r.stat=ji,r.prim=r.lb),r.dual=r.coef,e.obj_val+=r.coef*r.prim;if(r.type==Li||r.type==Ai)a*r.dual<-t.tol_dj&&(e.dbs_stat=Ki,e.some==0&&t.meth==os&&(e.some=e.m+s)),u<-a*r.dual&&(u=-a*r.dual);if(r.type==Li||r.type==Oi)a*r.dual>+t.tol_dj&&(e.dbs_stat=Ki,e.some==0&&t.meth==os&&(e.some=e.m+s)),u<+a*r.dual&&(u=+a*r.dual)}t.msg_lev>=rs&&t.out_dly==0&&h("~"+e.it_cnt+": obj = "+e.obj_val+"  infeas = "+(t.meth==os?o:u)+""),t.msg_lev>=is&&t.out_dly==0&&(e.pbs_stat==$i&&e.dbs_stat==$i?h("OPTIMAL SOLUTION FOUND"):e.pbs_stat==Ki?h("PROBLEM HAS NO FEASIBLE SOLUTION"):t.meth==os?h("PROBLEM HAS UNBOUNDED SOLUTION"):h("PROBLEM HAS NO DUAL FEASIBLE SOLUTION"))}var s={},o,u,a;(e==null||e.magic!=O)&&l("glp_simplex: P = "+e+"; invalid problem object"),e.tree!=null&&e.tree.reason!=0&&l("glp_simplex: operation not allowed"),t==null&&(t=s,Ot(t)),t.msg_lev!=ts&&t.msg_lev!=ns&&t.msg_lev!=rs&&t.msg_lev!=is&&t.msg_lev!=ss&&l("glp_simplex: msg_lev = "+t.msg_lev+"; invalid parameter"),t.meth!=os&&t.meth!=us&&t.meth!=as&&l("glp_simplex: meth = "+t.meth+"; invalid parameter"),t.pricing!=fs&&t.pricing!=ls&&l("glp_simplex: pricing = "+t.pricing+"; invalid parameter"),t.r_test!=cs&&t.r_test!=hs&&l("glp_simplex: r_test = "+t.r_test+"; invalid parameter"),0<t.tol_bnd&&t.tol_bnd<1||l("glp_simplex: tol_bnd = "+t.tol_bnd+"; invalid parameter"),0<t.tol_dj&&t.tol_dj<1||l("glp_simplex: tol_dj = "+t.tol_dj+"; invalid parameter"),0<t.tol_piv&&t.tol_piv<1||l("glp_simplex: tol_piv = "+t.tol_piv+"; invalid parameter"),t.it_lim<0&&l("glp_simplex: it_lim = "+t.it_lim+"; invalid parameter"),t.tm_lim<0&&l("glp_simplex: tm_lim = "+t.tm_lim+"; invalid parameter"),t.out_frq<1&&l("glp_simplex: out_frq = "+t.out_frq+"; invalid parameter"),t.out_dly<0&&l("glp_simplex: out_dly = "+t.out_dly+"; invalid parameter"),t.presolve!=Bs&&t.presolve!=js&&l("glp_simplex: presolve = "+t.presolve+"; invalid parameter"),e.pbs_stat=e.dbs_stat=Vi,e.obj_val=0,e.some=0;for(o=1;o<=e.m;o++){var f=e.row[o];if(f.type==Mi&&f.lb>=f.ub)return t.msg_lev>=ns&&h("glp_simplex: row "+o+": lb = "+f.lb+", ub = "+f.ub+"; incorrect bounds"),a=Gs,a}for(u=1;u<=e.n;u++){var p=e.col[u];if(p.type==Mi&&p.lb>=p.ub)return t.msg_lev>=ns&&h("glp_simplex: column "+u+": lb = "+p.lb+", ub = "+p.ub+"; incorrect bounds"),a=Gs,a}return t.msg_lev>=is&&(h("GLPK Simplex Optimizer, v"+S()+""),h(e.m+" row"+(e.m==1?"":"s")+", "+e.n+" column"+(e.n==1?"":"s")+", "+e.nnz+" non-zero"+(e.nnz==1?"":"s")+"")),e.nnz==0?(i(e,t),a=0):t.presolve?a=r(e,t):a=n(e,t),a},Ot=e.glp_init_smcp=function(e){e.msg_lev=is,e.meth=os,e.pricing=ls,e.r_test=hs,e.tol_bnd=1e-7,e.tol_dj=1e-7,e.tol_piv=1e-10,e.obj_ll=-n,e.obj_ul=+n,e.it_lim=r,e.tm_lim=r,e.out_frq=500,e.out_dly=0,e.presolve=js},Mt=e.glp_get_status=function(e){var t;t=_t(e);switch(t){case $i:switch(Dt(e)){case $i:t=Qi;break;case Ki:t=Gi;break;case Vi:case Ji:break;default:c(e!=e)}break;case Vi:case Ji:case Ki:break;default:c(e!=e)}return t},_t=e.glp_get_prim_stat=function(e){return e.pbs_stat},Dt=e.glp_get_dual_stat=function(e){return e.dbs_stat},Pt=e.glp_get_obj_val=function(e){return e.obj_val},Ht=e.glp_get_row_stat=function(e,t){return 1<=t&&t<=e.m||l("glp_get_row_stat: i = "+t+"; row number out of range"),e.row[t].stat},Bt=e.glp_get_row_prim=function(e,t){return 1<=t&&t<=e.m||l("glp_get_row_prim: i = "+t+"; row number out of range"),e.row[t].prim},jt=e.glp_get_row_dual=function(e,t){return 1<=t&&t<=e.m||l("glp_get_row_dual: i = "+t+"; row number out of range"),e.row[t].dual},Ft=e.glp_get_col_stat=function(e,t){return 1<=t&&t<=e.n||l("glp_get_col_stat: j = "+t+"; column number out of range"),e.col[t].stat},It=e.glp_get_col_prim=function(e,t){return 1<=t&&t<=e.n||l("glp_get_col_prim: j = "+t+"; column number out of range"),e.col[t].prim},qt=e.glp_get_col_dual=function(e,t){return 1<=t&&t<=e.n||l("glp_get_col_dual: j = "+t+"; column number out of range"),e.col[t].dual},Rt=e.glp_get_unbnd_ray=function(e){var t=e.some;return c(t>=0),t>e.m+e.n&&(t=0),t},Ut=e.glp_set_col_kind=function(e,t,n){1<=t&&t<=e.n||l("glp_set_col_kind: j = "+t+"; column number out of range");var r=e.col[t];switch(n){case Ni:r.kind=Ni;break;case Ci:r.kind=Ci;break;case ki:r.kind=Ci,(r.type!=Mi||r.lb!=0||r.ub!=1)&&R(e,t,Mi,0,1);break;default:l("glp_set_col_kind: j = "+t+"; kind = "+n+"; invalid column kind")}},zt=e.glp_get_col_kind=function(e,t){1<=t&&t<=e.n||l("glp_get_col_kind: j = "+t+"; column number out of range");var n=e.col[t],r=n.kind;switch(r){case Ni:break;case Ci:n.type==Mi&&n.lb==0&&n.ub==1&&(r=ki);break;default:c(r!=r)}return r},Wt=e.glp_get_num_int=function(e){var t,n=0;for(var r=1;r<=e.n;r++)t=e.col[r],t.kind==Ci&&n++;return n},Xt=e.glp_get_num_bin=function(e){var t,n=0;for(var r=1;r<=e.n;r++)t=e.col[r],t.kind==Ci&&t.type==Mi&&t.lb==0&&t.ub==1&&n++;return n},Vt=e.glp_intopt=function(e,t){function n(e,t){var n,r;return Mt(e)!=Qi?(t.msg_lev>=ns&&h("glp_intopt: optimal basis to initial LP relaxation not provided"),r=so,r):(t.msg_lev>=is&&h("Integer optimization begins..."),n=Sr(e,t),r=Rr(n),kr(n),r==0?e.mip_stat==$i?(t.msg_lev>=is&&h("INTEGER OPTIMAL SOLUTION FOUND"),e.mip_stat=Qi):(t.msg_lev>=is&&h("PROBLEM HAS NO INTEGER FEASIBLE SOLUTION"),e.mip_stat=Ki):r==uo?t.msg_lev>=is&&h("RELATIVE MIP GAP TOLERANCE REACHED; SEARCH TERMINATED"):r==no?t.msg_lev>=is&&h("TIME LIMIT EXCEEDED; SEARCH TERMINATED"):r==Ys?t.msg_lev>=ns&&h("glp_intopt: cannot solve current LP relaxation"):r==oo?t.msg_lev>=is&&h("SEARCH TERMINATED BY APPLICATION"):c(r!=r),r)}function r(e,t){function l(){return o!=null&&Z(o),f}function p(){return pc(s,o),Z(o),o=null,dc(s,e),l()}var r=E(),i=r.term_out,s,o=null,u={},a={},f;t.msg_lev>=is&&h("Preprocessing..."),s=Vl(),cc(s,e,js,Xi,js),!i||t.msg_lev<is?r.term_out=js:r.term_out=Bs,f=rh(s,t),r.term_out=i,f!=0&&(f==ro?t.msg_lev>=is&&h("PROBLEM HAS NO PRIMAL FEASIBLE SOLUTION"):f==io?t.msg_lev>=is&&h("LP RELAXATION HAS NO DUAL FEASIBLE SOLUTION"):c(f!=f));if(f!=0)return l();o=_(),hc(s,o);if(o.m==0&&o.n==0)return o.mip_stat=Qi,o.mip_obj=o.c0,t.msg_lev>=is&&(h("Objective value = "+o.mip_obj+""),h("INTEGER OPTIMAL SOLUTION FOUND BY MIP PREPROCESSOR")),p();if(t.msg_lev>=is){var d=Wt(o),v=Xt(o),m;h(o.m+" row"+(o.m==1?"":"s")+", "+o.n+" column"+(o.n==1?"":"s")+", "+o.nnz+" non-zero"+(o.nnz==1?"":"s")+""),v==0?m="none of":d==1&&v==1?m="":v==1?m="one of":v==d?m="all of":m=v+" of",h(d+" integer variable"+(d==1?"":"s")+", "+m+" which "+(v==1?"is":"are")+" binary")}return nn(e,u),sn(o,u),!i||t.msg_lev<is?r.term_out=js:r.term_out=Bs,Mh(o,Fi|Ii|qi|Ri),r.term_out=i,!i||t.msg_lev<is?r.term_out=js:r.term_out=Bs,gr(o,0),r.term_out=i,t.msg_lev>=is&&h("Solving LP relaxation..."),Ot(a),a.msg_lev=t.msg_lev,o.it_cnt=e.it_cnt,f=At(o,a),e.it_cnt=o.it_cnt,f!=0?(t.msg_lev>=ns&&h("glp_intopt: cannot solve LP relaxation"),f=Ys,l()):(f=Mt(o),f==Qi?f=0:f==Ki?f=ro:f==Gi?f=io:c(f!=f),f!=0?l():(o.it_cnt=e.it_cnt,f=n(o,t),e.it_cnt=o.it_cnt,o.mip_stat!=Qi&&o.mip_stat!=$i?(e.mip_stat=o.mip_stat,l()):p()))}var i,s,o,u;(e==null||e.magic!=O)&&l("glp_intopt: P = "+e+"; invalid problem object"),e.tree!=null&&l("glp_intopt: operation not allowed"),t==null&&(t={},$t(t)),t.msg_lev!=ts&&t.msg_lev!=ns&&t.msg_lev!=rs&&t.msg_lev!=is&&t.msg_lev!=ss&&l("glp_intopt: msg_lev = "+t.msg_lev+"; invalid parameter"),t.br_tech!=gs&&t.br_tech!=ys&&t.br_tech!=bs&&t.br_tech!=ws&&t.br_tech!=Es&&l("glp_intopt: br_tech = "+t.br_tech+"; invalid parameter"),t.bt_tech!=Ss&&t.bt_tech!=xs&&t.bt_tech!=Ts&&t.bt_tech!=Ns&&l("glp_intopt: bt_tech = "+t.bt_tech+"; invalid parameter"),0<t.tol_int&&t.tol_int<1||l("glp_intopt: tol_int = "+t.tol_int+"; invalid parameter"),0<t.tol_obj&&t.tol_obj<1||l("glp_intopt: tol_obj = "+t.tol_obj+"; invalid parameter"),t.tm_lim<0&&l("glp_intopt: tm_lim = "+t.tm_lim+"; invalid parameter"),t.out_frq<0&&l("glp_intopt: out_frq = "+t.out_frq+"; invalid parameter"),t.out_dly<0&&l("glp_intopt: out_dly = "+t.out_dly+"; invalid parameter"),0<=t.cb_size&&t.cb_size<=256||l("glp_intopt: cb_size = "+t.cb_size+"; invalid parameter"),t.pp_tech!=Cs&&t.pp_tech!=ks&&t.pp_tech!=Ls&&l("glp_intopt: pp_tech = "+t.pp_tech+"; invalid parameter"),t.mip_gap<0&&l("glp_intopt: mip_gap = "+t.mip_gap+"; invalid parameter"),t.mir_cuts!=Bs&&t.mir_cuts!=js&&l("glp_intopt: mir_cuts = "+t.mir_cuts+"; invalid parameter"),t.gmi_cuts!=Bs&&t.gmi_cuts!=js&&l("glp_intopt: gmi_cuts = "+t.gmi_cuts+"; invalid parameter"),t.cov_cuts!=Bs&&t.cov_cuts!=js&&l("glp_intopt: cov_cuts = "+t.cov_cuts+"; invalid parameter"),t.clq_cuts!=Bs&&t.clq_cuts!=js&&l("glp_intopt: clq_cuts = "+t.clq_cuts+"; invalid parameter"),t.presolve!=Bs&&t.presolve!=js&&l("glp_intopt: presolve = "+t.presolve+"; invalid parameter"),t.binarize!=Bs&&t.binarize!=js&&l("glp_intopt: binarize = "+t.binarize+"; invalid parameter"),t.fp_heur!=Bs&&t.fp_heur!=js&&l("glp_intopt: fp_heur = "+t.fp_heur+"; invalid parameter"),e.mip_stat=Vi,e.mip_obj=0;for(i=1;i<=e.m;i++){var a=e.row[i];if(a.type==Mi&&a.lb>=a.ub)return t.msg_lev>=ns&&h("glp_intopt: row "+i+": lb = "+a.lb+", ub = "+a.ub+"; incorrect bounds"),o=Gs,o}for(s=1;s<=e.n;s++){u=e.col[s];if(u.type==Mi&&u.lb>=u.ub)return t.msg_lev>=ns&&h("glp_intopt: column "+s+": lb = "+u.lb+", ub = "+u.ub+"; incorrect bounds"),o=Gs,o}for(s=1;s<=e.n;s++){u=e.col[s];if(u.kind!=Ci)continue;if(u.type==Ai||u.type==Mi)if(u.lb!=Math.floor(u.lb))return t.msg_lev>=ns&&h("glp_intopt: integer column "+s+" has non-integer lower bound "+u.lb+""),o=Gs,o;if(u.type==Oi||u.type==Mi)if(u.ub!=Math.floor(u.ub))return t.msg_lev>=ns&&h("glp_intopt: integer column "+s+" has non-integer upper bound "+u.ub+""),o=Gs,o;if(u.type==_i&&u.lb!=Math.floor(u.lb))return t.msg_lev>=ns&&h("glp_intopt: integer column "+s+" has non-integer fixed value "+u.lb+""),o=Gs,o}if(t.msg_lev>=is){var f=Wt(e),p=Xt(e),d;h("GLPK Integer Optimizer, v"+S()+""),h(e.m+" row"+(e.m==1?"":"s")+", "+e.n+" column"+(e.n==1?"":"s")+", "+e.nnz+" non-zero"+(e.nnz==1?"":"s")+""),p==0?d="none of":f==1&&p==1?d="":p==1?d="one of":p==f?d="all of":d=p+" of",h(f+" integer variable"+(f==1?"":"s")+", "+d+" which "+(p==1?"is":"are")+" binary")}return t.presolve?o=r(e,t):o=n(e,t),o},$t=e.glp_init_iocp=function(e){e.msg_lev=is,e.br_tech=ws,e.bt_tech=Ts,e.tol_int=1e-5,e.tol_obj=1e-7,e.tm_lim=r,e.out_frq=5e3,e.out_dly=1e4,e.cb_func=null,e.cb_info=null,e.cb_size=0,e.pp_tech=Ls,e.mip_gap=0,e.mir_cuts=js,e.gmi_cuts=js,e.cov_cuts=js,e.clq_cuts=js,e.presolve=js,e.binarize=js,e.fp_heur=js},Jt=e.glp_mip_status=function(e){return e.mip_stat},Kt=e.glp_mip_obj_val=function(e){return e.mip_obj},Qt=e.glp_mip_row_val=function(e,t){return 1<=t&&t<=e.m||l("glp_mip_row_val: i = "+t+"; row number out of range"),e.row[t].mipx},Gt=e.glp_mip_col_val=function(e,t){return 1<=t&&t<=e.n||l("glp_mip_col_val: j = "+t+"; column number out of range"),e.col[t].mipx},Zt=e.glp_bf_exists=function(e){return e.m==0||e.valid},en=e.glp_factorize=function(e){function t(e,t,n,r){var i=e.m,s,o,u;c(1<=t&&t<=i),o=e.head[t];if(o<=i)u=1,n[1]=o,r[1]=1;else{u=0;for(s=e.col[o-i].ptr;s!=null;s=s.c_next)u++,n[u]=s.row.i,r[u]=-s.row.rii*s.val*s.col.sjj}return u}var n=e.m,r=e.n,i=e.row,s=e.col,o=e.head,u,a,f,l;e.valid=0,u=0;for(a=1;a<=n+r;a++){a<=n?(f=i[a].stat,i[a].bind=0):(f=s[a-n].stat,s[a-n].bind=0);if(f==Di){u++;if(u>n)return l=Js,l;o[u]=a,a<=n?i[a].bind=u:s[a-n].bind=u}}if(u<n)return l=Js,l;if(n>0){e.bfd==null&&(e.bfd=Jn(),rn(e));switch(Qn(e.bfd,n,e.head,t,e)){case 0:break;case zn:return l=Ks,l;case Wn:return l=Qs,l;default:c(e!=e)}e.valid=1}return l=0,l},tn=e.glp_bf_updated=function(e){return e.m!=0&&!e.valid&&l("glp_bf_update: basis factorization does not exist"),e.m==0?0:er(e.bfd)},nn=e.glp_get_bfcp=function(e,t){var n=e.bfcp;n==null?(t.type=Yi,t.lu_size=0,t.piv_tol=.1,t.piv_lim=4,t.suhl=Bs,t.eps_tol=1e-15,t.max_gro=1e10,t.nfs_max=100,t.upd_tol=1e-6,t.nrs_max=100,t.rs_size=0):p(t,n)},sn=e.glp_set_bfcp=function(e,t){var n=e.bfcp;t==null?n!=null&&(e.bfcp=null):(n==null&&(n=e.bfcp={}),p(n,t),n.type!=Yi&&n.type!=Zi&&n.type!=es&&l("glp_set_bfcp: type = "+n.type+"; invalid parameter"),n.lu_size<0&&l("glp_set_bfcp: lu_size = "+n.lu_size+"; invalid parameter"),0<n.piv_tol&&n.piv_tol<1||l("glp_set_bfcp: piv_tol = "+n.piv_tol+"; invalid parameter"),n.piv_lim<1&&l("glp_set_bfcp: piv_lim = "+n.piv_lim+"; invalid parameter"),n.suhl!=Bs&&n.suhl!=js&&l("glp_set_bfcp: suhl = "+n.suhl+"; invalid parameter"),0<=n.eps_tol&&n.eps_tol<=1e-6||l("glp_set_bfcp: eps_tol = "+n.eps_tol+"; invalid parameter"),n.max_gro<1&&l("glp_set_bfcp: max_gro = "+n.max_gro+"; invalid parameter"),1<=n.nfs_max&&n.nfs_max<=32767||l("glp_set_bfcp: nfs_max = "+n.nfs_max+"; invalid parameter"),0<n.upd_tol&&n.upd_tol<1||l("glp_set_bfcp: upd_tol = "+n.upd_tol+"; invalid parameter"),1<=n.nrs_max&&n.nrs_max<=32767||l("glp_set_bfcp: nrs_max = "+n.nrs_max+"; invalid parameter"),n.rs_size<0&&l("glp_set_bfcp: rs_size = "+n.nrs_max+"; invalid parameter"),n.rs_size==0&&(n.rs_size=20*n.nrs_max)),e.bfd!=null&&rn(e)},on=e.glp_get_bhead=function(e,t){return e.m!=0&&!e.valid&&l("glp_get_bhead: basis factorization does not exist"),1<=t&&t<=e.m||l("glp_get_bhead: k = "+t+"; index out of range"),e.head[t]},un=e.glp_get_row_bind=function(e,t){return e.m!=0&&!e.valid&&l("glp_get_row_bind: basis factorization does not exist"),1<=t&&t<=e.m||l("glp_get_row_bind: i = "+t+"; row number out of range"),e.row[t].bind},an=e.glp_get_col_bind=function(e,t){return e.m!=0&&!e.valid&&l("glp_get_col_bind: basis factorization does not exist"),1<=t&&t<=e.n||l("glp_get_col_bind: j = "+t+"; column number out of range"),e.col[t].bind},fn=e.glp_ftran=function(e,t){var n=e.m,r=e.row,i=e.col,s,o;n!=0&&!e.valid&&l("glp_ftran: basis factorization does not exist");for(s=1;s<=n;s++)t[s]*=r[s].rii;n>0&&Gn(e.bfd,t);for(s=1;s<=n;s++)o=e.head[s],o<=n?t[s]/=r[o].rii:t[s]*=i[o-n].sjj},ln=e.glp_btran=function(e,t){var n=e.m,r=e.row,i=e.col,s,o;n!=0&&!e.valid&&l("glp_btran: basis factorization does not exist");for(s=1;s<=n;s++)o=e.head[s],o<=n?t[s]/=r[o].rii:t[s]*=i[o-n].sjj;n>0&&Yn(e.bfd,t);for(s=1;s<=n;s++)t[s]*=r[s].rii},cn=e.glp_warm_up=function(e){var t,n,r,i,s,o,u,a,f,l;e.pbs_stat=e.dbs_stat=Vi,e.obj_val=0,e.some=0;for(i=1;i<=e.m;i++)t=e.row[i],t.prim=t.dual=0;for(s=1;s<=e.n;s++)n=e.col[s],n.prim=n.dual=0;if(!Zt(e)){u=en(e);if(u!=0)return u}l=new Array(1+e.m);for(i=1;i<=e.m;i++)l[i]=0;for(i=1;i<=e.m;i++){t=e.row[i];if(t.stat==Di)continue;t.stat==Pi?t.prim=t.lb:t.stat==Hi?t.prim=t.ub:t.stat==Bi?t.prim=0:t.stat==ji?t.prim=t.lb:c(t!=t),l[i]-=t.prim}for(s=1;s<=e.n;s++){n=e.col[s];if(n.stat==Di)continue;n.stat==Pi?n.prim=n.lb:n.stat==Hi?n.prim=n.ub:n.stat==Bi?n.prim=0:n.stat==ji?n.prim=n.lb:c(n!=n);if(n.prim!=0)for(r=n.ptr;r!=null;r=r.c_next)l[r.row.i]+=r.val*n.prim}fn(e,l),e.pbs_stat=$i;for(i=1;i<=e.m;i++){t=e.row[i];if(t.stat!=Di)continue;t.prim=l[t.bind],o=t.type;if(o==Ai||o==Mi||o==_i)a=1e-6+1e-9*Math.abs(t.lb),t.prim<t.lb-a&&(e.pbs_stat=Ji);if(o==Oi||o==Mi||o==_i)a=1e-6+1e-9*Math.abs(t.ub),t.prim>t.ub+a&&(e.pbs_stat=Ji)}for(s=1;s<=e.n;s++){n=e.col[s];if(n.stat!=Di)continue;n.prim=l[n.bind],o=n.type;if(o==Ai||o==Mi||o==_i)a=1e-6+1e-9*Math.abs(n.lb),n.prim<n.lb-a&&(e.pbs_stat=Ji);if(o==Oi||o==Mi||o==_i)a=1e-6+1e-9*Math.abs(n.ub),n.prim>n.ub+a&&(e.pbs_stat=Ji)}e.obj_val=e.c0;for(s=1;s<=e.n;s++)n=e.col[s],e.obj_val+=n.coef*n.prim;for(i=1;i<=e.m;i++)l[i]=0;for(s=1;s<=e.n;s++)n=e.col[s],n.stat==Di&&(l[n.bind]=n.coef);ln(e,l),e.dbs_stat=$i;for(i=1;i<=e.m;i++){t=e.row[i];if(t.stat==Di){t.dual=0;continue}t.dual=-l[i],o=t.type,f=e.dir==xi?+t.dual:-t.dual;if((o==Li||o==Ai)&&f<-0.00001||(o==Li||o==Oi)&&f>1e-5)e.dbs_stat=Ji}for(s=1;s<=e.n;s++){n=e.col[s];if(n.stat==Di){n.dual=0;continue}n.dual=n.coef;for(r=n.ptr;r!=null;r=r.c_next)n.dual+=r.val*l[r.row.i];o=n.type,f=e.dir==xi?+n.dual:-n.dual;if((o==Li||o==Ai)&&f<-0.00001||(o==Li||o==Oi)&&f>1e-5)e.dbs_stat=Ji}return 0},hn=e.glp_eval_tab_row=function(e,t,n,r){var i=e.m,s=e.n,o,u,a,f,h,p,d,v;i!=0&&!e.valid&&l("glp_eval_tab_row: basis factorization does not exist"),1<=t&&t<=i+s||l("glp_eval_tab_row: k = "+t+"; variable number out of range"),t<=i?o=un(e,t):o=an(e,t-i),o==0&&l("glp_eval_tab_row: k = "+t+"; variable must be basic"),c(1<=o&&o<=i),d=new Array(1+i),h=new Array(1+i),v=new Array(1+i);for(u=1;u<=i;u++)d[u]=0;d[o]=1,ln(e,d),a=0;for(t=1;t<=i+s;t++){if(t<=i){if(Ht(e,t)==Di)continue;p=-d[t]}else{if(Ft(e,t-i)==Di)continue;f=mt(e,t-i,h,v),p=0;for(u=1;u<=f;u++)p+=d[h[u]]*v[u]}p!=0&&(a++,n[a]=t,r[a]=p)}return c(a<=s),a},pn=e.glp_eval_tab_col=function(e,t,n,r){var i=e.m,s=e.n,o,u,a,f;i!=0&&!e.valid&&l("glp_eval_tab_col: basis factorization does not exist"),1<=t&&t<=i+s||l("glp_eval_tab_col: k = "+t+"; variable number out of range"),t<=i?a=Ht(e,t):a=Ft(e,t-i),a==Di&&l("glp_eval_tab_col: k = "+t+"; variable must be non-basic"),f=new Array(1+i);for(o=1;o<=i;o++)f[o]=0;if(t<=i)f[t]=-1;else{u=mt(e,t-i,n,r);for(o=1;o<=u;o++)f[n[o]]=r[o]}fn(e,f),u=0;for(o=1;o<=i;o++)f[o]!=0&&(u++,n[u]=on(e,o),r[u]=f[o]);return u},dn=e.glp_transform_row=function(e,t,n,r){var i,s,o,u,a,f,h,p,d,v,m,g,y;Zt(e)||l("glp_transform_row: basis factorization does not exist "),u=rt(e),a=it(e),v=new Array(1+a);for(s=1;s<=a;s++)v[s]=0;0<=t&&t<=a||l("glp_transform_row: len = "+t+"; invalid row length");for(f=1;f<=t;f++)s=n[f],1<=s&&s<=a||l("glp_transform_row: ind["+f+"] = "+s+"; column index out of range"),r[f]==0&&l("glp_transform_row: val["+f+"] = 0; zero coefficient not allowed"),v[s]!=0&&l("glp_transform_row: ind["+f+"] = "+s+"; duplicate column indices not allowed"),v[s]=r[f];m=new Array(1+u);for(i=1;i<=u;i++)o=on(e,i),c(1<=o&&o<=u+a),m[i]=o<=u?0:v[o-u];g=m,ln(e,g),t=0;for(i=1;i<=u;i++)Ht(e,i)!=Di&&(d=-g[i],d!=0&&(t++,n[t]=i,r[t]=d));p=new Array(1+u),y=new Array(1+u);for(s=1;s<=a;s++)if(Ft(e,s)!=Di){d=v[s],h=mt(e,s,p,y);for(f=1;f<=h;f++)d+=y[f]*g[p[f]];d!=0&&(t++,n[t]=u+s,r[t]=d)}return c(t<=a),t},vn=e.glp_transform_col=function(e,t,n,r){var i,s,o,u,a;Zt(e)||l("glp_transform_col: basis factorization does not exist "),s=rt(e),u=new Array(1+s);for(i=1;i<=s;i++)u[i]=0;0<=t&&t<=s||l("glp_transform_col: len = "+t+"; invalid column length");for(o=1;o<=t;o++)i=n[o],1<=i&&i<=s||l("glp_transform_col: ind["+o+"] = "+i+"; row index out of range"),r[o]==0&&l("glp_transform_col: val["+o+"] = 0; zero coefficient not allowed"),u[i]!=0&&l("glp_transform_col: ind["+o+"] = "+i+"; duplicate row indices not allowed"),u[i]=r[o];a=u,fn(e,a),t=0;for(i=1;i<=s;i++)a[i]!=0&&(t++,n[t]=on(e,i),r[t]=a[i]);return t},mn=e.glp_prim_rtest=function(e,t,r,i,s,o){var u,a,f,h,p,d,v,m,g,y,b,w,E,S;_t(e)!=$i&&l("glp_prim_rtest: basic solution is not primal feasible "),s!=+1&&s!=-1&&l("glp_prim_rtest: dir = "+s+"; invalid parameter"),0<o&&o<1||l("glp_prim_rtest: eps = "+o+"; invalid parameter"),a=rt(e),f=it(e),h=0,S=n,g=0;for(p=1;p<=t;p++){u=r[p],1<=u&&u<=a+f||l("glp_prim_rtest: ind["+p+"] = "+u+"; variable number out of range"),u<=a?(d=ut(e,u),b=at(e,u),w=ft(e,u),v=Ht(e,u),y=Bt(e,u)):(d=lt(e,u-a),b=ct(e,u-a),w=ht(e,u-a),v=Ft(e,u-a),y=It(e,u-a)),v!=Di&&l("glp_prim_rtest: ind["+p+"] = "+u+"; non-basic variable not allowed"),m=s>0?+i[p]:-i[p];if(d==Li)continue;if(d==Ai){if(m>-o)continue;E=(b-y)/m}else if(d==Oi){if(m<+o)continue;E=(w-y)/m}else if(d==Mi)if(m<0){if(m>-o)continue;E=(b-y)/m}else{if(m<+o)continue;E=(w-y)/m}else if(d==_i){if(-o<m&&m<+o)continue;E=0}else c(d!=d);E<0&&(E=0);if(S>E||S==E&&g<Math.abs(m))h=p,S=E,g=Math.abs(m)}return h},gn=e.glp_dual_rtest=function(e,t,r,i,s,o){var u,a,f,h,p,d,v,m,g,y,b,w;Dt(e)!=$i&&l("glp_dual_rtest: basic solution is not dual feasible"),s!=+1&&s!=-1&&l("glp_dual_rtest: dir = "+s+"; invalid parameter"),0<o&&o<1||l("glp_dual_rtest: eps = "+o+"; invalid parameter"),a=rt(e),f=it(e),y=nt(e)==xi?1:-1,h=0,w=n,m=0;for(p=1;p<=t;p++){u=r[p],1<=u&&u<=a+f||l("glp_dual_rtest: ind["+p+"] = "+u+"; variable number out of range"),u<=a?(d=Ht(e,u),g=jt(e,u)):(d=Ft(e,u-a),g=qt(e,u-a)),d==Di&&l("glp_dual_rtest: ind["+p+"] = "+u+"; basic variable not allowed"),v=s>0?+i[p]:-i[p];if(d==Pi){if(v<+o)continue;b=y*g/v}else if(d==Hi){if(v>-o)continue;b=y*g/v}else if(d==Bi){if(-o<v&&v<+o)continue;b=0}else{if(d==ji)continue;c(d!=d)}b<0&&(b=0);if(w>b||w==b&&m<Math.abs(v))h=p,w=b,m=Math.abs(v)}return h},bn=e.glp_analyze_bound=function(e,t,r){function k(){f<0?(x=g,T=h):(N=g,C=h)}var i,s,o,u,a,f,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C;x=T=N=C=null,(e==null||e.magic!=O)&&l("glp_analyze_bound: P = "+e+"; invalid problem object"),o=e.m,u=e.n,(e.pbs_stat!=$i||e.dbs_stat!=$i)&&l("glp_analyze_bound: optimal basic solution required"),o!=0&&!e.valid&&l("glp_analyze_bound: basis factorization required"),1<=t&&t<=o+u||l("glp_analyze_bound: k = "+t+"; variable number out of range"),t<=o?(i=e.row[t],a=i.stat,m=i.prim):(s=e.col[t-o],a=s.stat,m=s.prim),a==Di&&l("glp_analyze_bound: k = "+t+"; basic variable not allowed "),v=new Array(1+o),S=new Array(1+o),p=pn(e,t,v,S),c(0<=p&&p<=o);for(f=-1;f<=1;f+=2){d=mn(e,p,v,S,f,1e-9);if(d==0){h=0,g=f<0?-n:+n,k();continue}c(1<=d&&d<=p),h=v[d],h<=o?(i=e.row[h],y=at(e,i.i),b=ft(e,i.i),a=i.stat,w=i.prim):(s=e.col[h-o],y=ct(e,s.j),b=ht(e,s.j),a=s.stat,w=s.prim),c(a==Di),f<0&&S[d]>0||f>0&&S[d]<0?(c(y!=-n),E=y-w):(c(b!=+n),E=b-w),c(S[d]!=0),g=m+E/S[d],k()}r(x,T,N,C)},wn=e.glp_analyze_coef=function(e,t,r){function U(){h<0?(B=C,j=d,F=k):(I=C,q=d,R=k)}var i,s,o,u,a,f,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,M,_,D,P,H,B=null,j=null,F=null,I=null,q=null,R=null;(e==null||e.magic!=O)&&l("glp_analyze_coef: P = "+e+"; invalid problem object"),o=e.m,u=e.n,(e.pbs_stat!=$i||e.dbs_stat!=$i)&&l("glp_analyze_coef: optimal basic solution required"),o!=0&&!e.valid&&l("glp_analyze_coef: basis factorization required"),1<=t&&t<=o+u||l("glp_analyze_coef: k = "+t+"; variable number out of range"),t<=o?(i=e.row[t],a=i.type,S=i.lb,x=i.ub,T=0,f=i.stat,N=i.prim):(s=e.col[t-o],a=s.type,S=s.lb,x=s.ub,T=s.coef,f=s.stat,N=s.prim),f!=Di&&l("glp_analyze_coef: k = "+t+"; non-basic variable not allowed"),w=new Array(1+o),H=new Array(1+o),E=new Array(1+u),P=new Array(1+u),y=hn(e,t,E,P),c(0<=y&&y<=u);for(h=-1;h<=1;h+=2){e.dir==xi?v=-h:e.dir==Ti?v=+h:c(e!=e),b=gn(e,y,E,P,v,1e-9);if(b==0){C=h<0?-n:+n,d=0,k=N,U();continue}c(1<=b&&b<=y),d=E[b],c(1<=d&&d<=o+u),d<=o?(i=e.row[d],f=i.stat,L=i.dual):(s=e.col[d-o],f=s.stat,L=s.dual),c(P[b]!=0),A=-L/P[b],C=T+A,h<0&&P[b]>0||h>0&&P[b]<0?v=1:v=-1,e.dir==Ti&&(v=-v),v>0?c(f==Pi||f==Bi):c(f==Hi||f==Bi),m=pn(e,d,w,H),t<=o?(i=e.row[t],i.type=Li,i.lb=i.ub=0):(s=e.col[t-o],s.type=Li,s.lb=s.ub=0),g=mn(e,m,w,H,v,1e-9),t<=o?(i=e.row[t],i.type=a,i.lb=S,i.ub=x):(s=e.col[t-o],s.type=a,s.lb=S,s.ub=x);if(g==0){v<0&&P[b]>0||v>0&&P[b]<0?k=-n:k=+n,U();continue}c(1<=g&&g<=m),p=w[g],c(1<=p&&p<=o+u),c(p!=t),p<=o?(i=e.row[p],c(i.stat==Di),M=at(e,i.i),_=ft(e,i.i),D=i.prim):(s=e.col[p-o],c(s.stat==Di),M=ct(e,s.j),_=ht(e,s.j),D=s.prim),v<0&&H[g]>0||v>0&&H[g]<0?(c(M!=-n),A=M-D):(c(_!=+n),A=_-D),c(H[g]!=0),k=N+P[b]/H[g]*A,U()}callback(B,j,F,I,q,R)};const zn=1,Wn=2,Xn=3,Vn=4,$n=5,nr="!\"#$%&()/,.;?@_`'{}|~";var rr=e.glp_read_lp=function(e,t,r){function D(e,t){throw new Error(e.count+": "+t)}function W(e,t){h(e.count+": warning: "+t)}function X(e){var t;c(e.c!=f),e.c=="\n"&&e.count++,t=e.callback(),t<0?e.c=="\n"?(e.count--,t=f):(W(e,"missing final end of line"),t="\n"):t!="\n"&&(x(t)?t=" ":T(t)&&D(e,"invalid control character "+t.charCodeAt(0))),e.c=t}function V(e){e.image+=e.c,X(e)}function J(e,t){return e.toLowerCase()==t.toLowerCase()?1:0}function K(e){function n(){e.token=y;while(C(e.c)||L(nr,e.c)>=0)V(e);t&&(J(e.image,"minimize")?e.token=s:J(e.image,"minimum")?e.token=s:J(e.image,"min")?e.token=s:J(e.image,"maximize")?e.token=o:J(e.image,"maximum")?e.token=o:J(e.image,"max")?e.token=o:J(e.image,"subject")?e.c==" "&&(X(e),A(e.c)=="t"&&(e.token=u,e.image+=" ",V(e),A(e.c)!="o"&&D(e,"keyword `subject to' incomplete"),V(e),N(e.c)&&D(e,"keyword `"+e.image+e.c+"...' not recognized"))):J(e.image,"such")?e.c==" "&&(X(e),A(e.c)=="t"&&(e.token=u,e.image+=" ",V(e),A(e.c)!="h"&&D(e,"keyword `such that' incomplete"),V(e),A(e.c)!="a"&&D(e,"keyword `such that' incomplete"),V(e),A(e.c)!="t"&&D(e,"keyword `such that' incomplete"),V(e),N(e.c)&&D(e,"keyword `"+e.image+e.c+"...' not recognized"))):J(e.image,"st")?e.token=u:J(e.image,"s.t.")?e.token=u:J(e.image,"st.")?e.token=u:J(e.image,"bounds")?e.token=a:J(e.image,"bound")?e.token=a:J(e.image,"general")?e.token=l:J(e.image,"generals")?e.token=l:J(e.image,"gen")?e.token=l:J(e.image,"integer")?e.token=p:J(e.image,"integers")?e.token=p:J(e.image,"int")?e.token=p:J(e.image,"binary")?e.token=m:J(e.image,"binaries")?e.token=m:J(e.image,"bin")?e.token=m:J(e.image,"end")&&(e.token=g))}var t;e.token=-1,e.image="",e.value=0;for(;;){t=0;while(e.c==" ")X(e);if(e.c==f)e.token=i;else if(e.c=="\n"){X(e);if(!N(e.c))continue;t=1,n()}else{if(e.c=="\\"){while(e.c!="\n")X(e);continue}if(N(e.c)||e.c!="."&&L(nr,e.c)>=0)n();else if(k(e.c)||e.c=="."){e.token=b;while(k(e.c))V(e);if(e.c=="."){V(e),e.image.length==1&&!k(e.c)&&D(e,"invalid use of decimal point");while(k(e.c))V(e)}if(e.c=="e"||e.c=="E"){V(e),(e.c=="+"||e.c=="-")&&V(e),k(e.c)||D(e,"numeric constant `"+e.image+"' incomplete");while(k(e.c))V(e)}e.value=Number(e.image),e.value==Number.NaN&&D(e,"numeric constant `"+e.image+"' out of range")}else e.c=="+"?(e.token=w,V(e)):e.c=="-"?(e.token=E,V(e)):e.c==":"?(e.token=S,V(e)):e.c=="<"?(e.token=O,V(e),e.c=="="&&V(e)):e.c==">"?(e.token=M,V(e),e.c=="="&&V(e)):e.c=="="?(e.token=_,V(e),e.c=="<"?(e.token=O,V(e)):e.c==">"&&(e.token=M,V(e))):D(e,"character `"+e.c+"' not recognized")}break}while(e.c==" ")X(e)}function Q(e,t){var r=bt(e.P,t);if(r==0){r=j(e.P,1),I(e.P,r,t);if(e.n_max<r){var i=e.n_max,s=e.ind,o=e.val,u=e.flag,a=e.lb,f=e.ub;e.n_max+=e.n_max,e.ind=new Array(1+e.n_max),d(e.ind,1,s,1,i),e.val=new Array(1+e.n_max),d(e.val,1,o,1,i),e.flag=new Array(1+e.n_max),v(e.flag,1,0,e.n_max),d(e.flag,1,u,1,i),e.lb=new Array(1+e.n_max),d(e.lb,1,a,1,i),e.ub=new Array(1+e.n_max),d(e.ub,1,f,1,i)}e.lb[r]=+n,e.ub[r]=-n}return r}function Y(e){var t,n,r=0,i,s,o;for(;;){e.token==w?(s=1,K(e)):e.token==E?(s=-1,K(e)):s=1,e.token==b?(o=e.value,K(e)):o=1,e.token!=y&&D(e,"missing variable name"),t=Q(e,e.image),e.flag[t]&&D(e,"multiple use of variable `"+e.image+"' not allowed"),r++,e.ind[r]=t,e.val[r]=s*o,e.flag[t]=1,K(e);if(e.token==w||e.token==E)continue;for(n=1;n<=r;n++)e.flag[e.ind[n]]=0;i=0;for(n=1;n<=r;n++)e.val[n]!=0&&(i++,e.ind[i]=e.ind[n],e.val[i]=e.val[n]);break}return i}function Z(e){var t,n;e.token==s?H(e.P,xi):e.token==o?H(e.P,Ti):c(e!=e),K(e),e.token==y&&e.c==":"?(P(e.P,e.image),K(e),c(e.token==S),K(e)):P(e.P,"obj"),n=Y(e);for(t=1;t<=n;t++)U(e.P,e.ind[t],e.val[t])}function et(e){var t,n,r,i;c(e.token==u),K(e);for(;;){t=B(e.P,1),e.token==y&&e.c==":"?(yt(e.P,e.image)!=0&&D(e,"constraint `"+e.image+"' multiply defined"),F(e.P,t,e.image),K(e),c(e.token==S),K(e)):F(e.P,t,"r."+e.count),n=Y(e),z(e.P,t,n,e.ind,e.val),e.token==O?(r=Oi,K(e)):e.token==M?(r=Ai,K(e)):e.token==_?(r=_i,K(e)):D(e,"missing constraint sense"),e.token==w?(i=1,K(e)):e.token==E?(i=-1,K(e)):i=1,e.token!=b&&D(e,"missing right-hand side"),q(e.P,t,r,i*e.value,i*e.value),e.c!="\n"&&e.c!=f&&D(e,"invalid symbol(s) beyond right-hand side"),K(e);if(e.token==w||e.token==E||e.token==b||e.token==y)continue;break}}function tt(e,t,r){e.lb[t]!=+n&&W(e,"lower bound of variable `"+ot(e.P,t)+"' redefined"),e.lb[t]=r}function nt(e,t,r){e.ub[t]!=-n&&W(e,"upper bound of variable `"+ot(e.P,t)+"' redefined"),e.ub[t]=r}function rt(e){var t,r,i,s;c(e.token==a),K(e);for(;;){if(e.token!=w&&e.token!=E&&e.token!=b&&e.token!=y)return;e.token==w||e.token==E?(r=1,s=e.token==w?1:-1,K(e),e.token==b?(i=s*e.value,K(e)):J(e.image,"infinity")||J(e.image,"inf")?(s>0&&D(e,"invalid use of `+inf' as lower bound"),i=-n,K(e)):D(e,"missing lower bound")):e.token==b?(r=1,i=e.value,K(e)):r=0,r&&(e.token!=O&&D(e,"missing `<', `<=', or `=<' after lower bound"),K(e)),e.token!=y&&D(e,"missing variable name"),t=Q(e,e.image),r&&tt(e,t,i),K(e),e.token==O?(K(e),e.token==w||e.token==E?(s=e.token==w?1:-1,K(e),e.token==b?(nt(e,t,s*e.value),K(e)):J(e.image,"infinity")||J(e.image,"inf")?(s<0&&D(e,"invalid use of `-inf' as upper bound"),nt(e,t,+n),K(e)):D(e,"missing upper bound")):e.token==b?(nt(e,t,e.value),K(e)):D(e,"missing upper bound")):e.token==M?(r&&D(e,"invalid bound definition"),K(e),e.token==w||e.token==E?(s=e.token==w?1:-1,K(e),e.token==b?(tt(e,t,s*e.value),K(e)):J(e.image,"infinity")||J(e.image,"inf")==0?(s>0&&D(e,"invalid use of `+inf' as lower bound"),tt(e,t,-n),K(e)):D(e,"missing lower bound")):e.token==b?(tt(e,t,e.value),K(e)):D(e,"missing lower bound")):e.token==_?(r&&D(e,"invalid bound definition"),K(e),e.token==w||e.token==E?(s=e.token==w?1:-1,K(e),e.token==b?(tt(e,t,s*e.value),nt(e,t,s*e.value),K(e)):D(e,"missing fixed value")):e.token==b?(tt(e,t,e.value),nt(e,t,e.value),K(e)):D(e,"missing fixed value")):J(e.image,"free")?(r&&D(e,"invalid bound definition"),tt(e,t,-n),nt(e,t,+n),K(e)):r||D(e,"invalid bound definition")}}function it(e){var t,n;e.token==l?(n=0,K(e)):e.token==p?(n=0,K(e)):e.token==m?(n=1,K(e)):c(e!=e);while(e.token==y)t=Q(e,e.image),Ut(e.P,t,Ci),n&&(tt(e,t,0),nt(e,t,1)),K(e)}function vt(){return ut!=0&&G(e),ut}const i=0,s=1,o=2,u=3,a=4,l=5,p=6,m=7,g=8,y=9,b=10,w=11,E=12,S=13,O=14,M=15,_=16;var st={},ut;h("Reading problem data"),t==null&&(t={}),tr("glp_read_lp",t),st.P=e,st.parm=t,st.callback=r,st.count=0,st.c="\n",st.token=i,st.image="",st.value=0,st.n_max=100,st.ind=new Array(1+st.n_max),st.val=new Array(1+st.n_max),st.flag=new Array(1+st.n_max),v(st.flag,1,0,st.n_max),st.lb=new Array(1+st.n_max),st.ub=new Array(1+st.n_max),G(e),gt(e),K(st),st.token!=s&&st.token!=o&&D(st,"`minimize' or `maximize' keyword missing"),Z(st),st.token!=u&&D(st,"constraints section missing"),et(st),st.token==a&&rt(st);while(st.token==l||st.token==p||st.token==m)it(st);st.token==g?K(st):st.token==i?W(st,"keyword `end' missing"):D(st,"symbol "+st.image+" in wrong position"),st.token!=i&&D(st,"extra symbol(s) detected beyond `end'");var at,ft,lt,ct;for(at=1;at<=e.n;at++)lt=st.lb[at],ct=st.ub[at],lt==+n&&(lt=0),ct==-n&&(ct=+n),lt==-n&&ct==+n?ft=Li:ct==+n?ft=Ai:lt==-n?ft=Oi:lt!=ct?ft=Mi:ft=_i,R(st.P,at,ft,lt,ct);h(e.m+" row"+(e.m==1?"":"s")+", "+e.n+" column"+(e.n==1?"":"s")+", "+e.nnz+" non-zero"+(e.nnz==1?"":"s"));if(Wt(e)>0){var ht=Wt(e),pt=Xt(e);if(ht==1)pt==0?h("One variable is integer"):h("One variable is binary");else{var dt=ht+" integer variables, ";pt==0?dt+="none":pt==1?dt+="one":pt==ht?dt+="all":dt+=pt,h(dt+" of which "+(pt==1?"is":"are")+" binary")}}return h(st.count+" lines were read"),wt(e),$(e),ut=0,vt()},ir=e.glp_write_lp=function(e,t,n){function r(e){if(e[0]==".")return 1;if(k(e[0]))return 1;for(var t=0;t<e.length;t++)if(!C(e[t])&&L(nr,e[t])<0)return 1;return 0}function i(e){for(var t=0;t<e.length;t++)e[t]==" "?e[t]="_":e[t]=="-"?e[t]="~":e[t]=="["?e[t]="(":e[t]=="]"&&(e[t]=")")}function s(e,t){function s(){return t==0?"obj":"r_"+t}var n;return t==0?n=tt(e.P):n=st(e.P,t),n==null?s():(i(n),r(n)?s():n)}function o(e,t){function s(){return"x_"+t}var n=ot(e.P,t);return n==null?s():(i(n),r(n)?s():n)}function S(){return n("End"),g++,h(g+" lines were written"),0}var u={},a,f,l,p,d,v,m,g,y,b,w,E;h("Writing problem data"),t==null&&(t={}),tr("glp_write_lp",t),u.P=e,u.parm=t,g=0,n("\\* Problem: "+(e.name==null?"Unknown":e.name)+" *\\"),g++,n(""),g++;if(e.m>0&&e.n>0){e.dir==xi?(n("Minimize"),g++):e.dir==Ti?(n("Maximize"),g++):c(e!=e),E=s(u,0),b=" "+E+":",v=0;for(d=1;d<=e.n;d++){f=e.col[d];if(f.coef!=0||f.ptr==null)v++,E=o(u,d),f.coef==0?w=" + 0 "+E:f.coef==+1?w=" + "+E:f.coef==-1?w=" - "+E:f.coef>0?w=" + "+f.coef+" "+E:w=" - "+ -f.coef+" "+E,b.length+w.length>72&&(n(b),b="",g++),b+=w}v==0&&(w=" 0 "+o(u,1),b+=w),n(b),g++,e.c0!=0&&(n("\\* constant term = "+e.c0+" *\\"),g++),n(""),g++,n("Subject To"),g++;for(p=1;p<=e.m;p++){a=e.row[p];if(a.type==Li)continue;E=s(u,p),b=" "+E+":";for(l=a.ptr;l!=null;l=l.r_next)E=o(u,l.col.j),l.val==+1?w=" + "+E:l.val==-1?w=" - "+E:l.val>0?w=" + "+l.val+" "+E:w=" - "+ -l.val+" "+E,b.length+w.length>72&&(n(b),b="",g++),b+=w;a.type==Mi?(w=" - ~r_"+p,b.length+w.length>72&&(n(b),b="",g++),b+=w):a.ptr==null&&(w=" 0 "+o(u,1),b+=w),a.type==Ai?w=" >= "+a.lb:a.type==Oi?w=" <= "+a.ub:a.type==Mi||a.type==_i?w=" = "+a.lb:c(a!=a),b.length+w.length>72&&(n(b),b="",g++),b+=w,n(b),g++}n(""),g++,m=0;for(p=1;p<=e.m;p++){a=e.row[p];if(a.type!=Mi)continue;m||(n("Bounds"),m=1,g++),n(" 0 <= ~r_"+p+" <= "+a.ub-a.lb),g++}for(d=1;d<=e.n;d++){f=e.col[d];if(f.type==Ai&&f.lb==0)continue;m||(n("Bounds"),m=1,g++),E=o(u,d),f.type==Li?(n(" "+E+" free"),g++):f.type==Ai?(n(" "+E+" >= "+f.lb),g++):f.type==Oi?(n(" -Inf <= "+E+" <= "+f.ub),g++):f.type==Mi?(n(" "+f.lb+" <= "+E+" <= "+f.ub),g++):f.type==_i?(n(" "+E+" = "+f.lb),g++):c(f!=f)}m&&n(""),g++,m=0;for(d=1;d<=e.n;d++){f=e.col[d];if(f.kind==Ni)continue;c(f.kind==Ci),m||(n("Generals"),m=1,g++),n(" "+o(u,d)),g++}return m&&(n(""),g++),S()}return h("Warning: problem has no rows/columns"),n("\\* WARNING: PROBLEM HAS NO ROWS/COLUMNS *\\"),g++,n(""),g++,S()},sr=e.glp_read_lp_from_string=function(e,t,n){var r=0;return rr(e,t,function(){return r<n.length?n[r++]:-1})};const or=1,ur=2,ar=3,fr=4,lr=5,Gr=0,Yr=5,Ei=e.GLP_MAJOR_VERSION=4,Si=e.GLP_MINOR_VERSION=47,xi=e.GLP_MIN=1,Ti=e.GLP_MAX=2,Ni=e.GLP_CV=1,Ci=e.GLP_IV=2,ki=e.GLP_BV=3,Li=e.GLP_FR=e.GLP_FR=1,Ai=e.GLP_LO=e.GLP_LO=2,Oi=e.GLP_UP=e.GLP_UP=3,Mi=e.GLP_DB=e.GLP_DB=4,_i=e.GLP_FX=e.GLP_FX=5,Di=e.GLP_BS=1,Pi=e.GLP_NL=2,Hi=e.GLP_NU=3,Bi=e.GLP_NF=4,ji=e.GLP_NS=5,Fi=e.GLP_SF_GM=1,Ii=e.GLP_SF_EQ=16,qi=e.GLP_SF_2N=32,Ri=e.GLP_SF_SKIP=64,Ui=e.GLP_SF_AUTO=128,zi=e.GLP_SOL=1,Wi=e.GLP_IPT=2,Xi=e.GLP_MIP=3,Vi=e.GLP_UNDEF=1,$i=e.GLP_FEAS=2,Ji=e.GLP_INFEAS=3,Ki=e.GLP_NOFEAS=4,Qi=e.GLP_OPT=5,Gi=e.GLP_UNBND=6,Yi=e.GLP_BF_FT=1,Zi=e.GLP_BF_BG=2,es=e.GLP_BF_GR=3,ts=e.GLP_MSG_OFF=0,ns=e.GLP_MSG_ERR=1,rs=e.GLP_MSG_ON=2,is=e.GLP_MSG_ALL=3,ss=e.GLP_MSG_DBG=4,os=e.GLP_PRIMAL=1,us=e.GLP_DUALP=2,as=e.GLP_DUAL=3,fs=e.GLP_PT_STD=17,ls=e.GLP_PT_PSE=34,cs=e.GLP_RT_STD=17,hs=e.GLP_RT_HAR=34,ps=e.GLP_ORD_NONE=0,ds=e.GLP_ORD_QMD=1,vs=e.GLP_ORD_AMD=2,ms=e.GLP_ORD_SYMAMD=3,gs=e.GLP_BR_FFV=1,ys=e.GLP_BR_LFV=2,bs=e.GLP_BR_MFV=3,ws=e.GLP_BR_DTH=4,Es=e.GLP_BR_PCH=5,Ss=e.GLP_BT_DFS=1,xs=e.GLP_BT_BFS=2,Ts=e.GLP_BT_BLB=3,Ns=e.GLP_BT_BPH=4,Cs=e.GLP_PP_NONE=0,ks=e.GLP_PP_ROOT=1,Ls=e.GLP_PP_ALL=2,As=e.GLP_RF_REG=0,Os=e.GLP_RF_LAZY=1,Ms=e.GLP_RF_CUT=2,_s=e.GLP_RF_GMI=1,Ds=e.GLP_RF_MIR=2,Ps=e.GLP_RF_COV=3,Hs=e.GLP_RF_CLQ=4,Bs=e.GLP_ON=1,js=e.GLP_OFF=0,Fs=e.GLP_IROWGEN=1,Is=e.GLP_IBINGO=2,qs=e.GLP_IHEUR=3,Rs=e.GLP_ICUTGEN=4,Us=e.GLP_IBRANCH=5,zs=e.GLP_ISELECT=6,Ws=e.GLP_IPREPRO=7,Xs=e.GLP_NO_BRNCH=0,Vs=e.GLP_DN_BRNCH=1,$s=e.GLP_UP_BRNCH=2,Js=e.GLP_EBADB=1,Ks=e.GLP_ESING=2,Qs=e.GLP_ECOND=3,Gs=e.GLP_EBOUND=4,Ys=e.GLP_EFAIL=5,Zs=e.GLP_EOBJLL=6,eo=e.GLP_EOBJUL=7,to=e.GLP_EITLIM=8,no=e.GLP_ETMLIM=9,ro=e.GLP_ENOPFS=10,io=e.GLP_ENODFS=11,so=e.GLP_EROOT=12,oo=e.GLP_ESTOP=13,uo=e.GLP_EMIPGAP=14,ao=e.GLP_ENOFEAS=15,fo=e.GLP_ENOCVG=16,lo=e.GLP_EINSTAB=17,co=e.GLP_EDATA=18,ho=e.GLP_ERANGE=19,po=e.GLP_KKT_PE=1,vo=e.GLP_KKT_PB=2,mo=e.GLP_KKT_DE=3,go=e.GLP_KKT_DB=4,yo=e.GLP_KKT_CS=5,bo=e.GLP_MPS_DECK=1,wo=e.GLP_MPS_FILE=2,Eo=e.GLP_ASN_MIN=1,So=e.GLP_ASN_MAX=2,xo=e.GLP_ASN_MMP=3,To=e.LPX_LP=100,No=e.LPX_MIP=101,Co=e.LPX_FR=110,ko=e.LPX_LO=111,Lo=e.LPX_UP=112,Ao=e.LPX_DB=113,Oo=e.LPX_FX=114,Mo=e.LPX_MIN=120,_o=e.LPX_MAX=121,Do=e.LPX_P_UNDEF=132,Po=e.LPX_P_FEAS=133,Ho=e.LPX_P_INFEAS=134,Bo=e.LPX_P_NOFEAS=135,jo=e.LPX_D_UNDEF=136,Fo=e.LPX_D_FEAS=137,Io=e.LPX_D_INFEAS=138,qo=e.LPX_D_NOFEAS=139,Ro=e.LPX_BS=140,Uo=e.LPX_NL=141,zo=e.LPX_NU=142,Wo=e.LPX_NF=143,Xo=e.LPX_NS=144,Vo=e.LPX_T_UNDEF=150,$o=e.LPX_T_OPT=151,Jo=e.LPX_CV=160,Ko=e.LPX_IV=161,Qo=e.LPX_I_UNDEF=170,Go=e.LPX_I_OPT=171,Yo=e.LPX_I_FEAS=172,Zo=e.LPX_I_NOFEAS=173,eu=e.LPX_OPT=180,tu=e.LPX_FEAS=181,nu=e.LPX_INFEAS=182,ru=e.LPX_NOFEAS=183,iu=e.LPX_UNBND=184,su=e.LPX_UNDEF=185,ou=e.LPX_E_OK=200,uu=e.LPX_E_EMPTY=201,au=e.LPX_E_BADB=202,fu=e.LPX_E_INFEAS=203,lu=e.LPX_E_FAULT=204,cu=e.LPX_E_OBJLL=205,hu=e.LPX_E_OBJUL=206,pu=e.LPX_E_ITLIM=207,du=e.LPX_E_TMLIM=208,vu=e.LPX_E_NOFEAS=209,mu=e.LPX_E_INSTAB=210,gu=e.LPX_E_SING=211,yu=e.LPX_E_NOCONV=212,bu=e.LPX_E_NOPFS=213,wu=e.LPX_E_NODFS=214,Eu=e.LPX_E_MIPGAP=215,Su=e.LPX_K_MSGLEV=300,xu=e.LPX_K_SCALE=301,Tu=e.LPX_K_DUAL=302,Nu=e.LPX_K_PRICE=303,Cu=e.LPX_K_RELAX=304,ku=e.LPX_K_TOLBND=305,Lu=e.LPX_K_TOLDJ=306,Au=e.LPX_K_TOLPIV=307,Ou=e.LPX_K_ROUND=308,Mu=e.LPX_K_OBJLL=309,_u=e.LPX_K_OBJUL=310,Du=e.LPX_K_ITLIM=311,Pu=e.LPX_K_ITCNT=312,Hu=e.LPX_K_TMLIM=313,Bu=e.LPX_K_OUTFRQ=314,ju=e.LPX_K_OUTDLY=315,Fu=e.LPX_K_BRANCH=316,Iu=e.LPX_K_BTRACK=317,qu=e.LPX_K_TOLINT=318,Ru=e.LPX_K_TOLOBJ=319,Uu=e.LPX_K_MPSINFO=320,zu=e.LPX_K_MPSOBJ=321,Wu=e.LPX_K_MPSORIG=322,Xu=e.LPX_K_MPSWIDE=323,Vu=e.LPX_K_MPSFREE=324,$u=e.LPX_K_MPSSKIP=325,Ju=e.LPX_K_LPTORIG=326,Ku=e.LPX_K_PRESOL=327,Qu=e.LPX_K_BINARIZE=328,Gu=e.LPX_K_USECUTS=329,Yu=e.LPX_K_BFTYPE=330,Zu=e.LPX_K_MIPGAP=331,ea=e.LPX_C_COVER=1,ta=e.LPX_C_CLIQUE=2,na=e.LPX_C_GOMORY=4,ra=e.LPX_C_MIR=8,ia=e.LPX_C_ALL=255,aa=1;LPF_ECOND=2,LPF_ELIMIT=3;const fa=0;if(fa)function ma(e,t,n,r){var i=e.m,s=e.B,o,u,a,f=0,l,c,p;for(o=1;o<=i;o++){l=0,p=1;for(u=1;u<=i;u++)t?c=s[i*(u-1)+o]*n[u]:c=s[i*(o-1)+u]*n[u],p<Math.abs(c)&&(p=Math.abs(c)),l+=c;a=Math.abs(l-r[o])/p,f<a&&(f=a)}f>1e-8&&h((t?"lpf_btran":"lpf_ftran")+": dmax = "+f+"; relative error too large")}const Al=1,Ol=2,hh=1,ph=2,dh=1,vh=2,mh=0,gh=1e-10;if(mh)function ma(e,t){var n=e.n,r=e.f,i=e.u,s=e.p,o=e.c,u,a,f,l,p=0,d,v;c(o!=null);for(u=1;u<=n;u++)for(a=1;a<=n;a++){d=0;for(f=1;f<=n;f++)d+=r[bh(e,u,f)]*o[bh(e,f,a)];f=s[a],v=u<=f?i[wh(e,u,f)]:0,l=Math.abs(d-v)/(1+Math.abs(v)),p<l&&(p=l)}p>1e-8&&h(t+": dmax = "+p+"; relative error too large")}var Mh=e.glp_scale_prob=function(e,t){function n(e,t,n){var r,i,s;c(1<=t&&t<=e.m),i=1;for(r=e.row[t].ptr;r!=null;r=r.r_next){s=Math.abs(r.val),n&&(s*=r.row.rii*r.col.sjj);if(r.r_prev==null||i>s)i=s}return i}function r(e,t,n){var r,i,s;c(1<=t&&t<=e.m),i=1;for(r=e.row[t].ptr;r!=null;r=r.r_next){s=Math.abs(r.val),n&&(s*=r.row.rii*r.col.sjj);if(r.r_prev==null||i<s)i=s}return i}function i(e,t,n){var r,i,s;c(1<=t&&t<=e.n),i=1;for(r=e.col[t].ptr;r!=null;r=r.c_next){s=Math.abs(r.val),n&&(s*=r.row.rii*r.col.sjj);if(r.c_prev==null||i>s)i=s}return i}function s(e,t,n){var r,i,s;c(1<=t&&t<=e.n),i=1;for(r=e.col[t].ptr;r!=null;r=r.c_next){s=Math.abs(r.val),n&&(s*=r.row.rii*r.col.sjj);if(r.c_prev==null||i<s)i=s}return i}function o(e,t){var r,i,s;i=1;for(r=1;r<=e.m;r++){s=n(e,r,t);if(r==1||i>s)i=s}return i}function u(e,t){var n,i,s;i=1;for(n=1;n<=e.m;n++){s=r(e,n,t);if(n==1||i<s)i=s}return i}function a(e,t){var n,i,o,u;c(t==0||t==1);for(o=0;o<=1;o++)if(o==t)for(n=1;n<=e.m;n++)u=r(e,n,1),Et(e,n,xt(e,n)/u);else for(i=1;i<=e.n;i++)u=s(e,i,1),St(e,i,Tt(e,i)/u)}function f(e,t){var o,u,a,f;c(t==0||t==1);for(a=0;a<=1;a++)if(a==t)for(o=1;o<=e.m;o++)f=n(e,o,1)*r(e,o,1),Et(e,o,xt(e,o)/Math.sqrt(f));else for(u=1;u<=e.n;u++)f=i(e,u,1)*s(e,u,1),St(e,u,Tt(e,u)/Math.sqrt(f))}function p(e){var t,i,s;i=1;for(t=1;t<=e.m;t++){s=r(e,t,1)/n(e,t,1);if(t==1||i<s)i=s}return i}function d(e){var t,n,r;n=1;for(t=1;t<=e.n;t++){r=s(e,t,1)/i(e,t,1);if(t==1||n<r)n=r}return n}function v(e,t,n){var r,i,s=0,a;i=p(e)>d(e);for(r=1;r<=t;r++){a=s,s=u(e,1)/o(e,1);if(r>1&&s>n*a)break;f(e,i)}}function m(e,t){function n(e,t,n,r){return e+": min|aij| = "+t+"  max|aij| = "+n+"  ratio = "+r+""}var r,i,s;h("Scaling..."),Nt(e),r=o(e,1),i=u(e,1),s=i/r,h(n(" A",r,i,s));if(r>=.1&&i<=10){h("Problem data seem to be well scaled");if(t&Ri)return}t&Fi&&(v(e,15,.9),r=o(e,1),i=u(e,1),s=i/r,h(n("GM",r,i,s))),t&Ii&&(a(e,p(e)>d(e)),r=o(e,1),i=u(e,1),s=i/r,h(n("EQ",r,i,s)));if(t&qi){var f,l;for(f=1;f<=e.m;f++)Et(e,f,ua(xt(e,f)));for(l=1;l<=e.n;l++)St(e,l,ua(Tt(e,l)));r=o(e,1),i=u(e,1),s=i/r,h(n("2N",r,i,s))}}t&~(Fi|Ii|qi|Ri|Ui)&&l("glp_scale_prob: flags = "+t+"; invalid scaling options"),t&Ui&&(t=Fi|Ii|Ri),m(e,t)}})(typeof exports=="object"&&exports||this);